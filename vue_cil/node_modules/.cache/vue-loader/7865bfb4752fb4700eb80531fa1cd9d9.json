{"remainingRequest":"C:\\xampp\\htdocs\\xiuse_jie\\vue_cil\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\xampp\\htdocs\\xiuse_jie\\vue_cil\\src\\components\\live.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"C:\\xampp\\htdocs\\xiuse_jie\\vue_cil\\src\\components\\live.vue","mtime":1569261797712},{"path":"C:\\xampp\\htdocs\\xiuse_jie\\vue_cil\\node_modules\\css-loader\\index.js","mtime":1564486955159},{"path":"C:\\xampp\\htdocs\\xiuse_jie\\vue_cil\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1564486976742},{"path":"C:\\xampp\\htdocs\\xiuse_jie\\vue_cil\\node_modules\\postcss-loader\\src\\index.js","mtime":1564486966792},{"path":"C:\\xampp\\htdocs\\xiuse_jie\\vue_cil\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1564486950657},{"path":"C:\\xampp\\htdocs\\xiuse_jie\\vue_cil\\node_modules\\vue-loader\\lib\\index.js","mtime":1564486976739}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n.live .back{\r\n    position: fixed;\r\n    left:10px;\r\n    top:10px;\r\n    z-index: 999;\r\n}\r\n.live .videoBox{\r\n    position: relative;\r\n}\r\n.live .videoBox .focus{\r\n    width:30px;\r\n    height:30px;\r\n    position: absolute;\r\n    z-index: 999;\r\n    right:15px;\r\n    transform: translateY(-50%);\r\n    top:50%;\r\n    border-radius: 50%;\r\n    background-position: center;\r\n    background-repeat: no-repeat;\r\n    background-size: 100%;\r\n}\r\n.live .videoBox .no_focus{\r\n    background-image: url(\"//127.0.0.1:7000/img/usercard_no_focus_on.png\");\r\n}\r\n.live .videoBox .focused{\r\n    background-image: url(\"//127.0.0.1:7000/img/usercard_focused_on.png\");\r\n}\r\n\r\n",{"version":3,"sources":["live.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"live.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n    <div class=\"live\">\r\n        <div class=\"back\" @click=\"backSquare\"><van-icon name=\"arrow-left\" size=\"18px\"/></div>\r\n        <div class=\"videoBox\">\r\n            <div class=\"focus\" v-bind:class=\"{focused:focused,'no_focus':no_focus}\" v-on:click=\"focus\"></div>\r\n             <video  id=\"videobox\" autoplay class=\"video-js vjs-default-skin vjs-big-play-centered vjs-16-9\" preload=\"auto\" webkit-playsinline=\"true\" playsinline=\"true\" type=\"application/x-mpegURL\" allowsInlineMediaPlayback=YES  webview.allowsInlineMediaPlayback=YES  width='100%' ref='videoRef' x5-video-player-fullscreen=\"true\" poster=\"http://127.0.0.1:7000/img/showself.png\">\r\n            <source :src=\"$store.getters.getSourceSrc\">\r\n        </video>\r\n        </div>\r\n    </div>\r\n   \r\n       \r\n</template>\r\n<script>\r\n//引用videojs实现网页可以播放hls流的视频\r\nimport 'video.js/dist/video-js.css'\r\nimport videojs from 'video.js'\r\nimport 'videojs-contrib-hls'\r\nexport default {\r\n    data(){\r\n        return{\r\n            focused:false,\r\n            no_focus:true\r\n        }\r\n    },\r\n    \r\n    mounted(){\r\n        videojs('videobox',{\r\n            bigPlayButton: true,\r\n                    textTrackDisplay: true,\r\n                    posterImage: true,\r\n                    errorDisplay: false,\r\n                    controlBar: false,\r\n                    playbackRates: [0.5, 1, 1.5, 2],\r\n                    ControlBar:{\r\n                        customControlSpacer: true\r\n                    },\r\n                    function() {\r\n                        this.play()\r\n                    }\r\n        })\r\n       \r\n    },\r\n    beforeDestroy(){\r\n            const videoDom = this.$refs.videoRef;   //不能用document 获取节点\r\n            videojs(videoDom).dispose();  //销毁video实例，避免出现节点不存在 但是flash一直在执行,也避免重新进入页面video未重新声明\r\n    },\r\n    methods:{\r\n        backSquare(){\r\n            this.$router.push({name:'square'})\r\n        },\r\n        focus(){//关注\r\n            this.focused=!this.focused\r\n            this.no_focus=!this.no_focus\r\n            //判断有没有关注了主播，有关注，则发送后台移除关注，没关注，则发送后台添加关注\r\n            if(this.focused){\r\n                //未关注时，获取视频的信息，发送ajax到后台，添加关注的主播\r\n                this.axios.post(\"http://127.0.0.1:7000/square/saveFocus\",\r\n                    this.qs.stringify({\r\n                        hid:this.$route.params.hid,\r\n                        hallBg_src:this.$route.params.hallBg_src,\r\n                        hallRanking_src:this.$route.params.hallRanking_src,\r\n                        RankIcon_src:this.$route.params.RankIcon_src,\r\n                        sign:this.$route.params.sign,\r\n                        watchIcon_src:this.$route.params.watchIcon_src,\r\n                        watchNum:this.$route.params.watchNum,\r\n                        uid:this.$route.params.uid,//假设当前的用户3对应的id\r\n                        sourceSrc:this.$route.params.sourceSrc\r\n                    })\r\n                ).then(res=>{\r\n                    if(res.data.code===1) console.log(\"关注成功\")\r\n                })\r\n            }else{\r\n                //获取视频的id和当前用户的id，发送ajax到后台，移除关注的主播\r\n                this.axios.get(\"http://127.0.0.1:7000/square/canncelFocus\",{\r\n                    params:{\r\n                        uid:this.$store.getters.getUid,\r\n                        hid:this.$route.params.hid\r\n                    }\r\n                }).then(res=>{\r\n                    if(res.data.code===1) console.log(\"成功取消关注\")\r\n                })\r\n            }\r\n            \r\n            \r\n                        \r\n        }\r\n\r\n    },\r\n    created(){\r\n       //初始化关注按钮状态，发送ajax从后台获取\r\n       this.axios.get(\"http://127.0.0.1:7000/square/singleFocus\",{\r\n           params:{\r\n               uid:this.$store.getters.getUid,\r\n               hid:this.$route.params.hid\r\n           }\r\n       })\r\n       .then(res=>{\r\n        //    console.log(res.data.code)\r\n        //如果已经关注了，显示相应的关注按钮\r\n        if(res.data.code===1){\r\n            this.focused=true\r\n            this.no_focus=false\r\n        }\r\n       })\r\n    }\r\n}\r\n</script>\r\n<style>\r\n.live .back{\r\n    position: fixed;\r\n    left:10px;\r\n    top:10px;\r\n    z-index: 999;\r\n}\r\n.live .videoBox{\r\n    position: relative;\r\n}\r\n.live .videoBox .focus{\r\n    width:30px;\r\n    height:30px;\r\n    position: absolute;\r\n    z-index: 999;\r\n    right:15px;\r\n    transform: translateY(-50%);\r\n    top:50%;\r\n    border-radius: 50%;\r\n    background-position: center;\r\n    background-repeat: no-repeat;\r\n    background-size: 100%;\r\n}\r\n.live .videoBox .no_focus{\r\n    background-image: url(\"//127.0.0.1:7000/img/usercard_no_focus_on.png\");\r\n}\r\n.live .videoBox .focused{\r\n    background-image: url(\"//127.0.0.1:7000/img/usercard_focused_on.png\");\r\n}\r\n\r\n</style>\r\n\r\n"]}]}