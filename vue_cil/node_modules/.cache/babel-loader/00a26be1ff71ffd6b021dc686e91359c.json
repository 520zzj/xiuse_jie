{"remainingRequest":"C:\\xampp\\htdocs\\xiuse_jie\\vue_cil\\node_modules\\babel-loader\\lib\\index.js!C:\\xampp\\htdocs\\xiuse_jie\\vue_cil\\src\\lib\\mui\\js\\mui.js","dependencies":[{"path":"C:\\xampp\\htdocs\\xiuse_jie\\vue_cil\\src\\lib\\mui\\js\\mui.js","mtime":1564370151673},{"path":"C:\\xampp\\htdocs\\xiuse_jie\\vue_cil\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1563343078629},{"path":"C:\\xampp\\htdocs\\xiuse_jie\\vue_cil\\node_modules\\babel-loader\\lib\\index.js","mtime":1563343078283}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.to-string\";\nimport \"core-js/modules/es6.string.repeat\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.regexp.replace\";\nimport \"core-js/modules/es6.array.sort\";\nimport \"core-js/modules/es6.regexp.split\";\nimport \"core-js/modules/es6.regexp.match\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es6.object.set-prototype-of\";\nimport \"core-js/modules/es6.regexp.constructor\";\nimport _typeof from \"C:\\\\xampp\\\\htdocs\\\\xiuse_jie\\\\vue_cil\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/typeof\";\n\n/*!\r\n * =====================================================\r\n * Mui v3.7.0 (http://dev.dcloud.net.cn/mui)\r\n * =====================================================\r\n */\n\n/**\r\n * MUI核心JS\r\n * @type _L4.$|Function\r\n */\nvar mui = function (document, undefined) {\n  var readyRE = /complete|loaded|interactive/;\n  var idSelectorRE = /^#([\\w-]+)$/;\n  var classSelectorRE = /^\\.([\\w-]+)$/;\n  var tagSelectorRE = /^[\\w-]+$/;\n  var translateRE = /translate(?:3d)?\\((.+?)\\)/;\n  var translateMatrixRE = /matrix(3d)?\\((.+?)\\)/;\n\n  var $ = function $(selector, context) {\n    context = context || document;\n    if (!selector) return wrap();\n    if (_typeof(selector) === 'object') if ($.isArrayLike(selector)) {\n      return wrap($.slice.call(selector), null);\n    } else {\n      return wrap([selector], null);\n    }\n    if (typeof selector === 'function') return $.ready(selector);\n\n    if (typeof selector === 'string') {\n      try {\n        selector = selector.trim();\n\n        if (idSelectorRE.test(selector)) {\n          var found = document.getElementById(RegExp.$1);\n          return wrap(found ? [found] : []);\n        }\n\n        return wrap($.qsa(selector, context), selector);\n      } catch (e) {}\n    }\n\n    return wrap();\n  };\n\n  var wrap = function wrap(dom, selector) {\n    dom = dom || [];\n    Object.setPrototypeOf(dom, $.fn);\n    dom.selector = selector || '';\n    return dom;\n  };\n\n  $.uuid = 0;\n  $.data = {};\n  /**\r\n   * extend(simple)\r\n   * @param {type} target\r\n   * @param {type} source\r\n   * @param {type} deep\r\n   * @returns {unresolved}\r\n   */\n\n  $.extend = function () {\n    //from jquery2\n    var options,\n        name,\n        src,\n        copy,\n        copyIsArray,\n        clone,\n        target = arguments[0] || {},\n        i = 1,\n        length = arguments.length,\n        deep = false;\n\n    if (typeof target === \"boolean\") {\n      deep = target;\n      target = arguments[i] || {};\n      i++;\n    }\n\n    if (_typeof(target) !== \"object\" && !$.isFunction(target)) {\n      target = {};\n    }\n\n    if (i === length) {\n      target = this;\n      i--;\n    }\n\n    for (; i < length; i++) {\n      if ((options = arguments[i]) != null) {\n        for (name in options) {\n          src = target[name];\n          copy = options[name];\n\n          if (target === copy) {\n            continue;\n          }\n\n          if (deep && copy && ($.isPlainObject(copy) || (copyIsArray = $.isArray(copy)))) {\n            if (copyIsArray) {\n              copyIsArray = false;\n              clone = src && $.isArray(src) ? src : [];\n            } else {\n              clone = src && $.isPlainObject(src) ? src : {};\n            }\n\n            target[name] = $.extend(deep, clone, copy);\n          } else if (copy !== undefined) {\n            target[name] = copy;\n          }\n        }\n      }\n    }\n\n    return target;\n  };\n  /**\r\n   * mui noop(function)\r\n   */\n\n\n  $.noop = function () {};\n  /**\r\n   * mui slice(array)\r\n   */\n\n\n  $.slice = [].slice;\n  /**\r\n   * mui filter(array)\r\n   */\n\n  $.filter = [].filter;\n\n  $.type = function (obj) {\n    return obj == null ? String(obj) : class2type[{}.toString.call(obj)] || \"object\";\n  };\n  /**\r\n   * mui isArray\r\n   */\n\n\n  $.isArray = Array.isArray || function (object) {\n    return object instanceof Array;\n  };\n  /**\r\n   * mui isArrayLike \r\n   * @param {Object} obj\r\n   */\n\n\n  $.isArrayLike = function (obj) {\n    var length = !!obj && \"length\" in obj && obj.length;\n    var type = $.type(obj);\n\n    if (type === \"function\" || $.isWindow(obj)) {\n      return false;\n    }\n\n    return type === \"array\" || length === 0 || typeof length === \"number\" && length > 0 && length - 1 in obj;\n  };\n  /**\r\n   * mui isWindow(需考虑obj为undefined的情况)\r\n   */\n\n\n  $.isWindow = function (obj) {\n    return obj != null && obj === obj.window;\n  };\n  /**\r\n   * mui isObject\r\n   */\n\n\n  $.isObject = function (obj) {\n    return $.type(obj) === \"object\";\n  };\n  /**\r\n   * mui isPlainObject\r\n   */\n\n\n  $.isPlainObject = function (obj) {\n    return $.isObject(obj) && !$.isWindow(obj) && Object.getPrototypeOf(obj) === Object.prototype;\n  };\n  /**\r\n   * mui isEmptyObject\r\n   * @param {Object} o\r\n   */\n\n\n  $.isEmptyObject = function (o) {\n    for (var p in o) {\n      if (p !== undefined) {\n        return false;\n      }\n    }\n\n    return true;\n  };\n  /**\r\n   * mui isFunction\r\n   */\n\n\n  $.isFunction = function (value) {\n    return $.type(value) === \"function\";\n  };\n  /**\r\n   * mui querySelectorAll\r\n   * @param {type} selector\r\n   * @param {type} context\r\n   * @returns {Array}\r\n   */\n\n\n  $.qsa = function (selector, context) {\n    context = context || document;\n    return $.slice.call(classSelectorRE.test(selector) ? context.getElementsByClassName(RegExp.$1) : tagSelectorRE.test(selector) ? context.getElementsByTagName(selector) : context.querySelectorAll(selector));\n  };\n  /**\r\n   * ready(DOMContentLoaded)\r\n   * @param {type} callback\r\n   * @returns {_L6.$}\r\n   */\n\n\n  $.ready = function (callback) {\n    if (readyRE.test(document.readyState)) {\n      callback($);\n    } else {\n      document.addEventListener('DOMContentLoaded', function () {\n        callback($);\n      }, false);\n    }\n\n    return this;\n  };\n  /**\r\n   * 将 fn 缓存一段时间后, 再被调用执行\r\n   * 此方法为了避免在 ms 段时间内, 执行 fn 多次. 常用于 resize , scroll , mousemove 等连续性事件中;\r\n   * 当 ms 设置为 -1, 表示立即执行 fn, 即和直接调用 fn 一样;\r\n   * 调用返回函数的 stop 停止最后一次的 buffer 效果\r\n   * @param {Object} fn\r\n   * @param {Object} ms\r\n   * @param {Object} context\r\n   */\n\n\n  $.buffer = function (fn, ms, context) {\n    var timer;\n    var lastStart = 0;\n    var lastEnd = 0;\n    var ms = ms || 150;\n\n    function run() {\n      if (timer) {\n        timer.cancel();\n        timer = 0;\n      }\n\n      lastStart = $.now();\n      fn.apply(context || this, arguments);\n      lastEnd = $.now();\n    }\n\n    return $.extend(function () {\n      if (!lastStart || // 从未运行过\n      lastEnd >= lastStart && $.now() - lastEnd > ms || // 上次运行成功后已经超过ms毫秒\n      lastEnd < lastStart && $.now() - lastStart > ms * 8 // 上次运行或未完成，后8*ms毫秒\n      ) {\n          run.apply(this, arguments);\n        } else {\n        if (timer) {\n          timer.cancel();\n        }\n\n        timer = $.later(run, ms, null, $.slice.call(arguments));\n      }\n    }, {\n      stop: function stop() {\n        if (timer) {\n          timer.cancel();\n          timer = 0;\n        }\n      }\n    });\n  };\n  /**\r\n   * each\r\n   * @param {type} elements\r\n   * @param {type} callback\r\n   * @returns {_L8.$}\r\n   */\n\n\n  $.each = function (elements, callback, hasOwnProperty) {\n    if (!elements) {\n      return this;\n    }\n\n    if (typeof elements.length === 'number') {\n      [].every.call(elements, function (el, idx) {\n        return callback.call(el, idx, el) !== false;\n      });\n    } else {\n      for (var key in elements) {\n        if (hasOwnProperty) {\n          if (elements.hasOwnProperty(key)) {\n            if (callback.call(elements[key], key, elements[key]) === false) return elements;\n          }\n        } else {\n          if (callback.call(elements[key], key, elements[key]) === false) return elements;\n        }\n      }\n    }\n\n    return this;\n  };\n\n  $.focus = function (element) {\n    if ($.os.ios) {\n      setTimeout(function () {\n        element.focus();\n      }, 10);\n    } else {\n      element.focus();\n    }\n  };\n  /**\r\n   * trigger event\r\n   * @param {type} element\r\n   * @param {type} eventType\r\n   * @param {type} eventData\r\n   * @returns {_L8.$}\r\n   */\n\n\n  $.trigger = function (element, eventType, eventData) {\n    element.dispatchEvent(new CustomEvent(eventType, {\n      detail: eventData,\n      bubbles: true,\n      cancelable: true\n    }));\n    return this;\n  };\n  /**\r\n   * getStyles\r\n   * @param {type} element\r\n   * @param {type} property\r\n   * @returns {styles}\r\n   */\n\n\n  $.getStyles = function (element, property) {\n    var styles = element.ownerDocument.defaultView.getComputedStyle(element, null);\n\n    if (property) {\n      return styles.getPropertyValue(property) || styles[property];\n    }\n\n    return styles;\n  };\n  /**\r\n   * parseTranslate\r\n   * @param {type} translateString\r\n   * @param {type} position\r\n   * @returns {Object}\r\n   */\n\n\n  $.parseTranslate = function (translateString, position) {\n    var result = translateString.match(translateRE || '');\n\n    if (!result || !result[1]) {\n      result = ['', '0,0,0'];\n    }\n\n    result = result[1].split(\",\");\n    result = {\n      x: parseFloat(result[0]),\n      y: parseFloat(result[1]),\n      z: parseFloat(result[2])\n    };\n\n    if (position && result.hasOwnProperty(position)) {\n      return result[position];\n    }\n\n    return result;\n  };\n  /**\r\n   * parseTranslateMatrix\r\n   * @param {type} translateString\r\n   * @param {type} position\r\n   * @returns {Object}\r\n   */\n\n\n  $.parseTranslateMatrix = function (translateString, position) {\n    var matrix = translateString.match(translateMatrixRE);\n    var is3D = matrix && matrix[1];\n\n    if (matrix) {\n      matrix = matrix[2].split(\",\");\n      if (is3D === \"3d\") matrix = matrix.slice(12, 15);else {\n        matrix.push(0);\n        matrix = matrix.slice(4, 7);\n      }\n    } else {\n      matrix = [0, 0, 0];\n    }\n\n    var result = {\n      x: parseFloat(matrix[0]),\n      y: parseFloat(matrix[1]),\n      z: parseFloat(matrix[2])\n    };\n\n    if (position && result.hasOwnProperty(position)) {\n      return result[position];\n    }\n\n    return result;\n  };\n\n  $.hooks = {};\n\n  $.addAction = function (type, hook) {\n    var hooks = $.hooks[type];\n\n    if (!hooks) {\n      hooks = [];\n    }\n\n    hook.index = hook.index || 1000;\n    hooks.push(hook);\n    hooks.sort(function (a, b) {\n      return a.index - b.index;\n    });\n    $.hooks[type] = hooks;\n    return $.hooks[type];\n  };\n\n  $.doAction = function (type, callback) {\n    if ($.isFunction(callback)) {\n      //指定了callback\n      $.each($.hooks[type], callback);\n    } else {\n      //未指定callback，直接执行\n      $.each($.hooks[type], function (index, hook) {\n        return !hook.handle();\n      });\n    }\n  };\n  /**\r\n   * setTimeout封装\r\n   * @param {Object} fn\r\n   * @param {Object} when\r\n   * @param {Object} context\r\n   * @param {Object} data\r\n   */\n\n\n  $.later = function (fn, when, context, data) {\n    when = when || 0;\n    var m = fn;\n    var d = data;\n    var f;\n    var r;\n\n    if (typeof fn === 'string') {\n      m = context[fn];\n    }\n\n    f = function f() {\n      m.apply(context, $.isArray(d) ? d : [d]);\n    };\n\n    r = setTimeout(f, when);\n    return {\n      id: r,\n      cancel: function cancel() {\n        clearTimeout(r);\n      }\n    };\n  };\n\n  $.now = Date.now || function () {\n    return +new Date();\n  };\n\n  var class2type = {};\n  $.each(['Boolean', 'Number', 'String', 'Function', 'Array', 'Date', 'RegExp', 'Object', 'Error'], function (i, name) {\n    class2type[\"[object \" + name + \"]\"] = name.toLowerCase();\n  });\n\n  if (window.JSON) {\n    $.parseJSON = JSON.parse;\n  }\n  /**\r\n   * $.fn\r\n   */\n\n\n  $.fn = {\n    each: function each(callback) {\n      [].every.call(this, function (el, idx) {\n        return callback.call(el, idx, el) !== false;\n      });\n      return this;\n    }\n  };\n  /**\r\n   * 兼容 AMD 模块\r\n   **/\n\n  if (typeof define === 'function' && define.amd) {\n    define('mui', [], function () {\n      return $;\n    });\n  }\n\n  return $;\n}(document); //window.mui = mui;\n//'$' in window || (window.$ = mui);\n\n/**\r\n * $.os\r\n * @param {type} $\r\n * @returns {undefined}\r\n */\n\n\n(function ($, window) {\n  function detect(ua) {\n    this.os = {};\n    var funcs = [function () {\n      //wechat\n      var wechat = ua.match(/(MicroMessenger)\\/([\\d\\.]+)/i);\n\n      if (wechat) {\n        //wechat\n        this.os.wechat = {\n          version: wechat[2].replace(/_/g, '.')\n        };\n      }\n\n      return false;\n    }, function () {\n      //android\n      var android = ua.match(/(Android);?[\\s\\/]+([\\d.]+)?/);\n\n      if (android) {\n        this.os.android = true;\n        this.os.version = android[2];\n        this.os.isBadAndroid = !/Chrome\\/\\d/.test(window.navigator.appVersion);\n      }\n\n      return this.os.android === true;\n    }, function () {\n      //ios\n      var iphone = ua.match(/(iPhone\\sOS)\\s([\\d_]+)/);\n\n      if (iphone) {\n        //iphone\n        this.os.ios = this.os.iphone = true;\n        this.os.version = iphone[2].replace(/_/g, '.');\n      } else {\n        var ipad = ua.match(/(iPad).*OS\\s([\\d_]+)/);\n\n        if (ipad) {\n          //ipad\n          this.os.ios = this.os.ipad = true;\n          this.os.version = ipad[2].replace(/_/g, '.');\n        }\n      }\n\n      return this.os.ios === true;\n    }];\n    [].every.call(funcs, function (func) {\n      return !func.call($);\n    });\n  }\n\n  detect.call($, navigator.userAgent);\n})(mui, window);\n/**\r\n * $.os.plus\r\n * @param {type} $\r\n * @returns {undefined}\r\n */\n\n\n(function ($, document) {\n  function detect(ua) {\n    this.os = this.os || {};\n    var plus = ua.match(/Html5Plus/i); //TODO 5\\+Browser?\n\n    if (plus) {\n      this.os.plus = true;\n      $(function () {\n        document.body.classList.add('mui-plus');\n      });\n\n      if (ua.match(/StreamApp/i)) {\n        //TODO 最好有流应用自己的标识\n        this.os.stream = true;\n        $(function () {\n          document.body.classList.add('mui-plus-stream');\n        });\n      }\n    }\n  }\n\n  detect.call($, navigator.userAgent);\n})(mui, document);\n/**\r\n * 仅提供简单的on，off(仅支持事件委托，不支持当前元素绑定，当前元素绑定请直接使用addEventListener,removeEventListener)\r\n * @param {Object} $\r\n */\n\n\n(function ($) {\n  if ('ontouchstart' in window) {\n    $.isTouchable = true;\n    $.EVENT_START = 'touchstart';\n    $.EVENT_MOVE = 'touchmove';\n    $.EVENT_END = 'touchend';\n  } else {\n    $.isTouchable = false;\n    $.EVENT_START = 'mousedown';\n    $.EVENT_MOVE = 'mousemove';\n    $.EVENT_END = 'mouseup';\n  }\n\n  $.EVENT_CANCEL = 'touchcancel';\n  $.EVENT_CLICK = 'click';\n  var _mid = 1;\n  var delegates = {}; //需要wrap的函数\n\n  var eventMethods = {\n    preventDefault: 'isDefaultPrevented',\n    stopImmediatePropagation: 'isImmediatePropagationStopped',\n    stopPropagation: 'isPropagationStopped'\n  }; //默认true返回函数\n\n  var returnTrue = function returnTrue() {\n    return true;\n  }; //默认false返回函数\n\n\n  var returnFalse = function returnFalse() {\n    return false;\n  }; //wrap浏览器事件\n\n\n  var compatible = function compatible(event, target) {\n    if (!event.detail) {\n      event.detail = {\n        currentTarget: target\n      };\n    } else {\n      event.detail.currentTarget = target;\n    }\n\n    $.each(eventMethods, function (name, predicate) {\n      var sourceMethod = event[name];\n\n      event[name] = function () {\n        this[predicate] = returnTrue;\n        return sourceMethod && sourceMethod.apply(event, arguments);\n      };\n\n      event[predicate] = returnFalse;\n    }, true);\n    return event;\n  }; //简单的wrap对象_mid\n\n\n  var mid = function mid(obj) {\n    return obj && (obj._mid || (obj._mid = _mid++));\n  }; //事件委托对象绑定的事件回调列表\n\n\n  var delegateFns = {}; //返回事件委托的wrap事件回调\n\n  var delegateFn = function delegateFn(element, event, selector, callback) {\n    return function (e) {\n      //same event\n      var callbackObjs = delegates[element._mid][event];\n      var handlerQueue = [];\n      var target = e.target;\n      var selectorAlls = {};\n\n      for (; target && target !== document; target = target.parentNode) {\n        if (target === element) {\n          break;\n        }\n\n        if (~['click', 'tap', 'doubletap', 'longtap', 'hold'].indexOf(event) && (target.disabled || target.classList.contains('mui-disabled'))) {\n          break;\n        }\n\n        var matches = {};\n        $.each(callbackObjs, function (selector, callbacks) {\n          //same selector\n          selectorAlls[selector] || (selectorAlls[selector] = $.qsa(selector, element));\n\n          if (selectorAlls[selector] && ~selectorAlls[selector].indexOf(target)) {\n            if (!matches[selector]) {\n              matches[selector] = callbacks;\n            }\n          }\n        }, true);\n\n        if (!$.isEmptyObject(matches)) {\n          handlerQueue.push({\n            element: target,\n            handlers: matches\n          });\n        }\n      }\n\n      selectorAlls = null;\n      e = compatible(e); //compatible event\n\n      $.each(handlerQueue, function (index, handler) {\n        target = handler.element;\n        var tagName = target.tagName;\n\n        if (event === 'tap' && tagName !== 'INPUT' && tagName !== 'TEXTAREA' && tagName !== 'SELECT') {\n          e.preventDefault();\n          e.detail && e.detail.gesture && e.detail.gesture.preventDefault();\n        }\n\n        $.each(handler.handlers, function (index, handler) {\n          $.each(handler, function (index, callback) {\n            if (callback.call(target, e) === false) {\n              e.preventDefault();\n              e.stopPropagation();\n            }\n          }, true);\n        }, true);\n\n        if (e.isPropagationStopped()) {\n          return false;\n        }\n      }, true);\n    };\n  };\n\n  var findDelegateFn = function findDelegateFn(element, event) {\n    var delegateCallbacks = delegateFns[mid(element)];\n    var result = [];\n\n    if (delegateCallbacks) {\n      result = [];\n\n      if (event) {\n        var filterFn = function filterFn(fn) {\n          return fn.type === event;\n        };\n\n        return delegateCallbacks.filter(filterFn);\n      } else {\n        result = delegateCallbacks;\n      }\n    }\n\n    return result;\n  };\n\n  var preventDefaultException = /^(INPUT|TEXTAREA|BUTTON|SELECT)$/;\n  /**\r\n   * mui delegate events\r\n   * @param {type} event\r\n   * @param {type} selector\r\n   * @param {type} callback\r\n   * @returns {undefined}\r\n   */\n\n  $.fn.on = function (event, selector, callback) {\n    //仅支持简单的事件委托,主要是tap事件使用，类似mouse,focus之类暂不封装支持\n    return this.each(function () {\n      var element = this;\n      mid(element);\n      mid(callback);\n      var isAddEventListener = false;\n      var delegateEvents = delegates[element._mid] || (delegates[element._mid] = {});\n      var delegateCallbackObjs = delegateEvents[event] || (delegateEvents[event] = {});\n\n      if ($.isEmptyObject(delegateCallbackObjs)) {\n        isAddEventListener = true;\n      }\n\n      var delegateCallbacks = delegateCallbackObjs[selector] || (delegateCallbackObjs[selector] = []);\n      delegateCallbacks.push(callback);\n\n      if (isAddEventListener) {\n        var delegateFnArray = delegateFns[mid(element)];\n\n        if (!delegateFnArray) {\n          delegateFnArray = [];\n        }\n\n        var delegateCallback = delegateFn(element, event, selector, callback);\n        delegateFnArray.push(delegateCallback);\n        delegateCallback.i = delegateFnArray.length - 1;\n        delegateCallback.type = event;\n        delegateFns[mid(element)] = delegateFnArray;\n        element.addEventListener(event, delegateCallback);\n\n        if (event === 'tap') {\n          //TODO 需要找个更好的解决方案\n          element.addEventListener('click', function (e) {\n            if (e.target) {\n              var tagName = e.target.tagName;\n\n              if (!preventDefaultException.test(tagName)) {\n                if (tagName === 'A') {\n                  var href = e.target.href;\n\n                  if (!(href && ~href.indexOf('tel:'))) {\n                    e.preventDefault();\n                  }\n                } else {\n                  e.preventDefault();\n                }\n              }\n            }\n          });\n        }\n      }\n    });\n  };\n\n  $.fn.off = function (event, selector, callback) {\n    return this.each(function () {\n      var _mid = mid(this);\n\n      if (!event) {\n        //mui(selector).off();\n        delegates[_mid] && delete delegates[_mid];\n      } else if (!selector) {\n        //mui(selector).off(event);\n        delegates[_mid] && delete delegates[_mid][event];\n      } else if (!callback) {\n        //mui(selector).off(event,selector);\n        delegates[_mid] && delegates[_mid][event] && delete delegates[_mid][event][selector];\n      } else {\n        //mui(selector).off(event,selector,callback);\n        var delegateCallbacks = delegates[_mid] && delegates[_mid][event] && delegates[_mid][event][selector];\n        $.each(delegateCallbacks, function (index, delegateCallback) {\n          if (mid(delegateCallback) === mid(callback)) {\n            delegateCallbacks.splice(index, 1);\n            return false;\n          }\n        }, true);\n      }\n\n      if (delegates[_mid]) {\n        //如果off掉了所有当前element的指定的event事件，则remove掉当前element的delegate回调\n        if (!delegates[_mid][event] || $.isEmptyObject(delegates[_mid][event])) {\n          findDelegateFn(this, event).forEach(function (fn) {\n            this.removeEventListener(fn.type, fn);\n            delete delegateFns[_mid][fn.i];\n          }.bind(this));\n        }\n      } else {\n        //如果delegates[_mid]已不存在，删除所有\n        findDelegateFn(this).forEach(function (fn) {\n          this.removeEventListener(fn.type, fn);\n          delete delegateFns[_mid][fn.i];\n        }.bind(this));\n      }\n    });\n  };\n})(mui);\n/**\r\n * mui target(action>popover>modal>tab>toggle)\r\n */\n\n\n(function ($, window, document) {\n  /**\r\n   * targets\r\n   */\n  $.targets = {};\n  /**\r\n   * target handles\r\n   */\n\n  $.targetHandles = [];\n  /**\r\n   * register target\r\n   * @param {type} target\r\n   * @returns {$.targets}\r\n   */\n\n  $.registerTarget = function (target) {\n    target.index = target.index || 1000;\n    $.targetHandles.push(target);\n    $.targetHandles.sort(function (a, b) {\n      return a.index - b.index;\n    });\n    return $.targetHandles;\n  };\n\n  window.addEventListener($.EVENT_START, function (event) {\n    var target = event.target;\n    var founds = {};\n\n    for (; target && target !== document; target = target.parentNode) {\n      var isFound = false;\n      $.each($.targetHandles, function (index, targetHandle) {\n        var name = targetHandle.name;\n\n        if (!isFound && !founds[name] && targetHandle.hasOwnProperty('handle')) {\n          $.targets[name] = targetHandle.handle(event, target);\n\n          if ($.targets[name]) {\n            founds[name] = true;\n\n            if (targetHandle.isContinue !== true) {\n              isFound = true;\n            }\n          }\n        } else {\n          if (!founds[name]) {\n            if (targetHandle.isReset !== false) $.targets[name] = false;\n          }\n        }\n      });\n\n      if (isFound) {\n        break;\n      }\n    }\n  });\n  window.addEventListener('click', function (event) {\n    //解决touch与click的target不一致的问题(比如链接边缘点击时，touch的target为html，而click的target为A)\n    var target = event.target;\n    var isFound = false;\n\n    for (; target && target !== document; target = target.parentNode) {\n      if (target.tagName === 'A') {\n        $.each($.targetHandles, function (index, targetHandle) {\n          var name = targetHandle.name;\n\n          if (targetHandle.hasOwnProperty('handle')) {\n            if (targetHandle.handle(event, target)) {\n              isFound = true;\n              event.preventDefault();\n              return false;\n            }\n          }\n        });\n\n        if (isFound) {\n          break;\n        }\n      }\n    }\n  });\n})(mui, window, document);\n/**\r\n * fixed trim\r\n * @param {type} undefined\r\n * @returns {undefined}\r\n */\n\n\n(function (undefined) {\n  if (String.prototype.trim === undefined) {\n    // fix for iOS 3.2\n    String.prototype.trim = function () {\n      return this.replace(/^\\s+|\\s+$/g, '');\n    };\n  }\n\n  Object.setPrototypeOf = Object.setPrototypeOf || function (obj, proto) {\n    obj['__proto__'] = proto;\n    return obj;\n  };\n})();\n/**\r\n * fixed CustomEvent\r\n */\n\n\n(function () {\n  if (typeof window.CustomEvent === 'undefined') {\n    var _CustomEvent = function _CustomEvent(event, params) {\n      params = params || {\n        bubbles: false,\n        cancelable: false,\n        detail: undefined\n      };\n      var evt = document.createEvent('Events');\n      var bubbles = true;\n\n      for (var name in params) {\n        name === 'bubbles' ? bubbles = !!params[name] : evt[name] = params[name];\n      }\n\n      evt.initEvent(event, bubbles, true);\n      return evt;\n    };\n\n    ;\n    _CustomEvent.prototype = window.Event.prototype;\n    window.CustomEvent = _CustomEvent;\n  }\n})();\n/*\r\n\tA shim for non ES5 supporting browsers.\r\n\tAdds function bind to Function prototype, so that you can do partial application.\r\n\tWorks even with the nasty thing, where the first word is the opposite of extranet, the second one is the profession of Columbus, and the version number is 9, flipped 180 degrees.\r\n*/\n\n\nFunction.prototype.bind = Function.prototype.bind || function (to) {\n  // Make an array of our arguments, starting from second argument\n  var partial = Array.prototype.splice.call(arguments, 1),\n      // We'll need the original function.\n  fn = this;\n\n  var bound = function bound() {\n    // Join the already applied arguments to the now called ones (after converting to an array again).\n    var args = partial.concat(Array.prototype.splice.call(arguments, 0)); // If not being called as a constructor\n\n    if (!(this instanceof bound)) {\n      // return the result of the function called bound to target and partially applied.\n      return fn.apply(to, args);\n    } // If being called as a constructor, apply the function bound to self.\n\n\n    fn.apply(this, args);\n  }; // Attach the prototype of the function to our newly created function.\n\n\n  bound.prototype = fn.prototype;\n  return bound;\n};\n/**\r\n * mui fixed classList\r\n * @param {type} document\r\n * @returns {undefined}\r\n */\n\n\n(function (document) {\n  if (!(\"classList\" in document.documentElement) && Object.defineProperty && typeof HTMLElement !== 'undefined') {\n    Object.defineProperty(HTMLElement.prototype, 'classList', {\n      get: function get() {\n        var self = this;\n\n        function update(fn) {\n          return function (value) {\n            var classes = self.className.split(/\\s+/),\n                index = classes.indexOf(value);\n            fn(classes, index, value);\n            self.className = classes.join(\" \");\n          };\n        }\n\n        var ret = {\n          add: update(function (classes, index, value) {\n            ~index || classes.push(value);\n          }),\n          remove: update(function (classes, index) {\n            ~index && classes.splice(index, 1);\n          }),\n          toggle: update(function (classes, index, value) {\n            ~index ? classes.splice(index, 1) : classes.push(value);\n          }),\n          contains: function contains(value) {\n            return !!~self.className.split(/\\s+/).indexOf(value);\n          },\n          item: function item(i) {\n            return self.className.split(/\\s+/)[i] || null;\n          }\n        };\n        Object.defineProperty(ret, 'length', {\n          get: function get() {\n            return self.className.split(/\\s+/).length;\n          }\n        });\n        return ret;\n      }\n    });\n  }\n})(document);\n/**\r\n * mui fixed requestAnimationFrame\r\n * @param {type} window\r\n * @returns {undefined}\r\n */\n\n\n(function (window) {\n  if (!window.requestAnimationFrame) {\n    var lastTime = 0;\n\n    window.requestAnimationFrame = window.webkitRequestAnimationFrame || function (callback, element) {\n      var currTime = new Date().getTime();\n      var timeToCall = Math.max(0, 16.7 - (currTime - lastTime));\n      var id = window.setTimeout(function () {\n        callback(currTime + timeToCall);\n      }, timeToCall);\n      lastTime = currTime + timeToCall;\n      return id;\n    };\n\n    window.cancelAnimationFrame = window.webkitCancelAnimationFrame || window.webkitCancelRequestAnimationFrame || function (id) {\n      clearTimeout(id);\n    };\n  }\n\n  ;\n})(window);\n/**\r\n * fastclick(only for radio,checkbox)\r\n */\n\n\n(function ($, window, name) {\n  if (!$.os.android && !$.os.ios) {\n    //目前仅识别android和ios\n    return;\n  }\n\n  if (window.FastClick) {\n    return;\n  }\n\n  var handle = function handle(event, target) {\n    if (target.tagName === 'LABEL') {\n      if (target.parentNode) {\n        target = target.parentNode.querySelector('input');\n      }\n    }\n\n    if (target && (target.type === 'radio' || target.type === 'checkbox')) {\n      if (!target.disabled) {\n        //disabled\n        return target;\n      }\n    }\n\n    return false;\n  };\n\n  $.registerTarget({\n    name: name,\n    index: 40,\n    handle: handle,\n    target: false\n  });\n\n  var dispatchEvent = function dispatchEvent(event) {\n    var targetElement = $.targets.click;\n\n    if (targetElement) {\n      var clickEvent, touch; // On some Android devices activeElement needs to be blurred otherwise the synthetic click will have no effect\n\n      if (document.activeElement && document.activeElement !== targetElement) {\n        document.activeElement.blur();\n      }\n\n      touch = event.detail.gesture.changedTouches[0]; // Synthesise a click event, with an extra attribute so it can be tracked\n\n      clickEvent = document.createEvent('MouseEvents');\n      clickEvent.initMouseEvent('click', true, true, window, 1, touch.screenX, touch.screenY, touch.clientX, touch.clientY, false, false, false, false, 0, null);\n      clickEvent.forwardedTouchEvent = true;\n      targetElement.dispatchEvent(clickEvent);\n      event.detail && event.detail.gesture.preventDefault();\n    }\n  };\n\n  window.addEventListener('tap', dispatchEvent);\n  window.addEventListener('doubletap', dispatchEvent); //捕获\n\n  window.addEventListener('click', function (event) {\n    if ($.targets.click) {\n      if (!event.forwardedTouchEvent) {\n        //stop click\n        if (event.stopImmediatePropagation) {\n          event.stopImmediatePropagation();\n        } else {\n          // Part of the hack for browsers that don't support Event#stopImmediatePropagation\n          event.propagationStopped = true;\n        }\n\n        event.stopPropagation();\n        event.preventDefault();\n        return false;\n      }\n    }\n  }, true);\n})(mui, window, 'click');\n\n(function ($, document) {\n  $(function () {\n    if (!$.os.ios) {\n      return;\n    }\n\n    var CLASS_FOCUSIN = 'mui-focusin';\n    var CLASS_BAR_TAB = 'mui-bar-tab';\n    var CLASS_BAR_FOOTER = 'mui-bar-footer';\n    var CLASS_BAR_FOOTER_SECONDARY = 'mui-bar-footer-secondary';\n    var CLASS_BAR_FOOTER_SECONDARY_TAB = 'mui-bar-footer-secondary-tab'; // var content = document.querySelector('.' + CLASS_CONTENT);\n    // if (content) {\n    // \tdocument.body.insertBefore(content, document.body.firstElementChild);\n    // }\n\n    document.addEventListener('focusin', function (e) {\n      if ($.os.plus) {\n        //在父webview里边不fix\n        if (window.plus) {\n          if (plus.webview.currentWebview().children().length > 0) {\n            return;\n          }\n        }\n      }\n\n      var target = e.target; //TODO 需考虑所有键盘弹起的情况\n\n      if (target.tagName && (target.tagName === 'TEXTAREA' || target.tagName === 'INPUT' && (target.type === 'text' || target.type === 'search' || target.type === 'number'))) {\n        if (target.disabled || target.readOnly) {\n          return;\n        }\n\n        document.body.classList.add(CLASS_FOCUSIN);\n        var isFooter = false;\n\n        for (; target && target !== document; target = target.parentNode) {\n          var classList = target.classList;\n\n          if (classList && classList.contains(CLASS_BAR_TAB) || classList.contains(CLASS_BAR_FOOTER) || classList.contains(CLASS_BAR_FOOTER_SECONDARY) || classList.contains(CLASS_BAR_FOOTER_SECONDARY_TAB)) {\n            isFooter = true;\n            break;\n          }\n        }\n\n        if (isFooter) {\n          var scrollTop = document.body.scrollHeight;\n          var scrollLeft = document.body.scrollLeft;\n          setTimeout(function () {\n            window.scrollTo(scrollLeft, scrollTop);\n          }, 20);\n        }\n      }\n    });\n    document.addEventListener('focusout', function (e) {\n      var classList = document.body.classList;\n\n      if (classList.contains(CLASS_FOCUSIN)) {\n        classList.remove(CLASS_FOCUSIN);\n        setTimeout(function () {\n          window.scrollTo(document.body.scrollLeft, document.body.scrollTop);\n        }, 20);\n      }\n    });\n  });\n})(mui, document);\n/**\r\n * mui namespace(optimization)\r\n * @param {type} $\r\n * @returns {undefined}\r\n */\n\n\n(function ($) {\n  $.namespace = 'mui';\n  $.classNamePrefix = $.namespace + '-';\n  $.classSelectorPrefix = '.' + $.classNamePrefix;\n  /**\r\n   * 返回正确的className\r\n   * @param {type} className\r\n   * @returns {String}\r\n   */\n\n  $.className = function (className) {\n    return $.classNamePrefix + className;\n  };\n  /**\r\n   * 返回正确的classSelector\r\n   * @param {type} classSelector\r\n   * @returns {String}\r\n   */\n\n\n  $.classSelector = function (classSelector) {\n    return classSelector.replace(/\\./g, $.classSelectorPrefix);\n  };\n  /**\r\n          * 返回正确的eventName\r\n          * @param {type} event\r\n          * @param {type} module\r\n          * @returns {String}\r\n          */\n\n\n  $.eventName = function (event, module) {\n    return event + ($.namespace ? '.' + $.namespace : '') + (module ? '.' + module : '');\n  };\n})(mui);\n/**\r\n * mui gestures\r\n * @param {type} $\r\n * @param {type} window\r\n * @returns {undefined}\r\n */\n\n\n(function ($, window) {\n  $.gestures = {\n    session: {}\n  };\n  /**\r\n   * Gesture preventDefault\r\n   * @param {type} e\r\n   * @returns {undefined}\r\n   */\n\n  $.preventDefault = function (e) {\n    e.preventDefault();\n  };\n  /**\r\n   * Gesture stopPropagation\r\n   * @param {type} e\r\n   * @returns {undefined}\r\n   */\n\n\n  $.stopPropagation = function (e) {\n    e.stopPropagation();\n  };\n  /**\r\n   * register gesture\r\n   * @param {type} gesture\r\n   * @returns {$.gestures}\r\n   */\n\n\n  $.addGesture = function (gesture) {\n    return $.addAction('gestures', gesture);\n  };\n\n  var round = Math.round;\n  var abs = Math.abs;\n  var sqrt = Math.sqrt;\n  var atan = Math.atan;\n  var atan2 = Math.atan2;\n  /**\r\n   * distance\r\n   * @param {type} p1\r\n   * @param {type} p2\r\n   * @returns {Number}\r\n   */\n\n  var getDistance = function getDistance(p1, p2, props) {\n    if (!props) {\n      props = ['x', 'y'];\n    }\n\n    var x = p2[props[0]] - p1[props[0]];\n    var y = p2[props[1]] - p1[props[1]];\n    return sqrt(x * x + y * y);\n  };\n  /**\r\n   * scale\r\n   * @param {Object} starts\r\n   * @param {Object} moves\r\n   */\n\n\n  var getScale = function getScale(starts, moves) {\n    if (starts.length >= 2 && moves.length >= 2) {\n      var props = ['pageX', 'pageY'];\n      return getDistance(moves[1], moves[0], props) / getDistance(starts[1], starts[0], props);\n    }\n\n    return 1;\n  };\n  /**\r\n   * angle\r\n   * @param {type} p1\r\n   * @param {type} p2\r\n   * @returns {Number}\r\n   */\n\n\n  var getAngle = function getAngle(p1, p2, props) {\n    if (!props) {\n      props = ['x', 'y'];\n    }\n\n    var x = p2[props[0]] - p1[props[0]];\n    var y = p2[props[1]] - p1[props[1]];\n    return atan2(y, x) * 180 / Math.PI;\n  };\n  /**\r\n   * direction\r\n   * @param {Object} x\r\n   * @param {Object} y\r\n   */\n\n\n  var getDirection = function getDirection(x, y) {\n    if (x === y) {\n      return '';\n    }\n\n    if (abs(x) >= abs(y)) {\n      return x > 0 ? 'left' : 'right';\n    }\n\n    return y > 0 ? 'up' : 'down';\n  };\n  /**\r\n   * rotation\r\n   * @param {Object} start\r\n   * @param {Object} end\r\n   */\n\n\n  var getRotation = function getRotation(start, end) {\n    var props = ['pageX', 'pageY'];\n    return getAngle(end[1], end[0], props) - getAngle(start[1], start[0], props);\n  };\n  /**\r\n   * px per ms\r\n   * @param {Object} deltaTime\r\n   * @param {Object} x\r\n   * @param {Object} y\r\n   */\n\n\n  var getVelocity = function getVelocity(deltaTime, x, y) {\n    return {\n      x: x / deltaTime || 0,\n      y: y / deltaTime || 0\n    };\n  };\n  /**\r\n   * detect gestures\r\n   * @param {type} event\r\n   * @param {type} touch\r\n   * @returns {undefined}\r\n   */\n\n\n  var detect = function detect(event, touch) {\n    if ($.gestures.stoped) {\n      return;\n    }\n\n    $.doAction('gestures', function (index, gesture) {\n      if (!$.gestures.stoped) {\n        if ($.options.gestureConfig[gesture.name] !== false) {\n          gesture.handle(event, touch);\n        }\n      }\n    });\n  };\n  /**\r\n   * 暂时无用\r\n   * @param {Object} node\r\n   * @param {Object} parent\r\n   */\n\n\n  var hasParent = function hasParent(node, parent) {\n    while (node) {\n      if (node == parent) {\n        return true;\n      }\n\n      node = node.parentNode;\n    }\n\n    return false;\n  };\n\n  var uniqueArray = function uniqueArray(src, key, sort) {\n    var results = [];\n    var values = [];\n    var i = 0;\n\n    while (i < src.length) {\n      var val = key ? src[i][key] : src[i];\n\n      if (values.indexOf(val) < 0) {\n        results.push(src[i]);\n      }\n\n      values[i] = val;\n      i++;\n    }\n\n    if (sort) {\n      if (!key) {\n        results = results.sort();\n      } else {\n        results = results.sort(function sortUniqueArray(a, b) {\n          return a[key] > b[key];\n        });\n      }\n    }\n\n    return results;\n  };\n\n  var getMultiCenter = function getMultiCenter(touches) {\n    var touchesLength = touches.length;\n\n    if (touchesLength === 1) {\n      return {\n        x: round(touches[0].pageX),\n        y: round(touches[0].pageY)\n      };\n    }\n\n    var x = 0;\n    var y = 0;\n    var i = 0;\n\n    while (i < touchesLength) {\n      x += touches[i].pageX;\n      y += touches[i].pageY;\n      i++;\n    }\n\n    return {\n      x: round(x / touchesLength),\n      y: round(y / touchesLength)\n    };\n  };\n\n  var multiTouch = function multiTouch() {\n    return $.options.gestureConfig.pinch;\n  };\n\n  var copySimpleTouchData = function copySimpleTouchData(touch) {\n    var touches = [];\n    var i = 0;\n\n    while (i < touch.touches.length) {\n      touches[i] = {\n        pageX: round(touch.touches[i].pageX),\n        pageY: round(touch.touches[i].pageY)\n      };\n      i++;\n    }\n\n    return {\n      timestamp: $.now(),\n      gesture: touch.gesture,\n      touches: touches,\n      center: getMultiCenter(touch.touches),\n      deltaX: touch.deltaX,\n      deltaY: touch.deltaY\n    };\n  };\n\n  var calDelta = function calDelta(touch) {\n    var session = $.gestures.session;\n    var center = touch.center;\n    var offset = session.offsetDelta || {};\n    var prevDelta = session.prevDelta || {};\n    var prevTouch = session.prevTouch || {};\n\n    if (touch.gesture.type === $.EVENT_START || touch.gesture.type === $.EVENT_END) {\n      prevDelta = session.prevDelta = {\n        x: prevTouch.deltaX || 0,\n        y: prevTouch.deltaY || 0\n      };\n      offset = session.offsetDelta = {\n        x: center.x,\n        y: center.y\n      };\n    }\n\n    touch.deltaX = prevDelta.x + (center.x - offset.x);\n    touch.deltaY = prevDelta.y + (center.y - offset.y);\n  };\n\n  var calTouchData = function calTouchData(touch) {\n    var session = $.gestures.session;\n    var touches = touch.touches;\n    var touchesLength = touches.length;\n\n    if (!session.firstTouch) {\n      session.firstTouch = copySimpleTouchData(touch);\n    }\n\n    if (multiTouch() && touchesLength > 1 && !session.firstMultiTouch) {\n      session.firstMultiTouch = copySimpleTouchData(touch);\n    } else if (touchesLength === 1) {\n      session.firstMultiTouch = false;\n    }\n\n    var firstTouch = session.firstTouch;\n    var firstMultiTouch = session.firstMultiTouch;\n    var offsetCenter = firstMultiTouch ? firstMultiTouch.center : firstTouch.center;\n    var center = touch.center = getMultiCenter(touches);\n    touch.timestamp = $.now();\n    touch.deltaTime = touch.timestamp - firstTouch.timestamp;\n    touch.angle = getAngle(offsetCenter, center);\n    touch.distance = getDistance(offsetCenter, center);\n    calDelta(touch);\n    touch.offsetDirection = getDirection(touch.deltaX, touch.deltaY);\n    touch.scale = firstMultiTouch ? getScale(firstMultiTouch.touches, touches) : 1;\n    touch.rotation = firstMultiTouch ? getRotation(firstMultiTouch.touches, touches) : 0;\n    calIntervalTouchData(touch);\n  };\n\n  var CAL_INTERVAL = 25;\n\n  var calIntervalTouchData = function calIntervalTouchData(touch) {\n    var session = $.gestures.session;\n    var last = session.lastInterval || touch;\n    var deltaTime = touch.timestamp - last.timestamp;\n    var velocity;\n    var velocityX;\n    var velocityY;\n    var direction;\n\n    if (touch.gesture.type != $.EVENT_CANCEL && (deltaTime > CAL_INTERVAL || last.velocity === undefined)) {\n      var deltaX = last.deltaX - touch.deltaX;\n      var deltaY = last.deltaY - touch.deltaY;\n      var v = getVelocity(deltaTime, deltaX, deltaY);\n      velocityX = v.x;\n      velocityY = v.y;\n      velocity = abs(v.x) > abs(v.y) ? v.x : v.y;\n      direction = getDirection(deltaX, deltaY) || last.direction;\n      session.lastInterval = touch;\n    } else {\n      velocity = last.velocity;\n      velocityX = last.velocityX;\n      velocityY = last.velocityY;\n      direction = last.direction;\n    }\n\n    touch.velocity = velocity;\n    touch.velocityX = velocityX;\n    touch.velocityY = velocityY;\n    touch.direction = direction;\n  };\n\n  var targetIds = {};\n\n  var convertTouches = function convertTouches(touches) {\n    for (var i = 0; i < touches.length; i++) {\n      !touches['identifier'] && (touches['identifier'] = 0);\n    }\n\n    return touches;\n  };\n\n  var getTouches = function getTouches(event, touch) {\n    var allTouches = convertTouches($.slice.call(event.touches || [event]));\n    var type = event.type;\n    var targetTouches = [];\n    var changedTargetTouches = []; //当touchstart或touchmove且touches长度为1，直接获得all和changed\n\n    if ((type === $.EVENT_START || type === $.EVENT_MOVE) && allTouches.length === 1) {\n      targetIds[allTouches[0].identifier] = true;\n      targetTouches = allTouches;\n      changedTargetTouches = allTouches;\n      touch.target = event.target;\n    } else {\n      var i = 0;\n      var targetTouches = [];\n      var changedTargetTouches = [];\n      var changedTouches = convertTouches($.slice.call(event.changedTouches || [event]));\n      touch.target = event.target;\n      var sessionTarget = $.gestures.session.target || event.target;\n      targetTouches = allTouches.filter(function (touch) {\n        return hasParent(touch.target, sessionTarget);\n      });\n\n      if (type === $.EVENT_START) {\n        i = 0;\n\n        while (i < targetTouches.length) {\n          targetIds[targetTouches[i].identifier] = true;\n          i++;\n        }\n      }\n\n      i = 0;\n\n      while (i < changedTouches.length) {\n        if (targetIds[changedTouches[i].identifier]) {\n          changedTargetTouches.push(changedTouches[i]);\n        }\n\n        if (type === $.EVENT_END || type === $.EVENT_CANCEL) {\n          delete targetIds[changedTouches[i].identifier];\n        }\n\n        i++;\n      }\n\n      if (!changedTargetTouches.length) {\n        return false;\n      }\n    }\n\n    targetTouches = uniqueArray(targetTouches.concat(changedTargetTouches), 'identifier', true);\n    var touchesLength = targetTouches.length;\n    var changedTouchesLength = changedTargetTouches.length;\n\n    if (type === $.EVENT_START && touchesLength - changedTouchesLength === 0) {\n      //first\n      touch.isFirst = true;\n      $.gestures.touch = $.gestures.session = {\n        target: event.target\n      };\n    }\n\n    touch.isFinal = (type === $.EVENT_END || type === $.EVENT_CANCEL) && touchesLength - changedTouchesLength === 0;\n    touch.touches = targetTouches;\n    touch.changedTouches = changedTargetTouches;\n    return true;\n  };\n\n  var handleTouchEvent = function handleTouchEvent(event) {\n    var touch = {\n      gesture: event\n    };\n    var touches = getTouches(event, touch);\n\n    if (!touches) {\n      return;\n    }\n\n    calTouchData(touch);\n    detect(event, touch);\n    $.gestures.session.prevTouch = touch;\n\n    if (event.type === $.EVENT_END && !$.isTouchable) {\n      $.gestures.touch = $.gestures.session = {};\n    }\n  };\n\n  window.addEventListener($.EVENT_START, handleTouchEvent);\n  window.addEventListener($.EVENT_MOVE, handleTouchEvent);\n  window.addEventListener($.EVENT_END, handleTouchEvent);\n  window.addEventListener($.EVENT_CANCEL, handleTouchEvent); //fixed hashchange(android)\n\n  window.addEventListener($.EVENT_CLICK, function (e) {\n    //TODO 应该判断当前target是不是在targets.popover内部，而不是非要相等\n    if (($.os.android || $.os.ios) && ($.targets.popover && e.target === $.targets.popover || $.targets.tab || $.targets.offcanvas || $.targets.modal)) {\n      e.preventDefault();\n    }\n  }, true); //增加原生滚动识别\n\n  $.isScrolling = false;\n  var scrollingTimeout = null;\n  window.addEventListener('scroll', function () {\n    $.isScrolling = true;\n    scrollingTimeout && clearTimeout(scrollingTimeout);\n    scrollingTimeout = setTimeout(function () {\n      $.isScrolling = false;\n    }, 250);\n  });\n})(mui, window);\n/**\r\n * mui gesture flick[left|right|up|down]\r\n * @param {type} $\r\n * @param {type} name\r\n * @returns {undefined}\r\n */\n\n\n(function ($, name) {\n  var flickStartTime = 0;\n\n  var handle = function handle(event, touch) {\n    var session = $.gestures.session;\n    var options = this.options;\n    var now = $.now();\n\n    switch (event.type) {\n      case $.EVENT_MOVE:\n        if (now - flickStartTime > 300) {\n          flickStartTime = now;\n          session.flickStart = touch.center;\n        }\n\n        break;\n\n      case $.EVENT_END:\n      case $.EVENT_CANCEL:\n        touch.flick = false;\n\n        if (session.flickStart && options.flickMaxTime > now - flickStartTime && touch.distance > options.flickMinDistince) {\n          touch.flick = true;\n          touch.flickTime = now - flickStartTime;\n          touch.flickDistanceX = touch.center.x - session.flickStart.x;\n          touch.flickDistanceY = touch.center.y - session.flickStart.y;\n          $.trigger(session.target, name, touch);\n          $.trigger(session.target, name + touch.direction, touch);\n        }\n\n        break;\n    }\n  };\n  /**\r\n   * mui gesture flick\r\n   */\n\n\n  $.addGesture({\n    name: name,\n    index: 5,\n    handle: handle,\n    options: {\n      flickMaxTime: 200,\n      flickMinDistince: 10\n    }\n  });\n})(mui, 'flick');\n/**\r\n * mui gesture swipe[left|right|up|down]\r\n * @param {type} $\r\n * @param {type} name\r\n * @returns {undefined}\r\n */\n\n\n(function ($, name) {\n  var handle = function handle(event, touch) {\n    var session = $.gestures.session;\n\n    if (event.type === $.EVENT_END || event.type === $.EVENT_CANCEL) {\n      var options = this.options;\n      touch.swipe = false; //TODO 后续根据velocity计算\n\n      if (touch.direction && options.swipeMaxTime > touch.deltaTime && touch.distance > options.swipeMinDistince) {\n        touch.swipe = true;\n        $.trigger(session.target, name, touch);\n        $.trigger(session.target, name + touch.direction, touch);\n      }\n    }\n  };\n  /**\r\n   * mui gesture swipe\r\n   */\n\n\n  $.addGesture({\n    name: name,\n    index: 10,\n    handle: handle,\n    options: {\n      swipeMaxTime: 300,\n      swipeMinDistince: 18\n    }\n  });\n})(mui, 'swipe');\n/**\r\n * mui gesture drag[start|left|right|up|down|end]\r\n * @param {type} $\r\n * @param {type} name\r\n * @returns {undefined}\r\n */\n\n\n(function ($, name) {\n  var handle = function handle(event, touch) {\n    var session = $.gestures.session;\n\n    switch (event.type) {\n      case $.EVENT_START:\n        break;\n\n      case $.EVENT_MOVE:\n        if (!touch.direction || !session.target) {\n          return;\n        } //修正direction,可在session期间自行锁定拖拽方向，方便开发scroll类不同方向拖拽插件嵌套\n\n\n        if (session.lockDirection && session.startDirection) {\n          if (session.startDirection && session.startDirection !== touch.direction) {\n            if (session.startDirection === 'up' || session.startDirection === 'down') {\n              touch.direction = touch.deltaY < 0 ? 'up' : 'down';\n            } else {\n              touch.direction = touch.deltaX < 0 ? 'left' : 'right';\n            }\n          }\n        }\n\n        if (!session.drag) {\n          session.drag = true;\n          $.trigger(session.target, name + 'start', touch);\n        }\n\n        $.trigger(session.target, name, touch);\n        $.trigger(session.target, name + touch.direction, touch);\n        break;\n\n      case $.EVENT_END:\n      case $.EVENT_CANCEL:\n        if (session.drag && touch.isFinal) {\n          $.trigger(session.target, name + 'end', touch);\n        }\n\n        break;\n    }\n  };\n  /**\r\n   * mui gesture drag\r\n   */\n\n\n  $.addGesture({\n    name: name,\n    index: 20,\n    handle: handle,\n    options: {\n      fingers: 1\n    }\n  });\n})(mui, 'drag');\n/**\r\n * mui gesture tap and doubleTap\r\n * @param {type} $\r\n * @param {type} name\r\n * @returns {undefined}\r\n */\n\n\n(function ($, name) {\n  var lastTarget;\n  var lastTapTime;\n\n  var handle = function handle(event, touch) {\n    var session = $.gestures.session;\n    var options = this.options;\n\n    switch (event.type) {\n      case $.EVENT_END:\n        if (!touch.isFinal) {\n          return;\n        }\n\n        var target = session.target;\n\n        if (!target || target.disabled || target.classList && target.classList.contains('mui-disabled')) {\n          return;\n        }\n\n        if (touch.distance < options.tapMaxDistance && touch.deltaTime < options.tapMaxTime) {\n          if ($.options.gestureConfig.doubletap && lastTarget && lastTarget === target) {\n            //same target\n            if (lastTapTime && touch.timestamp - lastTapTime < options.tapMaxInterval) {\n              $.trigger(target, 'doubletap', touch);\n              lastTapTime = $.now();\n              lastTarget = target;\n              return;\n            }\n          }\n\n          $.trigger(target, name, touch);\n          lastTapTime = $.now();\n          lastTarget = target;\n        }\n\n        break;\n    }\n  };\n  /**\r\n   * mui gesture tap\r\n   */\n\n\n  $.addGesture({\n    name: name,\n    index: 30,\n    handle: handle,\n    options: {\n      fingers: 1,\n      tapMaxInterval: 300,\n      tapMaxDistance: 5,\n      tapMaxTime: 250\n    }\n  });\n})(mui, 'tap');\n/**\r\n * mui gesture longtap\r\n * @param {type} $\r\n * @param {type} name\r\n * @returns {undefined}\r\n */\n\n\n(function ($, name) {\n  var timer;\n\n  var handle = function handle(event, touch) {\n    var session = $.gestures.session;\n    var options = this.options;\n\n    switch (event.type) {\n      case $.EVENT_START:\n        clearTimeout(timer);\n        timer = setTimeout(function () {\n          $.trigger(session.target, name, touch);\n        }, options.holdTimeout);\n        break;\n\n      case $.EVENT_MOVE:\n        if (touch.distance > options.holdThreshold) {\n          clearTimeout(timer);\n        }\n\n        break;\n\n      case $.EVENT_END:\n      case $.EVENT_CANCEL:\n        clearTimeout(timer);\n        break;\n    }\n  };\n  /**\r\n   * mui gesture longtap\r\n   */\n\n\n  $.addGesture({\n    name: name,\n    index: 10,\n    handle: handle,\n    options: {\n      fingers: 1,\n      holdTimeout: 500,\n      holdThreshold: 2\n    }\n  });\n})(mui, 'longtap');\n/**\r\n * mui gesture hold\r\n * @param {type} $\r\n * @param {type} name\r\n * @returns {undefined}\r\n */\n\n\n(function ($, name) {\n  var timer;\n\n  var handle = function handle(event, touch) {\n    var session = $.gestures.session;\n    var options = this.options;\n\n    switch (event.type) {\n      case $.EVENT_START:\n        if ($.options.gestureConfig.hold) {\n          timer && clearTimeout(timer);\n          timer = setTimeout(function () {\n            touch.hold = true;\n            $.trigger(session.target, name, touch);\n          }, options.holdTimeout);\n        }\n\n        break;\n\n      case $.EVENT_MOVE:\n        break;\n\n      case $.EVENT_END:\n      case $.EVENT_CANCEL:\n        if (timer) {\n          clearTimeout(timer) && (timer = null);\n          $.trigger(session.target, 'release', touch);\n        }\n\n        break;\n    }\n  };\n  /**\r\n   * mui gesture hold\r\n   */\n\n\n  $.addGesture({\n    name: name,\n    index: 10,\n    handle: handle,\n    options: {\n      fingers: 1,\n      holdTimeout: 0\n    }\n  });\n})(mui, 'hold');\n/**\r\n * mui gesture pinch\r\n * @param {type} $\r\n * @param {type} name\r\n * @returns {undefined}\r\n */\n\n\n(function ($, name) {\n  var handle = function handle(event, touch) {\n    var options = this.options;\n    var session = $.gestures.session;\n\n    switch (event.type) {\n      case $.EVENT_START:\n        break;\n\n      case $.EVENT_MOVE:\n        if ($.options.gestureConfig.pinch) {\n          if (touch.touches.length < 2) {\n            return;\n          }\n\n          if (!session.pinch) {\n            //start\n            session.pinch = true;\n            $.trigger(session.target, name + 'start', touch);\n          }\n\n          $.trigger(session.target, name, touch);\n          var scale = touch.scale;\n          var rotation = touch.rotation;\n          var lastScale = typeof touch.lastScale === 'undefined' ? 1 : touch.lastScale;\n          var scaleDiff = 0.000000000001; //防止scale与lastScale相等，不触发事件的情况。\n\n          if (scale > lastScale) {\n            //out\n            lastScale = scale - scaleDiff;\n            $.trigger(session.target, name + 'out', touch);\n          } //in\n          else if (scale < lastScale) {\n              lastScale = scale + scaleDiff;\n              $.trigger(session.target, name + 'in', touch);\n            }\n\n          if (Math.abs(rotation) > options.minRotationAngle) {\n            $.trigger(session.target, 'rotate', touch);\n          }\n        }\n\n        break;\n\n      case $.EVENT_END:\n      case $.EVENT_CANCEL:\n        if ($.options.gestureConfig.pinch && session.pinch && touch.touches.length === 2) {\n          session.pinch = false;\n          $.trigger(session.target, name + 'end', touch);\n        }\n\n        break;\n    }\n  };\n  /**\r\n   * mui gesture pinch\r\n   */\n\n\n  $.addGesture({\n    name: name,\n    index: 10,\n    handle: handle,\n    options: {\n      minRotationAngle: 0\n    }\n  });\n})(mui, 'pinch');\n/**\r\n * mui.init\r\n * @param {type} $\r\n * @returns {undefined}\r\n */\n\n\n(function ($) {\n  $.global = $.options = {\n    gestureConfig: {\n      tap: true,\n      doubletap: false,\n      longtap: false,\n      hold: false,\n      flick: true,\n      swipe: true,\n      drag: true,\n      pinch: false\n    }\n  };\n  /**\r\n   *\r\n   * @param {type} options\r\n   * @returns {undefined}\r\n   */\n\n  $.initGlobal = function (options) {\n    $.options = $.extend(true, $.global, options);\n    return this;\n  };\n\n  var inits = {};\n  /**\r\n   * 单页配置 初始化\r\n   * @param {object} options\r\n   */\n\n  $.init = function (options) {\n    $.options = $.extend(true, $.global, options || {});\n    $.ready(function () {\n      $.doAction('inits', function (index, init) {\n        var isInit = !!(!inits[init.name] || init.repeat);\n\n        if (isInit) {\n          init.handle.call($);\n          inits[init.name] = true;\n        }\n      });\n    });\n    return this;\n  };\n  /**\r\n   * 增加初始化执行流程\r\n   * @param {function} init\r\n   */\n\n\n  $.addInit = function (init) {\n    return $.addAction('inits', init);\n  };\n  /**\r\n   * 处理html5版本subpages \r\n   */\n\n\n  $.addInit({\n    name: 'iframe',\n    index: 100,\n    handle: function handle() {\n      var options = $.options;\n      var subpages = options.subpages || [];\n\n      if (!$.os.plus && subpages.length) {\n        //暂时只处理单个subpage。后续可以考虑支持多个subpage\n        createIframe(subpages[0]);\n      }\n    }\n  });\n\n  var createIframe = function createIframe(options) {\n    var wrapper = document.createElement('div');\n    wrapper.className = 'mui-iframe-wrapper';\n    var styles = options.styles || {};\n\n    if (typeof styles.top !== 'string') {\n      styles.top = '0px';\n    }\n\n    if (typeof styles.bottom !== 'string') {\n      styles.bottom = '0px';\n    }\n\n    wrapper.style.top = styles.top;\n    wrapper.style.bottom = styles.bottom;\n    var iframe = document.createElement('iframe');\n    iframe.src = options.url;\n    iframe.id = options.id || options.url;\n    iframe.name = iframe.id;\n    wrapper.appendChild(iframe);\n    document.body.appendChild(wrapper); //目前仅处理微信\n\n    $.os.wechat && handleScroll(wrapper, iframe);\n  };\n\n  function handleScroll(wrapper, iframe) {\n    var key = 'MUI_SCROLL_POSITION_' + document.location.href + '_' + iframe.src;\n    var scrollTop = parseFloat(localStorage.getItem(key)) || 0;\n\n    if (scrollTop) {\n      (function (y) {\n        iframe.onload = function () {\n          window.scrollTo(0, y);\n        };\n      })(scrollTop);\n    }\n\n    setInterval(function () {\n      var _scrollTop = window.scrollY;\n\n      if (scrollTop !== _scrollTop) {\n        localStorage.setItem(key, _scrollTop + '');\n        scrollTop = _scrollTop;\n      }\n    }, 100);\n  }\n\n  ;\n  $(function () {\n    var classList = document.body.classList;\n    var os = [];\n\n    if ($.os.ios) {\n      os.push({\n        os: 'ios',\n        version: $.os.version\n      });\n      classList.add('mui-ios');\n    } else if ($.os.android) {\n      os.push({\n        os: 'android',\n        version: $.os.version\n      });\n      classList.add('mui-android');\n    }\n\n    if ($.os.wechat) {\n      os.push({\n        os: 'wechat',\n        version: $.os.wechat.version\n      });\n      classList.add('mui-wechat');\n    }\n\n    if (os.length) {\n      $.each(os, function (index, osObj) {\n        var version = '';\n        var classArray = [];\n\n        if (osObj.version) {\n          $.each(osObj.version.split('.'), function (i, v) {\n            version = version + (version ? '-' : '') + v;\n            classList.add($.className(osObj.os + '-' + version));\n          });\n        }\n      });\n    }\n  });\n})(mui);\n/**\r\n * mui.init 5+\r\n * @param {type} $\r\n * @returns {undefined}\r\n */\n\n\n(function ($) {\n  var defaultOptions = {\n    swipeBack: false,\n    preloadPages: [],\n    //5+ lazyLoad webview\n    preloadLimit: 10,\n    //预加载窗口的数量限制(一旦超出，先进先出)\n    keyEventBind: {\n      backbutton: true,\n      menubutton: true\n    },\n    titleConfig: {\n      height: \"44px\",\n      backgroundColor: \"#f7f7f7\",\n      //导航栏背景色\n      bottomBorderColor: \"#cccccc\",\n      //底部边线颜色\n      title: {\n        //标题配置\n        text: \"\",\n        //标题文字\n        position: {\n          top: 0,\n          left: 0,\n          width: \"100%\",\n          height: \"100%\"\n        },\n        styles: {\n          color: \"#000000\",\n          align: \"center\",\n          family: \"'Helvetica Neue',Helvetica,sans-serif\",\n          size: \"17px\",\n          style: \"normal\",\n          weight: \"normal\",\n          fontSrc: \"\"\n        }\n      },\n      back: {\n        image: {\n          base64Data: '',\n          imgSrc: '',\n          sprite: {\n            top: '0px',\n            left: '0px',\n            width: '100%',\n            height: '100%'\n          },\n          position: {\n            top: \"10px\",\n            left: \"10px\",\n            width: \"24px\",\n            height: \"24px\"\n          }\n        }\n      }\n    }\n  }; //默认页面动画\n\n  var defaultShow = {\n    event: \"titleUpdate\",\n    autoShow: true,\n    duration: 300,\n    aniShow: 'slide-in-right',\n    extras: {}\n  }; //若执行了显示动画初始化操作，则要覆盖默认配置\n\n  if ($.options.show) {\n    defaultShow = $.extend(true, defaultShow, $.options.show);\n  }\n\n  $.currentWebview = null;\n  $.extend(true, $.global, defaultOptions);\n  $.extend(true, $.options, defaultOptions);\n  /**\r\n   * 等待动画配置\r\n   * @param {type} options\r\n   * @returns {Object}\r\n   */\n\n  $.waitingOptions = function (options) {\n    return $.extend(true, {}, {\n      autoShow: true,\n      title: '',\n      modal: false\n    }, options);\n  };\n  /**\r\n   * 窗口显示配置\r\n   * @param {type} options\r\n   * @returns {Object}\r\n   */\n\n\n  $.showOptions = function (options) {\n    return $.extend(true, {}, defaultShow, options);\n  };\n  /**\r\n   * 窗口默认配置\r\n   * @param {type} options\r\n   * @returns {Object}\r\n   */\n\n\n  $.windowOptions = function (options) {\n    return $.extend({\n      scalable: false,\n      bounce: \"\" //vertical\n\n    }, options);\n  };\n  /**\r\n   * plusReady\r\n   * @param {type} callback\r\n   * @returns {_L6.$}\r\n   */\n\n\n  $.plusReady = function (callback) {\n    if (window.plus) {\n      setTimeout(function () {\n        //解决callback与plusready事件的执行时机问题(典型案例:showWaiting,closeWaiting)\n        callback();\n      }, 0);\n    } else {\n      document.addEventListener(\"plusready\", function () {\n        callback();\n      }, false);\n    }\n\n    return this;\n  };\n  /**\r\n   * 5+ event(5+没提供之前我自己实现)\r\n   * @param {type} webview\r\n   * @param {type} eventType\r\n   * @param {type} data\r\n   * @returns {undefined}\r\n   */\n\n\n  $.fire = function (webview, eventType, data) {\n    if (webview) {\n      if (typeof data === 'undefined') {\n        data = '';\n      } else if (typeof data === 'boolean' || typeof data === 'number') {\n        webview.evalJS(\"typeof mui!=='undefined'&&mui.receive('\" + eventType + \"',\" + data + \")\");\n        return;\n      } else if ($.isPlainObject(data) || $.isArray(data)) {\n        data = JSON.stringify(data || {}).replace(/\\'/g, \"\\\\u0027\").replace(/\\\\/g, \"\\\\u005c\");\n      }\n\n      webview.evalJS(\"typeof mui!=='undefined'&&mui.receive('\" + eventType + \"','\" + data + \"')\");\n    }\n  };\n  /**\r\n   * 5+ event(5+没提供之前我自己实现)\r\n   * @param {type} eventType\r\n   * @param {type} data\r\n   * @returns {undefined}\r\n   */\n\n\n  $.receive = function (eventType, data) {\n    if (eventType) {\n      try {\n        if (data && typeof data === 'string') {\n          data = JSON.parse(data);\n        }\n      } catch (e) {}\n\n      $.trigger(document, eventType, data);\n    }\n  };\n\n  var triggerPreload = function triggerPreload(webview) {\n    if (!webview.preloaded) {\n      //保证仅触发一次\n      $.fire(webview, 'preload');\n      var list = webview.children();\n\n      for (var i = 0; i < list.length; i++) {\n        $.fire(list[i], 'preload');\n      }\n\n      webview.preloaded = true;\n    }\n  };\n\n  var trigger = function trigger(webview, eventType, timeChecked) {\n    if (timeChecked) {\n      if (!webview[eventType + 'ed']) {\n        $.fire(webview, eventType);\n        var list = webview.children();\n\n        for (var i = 0; i < list.length; i++) {\n          $.fire(list[i], eventType);\n        }\n\n        webview[eventType + 'ed'] = true;\n      }\n    } else {\n      $.fire(webview, eventType);\n      var list = webview.children();\n\n      for (var i = 0; i < list.length; i++) {\n        $.fire(list[i], eventType);\n      }\n    }\n  };\n  /**\r\n   * 打开新窗口\r\n   * @param {string} url 要打开的页面地址\r\n   * @param {string} id 指定页面ID\r\n   * @param {object} options 可选:参数,等待,窗口,显示配置{params:{},waiting:{},styles:{},show:{}}\r\n   */\n\n\n  $.openWindow = function (url, id, options) {\n    if (_typeof(url) === 'object') {\n      options = url;\n      url = options.url;\n      id = options.id || url;\n    } else {\n      if (_typeof(id) === 'object') {\n        options = id;\n        id = options.id || url;\n      } else {\n        id = id || url;\n      }\n    }\n\n    if (!$.os.plus) {\n      //TODO 先临时这么处理：手机上顶层跳，PC上parent跳\n      if ($.os.ios || $.os.android) {\n        window.top.location.href = url;\n      } else {\n        window.parent.location.href = url;\n      }\n\n      return;\n    }\n\n    if (!window.plus) {\n      return;\n    }\n\n    options = options || {};\n    var params = options.params || {};\n    var webview = null,\n        webviewCache = null,\n        nShow,\n        nWaiting;\n\n    if ($.webviews[id]) {\n      webviewCache = $.webviews[id]; //webview真实存在，才能获取\n\n      if (plus.webview.getWebviewById(id)) {\n        webview = webviewCache.webview;\n      }\n    } else if (options.createNew !== true) {\n      webview = plus.webview.getWebviewById(id);\n    }\n\n    if (webview) {\n      //已缓存\n      //每次show都需要传递动画参数；\n      //预加载的动画参数优先级：openWindow配置>preloadPages配置>mui默认配置；\n      nShow = webviewCache ? webviewCache.show : defaultShow;\n      nShow = options.show ? $.extend(nShow, options.show) : nShow;\n      nShow.autoShow && webview.show(nShow.aniShow, nShow.duration, function () {\n        triggerPreload(webview);\n        trigger(webview, 'pagebeforeshow', false);\n      });\n\n      if (webviewCache) {\n        webviewCache.afterShowMethodName && webview.evalJS(webviewCache.afterShowMethodName + '(\\'' + JSON.stringify(params) + '\\')');\n      }\n\n      return webview;\n    } else {\n      //新窗口\n      if (!url) {\n        throw new Error('webview[' + id + '] does not exist');\n      } //显示waiting\n\n\n      var waitingConfig = $.waitingOptions(options.waiting);\n\n      if (waitingConfig.autoShow) {\n        nWaiting = plus.nativeUI.showWaiting(waitingConfig.title, waitingConfig.options);\n      } //创建页面\n\n\n      options = $.extend(options, {\n        id: id,\n        url: url\n      });\n      webview = $.createWindow(options); //显示\n\n      nShow = $.showOptions(options.show);\n\n      if (nShow.autoShow) {\n        var showWebview = function showWebview() {\n          //关闭等待框\n          if (nWaiting) {\n            nWaiting.close();\n          } //显示页面\n\n\n          webview.show(nShow.aniShow, nShow.duration, function () {}, nShow.extras);\n          options.afterShowMethodName && webview.evalJS(options.afterShowMethodName + '(\\'' + JSON.stringify(params) + '\\')');\n        }; //titleUpdate触发时机早于loaded，更换为titleUpdate后，可以更早的显示webview\n\n\n        webview.addEventListener(nShow.event, showWebview, false); //loaded事件发生后，触发预加载和pagebeforeshow事件\n\n        webview.addEventListener(\"loaded\", function () {\n          triggerPreload(webview);\n          trigger(webview, 'pagebeforeshow', false);\n        }, false);\n      }\n    }\n\n    return webview;\n  };\n\n  $.openWindowWithTitle = function (options, titleConfig) {\n    options = options || {};\n    var url = options.url;\n    var id = options.id || url;\n\n    if (!$.os.plus) {\n      //TODO 先临时这么处理：手机上顶层跳，PC上parent跳\n      if ($.os.ios || $.os.android) {\n        window.top.location.href = url;\n      } else {\n        window.parent.location.href = url;\n      }\n\n      return;\n    }\n\n    if (!window.plus) {\n      return;\n    }\n\n    var params = options.params || {};\n    var webview = null,\n        webviewCache = null,\n        nShow,\n        nWaiting;\n\n    if ($.webviews[id]) {\n      webviewCache = $.webviews[id]; //webview真实存在，才能获取\n\n      if (plus.webview.getWebviewById(id)) {\n        webview = webviewCache.webview;\n      }\n    } else if (options.createNew !== true) {\n      webview = plus.webview.getWebviewById(id);\n    }\n\n    if (webview) {\n      //已缓存\n      //每次show都需要传递动画参数；\n      //预加载的动画参数优先级：openWindow配置>preloadPages配置>mui默认配置；\n      nShow = webviewCache ? webviewCache.show : defaultShow;\n      nShow = options.show ? $.extend(nShow, options.show) : nShow;\n      nShow.autoShow && webview.show(nShow.aniShow, nShow.duration, function () {\n        triggerPreload(webview);\n        trigger(webview, 'pagebeforeshow', false);\n      });\n\n      if (webviewCache) {\n        webviewCache.afterShowMethodName && webview.evalJS(webviewCache.afterShowMethodName + '(\\'' + JSON.stringify(params) + '\\')');\n      }\n\n      return webview;\n    } else {\n      //新窗口\n      if (!url) {\n        throw new Error('webview[' + id + '] does not exist');\n      } //显示waiting\n\n\n      var waitingConfig = $.waitingOptions(options.waiting);\n\n      if (waitingConfig.autoShow) {\n        nWaiting = plus.nativeUI.showWaiting(waitingConfig.title, waitingConfig.options);\n      } //创建页面\n\n\n      options = $.extend(options, {\n        id: id,\n        url: url\n      });\n      webview = $.createWindow(options);\n\n      if (titleConfig) {\n        //处理原生头\n        $.extend(true, $.options.titleConfig, titleConfig);\n        var tid = $.options.titleConfig.id ? $.options.titleConfig.id : id + \"_title\";\n        var view = new plus.nativeObj.View(tid, {\n          top: 0,\n          height: $.options.titleConfig.height,\n          width: \"100%\",\n          dock: \"top\",\n          position: \"dock\"\n        });\n        view.drawRect($.options.titleConfig.backgroundColor); //绘制背景色\n\n        var _b = parseInt($.options.titleConfig.height) - 1;\n\n        view.drawRect($.options.titleConfig.bottomBorderColor, {\n          top: _b + \"px\",\n          left: \"0px\"\n        }); //绘制底部边线\n        //绘制文字\n\n        if ($.options.titleConfig.title.text) {\n          var _title = $.options.titleConfig.title;\n          view.drawText(_title.text, _title.position, _title.styles);\n        } //返回图标绘制\n\n\n        var _back = $.options.titleConfig.back;\n        var backClick = null; //优先字体\n        //其次是图片\n\n        var _backImage = _back.image;\n\n        if (_backImage.base64Data || _backImage.imgSrc) {\n          //TODO 此处需要处理百分比的情况\n          backClick = {\n            left: parseInt(_backImage.position.left),\n            right: parseInt(_backImage.position.left) + parseInt(_backImage.position.width)\n          };\n          var bitmap = new plus.nativeObj.Bitmap(id + \"_back\");\n\n          if (_backImage.base64Data) {\n            //优先base64编码字符串\n            bitmap.loadBase64Data(_backImage.base64Data);\n          } else {\n            //其次加载图片文件\n            bitmap.load(_backImage.imgSrc);\n          }\n\n          view.drawBitmap(bitmap, _backImage.sprite, _backImage.position);\n        } //处理点击事件\n\n\n        view.setTouchEventRect({\n          top: \"0px\",\n          left: \"0px\",\n          width: \"100%\",\n          height: \"100%\"\n        });\n        view.interceptTouchEvent(true);\n        view.addEventListener(\"click\", function (e) {\n          var x = e.clientX; //返回按钮点击\n\n          if (backClick && x > backClick.left && x < backClick.right) {\n            if (_back.click && $.isFunction(_back.click)) {\n              _back.click();\n            } else {\n              webview.evalJS(\"window.mui&&mui.back();\");\n            }\n          }\n        }, false);\n        webview.append(view);\n      } //显示\n\n\n      nShow = $.showOptions(options.show);\n\n      if (nShow.autoShow) {\n        //titleUpdate触发时机早于loaded，更换为titleUpdate后，可以更早的显示webview\n        webview.addEventListener(nShow.event, function () {\n          //关闭等待框\n          if (nWaiting) {\n            nWaiting.close();\n          } //显示页面\n\n\n          webview.show(nShow.aniShow, nShow.duration, function () {}, nShow.extras);\n        }, false);\n      }\n    }\n\n    return webview;\n  };\n  /**\r\n   * 根据配置信息创建一个webview\r\n   * @param {type} options\r\n   * @param {type} isCreate\r\n   * @returns {webview}\r\n   */\n\n\n  $.createWindow = function (options, isCreate) {\n    if (!window.plus) {\n      return;\n    }\n\n    var id = options.id || options.url;\n    var webview;\n\n    if (options.preload) {\n      if ($.webviews[id] && $.webviews[id].webview.getURL()) {\n        //已经cache\n        webview = $.webviews[id].webview;\n      } else {\n        //新增预加载窗口\n        //判断是否携带createNew参数，默认为false\n        if (options.createNew !== true) {\n          webview = plus.webview.getWebviewById(id);\n        } //之前没有，那就新创建\t\n\n\n        if (!webview) {\n          webview = plus.webview.create(options.url, id, $.windowOptions(options.styles), $.extend({\n            preload: true\n          }, options.extras));\n\n          if (options.subpages) {\n            $.each(options.subpages, function (index, subpage) {\n              var subpageId = subpage.id || subpage.url;\n\n              if (subpageId) {\n                //过滤空对象\n                var subWebview = plus.webview.getWebviewById(subpageId);\n\n                if (!subWebview) {\n                  //如果该webview不存在，则创建\n                  subWebview = plus.webview.create(subpage.url, subpageId, $.windowOptions(subpage.styles), $.extend({\n                    preload: true\n                  }, subpage.extras));\n                }\n\n                webview.append(subWebview);\n              }\n            });\n          }\n        }\n      } //TODO 理论上，子webview也应该计算到预加载队列中，但这样就麻烦了，要退必须退整体，否则可能出现问题；\n\n\n      $.webviews[id] = {\n        webview: webview,\n        //目前仅preload的缓存webview\n        preload: true,\n        show: $.showOptions(options.show),\n        afterShowMethodName: options.afterShowMethodName //就不应该用evalJS。应该是通过事件消息通讯\n\n      }; //索引该预加载窗口\n\n      var preloads = $.data.preloads;\n      var index = preloads.indexOf(id);\n\n      if (~index) {\n        //删除已存在的(变相调整插入位置)\n        preloads.splice(index, 1);\n      }\n\n      preloads.push(id);\n\n      if (preloads.length > $.options.preloadLimit) {\n        //先进先出\n        var first = $.data.preloads.shift();\n        var webviewCache = $.webviews[first];\n\n        if (webviewCache && webviewCache.webview) {\n          //需要将自己打开的所有页面，全部close；\n          //关闭该预加载webview\t\n          $.closeAll(webviewCache.webview);\n        } //删除缓存\n\n\n        delete $.webviews[first];\n      }\n    } else {\n      if (isCreate !== false) {\n        //直接创建非预加载窗口\n        webview = plus.webview.create(options.url, id, $.windowOptions(options.styles), options.extras);\n\n        if (options.subpages) {\n          $.each(options.subpages, function (index, subpage) {\n            var subpageId = subpage.id || subpage.url;\n            var subWebview = plus.webview.getWebviewById(subpageId);\n\n            if (!subWebview) {\n              subWebview = plus.webview.create(subpage.url, subpageId, $.windowOptions(subpage.styles), subpage.extras);\n            }\n\n            webview.append(subWebview);\n          });\n        }\n      }\n    }\n\n    return webview;\n  };\n  /**\r\n   * 预加载\r\n   */\n\n\n  $.preload = function (options) {\n    //调用预加载函数，不管是否传递preload参数，强制变为true\n    if (!options.preload) {\n      options.preload = true;\n    }\n\n    return $.createWindow(options);\n  };\n  /**\r\n   *关闭当前webview打开的所有webview；\r\n   */\n\n\n  $.closeOpened = function (webview) {\n    var opened = webview.opened();\n\n    if (opened) {\n      for (var i = 0, len = opened.length; i < len; i++) {\n        var openedWebview = opened[i];\n        var open_open = openedWebview.opened();\n\n        if (open_open && open_open.length > 0) {\n          //关闭打开的webview\n          $.closeOpened(openedWebview); //关闭自己\n\n          openedWebview.close(\"none\");\n        } else {\n          //如果直接孩子节点，就不用关闭了，因为父关闭的时候，会自动关闭子；\n          if (openedWebview.parent() !== webview) {\n            openedWebview.close('none');\n          }\n        }\n      }\n    }\n  };\n\n  $.closeAll = function (webview, aniShow) {\n    $.closeOpened(webview);\n\n    if (aniShow) {\n      webview.close(aniShow);\n    } else {\n      webview.close();\n    }\n  };\n  /**\r\n   * 批量创建webview\r\n   * @param {type} options\r\n   * @returns {undefined}\r\n   */\n\n\n  $.createWindows = function (options) {\n    $.each(options, function (index, option) {\n      //初始化预加载窗口(创建)和非预加载窗口(仅配置，不创建)\n      $.createWindow(option, false);\n    });\n  };\n  /**\r\n   * 创建当前页面的子webview\r\n   * @param {type} options\r\n   * @returns {webview}\r\n   */\n\n\n  $.appendWebview = function (options) {\n    if (!window.plus) {\n      return;\n    }\n\n    var id = options.id || options.url;\n    var webview;\n\n    if (!$.webviews[id]) {\n      //保证执行一遍\n      //TODO 这里也有隐患，比如某个webview不是作为subpage创建的，而是作为target webview的话；\n      if (!plus.webview.getWebviewById(id)) {\n        webview = plus.webview.create(options.url, id, options.styles, options.extras);\n      } //之前的实现方案：子窗口loaded之后再append到父窗口中；\n      //问题：部分子窗口loaded事件发生较晚，此时执行父窗口的children方法会返回空，导致父子通讯失败；\n      //     比如父页面执行完preload事件后，需触发子页面的preload事件，此时未append的话，就无法触发；\n      //修改方式：不再监控loaded事件，直接append\n      //by chb@20150521\n      // webview.addEventListener('loaded', function() {\n\n\n      plus.webview.currentWebview().append(webview); // });\n\n      $.webviews[id] = options;\n    }\n\n    return webview;\n  }; //全局webviews\n\n\n  $.webviews = {}; //预加载窗口索引\n\n  $.data.preloads = []; //$.currentWebview\n\n  $.plusReady(function () {\n    $.currentWebview = plus.webview.currentWebview();\n  });\n  $.addInit({\n    name: '5+',\n    index: 100,\n    handle: function handle() {\n      var options = $.options;\n      var subpages = options.subpages || [];\n\n      if ($.os.plus) {\n        $.plusReady(function () {\n          //TODO  这里需要判断一下，最好等子窗口加载完毕后，再调用主窗口的show方法；\n          //或者：在openwindow方法中，监听实现；\n          $.each(subpages, function (index, subpage) {\n            $.appendWebview(subpage);\n          }); //判断是否首页\n\n          if (plus.webview.currentWebview() === plus.webview.getWebviewById(plus.runtime.appid)) {\n            //首页需要自己激活预加载；\n            //timeout因为子页面loaded之后才append的，防止子页面尚未append、从而导致其preload未触发的问题；\n            setTimeout(function () {\n              triggerPreload(plus.webview.currentWebview());\n            }, 300);\n          } //设置ios顶部状态栏颜色；\n\n\n          if ($.os.ios && $.options.statusBarBackground) {\n            plus.navigator.setStatusBarBackground($.options.statusBarBackground);\n          }\n\n          if ($.os.android && parseFloat($.os.version) < 4.4) {\n            //解决Android平台4.4版本以下，resume后，父窗体标题延迟渲染的问题；\n            if (plus.webview.currentWebview().parent() == null) {\n              document.addEventListener(\"resume\", function () {\n                var body = document.body;\n                body.style.display = 'none';\n                setTimeout(function () {\n                  body.style.display = '';\n                }, 10);\n              });\n            }\n          }\n        });\n      } else {//已支持iframe嵌入\n        //\t\t\t\tif (subpages.length > 0) {\n        //\t\t\t\t\tvar err = document.createElement('div');\n        //\t\t\t\t\terr.className = 'mui-error';\n        //\t\t\t\t\t//文字描述\n        //\t\t\t\t\tvar span = document.createElement('span');\n        //\t\t\t\t\tspan.innerHTML = '在该浏览器下，不支持创建子页面，具体参考';\n        //\t\t\t\t\terr.appendChild(span);\n        //\t\t\t\t\tvar a = document.createElement('a');\n        //\t\t\t\t\ta.innerHTML = '\"mui框架适用场景\"';\n        //\t\t\t\t\ta.href = 'http://ask.dcloud.net.cn/article/113';\n        //\t\t\t\t\terr.appendChild(a);\n        //\t\t\t\t\tdocument.body.appendChild(err);\n        //\t\t\t\t\tconsole.log('在该浏览器下，不支持创建子页面');\n        //\t\t\t\t}\n      }\n    }\n  });\n  window.addEventListener('preload', function () {\n    //处理预加载部分\n    var webviews = $.options.preloadPages || [];\n    $.plusReady(function () {\n      $.each(webviews, function (index, webview) {\n        $.createWindow($.extend(webview, {\n          preload: true\n        }));\n      });\n    });\n  });\n\n  $.supportStatusbarOffset = function () {\n    return $.os.plus && $.os.ios && parseFloat($.os.version) >= 7;\n  };\n\n  $.ready(function () {\n    //标识当前环境支持statusbar\n    if ($.supportStatusbarOffset()) {\n      document.body.classList.add('mui-statusbar');\n    }\n  });\n})(mui);\n/**\r\n * mui back\r\n * @param {type} $\r\n * @param {type} window\r\n * @returns {undefined}\r\n */\n\n\n(function ($, window) {\n  /**\r\n   * register back\r\n   * @param {type} back\r\n   * @returns {$.gestures}\r\n   */\n  $.addBack = function (back) {\n    return $.addAction('backs', back);\n  };\n  /**\r\n   * default\r\n   */\n\n\n  $.addBack({\n    name: 'browser',\n    index: 100,\n    handle: function handle() {\n      if (window.history.length > 1) {\n        window.history.back();\n        return true;\n      }\n\n      return false;\n    }\n  });\n  /**\r\n   * 后退\r\n   */\n\n  $.back = function () {\n    if (typeof $.options.beforeback === 'function') {\n      if ($.options.beforeback() === false) {\n        return;\n      }\n    }\n\n    $.doAction('backs');\n  };\n\n  window.addEventListener('tap', function (e) {\n    var action = $.targets.action;\n\n    if (action && action.classList.contains('mui-action-back')) {\n      $.back();\n      $.targets.action = false;\n    }\n  });\n  window.addEventListener('swiperight', function (e) {\n    var detail = e.detail;\n\n    if ($.options.swipeBack === true && Math.abs(detail.angle) < 3) {\n      $.back();\n    }\n  });\n})(mui, window);\n/**\r\n * mui back 5+\r\n * @param {type} $\r\n * @param {type} window\r\n * @returns {undefined}\r\n */\n\n\n(function ($, window) {\n  if ($.os.plus && $.os.android) {\n    $.addBack({\n      name: 'mui',\n      index: 5,\n      handle: function handle() {\n        //后续重新设计此处，将back放到各个空间内部实现\n        //popover\n        if ($.targets._popover && $.targets._popover.classList.contains('mui-active')) {\n          $($.targets._popover).popover('hide');\n          return true;\n        } //offcanvas\n\n\n        var offCanvas = document.querySelector('.mui-off-canvas-wrap.mui-active');\n\n        if (offCanvas) {\n          $(offCanvas).offCanvas('close');\n          return true;\n        }\n\n        var previewImage = $.isFunction($.getPreviewImage) && $.getPreviewImage();\n\n        if (previewImage && previewImage.isShown()) {\n          previewImage.close();\n          return true;\n        } //popup\n\n\n        return $.closePopup();\n      }\n    });\n  } //首次按下back按键的时间\n\n\n  $.__back__first = null;\n  /**\r\n   * 5+ back\r\n   */\n\n  $.addBack({\n    name: '5+',\n    index: 10,\n    handle: function handle() {\n      if (!window.plus) {\n        return false;\n      }\n\n      var wobj = plus.webview.currentWebview();\n      var parent = wobj.parent();\n\n      if (parent) {\n        parent.evalJS('mui&&mui.back();');\n      } else {\n        wobj.canBack(function (e) {\n          //by chb 暂时注释，在碰到类似popover之类的锚点的时候，需多次点击才能返回；\n          if (e.canBack) {\n            //webview history back\n            window.history.back();\n          } else {\n            //webview close or hide\n            //fixed by fxy 此处不应该用opener判断，因为用户有可能自己close掉当前窗口的opener。这样的话。opener就为空了，导致不能执行close\n            if (wobj.id === plus.runtime.appid) {\n              //首页\n              //首页不存在opener的情况下，后退实际上应该是退出应用；\n              //首次按键，提示‘再按一次退出应用’\n              if (!$.__back__first) {\n                $.__back__first = new Date().getTime();\n                mui.toast('再按一次退出应用');\n                setTimeout(function () {\n                  $.__back__first = null;\n                }, 2000);\n              } else {\n                if (new Date().getTime() - $.__back__first < 2000) {\n                  plus.runtime.quit();\n                }\n              }\n            } else {\n              //其他页面，\n              if (wobj.preload) {\n                wobj.hide(\"auto\");\n              } else {\n                //关闭页面时，需要将其打开的所有子页面全部关闭；\n                $.closeAll(wobj);\n              }\n            }\n          }\n        });\n      }\n\n      return true;\n    }\n  });\n\n  $.menu = function () {\n    var menu = document.querySelector('.mui-action-menu');\n\n    if (menu) {\n      $.trigger(menu, $.EVENT_START); //临时处理menu无touchstart的话，找不到当前targets的问题\n\n      $.trigger(menu, 'tap');\n    } else {\n      //执行父窗口的menu\n      if (window.plus) {\n        var wobj = $.currentWebview;\n        var parent = wobj.parent();\n\n        if (parent) {\n          //又得evalJS\n          parent.evalJS('mui&&mui.menu();');\n        }\n      }\n    }\n  };\n\n  var __back = function __back() {\n    $.back();\n  };\n\n  var __menu = function __menu() {\n    $.menu();\n  }; //默认监听\n\n\n  $.plusReady(function () {\n    if ($.options.keyEventBind.backbutton) {\n      plus.key.addEventListener('backbutton', __back, false);\n    }\n\n    if ($.options.keyEventBind.menubutton) {\n      plus.key.addEventListener('menubutton', __menu, false);\n    }\n  }); //处理按键监听事件\n\n  $.addInit({\n    name: 'keyEventBind',\n    index: 1000,\n    handle: function handle() {\n      $.plusReady(function () {\n        //如果不为true，则移除默认监听\n        if (!$.options.keyEventBind.backbutton) {\n          plus.key.removeEventListener('backbutton', __back);\n        }\n\n        if (!$.options.keyEventBind.menubutton) {\n          plus.key.removeEventListener('menubutton', __menu);\n        }\n      });\n    }\n  });\n})(mui, window);\n/**\r\n * mui.init pulldownRefresh\r\n * @param {type} $\r\n * @returns {undefined}\r\n */\n\n\n(function ($) {\n  $.addInit({\n    name: 'pullrefresh',\n    index: 1000,\n    handle: function handle() {\n      var options = $.options;\n      var pullRefreshOptions = options.pullRefresh || {};\n      var hasPulldown = pullRefreshOptions.down && pullRefreshOptions.down.hasOwnProperty('callback');\n      var hasPullup = pullRefreshOptions.up && pullRefreshOptions.up.hasOwnProperty('callback');\n\n      if (hasPulldown || hasPullup) {\n        var container = pullRefreshOptions.container;\n\n        if (container) {\n          var $container = $(container);\n\n          if ($container.length === 1) {\n            if ($.os.plus) {\n              //5+环境\n              if (hasPulldown && pullRefreshOptions.down.style == \"circle\") {\n                //原生转圈\n                $.plusReady(function () {\n                  //这里改写$.fn.pullRefresh\n                  $.fn.pullRefresh = $.fn.pullRefresh_native;\n                  $container.pullRefresh(pullRefreshOptions);\n                });\n              } else if ($.os.android) {\n                //非原生转圈，但是Android环境\n                $.plusReady(function () {\n                  //这里改写$.fn.pullRefresh\n                  $.fn.pullRefresh = $.fn.pullRefresh_native;\n                  var webview = plus.webview.currentWebview();\n\n                  if (window.__NWin_Enable__ === false) {\n                    //不支持多webview\n                    $container.pullRefresh(pullRefreshOptions);\n                  } else {\n                    if (hasPullup) {\n                      //当前页面初始化pullup\n                      var upOptions = {};\n                      upOptions.up = pullRefreshOptions.up;\n                      upOptions.webviewId = webview.id || webview.getURL();\n                      $container.pullRefresh(upOptions);\n                    }\n\n                    if (hasPulldown) {\n                      var parent = webview.parent();\n                      var id = webview.id || webview.getURL();\n\n                      if (parent) {\n                        if (!hasPullup) {\n                          //如果没有上拉加载，需要手动初始化一个默认的pullRefresh，以便当前页面容器可以调用endPulldownToRefresh等方法\n                          $container.pullRefresh({\n                            webviewId: id\n                          });\n                        }\n\n                        var downOptions = {\n                          webviewId: id //子页面id\n\n                        };\n                        downOptions.down = $.extend({}, pullRefreshOptions.down);\n                        downOptions.down.callback = '_CALLBACK'; //改写父页面的$.fn.pullRefresh\n\n                        parent.evalJS(\"mui.fn.pullRefresh=mui.fn.pullRefresh_native\"); //父页面初始化pulldown\n\n                        parent.evalJS(\"mui&&mui(document.querySelector('.mui-content')).pullRefresh('\" + JSON.stringify(downOptions) + \"')\");\n                      }\n                    }\n                  }\n                });\n              } else {\n                //非原生转圈，iOS环境\n                $container.pullRefresh(pullRefreshOptions);\n              }\n            } else {\n              $container.pullRefresh(pullRefreshOptions);\n            }\n          }\n        }\n      }\n    }\n  });\n})(mui);\n/**\r\n * mui ajax\r\n * @param {type} $\r\n * @returns {undefined}\r\n */\n\n\n(function ($, window, undefined) {\n  var jsonType = 'application/json';\n  var htmlType = 'text/html';\n  var rscript = /<script\\b[^<]*(?:(?!<\\/script>)<[^<]*)*<\\/script>/gi;\n  var scriptTypeRE = /^(?:text|application)\\/javascript/i;\n  var xmlTypeRE = /^(?:text|application)\\/xml/i;\n  var blankRE = /^\\s*$/;\n  $.ajaxSettings = {\n    type: 'GET',\n    beforeSend: $.noop,\n    success: $.noop,\n    error: $.noop,\n    complete: $.noop,\n    context: null,\n    xhr: function xhr(protocol) {\n      return new window.XMLHttpRequest();\n    },\n    accepts: {\n      script: 'text/javascript, application/javascript, application/x-javascript',\n      json: jsonType,\n      xml: 'application/xml, text/xml',\n      html: htmlType,\n      text: 'text/plain'\n    },\n    timeout: 0,\n    processData: true,\n    cache: true\n  };\n\n  var ajaxBeforeSend = function ajaxBeforeSend(xhr, settings) {\n    var context = settings.context;\n\n    if (settings.beforeSend.call(context, xhr, settings) === false) {\n      return false;\n    }\n  };\n\n  var ajaxSuccess = function ajaxSuccess(data, xhr, settings) {\n    settings.success.call(settings.context, data, 'success', xhr);\n    ajaxComplete('success', xhr, settings);\n  }; // type: \"timeout\", \"error\", \"abort\", \"parsererror\"\n\n\n  var ajaxError = function ajaxError(error, type, xhr, settings) {\n    settings.error.call(settings.context, xhr, type, error);\n    ajaxComplete(type, xhr, settings);\n  }; // status: \"success\", \"notmodified\", \"error\", \"timeout\", \"abort\", \"parsererror\"\n\n\n  var ajaxComplete = function ajaxComplete(status, xhr, settings) {\n    settings.complete.call(settings.context, xhr, status);\n  };\n\n  var serialize = function serialize(params, obj, traditional, scope) {\n    var type,\n        array = $.isArray(obj),\n        hash = $.isPlainObject(obj);\n    $.each(obj, function (key, value) {\n      type = $.type(value);\n\n      if (scope) {\n        key = traditional ? scope : scope + '[' + (hash || type === 'object' || type === 'array' ? key : '') + ']';\n      } // handle data in serializeArray() format\n\n\n      if (!scope && array) {\n        params.add(value.name, value.value);\n      } // recurse into nested objects\n      else if (type === \"array\" || !traditional && type === \"object\") {\n          serialize(params, value, traditional, key);\n        } else {\n          params.add(key, value);\n        }\n    });\n  };\n\n  var serializeData = function serializeData(options) {\n    if (options.processData && options.data && typeof options.data !== \"string\") {\n      var contentType = options.contentType;\n\n      if (!contentType && options.headers) {\n        contentType = options.headers['Content-Type'];\n      }\n\n      if (contentType && ~contentType.indexOf(jsonType)) {\n        //application/json\n        options.data = JSON.stringify(options.data);\n      } else {\n        options.data = $.param(options.data, options.traditional);\n      }\n    }\n\n    if (options.data && (!options.type || options.type.toUpperCase() === 'GET')) {\n      options.url = appendQuery(options.url, options.data);\n      options.data = undefined;\n    }\n  };\n\n  var appendQuery = function appendQuery(url, query) {\n    if (query === '') {\n      return url;\n    }\n\n    return (url + '&' + query).replace(/[&?]{1,2}/, '?');\n  };\n\n  var mimeToDataType = function mimeToDataType(mime) {\n    if (mime) {\n      mime = mime.split(';', 2)[0];\n    }\n\n    return mime && (mime === htmlType ? 'html' : mime === jsonType ? 'json' : scriptTypeRE.test(mime) ? 'script' : xmlTypeRE.test(mime) && 'xml') || 'text';\n  };\n\n  var parseArguments = function parseArguments(url, data, success, dataType) {\n    if ($.isFunction(data)) {\n      dataType = success, success = data, data = undefined;\n    }\n\n    if (!$.isFunction(success)) {\n      dataType = success, success = undefined;\n    }\n\n    return {\n      url: url,\n      data: data,\n      success: success,\n      dataType: dataType\n    };\n  };\n\n  $.ajax = function (url, options) {\n    if (_typeof(url) === \"object\") {\n      options = url;\n      url = undefined;\n    }\n\n    var settings = options || {};\n    settings.url = url || settings.url;\n\n    for (var key in $.ajaxSettings) {\n      if (settings[key] === undefined) {\n        settings[key] = $.ajaxSettings[key];\n      }\n    }\n\n    serializeData(settings);\n    var dataType = settings.dataType;\n\n    if (settings.cache === false || (!options || options.cache !== true) && 'script' === dataType) {\n      settings.url = appendQuery(settings.url, '_=' + $.now());\n    }\n\n    var mime = settings.accepts[dataType && dataType.toLowerCase()];\n    var headers = {};\n\n    var setHeader = function setHeader(name, value) {\n      headers[name.toLowerCase()] = [name, value];\n    };\n\n    var protocol = /^([\\w-]+:)\\/\\//.test(settings.url) ? RegExp.$1 : window.location.protocol;\n    var xhr = settings.xhr(settings);\n    var nativeSetHeader = xhr.setRequestHeader;\n    var abortTimeout;\n    setHeader('X-Requested-With', 'XMLHttpRequest');\n    setHeader('Accept', mime || '*/*');\n\n    if (!!(mime = settings.mimeType || mime)) {\n      if (mime.indexOf(',') > -1) {\n        mime = mime.split(',', 2)[0];\n      }\n\n      xhr.overrideMimeType && xhr.overrideMimeType(mime);\n    }\n\n    if (settings.contentType || settings.contentType !== false && settings.data && settings.type.toUpperCase() !== 'GET') {\n      setHeader('Content-Type', settings.contentType || 'application/x-www-form-urlencoded');\n    }\n\n    if (settings.headers) {\n      for (var name in settings.headers) {\n        setHeader(name, settings.headers[name]);\n      }\n    }\n\n    xhr.setRequestHeader = setHeader;\n\n    xhr.onreadystatechange = function () {\n      if (xhr.readyState === 4) {\n        xhr.onreadystatechange = $.noop;\n        clearTimeout(abortTimeout);\n        var result,\n            error = false;\n        var isLocal = protocol === 'file:';\n\n        if (xhr.status >= 200 && xhr.status < 300 || xhr.status === 304 || xhr.status === 0 && isLocal && xhr.responseText) {\n          dataType = dataType || mimeToDataType(settings.mimeType || xhr.getResponseHeader('content-type'));\n          result = xhr.responseText;\n\n          try {\n            // http://perfectionkills.com/global-eval-what-are-the-options/\n            if (dataType === 'script') {\n              (1, eval)(result);\n            } else if (dataType === 'xml') {\n              result = xhr.responseXML;\n            } else if (dataType === 'json') {\n              result = blankRE.test(result) ? null : $.parseJSON(result);\n            }\n          } catch (e) {\n            error = e;\n          }\n\n          if (error) {\n            ajaxError(error, 'parsererror', xhr, settings);\n          } else {\n            ajaxSuccess(result, xhr, settings);\n          }\n        } else {\n          var status = xhr.status ? 'error' : 'abort';\n          var statusText = xhr.statusText || null;\n\n          if (isLocal) {\n            status = 'error';\n            statusText = '404';\n          }\n\n          ajaxError(statusText, status, xhr, settings);\n        }\n      }\n    };\n\n    if (ajaxBeforeSend(xhr, settings) === false) {\n      xhr.abort();\n      ajaxError(null, 'abort', xhr, settings);\n      return xhr;\n    }\n\n    if (settings.xhrFields) {\n      for (var name in settings.xhrFields) {\n        xhr[name] = settings.xhrFields[name];\n      }\n    }\n\n    var async = 'async' in settings ? settings.async : true;\n    xhr.open(settings.type.toUpperCase(), settings.url, async, settings.username, settings.password);\n\n    for (var name in headers) {\n      if (headers.hasOwnProperty(name)) {\n        nativeSetHeader.apply(xhr, headers[name]);\n      }\n    }\n\n    if (settings.timeout > 0) {\n      abortTimeout = setTimeout(function () {\n        xhr.onreadystatechange = $.noop;\n        xhr.abort();\n        ajaxError(null, 'timeout', xhr, settings);\n      }, settings.timeout);\n    }\n\n    xhr.send(settings.data ? settings.data : null);\n    return xhr;\n  };\n\n  $.param = function (obj, traditional) {\n    var params = [];\n\n    params.add = function (k, v) {\n      this.push(encodeURIComponent(k) + '=' + encodeURIComponent(v));\n    };\n\n    serialize(params, obj, traditional);\n    return params.join('&').replace(/%20/g, '+');\n  };\n\n  $.get = function ()\n  /* url, data, success, dataType */\n  {\n    return $.ajax(parseArguments.apply(null, arguments));\n  };\n\n  $.post = function ()\n  /* url, data, success, dataType */\n  {\n    var options = parseArguments.apply(null, arguments);\n    options.type = 'POST';\n    return $.ajax(options);\n  };\n\n  $.getJSON = function ()\n  /* url, data, success */\n  {\n    var options = parseArguments.apply(null, arguments);\n    options.dataType = 'json';\n    return $.ajax(options);\n  };\n\n  $.fn.load = function (url, data, success) {\n    if (!this.length) return this;\n    var self = this,\n        parts = url.split(/\\s/),\n        selector,\n        options = parseArguments(url, data, success),\n        callback = options.success;\n    if (parts.length > 1) options.url = parts[0], selector = parts[1];\n\n    options.success = function (response) {\n      if (selector) {\n        var div = document.createElement('div');\n        div.innerHTML = response.replace(rscript, \"\");\n        var selectorDiv = document.createElement('div');\n        var childs = div.querySelectorAll(selector);\n\n        if (childs && childs.length > 0) {\n          for (var i = 0, len = childs.length; i < len; i++) {\n            selectorDiv.appendChild(childs[i]);\n          }\n        }\n\n        self[0].innerHTML = selectorDiv.innerHTML;\n      } else {\n        self[0].innerHTML = response;\n      }\n\n      callback && callback.apply(self, arguments);\n    };\n\n    $.ajax(options);\n    return this;\n  };\n})(mui, window);\n/**\r\n * 5+ ajax\r\n */\n\n\n(function ($) {\n  var originAnchor = document.createElement('a');\n  originAnchor.href = window.location.href;\n  $.plusReady(function () {\n    $.ajaxSettings = $.extend($.ajaxSettings, {\n      xhr: function xhr(settings) {\n        if (settings.crossDomain) {\n          //强制使用plus跨域\n          return new plus.net.XMLHttpRequest();\n        } //仅在webview的url为远程文件，且ajax请求的资源不同源下使用plus.net.XMLHttpRequest\n\n\n        if (originAnchor.protocol !== 'file:') {\n          var urlAnchor = document.createElement('a');\n          urlAnchor.href = settings.url;\n          urlAnchor.href = urlAnchor.href;\n          settings.crossDomain = originAnchor.protocol + '//' + originAnchor.host !== urlAnchor.protocol + '//' + urlAnchor.host;\n\n          if (settings.crossDomain) {\n            return new plus.net.XMLHttpRequest();\n          }\n        }\n\n        if ($.os.ios && window.webkit && window.webkit.messageHandlers) {\n          //wkwebview下同样使用5+ xhr\n          return new plus.net.XMLHttpRequest();\n        }\n\n        return new window.XMLHttpRequest();\n      }\n    });\n  });\n})(mui);\n/**\r\n * mui layout(offset[,position,width,height...])\r\n * @param {type} $\r\n * @param {type} window\r\n * @param {type} undefined\r\n * @returns {undefined}\r\n */\n\n\n(function ($, window, undefined) {\n  $.offset = function (element) {\n    var box = {\n      top: 0,\n      left: 0\n    };\n\n    if (_typeof(element.getBoundingClientRect) !== undefined) {\n      box = element.getBoundingClientRect();\n    }\n\n    return {\n      top: box.top + window.pageYOffset - element.clientTop,\n      left: box.left + window.pageXOffset - element.clientLeft\n    };\n  };\n})(mui, window);\n/**\r\n * mui animation\r\n */\n\n\n(function ($, window) {\n  /**\r\n   * scrollTo\r\n   */\n  $.scrollTo = function (scrollTop, duration, callback) {\n    duration = duration || 1000;\n\n    var scroll = function scroll(duration) {\n      if (duration <= 0) {\n        window.scrollTo(0, scrollTop);\n        callback && callback();\n        return;\n      }\n\n      var distaince = scrollTop - window.scrollY;\n      setTimeout(function () {\n        window.scrollTo(0, window.scrollY + distaince / duration * 10);\n        scroll(duration - 10);\n      }, 16.7);\n    };\n\n    scroll(duration);\n  };\n\n  $.animationFrame = function (cb) {\n    var args, isQueued, context;\n    return function () {\n      args = arguments;\n      context = this;\n\n      if (!isQueued) {\n        isQueued = true;\n        requestAnimationFrame(function () {\n          cb.apply(context, args);\n          isQueued = false;\n        });\n      }\n    };\n  };\n})(mui, window);\n\n(function ($) {\n  var initializing = false,\n      fnTest = /xyz/.test(function () {\n    xyz;\n  }) ? /\\b_super\\b/ : /.*/;\n\n  var Class = function Class() {};\n\n  Class.extend = function (prop) {\n    var _super = this.prototype;\n    initializing = true;\n    var prototype = new this();\n    initializing = false;\n\n    for (var name in prop) {\n      prototype[name] = typeof prop[name] == \"function\" && typeof _super[name] == \"function\" && fnTest.test(prop[name]) ? function (name, fn) {\n        return function () {\n          var tmp = this._super;\n          this._super = _super[name];\n          var ret = fn.apply(this, arguments);\n          this._super = tmp;\n          return ret;\n        };\n      }(name, prop[name]) : prop[name];\n    }\n\n    function Class() {\n      if (!initializing && this.init) this.init.apply(this, arguments);\n    }\n\n    Class.prototype = prototype;\n    Class.prototype.constructor = Class;\n    Class.extend = arguments.callee;\n    return Class;\n  };\n\n  $.Class = Class;\n})(mui);\n\n(function ($, document, undefined) {\n  var CLASS_PULL_TOP_POCKET = 'mui-pull-top-pocket';\n  var CLASS_PULL_BOTTOM_POCKET = 'mui-pull-bottom-pocket';\n  var CLASS_PULL = 'mui-pull';\n  var CLASS_PULL_LOADING = 'mui-pull-loading';\n  var CLASS_PULL_CAPTION = 'mui-pull-caption';\n  var CLASS_PULL_CAPTION_DOWN = 'mui-pull-caption-down';\n  var CLASS_PULL_CAPTION_REFRESH = 'mui-pull-caption-refresh';\n  var CLASS_PULL_CAPTION_NOMORE = 'mui-pull-caption-nomore';\n  var CLASS_ICON = 'mui-icon';\n  var CLASS_SPINNER = 'mui-spinner';\n  var CLASS_ICON_PULLDOWN = 'mui-icon-pulldown';\n  var CLASS_BLOCK = 'mui-block';\n  var CLASS_HIDDEN = 'mui-hidden';\n  var CLASS_VISIBILITY = 'mui-visibility';\n  var CLASS_LOADING_UP = CLASS_PULL_LOADING + ' ' + CLASS_ICON + ' ' + CLASS_ICON_PULLDOWN;\n  var CLASS_LOADING_DOWN = CLASS_PULL_LOADING + ' ' + CLASS_ICON + ' ' + CLASS_ICON_PULLDOWN;\n  var CLASS_LOADING = CLASS_PULL_LOADING + ' ' + CLASS_ICON + ' ' + CLASS_SPINNER;\n  var pocketHtml = ['<div class=\"' + CLASS_PULL + '\">', '<div class=\"{icon}\"></div>', '<div class=\"' + CLASS_PULL_CAPTION + '\">{contentrefresh}</div>', '</div>'].join('');\n  var PullRefresh = {\n    init: function init(element, options) {\n      this._super(element, $.extend(true, {\n        scrollY: true,\n        scrollX: false,\n        indicators: true,\n        deceleration: 0.003,\n        down: {\n          height: 50,\n          contentinit: '下拉可以刷新',\n          contentdown: '下拉可以刷新',\n          contentover: '释放立即刷新',\n          contentrefresh: '正在刷新...'\n        },\n        up: {\n          height: 50,\n          auto: false,\n          contentinit: '上拉显示更多',\n          contentdown: '上拉显示更多',\n          contentrefresh: '正在加载...',\n          contentnomore: '没有更多数据了',\n          duration: 300\n        }\n      }, options));\n    },\n    _init: function _init() {\n      this._super();\n\n      this._initPocket();\n    },\n    _initPulldownRefresh: function _initPulldownRefresh() {\n      this.pulldown = true;\n\n      if (this.topPocket) {\n        this.pullPocket = this.topPocket;\n        this.pullPocket.classList.add(CLASS_BLOCK);\n        this.pullPocket.classList.add(CLASS_VISIBILITY);\n        this.pullCaption = this.topCaption;\n        this.pullLoading = this.topLoading;\n      }\n    },\n    _initPullupRefresh: function _initPullupRefresh() {\n      this.pulldown = false;\n\n      if (this.bottomPocket) {\n        this.pullPocket = this.bottomPocket;\n        this.pullPocket.classList.add(CLASS_BLOCK);\n        this.pullPocket.classList.add(CLASS_VISIBILITY);\n        this.pullCaption = this.bottomCaption;\n        this.pullLoading = this.bottomLoading;\n      }\n    },\n    _initPocket: function _initPocket() {\n      var options = this.options;\n\n      if (options.down && options.down.hasOwnProperty('callback')) {\n        this.topPocket = this.scroller.querySelector('.' + CLASS_PULL_TOP_POCKET);\n\n        if (!this.topPocket) {\n          this.topPocket = this._createPocket(CLASS_PULL_TOP_POCKET, options.down, CLASS_LOADING_DOWN);\n          this.wrapper.insertBefore(this.topPocket, this.wrapper.firstChild);\n        }\n\n        this.topLoading = this.topPocket.querySelector('.' + CLASS_PULL_LOADING);\n        this.topCaption = this.topPocket.querySelector('.' + CLASS_PULL_CAPTION);\n      }\n\n      if (options.up && options.up.hasOwnProperty('callback')) {\n        this.bottomPocket = this.scroller.querySelector('.' + CLASS_PULL_BOTTOM_POCKET);\n\n        if (!this.bottomPocket) {\n          this.bottomPocket = this._createPocket(CLASS_PULL_BOTTOM_POCKET, options.up, CLASS_LOADING);\n          this.scroller.appendChild(this.bottomPocket);\n        }\n\n        this.bottomLoading = this.bottomPocket.querySelector('.' + CLASS_PULL_LOADING);\n        this.bottomCaption = this.bottomPocket.querySelector('.' + CLASS_PULL_CAPTION); //TODO only for h5\n\n        this.wrapper.addEventListener('scrollbottom', this);\n      }\n    },\n    _createPocket: function _createPocket(clazz, options, iconClass) {\n      var pocket = document.createElement('div');\n      pocket.className = clazz;\n      pocket.innerHTML = pocketHtml.replace('{contentrefresh}', options.contentinit).replace('{icon}', iconClass);\n      return pocket;\n    },\n    _resetPullDownLoading: function _resetPullDownLoading() {\n      var loading = this.pullLoading;\n\n      if (loading) {\n        this.pullCaption.innerHTML = this.options.down.contentdown;\n        loading.style.webkitTransition = \"\";\n        loading.style.webkitTransform = \"\";\n        loading.style.webkitAnimation = \"\";\n        loading.className = CLASS_LOADING_DOWN;\n      }\n    },\n    _setCaptionClass: function _setCaptionClass(isPulldown, caption, title) {\n      if (!isPulldown) {\n        switch (title) {\n          case this.options.up.contentdown:\n            caption.className = CLASS_PULL_CAPTION + ' ' + CLASS_PULL_CAPTION_DOWN;\n            break;\n\n          case this.options.up.contentrefresh:\n            caption.className = CLASS_PULL_CAPTION + ' ' + CLASS_PULL_CAPTION_REFRESH;\n            break;\n\n          case this.options.up.contentnomore:\n            caption.className = CLASS_PULL_CAPTION + ' ' + CLASS_PULL_CAPTION_NOMORE;\n            break;\n        }\n      }\n    },\n    _setCaption: function _setCaption(title, reset) {\n      if (this.loading) {\n        return;\n      }\n\n      var options = this.options;\n      var pocket = this.pullPocket;\n      var caption = this.pullCaption;\n      var loading = this.pullLoading;\n      var isPulldown = this.pulldown;\n      var self = this;\n\n      if (pocket) {\n        if (reset) {\n          setTimeout(function () {\n            caption.innerHTML = self.lastTitle = title;\n\n            if (isPulldown) {\n              loading.className = CLASS_LOADING_DOWN;\n            } else {\n              self._setCaptionClass(false, caption, title);\n\n              loading.className = CLASS_LOADING;\n            }\n\n            loading.style.webkitAnimation = \"\";\n            loading.style.webkitTransition = \"\";\n            loading.style.webkitTransform = \"\";\n          }, 100);\n        } else {\n          if (title !== this.lastTitle) {\n            caption.innerHTML = title;\n\n            if (isPulldown) {\n              if (title === options.down.contentrefresh) {\n                loading.className = CLASS_LOADING;\n                loading.style.webkitAnimation = \"spinner-spin 1s step-end infinite\";\n              } else if (title === options.down.contentover) {\n                loading.className = CLASS_LOADING_UP;\n                loading.style.webkitTransition = \"-webkit-transform 0.3s ease-in\";\n                loading.style.webkitTransform = \"rotate(180deg)\";\n              } else if (title === options.down.contentdown) {\n                loading.className = CLASS_LOADING_DOWN;\n                loading.style.webkitTransition = \"-webkit-transform 0.3s ease-in\";\n                loading.style.webkitTransform = \"rotate(0deg)\";\n              }\n            } else {\n              if (title === options.up.contentrefresh) {\n                loading.className = CLASS_LOADING + ' ' + CLASS_VISIBILITY;\n              } else {\n                loading.className = CLASS_LOADING + ' ' + CLASS_HIDDEN;\n              }\n\n              self._setCaptionClass(false, caption, title);\n            }\n\n            this.lastTitle = title;\n          }\n        }\n      }\n    }\n  };\n  $.PullRefresh = PullRefresh;\n})(mui, document);\n\n(function ($, window, document, undefined) {\n  var CLASS_SCROLL = 'mui-scroll';\n  var CLASS_SCROLLBAR = 'mui-scrollbar';\n  var CLASS_INDICATOR = 'mui-scrollbar-indicator';\n  var CLASS_SCROLLBAR_VERTICAL = CLASS_SCROLLBAR + '-vertical';\n  var CLASS_SCROLLBAR_HORIZONTAL = CLASS_SCROLLBAR + '-horizontal';\n  var CLASS_ACTIVE = 'mui-active';\n  var ease = {\n    quadratic: {\n      style: 'cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n      fn: function fn(k) {\n        return k * (2 - k);\n      }\n    },\n    circular: {\n      style: 'cubic-bezier(0.1, 0.57, 0.1, 1)',\n      fn: function fn(k) {\n        return Math.sqrt(1 - --k * k);\n      }\n    },\n    outCirc: {\n      style: 'cubic-bezier(0.075, 0.82, 0.165, 1)'\n    },\n    outCubic: {\n      style: 'cubic-bezier(0.165, 0.84, 0.44, 1)'\n    }\n  };\n  var Scroll = $.Class.extend({\n    init: function init(element, options) {\n      this.wrapper = this.element = element;\n      this.scroller = this.wrapper.children[0];\n      this.scrollerStyle = this.scroller && this.scroller.style;\n      this.stopped = false;\n      this.options = $.extend(true, {\n        scrollY: true,\n        //是否竖向滚动\n        scrollX: false,\n        //是否横向滚动\n        startX: 0,\n        //初始化时滚动至x\n        startY: 0,\n        //初始化时滚动至y\n        indicators: true,\n        //是否显示滚动条\n        stopPropagation: false,\n        hardwareAccelerated: true,\n        fixedBadAndorid: false,\n        preventDefaultException: {\n          tagName: /^(INPUT|TEXTAREA|BUTTON|SELECT|VIDEO)$/\n        },\n        momentum: true,\n        snapX: 0.5,\n        //横向切换距离(以当前容器宽度为基准)\n        snap: false,\n        //图片轮播，拖拽式选项卡\n        bounce: true,\n        //是否启用回弹\n        bounceTime: 500,\n        //回弹动画时间\n        bounceEasing: ease.outCirc,\n        //回弹动画曲线\n        scrollTime: 500,\n        scrollEasing: ease.outCubic,\n        //轮播动画曲线\n        directionLockThreshold: 5,\n        parallaxElement: false,\n        //视差元素\n        parallaxRatio: 0.5\n      }, options);\n      this.x = 0;\n      this.y = 0;\n      this.translateZ = this.options.hardwareAccelerated ? ' translateZ(0)' : '';\n\n      this._init();\n\n      if (this.scroller) {\n        this.refresh(); //\t\t\t\tif (this.options.startX !== 0 || this.options.startY !== 0) { //需要判断吗？后续根据实际情况再看看\n\n        this.scrollTo(this.options.startX, this.options.startY); //\t\t\t\t}\n      }\n    },\n    _init: function _init() {\n      this._initParallax();\n\n      this._initIndicators();\n\n      this._initEvent();\n    },\n    _initParallax: function _initParallax() {\n      if (this.options.parallaxElement) {\n        this.parallaxElement = document.querySelector(this.options.parallaxElement);\n        this.parallaxStyle = this.parallaxElement.style;\n        this.parallaxHeight = this.parallaxElement.offsetHeight;\n        this.parallaxImgStyle = this.parallaxElement.querySelector('img').style;\n      }\n    },\n    _initIndicators: function _initIndicators() {\n      var self = this;\n      self.indicators = [];\n\n      if (!this.options.indicators) {\n        return;\n      }\n\n      var indicators = [],\n          indicator; // Vertical scrollbar\n\n      if (self.options.scrollY) {\n        indicator = {\n          el: this._createScrollBar(CLASS_SCROLLBAR_VERTICAL),\n          listenX: false\n        };\n        this.wrapper.appendChild(indicator.el);\n        indicators.push(indicator);\n      } // Horizontal scrollbar\n\n\n      if (this.options.scrollX) {\n        indicator = {\n          el: this._createScrollBar(CLASS_SCROLLBAR_HORIZONTAL),\n          listenY: false\n        };\n        this.wrapper.appendChild(indicator.el);\n        indicators.push(indicator);\n      }\n\n      for (var i = indicators.length; i--;) {\n        this.indicators.push(new Indicator(this, indicators[i]));\n      }\n    },\n    _initSnap: function _initSnap() {\n      this.currentPage = {};\n      this.pages = [];\n      var snaps = this.snaps;\n      var length = snaps.length;\n      var m = 0;\n      var n = -1;\n      var x = 0;\n      var leftX = 0;\n      var rightX = 0;\n      var snapX = 0;\n\n      for (var i = 0; i < length; i++) {\n        var snap = snaps[i];\n        var offsetLeft = snap.offsetLeft;\n        var offsetWidth = snap.offsetWidth;\n\n        if (i === 0 || offsetLeft <= snaps[i - 1].offsetLeft) {\n          m = 0;\n          n++;\n        }\n\n        if (!this.pages[m]) {\n          this.pages[m] = [];\n        }\n\n        x = this._getSnapX(offsetLeft);\n        snapX = Math.round(offsetWidth * this.options.snapX);\n        leftX = x - snapX;\n        rightX = x - offsetWidth + snapX;\n        this.pages[m][n] = {\n          x: x,\n          leftX: leftX,\n          rightX: rightX,\n          pageX: m,\n          element: snap\n        };\n\n        if (snap.classList.contains(CLASS_ACTIVE)) {\n          this.currentPage = this.pages[m][0];\n        }\n\n        if (x >= this.maxScrollX) {\n          m++;\n        }\n      }\n\n      this.options.startX = this.currentPage.x || 0;\n    },\n    _getSnapX: function _getSnapX(offsetLeft) {\n      return Math.max(Math.min(0, -offsetLeft + this.wrapperWidth / 2), this.maxScrollX);\n    },\n    _gotoPage: function _gotoPage(index) {\n      this.currentPage = this.pages[Math.min(index, this.pages.length - 1)][0];\n\n      for (var i = 0, len = this.snaps.length; i < len; i++) {\n        if (i === index) {\n          this.snaps[i].classList.add(CLASS_ACTIVE);\n        } else {\n          this.snaps[i].classList.remove(CLASS_ACTIVE);\n        }\n      }\n\n      this.scrollTo(this.currentPage.x, 0, this.options.scrollTime);\n    },\n    _nearestSnap: function _nearestSnap(x) {\n      if (!this.pages.length) {\n        return {\n          x: 0,\n          pageX: 0\n        };\n      }\n\n      var i = 0;\n      var length = this.pages.length;\n\n      if (x > 0) {\n        x = 0;\n      } else if (x < this.maxScrollX) {\n        x = this.maxScrollX;\n      }\n\n      for (; i < length; i++) {\n        var nearestX = this.direction === 'left' ? this.pages[i][0].leftX : this.pages[i][0].rightX;\n\n        if (x >= nearestX) {\n          return this.pages[i][0];\n        }\n      }\n\n      return {\n        x: 0,\n        pageX: 0\n      };\n    },\n    _initEvent: function _initEvent(detach) {\n      var action = detach ? 'removeEventListener' : 'addEventListener';\n      window[action]('orientationchange', this);\n      window[action]('resize', this);\n      this.scroller[action]('webkitTransitionEnd', this);\n      this.wrapper[action]($.EVENT_START, this);\n      this.wrapper[action]($.EVENT_CANCEL, this);\n      this.wrapper[action]($.EVENT_END, this);\n      this.wrapper[action]('drag', this);\n      this.wrapper[action]('dragend', this);\n      this.wrapper[action]('flick', this);\n      this.wrapper[action]('scrollend', this);\n\n      if (this.options.scrollX) {\n        this.wrapper[action]('swiperight', this);\n      }\n\n      var segmentedControl = this.wrapper.querySelector('.mui-segmented-control');\n\n      if (segmentedControl) {\n        //靠，这个bug排查了一下午，阻止hash跳转，一旦hash跳转会导致可拖拽选项卡的tab不见\n        mui(segmentedControl)[detach ? 'off' : 'on']('click', 'a', $.preventDefault);\n      }\n\n      this.wrapper[action]('scrollstart', this);\n      this.wrapper[action]('refresh', this);\n    },\n    _handleIndicatorScrollend: function _handleIndicatorScrollend() {\n      this.indicators.map(function (indicator) {\n        indicator.fade();\n      });\n    },\n    _handleIndicatorScrollstart: function _handleIndicatorScrollstart() {\n      this.indicators.map(function (indicator) {\n        indicator.fade(1);\n      });\n    },\n    _handleIndicatorRefresh: function _handleIndicatorRefresh() {\n      this.indicators.map(function (indicator) {\n        indicator.refresh();\n      });\n    },\n    handleEvent: function handleEvent(e) {\n      if (this.stopped) {\n        this.resetPosition();\n        return;\n      }\n\n      switch (e.type) {\n        case $.EVENT_START:\n          this._start(e);\n\n          break;\n\n        case 'drag':\n          this.options.stopPropagation && e.stopPropagation();\n\n          this._drag(e);\n\n          break;\n\n        case 'dragend':\n        case 'flick':\n          this.options.stopPropagation && e.stopPropagation();\n\n          this._flick(e);\n\n          break;\n\n        case $.EVENT_CANCEL:\n        case $.EVENT_END:\n          this._end(e);\n\n          break;\n\n        case 'webkitTransitionEnd':\n          this.transitionTimer && this.transitionTimer.cancel();\n\n          this._transitionEnd(e);\n\n          break;\n\n        case 'scrollstart':\n          this._handleIndicatorScrollstart(e);\n\n          break;\n\n        case 'scrollend':\n          this._handleIndicatorScrollend(e);\n\n          this._scrollend(e);\n\n          e.stopPropagation();\n          break;\n\n        case 'orientationchange':\n        case 'resize':\n          this._resize();\n\n          break;\n\n        case 'swiperight':\n          e.stopPropagation();\n          break;\n\n        case 'refresh':\n          this._handleIndicatorRefresh(e);\n\n          break;\n      }\n    },\n    _start: function _start(e) {\n      this.moved = this.needReset = false;\n\n      this._transitionTime();\n\n      if (this.isInTransition) {\n        this.needReset = true;\n        this.isInTransition = false;\n        var pos = $.parseTranslateMatrix($.getStyles(this.scroller, 'webkitTransform'));\n        this.setTranslate(Math.round(pos.x), Math.round(pos.y)); //\t\t\t\tthis.resetPosition(); //reset\n\n        $.trigger(this.scroller, 'scrollend', this); //\t\t\t\te.stopPropagation();\n\n        e.preventDefault();\n      }\n\n      this.reLayout();\n      $.trigger(this.scroller, 'beforescrollstart', this);\n    },\n    _getDirectionByAngle: function _getDirectionByAngle(angle) {\n      if (angle < -80 && angle > -100) {\n        return 'up';\n      } else if (angle >= 80 && angle < 100) {\n        return 'down';\n      } else if (angle >= 170 || angle <= -170) {\n        return 'left';\n      } else if (angle >= -35 && angle <= 10) {\n        return 'right';\n      }\n\n      return null;\n    },\n    _drag: function _drag(e) {\n      //\t\t\tif (this.needReset) {\n      //\t\t\t\te.stopPropagation(); //disable parent drag(nested scroller)\n      //\t\t\t\treturn;\n      //\t\t\t}\n      var detail = e.detail;\n\n      if (this.options.scrollY || detail.direction === 'up' || detail.direction === 'down') {\n        //如果是竖向滚动或手势方向是上或下\n        //ios8 hack\n        if ($.os.ios && parseFloat($.os.version) >= 8) {\n          //多webview时，离开当前webview会导致后续touch事件不触发\n          var clientY = detail.gesture.touches[0].clientY; //下拉刷新 or 上拉加载\n\n          if (clientY + 10 > window.innerHeight || clientY < 10) {\n            this.resetPosition(this.options.bounceTime);\n            return;\n          }\n        }\n      }\n\n      var isPreventDefault = isReturn = false;\n\n      var direction = this._getDirectionByAngle(detail.angle);\n\n      if (detail.direction === 'left' || detail.direction === 'right') {\n        if (this.options.scrollX) {\n          isPreventDefault = true;\n\n          if (!this.moved) {\n            //识别角度(该角度导致轮播不灵敏)\n            //\t\t\t\t\t\tif (direction !== 'left' && direction !== 'right') {\n            //\t\t\t\t\t\t\tisReturn = true;\n            //\t\t\t\t\t\t} else {\n            $.gestures.session.lockDirection = true; //锁定方向\n\n            $.gestures.session.startDirection = detail.direction; //\t\t\t\t\t\t}\n          }\n        } else if (this.options.scrollY && !this.moved) {\n          isReturn = true;\n        }\n      } else if (detail.direction === 'up' || detail.direction === 'down') {\n        if (this.options.scrollY) {\n          isPreventDefault = true; //\t\t\t\t\tif (!this.moved) { //识别角度,竖向滚动似乎没必要进行小角度验证\n          //\t\t\t\t\t\tif (direction !== 'up' && direction !== 'down') {\n          //\t\t\t\t\t\t\tisReturn = true;\n          //\t\t\t\t\t\t}\n          //\t\t\t\t\t}\n\n          if (!this.moved) {\n            $.gestures.session.lockDirection = true; //锁定方向\n\n            $.gestures.session.startDirection = detail.direction;\n          }\n        } else if (this.options.scrollX && !this.moved) {\n          isReturn = true;\n        }\n      } else {\n        isReturn = true;\n      }\n\n      if (this.moved || isPreventDefault) {\n        e.stopPropagation(); //阻止冒泡(scroll类嵌套)\n\n        detail.gesture && detail.gesture.preventDefault();\n      }\n\n      if (isReturn) {\n        //禁止非法方向滚动\n        return;\n      }\n\n      if (!this.moved) {\n        $.trigger(this.scroller, 'scrollstart', this);\n      } else {\n        e.stopPropagation(); //move期间阻止冒泡(scroll嵌套)\n      }\n\n      var deltaX = 0;\n      var deltaY = 0;\n\n      if (!this.moved) {\n        //start\n        deltaX = detail.deltaX;\n        deltaY = detail.deltaY;\n      } else {\n        //move\n        deltaX = detail.deltaX - $.gestures.session.prevTouch.deltaX;\n        deltaY = detail.deltaY - $.gestures.session.prevTouch.deltaY;\n      }\n\n      var absDeltaX = Math.abs(detail.deltaX);\n      var absDeltaY = Math.abs(detail.deltaY);\n\n      if (absDeltaX > absDeltaY + this.options.directionLockThreshold) {\n        deltaY = 0;\n      } else if (absDeltaY >= absDeltaX + this.options.directionLockThreshold) {\n        deltaX = 0;\n      }\n\n      deltaX = this.hasHorizontalScroll ? deltaX : 0;\n      deltaY = this.hasVerticalScroll ? deltaY : 0;\n      var newX = this.x + deltaX;\n      var newY = this.y + deltaY; // Slow down if outside of the boundaries\n\n      if (newX > 0 || newX < this.maxScrollX) {\n        newX = this.options.bounce ? this.x + deltaX / 3 : newX > 0 ? 0 : this.maxScrollX;\n      }\n\n      if (newY > 0 || newY < this.maxScrollY) {\n        newY = this.options.bounce ? this.y + deltaY / 3 : newY > 0 ? 0 : this.maxScrollY;\n      }\n\n      if (!this.requestAnimationFrame) {\n        this._updateTranslate();\n      }\n\n      this.direction = detail.deltaX > 0 ? 'right' : 'left';\n      this.moved = true;\n      this.x = newX;\n      this.y = newY;\n      $.trigger(this.scroller, 'scroll', this);\n    },\n    _flick: function _flick(e) {\n      //\t\t\tif (!this.moved || this.needReset) {\n      //\t\t\t\treturn;\n      //\t\t\t}\n      if (!this.moved) {\n        return;\n      }\n\n      e.stopPropagation();\n      var detail = e.detail;\n\n      this._clearRequestAnimationFrame();\n\n      if (e.type === 'dragend' && detail.flick) {\n        //dragend\n        return;\n      }\n\n      var newX = Math.round(this.x);\n      var newY = Math.round(this.y);\n      this.isInTransition = false; // reset if we are outside of the boundaries\n\n      if (this.resetPosition(this.options.bounceTime)) {\n        return;\n      }\n\n      this.scrollTo(newX, newY); // ensures that the last position is rounded\n\n      if (e.type === 'dragend') {\n        //dragend\n        $.trigger(this.scroller, 'scrollend', this);\n        return;\n      }\n\n      var time = 0;\n      var easing = ''; // start momentum animation if needed\n\n      if (this.options.momentum && detail.flickTime < 300) {\n        momentumX = this.hasHorizontalScroll ? this._momentum(this.x, detail.flickDistanceX, detail.flickTime, this.maxScrollX, this.options.bounce ? this.wrapperWidth : 0, this.options.deceleration) : {\n          destination: newX,\n          duration: 0\n        };\n        momentumY = this.hasVerticalScroll ? this._momentum(this.y, detail.flickDistanceY, detail.flickTime, this.maxScrollY, this.options.bounce ? this.wrapperHeight : 0, this.options.deceleration) : {\n          destination: newY,\n          duration: 0\n        };\n        newX = momentumX.destination;\n        newY = momentumY.destination;\n        time = Math.max(momentumX.duration, momentumY.duration);\n        this.isInTransition = true;\n      }\n\n      if (newX != this.x || newY != this.y) {\n        if (newX > 0 || newX < this.maxScrollX || newY > 0 || newY < this.maxScrollY) {\n          easing = ease.quadratic;\n        }\n\n        this.scrollTo(newX, newY, time, easing);\n        return;\n      }\n\n      $.trigger(this.scroller, 'scrollend', this); //\t\t\te.stopPropagation();\n    },\n    _end: function _end(e) {\n      this.needReset = false;\n\n      if (!this.moved && this.needReset || e.type === $.EVENT_CANCEL) {\n        this.resetPosition();\n      }\n    },\n    _transitionEnd: function _transitionEnd(e) {\n      if (e.target != this.scroller || !this.isInTransition) {\n        return;\n      }\n\n      this._transitionTime();\n\n      if (!this.resetPosition(this.options.bounceTime)) {\n        this.isInTransition = false;\n        $.trigger(this.scroller, 'scrollend', this);\n      }\n    },\n    _scrollend: function _scrollend(e) {\n      if (this.y === 0 && this.maxScrollY === 0 || Math.abs(this.y) > 0 && this.y <= this.maxScrollY) {\n        $.trigger(this.scroller, 'scrollbottom', this);\n      }\n    },\n    _resize: function _resize() {\n      var that = this;\n      clearTimeout(that.resizeTimeout);\n      that.resizeTimeout = setTimeout(function () {\n        that.refresh();\n      }, that.options.resizePolling);\n    },\n    _transitionTime: function _transitionTime(time) {\n      time = time || 0;\n      this.scrollerStyle['webkitTransitionDuration'] = time + 'ms';\n\n      if (this.parallaxElement && this.options.scrollY) {\n        //目前仅支持竖向视差效果\n        this.parallaxStyle['webkitTransitionDuration'] = time + 'ms';\n      }\n\n      if (this.options.fixedBadAndorid && !time && $.os.isBadAndroid) {\n        this.scrollerStyle['webkitTransitionDuration'] = '0.001s';\n\n        if (this.parallaxElement && this.options.scrollY) {\n          //目前仅支持竖向视差效果\n          this.parallaxStyle['webkitTransitionDuration'] = '0.001s';\n        }\n      }\n\n      if (this.indicators) {\n        for (var i = this.indicators.length; i--;) {\n          this.indicators[i].transitionTime(time);\n        }\n      }\n\n      if (time) {\n        //自定义timer，保证webkitTransitionEnd始终触发\n        this.transitionTimer && this.transitionTimer.cancel();\n        this.transitionTimer = $.later(function () {\n          $.trigger(this.scroller, 'webkitTransitionEnd');\n        }, time + 100, this);\n      }\n    },\n    _transitionTimingFunction: function _transitionTimingFunction(easing) {\n      this.scrollerStyle['webkitTransitionTimingFunction'] = easing;\n\n      if (this.parallaxElement && this.options.scrollY) {\n        //目前仅支持竖向视差效果\n        this.parallaxStyle['webkitTransitionDuration'] = easing;\n      }\n\n      if (this.indicators) {\n        for (var i = this.indicators.length; i--;) {\n          this.indicators[i].transitionTimingFunction(easing);\n        }\n      }\n    },\n    _translate: function _translate(x, y) {\n      this.x = x;\n      this.y = y;\n    },\n    _clearRequestAnimationFrame: function _clearRequestAnimationFrame() {\n      if (this.requestAnimationFrame) {\n        cancelAnimationFrame(this.requestAnimationFrame);\n        this.requestAnimationFrame = null;\n      }\n    },\n    _updateTranslate: function _updateTranslate() {\n      var self = this;\n\n      if (self.x !== self.lastX || self.y !== self.lastY) {\n        self.setTranslate(self.x, self.y);\n      }\n\n      self.requestAnimationFrame = requestAnimationFrame(function () {\n        self._updateTranslate();\n      });\n    },\n    _createScrollBar: function _createScrollBar(clazz) {\n      var scrollbar = document.createElement('div');\n      var indicator = document.createElement('div');\n      scrollbar.className = CLASS_SCROLLBAR + ' ' + clazz;\n      indicator.className = CLASS_INDICATOR;\n      scrollbar.appendChild(indicator);\n\n      if (clazz === CLASS_SCROLLBAR_VERTICAL) {\n        this.scrollbarY = scrollbar;\n        this.scrollbarIndicatorY = indicator;\n      } else if (clazz === CLASS_SCROLLBAR_HORIZONTAL) {\n        this.scrollbarX = scrollbar;\n        this.scrollbarIndicatorX = indicator;\n      }\n\n      this.wrapper.appendChild(scrollbar);\n      return scrollbar;\n    },\n    _preventDefaultException: function _preventDefaultException(el, exceptions) {\n      for (var i in exceptions) {\n        if (exceptions[i].test(el[i])) {\n          return true;\n        }\n      }\n\n      return false;\n    },\n    _reLayout: function _reLayout() {\n      if (!this.hasHorizontalScroll) {\n        this.maxScrollX = 0;\n        this.scrollerWidth = this.wrapperWidth;\n      }\n\n      if (!this.hasVerticalScroll) {\n        this.maxScrollY = 0;\n        this.scrollerHeight = this.wrapperHeight;\n      }\n\n      this.indicators.map(function (indicator) {\n        indicator.refresh();\n      }); //以防slider类嵌套使用\n\n      if (this.options.snap && typeof this.options.snap === 'string') {\n        var items = this.scroller.querySelectorAll(this.options.snap);\n        this.itemLength = 0;\n        this.snaps = [];\n\n        for (var i = 0, len = items.length; i < len; i++) {\n          var item = items[i];\n\n          if (item.parentNode === this.scroller) {\n            this.itemLength++;\n            this.snaps.push(item);\n          }\n        }\n\n        this._initSnap(); //需要每次都_initSnap么。其实init的时候执行一次，后续resize的时候执行一次就行了吧.先这么做吧，如果影响性能，再调整\n\n      }\n    },\n    _momentum: function _momentum(current, distance, time, lowerMargin, wrapperSize, deceleration) {\n      var speed = parseFloat(Math.abs(distance) / time),\n          destination,\n          duration;\n      deceleration = deceleration === undefined ? 0.0006 : deceleration;\n      destination = current + speed * speed / (2 * deceleration) * (distance < 0 ? -1 : 1);\n      duration = speed / deceleration;\n\n      if (destination < lowerMargin) {\n        destination = wrapperSize ? lowerMargin - wrapperSize / 2.5 * (speed / 8) : lowerMargin;\n        distance = Math.abs(destination - current);\n        duration = distance / speed;\n      } else if (destination > 0) {\n        destination = wrapperSize ? wrapperSize / 2.5 * (speed / 8) : 0;\n        distance = Math.abs(current) + destination;\n        duration = distance / speed;\n      }\n\n      return {\n        destination: Math.round(destination),\n        duration: duration\n      };\n    },\n    _getTranslateStr: function _getTranslateStr(x, y) {\n      if (this.options.hardwareAccelerated) {\n        return 'translate3d(' + x + 'px,' + y + 'px,0px) ' + this.translateZ;\n      }\n\n      return 'translate(' + x + 'px,' + y + 'px) ';\n    },\n    //API\n    setStopped: function setStopped(stopped) {\n      this.stopped = !!stopped;\n    },\n    setTranslate: function setTranslate(x, y) {\n      this.x = x;\n      this.y = y;\n      this.scrollerStyle['webkitTransform'] = this._getTranslateStr(x, y);\n\n      if (this.parallaxElement && this.options.scrollY) {\n        //目前仅支持竖向视差效果\n        var parallaxY = y * this.options.parallaxRatio;\n        var scale = 1 + parallaxY / ((this.parallaxHeight - parallaxY) / 2);\n\n        if (scale > 1) {\n          this.parallaxImgStyle['opacity'] = 1 - parallaxY / 100 * this.options.parallaxRatio;\n          this.parallaxStyle['webkitTransform'] = this._getTranslateStr(0, -parallaxY) + ' scale(' + scale + ',' + scale + ')';\n        } else {\n          this.parallaxImgStyle['opacity'] = 1;\n          this.parallaxStyle['webkitTransform'] = this._getTranslateStr(0, -1) + ' scale(1,1)';\n        }\n      }\n\n      if (this.indicators) {\n        for (var i = this.indicators.length; i--;) {\n          this.indicators[i].updatePosition();\n        }\n      }\n\n      this.lastX = this.x;\n      this.lastY = this.y;\n      $.trigger(this.scroller, 'scroll', this);\n    },\n    reLayout: function reLayout() {\n      this.wrapper.offsetHeight;\n      var paddingLeft = parseFloat($.getStyles(this.wrapper, 'padding-left')) || 0;\n      var paddingRight = parseFloat($.getStyles(this.wrapper, 'padding-right')) || 0;\n      var paddingTop = parseFloat($.getStyles(this.wrapper, 'padding-top')) || 0;\n      var paddingBottom = parseFloat($.getStyles(this.wrapper, 'padding-bottom')) || 0;\n      var clientWidth = this.wrapper.clientWidth;\n      var clientHeight = this.wrapper.clientHeight;\n      this.scrollerWidth = this.scroller.offsetWidth;\n      this.scrollerHeight = this.scroller.offsetHeight;\n      this.wrapperWidth = clientWidth - paddingLeft - paddingRight;\n      this.wrapperHeight = clientHeight - paddingTop - paddingBottom;\n      this.maxScrollX = Math.min(this.wrapperWidth - this.scrollerWidth, 0);\n      this.maxScrollY = Math.min(this.wrapperHeight - this.scrollerHeight, 0);\n      this.hasHorizontalScroll = this.options.scrollX && this.maxScrollX < 0;\n      this.hasVerticalScroll = this.options.scrollY && this.maxScrollY < 0;\n\n      this._reLayout();\n    },\n    resetPosition: function resetPosition(time) {\n      var x = this.x,\n          y = this.y;\n      time = time || 0;\n\n      if (!this.hasHorizontalScroll || this.x > 0) {\n        x = 0;\n      } else if (this.x < this.maxScrollX) {\n        x = this.maxScrollX;\n      }\n\n      if (!this.hasVerticalScroll || this.y > 0) {\n        y = 0;\n      } else if (this.y < this.maxScrollY) {\n        y = this.maxScrollY;\n      }\n\n      if (x == this.x && y == this.y) {\n        return false;\n      }\n\n      this.scrollTo(x, y, time, this.options.scrollEasing);\n      return true;\n    },\n    _reInit: function _reInit() {\n      var groups = this.wrapper.querySelectorAll('.' + CLASS_SCROLL);\n\n      for (var i = 0, len = groups.length; i < len; i++) {\n        if (groups[i].parentNode === this.wrapper) {\n          this.scroller = groups[i];\n          break;\n        }\n      }\n\n      this.scrollerStyle = this.scroller && this.scroller.style;\n    },\n    refresh: function refresh() {\n      this._reInit();\n\n      this.reLayout();\n      $.trigger(this.scroller, 'refresh', this);\n      this.resetPosition();\n    },\n    scrollTo: function scrollTo(x, y, time, easing) {\n      var easing = easing || ease.circular; //\t\t\tthis.isInTransition = time > 0 && (this.lastX != x || this.lastY != y);\n      //暂不严格判断x,y，否则会导致部分版本上不正常触发轮播\n\n      this.isInTransition = time > 0;\n\n      if (this.isInTransition) {\n        this._clearRequestAnimationFrame();\n\n        this._transitionTimingFunction(easing.style);\n\n        this._transitionTime(time);\n\n        this.setTranslate(x, y);\n      } else {\n        this.setTranslate(x, y);\n      }\n    },\n    scrollToBottom: function scrollToBottom(time, easing) {\n      time = time || this.options.scrollTime;\n      this.scrollTo(0, this.maxScrollY, time, easing);\n    },\n    gotoPage: function gotoPage(index) {\n      this._gotoPage(index);\n    },\n    destroy: function destroy() {\n      this._initEvent(true); //detach\n\n\n      delete $.data[this.wrapper.getAttribute('data-scroll')];\n      this.wrapper.setAttribute('data-scroll', '');\n    }\n  }); //Indicator\n\n  var Indicator = function Indicator(scroller, options) {\n    this.wrapper = typeof options.el == 'string' ? document.querySelector(options.el) : options.el;\n    this.wrapperStyle = this.wrapper.style;\n    this.indicator = this.wrapper.children[0];\n    this.indicatorStyle = this.indicator.style;\n    this.scroller = scroller;\n    this.options = $.extend({\n      listenX: true,\n      listenY: true,\n      fade: false,\n      speedRatioX: 0,\n      speedRatioY: 0\n    }, options);\n    this.sizeRatioX = 1;\n    this.sizeRatioY = 1;\n    this.maxPosX = 0;\n    this.maxPosY = 0;\n\n    if (this.options.fade) {\n      this.wrapperStyle['webkitTransform'] = this.scroller.translateZ;\n      this.wrapperStyle['webkitTransitionDuration'] = this.options.fixedBadAndorid && $.os.isBadAndroid ? '0.001s' : '0ms';\n      this.wrapperStyle.opacity = '0';\n    }\n  };\n\n  Indicator.prototype = {\n    handleEvent: function handleEvent(e) {},\n    transitionTime: function transitionTime(time) {\n      time = time || 0;\n      this.indicatorStyle['webkitTransitionDuration'] = time + 'ms';\n\n      if (this.scroller.options.fixedBadAndorid && !time && $.os.isBadAndroid) {\n        this.indicatorStyle['webkitTransitionDuration'] = '0.001s';\n      }\n    },\n    transitionTimingFunction: function transitionTimingFunction(easing) {\n      this.indicatorStyle['webkitTransitionTimingFunction'] = easing;\n    },\n    refresh: function refresh() {\n      this.transitionTime();\n\n      if (this.options.listenX && !this.options.listenY) {\n        this.indicatorStyle.display = this.scroller.hasHorizontalScroll ? 'block' : 'none';\n      } else if (this.options.listenY && !this.options.listenX) {\n        this.indicatorStyle.display = this.scroller.hasVerticalScroll ? 'block' : 'none';\n      } else {\n        this.indicatorStyle.display = this.scroller.hasHorizontalScroll || this.scroller.hasVerticalScroll ? 'block' : 'none';\n      }\n\n      this.wrapper.offsetHeight; // force refresh\n\n      if (this.options.listenX) {\n        this.wrapperWidth = this.wrapper.clientWidth;\n        this.indicatorWidth = Math.max(Math.round(this.wrapperWidth * this.wrapperWidth / (this.scroller.scrollerWidth || this.wrapperWidth || 1)), 8);\n        this.indicatorStyle.width = this.indicatorWidth + 'px';\n        this.maxPosX = this.wrapperWidth - this.indicatorWidth;\n        this.minBoundaryX = 0;\n        this.maxBoundaryX = this.maxPosX;\n        this.sizeRatioX = this.options.speedRatioX || this.scroller.maxScrollX && this.maxPosX / this.scroller.maxScrollX;\n      }\n\n      if (this.options.listenY) {\n        this.wrapperHeight = this.wrapper.clientHeight;\n        this.indicatorHeight = Math.max(Math.round(this.wrapperHeight * this.wrapperHeight / (this.scroller.scrollerHeight || this.wrapperHeight || 1)), 8);\n        this.indicatorStyle.height = this.indicatorHeight + 'px';\n        this.maxPosY = this.wrapperHeight - this.indicatorHeight;\n        this.minBoundaryY = 0;\n        this.maxBoundaryY = this.maxPosY;\n        this.sizeRatioY = this.options.speedRatioY || this.scroller.maxScrollY && this.maxPosY / this.scroller.maxScrollY;\n      }\n\n      this.updatePosition();\n    },\n    updatePosition: function updatePosition() {\n      var x = this.options.listenX && Math.round(this.sizeRatioX * this.scroller.x) || 0,\n          y = this.options.listenY && Math.round(this.sizeRatioY * this.scroller.y) || 0;\n\n      if (x < this.minBoundaryX) {\n        this.width = Math.max(this.indicatorWidth + x, 8);\n        this.indicatorStyle.width = this.width + 'px';\n        x = this.minBoundaryX;\n      } else if (x > this.maxBoundaryX) {\n        this.width = Math.max(this.indicatorWidth - (x - this.maxPosX), 8);\n        this.indicatorStyle.width = this.width + 'px';\n        x = this.maxPosX + this.indicatorWidth - this.width;\n      } else if (this.width != this.indicatorWidth) {\n        this.width = this.indicatorWidth;\n        this.indicatorStyle.width = this.width + 'px';\n      }\n\n      if (y < this.minBoundaryY) {\n        this.height = Math.max(this.indicatorHeight + y * 3, 8);\n        this.indicatorStyle.height = this.height + 'px';\n        y = this.minBoundaryY;\n      } else if (y > this.maxBoundaryY) {\n        this.height = Math.max(this.indicatorHeight - (y - this.maxPosY) * 3, 8);\n        this.indicatorStyle.height = this.height + 'px';\n        y = this.maxPosY + this.indicatorHeight - this.height;\n      } else if (this.height != this.indicatorHeight) {\n        this.height = this.indicatorHeight;\n        this.indicatorStyle.height = this.height + 'px';\n      }\n\n      this.x = x;\n      this.y = y;\n      this.indicatorStyle['webkitTransform'] = this.scroller._getTranslateStr(x, y);\n    },\n    fade: function fade(val, hold) {\n      if (hold && !this.visible) {\n        return;\n      }\n\n      clearTimeout(this.fadeTimeout);\n      this.fadeTimeout = null;\n      var time = val ? 250 : 500,\n          delay = val ? 0 : 300;\n      val = val ? '1' : '0';\n      this.wrapperStyle['webkitTransitionDuration'] = time + 'ms';\n      this.fadeTimeout = setTimeout(function (val) {\n        this.wrapperStyle.opacity = val;\n        this.visible = +val;\n      }.bind(this, val), delay);\n    }\n  };\n  $.Scroll = Scroll;\n\n  $.fn.scroll = function (options) {\n    var scrollApis = [];\n    this.each(function () {\n      var scrollApi = null;\n      var self = this;\n      var id = self.getAttribute('data-scroll');\n\n      if (!id) {\n        id = ++$.uuid;\n\n        var _options = $.extend({}, options);\n\n        if (self.classList.contains('mui-segmented-control')) {\n          _options = $.extend(_options, {\n            scrollY: false,\n            scrollX: true,\n            indicators: false,\n            snap: '.mui-control-item'\n          });\n        }\n\n        $.data[id] = scrollApi = new Scroll(self, _options);\n        self.setAttribute('data-scroll', id);\n      } else {\n        scrollApi = $.data[id];\n      }\n\n      scrollApis.push(scrollApi);\n    });\n    return scrollApis.length === 1 ? scrollApis[0] : scrollApis;\n  };\n})(mui, window, document);\n\n(function ($, window, document, undefined) {\n  var CLASS_VISIBILITY = 'mui-visibility';\n  var CLASS_HIDDEN = 'mui-hidden';\n  var PullRefresh = $.Scroll.extend($.extend({\n    handleEvent: function handleEvent(e) {\n      this._super(e);\n\n      if (e.type === 'scrollbottom') {\n        if (e.target === this.scroller) {\n          this._scrollbottom();\n        }\n      }\n    },\n    _scrollbottom: function _scrollbottom() {\n      if (!this.pulldown && !this.loading) {\n        this.pulldown = false;\n\n        this._initPullupRefresh();\n\n        this.pullupLoading();\n      }\n    },\n    _start: function _start(e) {\n      //仅下拉刷新在start阻止默认事件\n      if (e.touches && e.touches.length && e.touches[0].clientX > 30) {\n        e.target && !this._preventDefaultException(e.target, this.options.preventDefaultException) && e.preventDefault();\n      }\n\n      if (!this.loading) {\n        this.pulldown = this.pullPocket = this.pullCaption = this.pullLoading = false;\n      }\n\n      this._super(e);\n    },\n    _drag: function _drag(e) {\n      this._super(e);\n\n      if (!this.pulldown && !this.loading && this.topPocket && e.detail.direction === 'down' && this.y >= 0) {\n        this._initPulldownRefresh();\n      }\n\n      if (this.pulldown) {\n        this._setCaption(this.y > this.options.down.height ? this.options.down.contentover : this.options.down.contentdown);\n      }\n    },\n    _reLayout: function _reLayout() {\n      this.hasVerticalScroll = true;\n\n      this._super();\n    },\n    //API\n    resetPosition: function resetPosition(time) {\n      if (this.pulldown) {\n        if (this.y >= this.options.down.height) {\n          this.pulldownLoading(undefined, time || 0);\n          return true;\n        } else {\n          !this.loading && this.topPocket.classList.remove(CLASS_VISIBILITY);\n        }\n      }\n\n      return this._super(time);\n    },\n    pulldownLoading: function pulldownLoading(y, time) {\n      typeof y === 'undefined' && (y = this.options.down.height); //默认高度\n\n      this.scrollTo(0, y, time, this.options.bounceEasing);\n\n      if (this.loading) {\n        return;\n      } //\t\t\tif (!this.pulldown) {\n\n\n      this._initPulldownRefresh(); //\t\t\t}\n\n\n      this._setCaption(this.options.down.contentrefresh);\n\n      this.loading = true;\n      this.indicators.map(function (indicator) {\n        indicator.fade(0);\n      });\n      var callback = this.options.down.callback;\n      callback && callback.call(this);\n    },\n    endPulldownToRefresh: function endPulldownToRefresh() {\n      var self = this;\n\n      if (self.topPocket && self.loading && this.pulldown) {\n        self.scrollTo(0, 0, self.options.bounceTime, self.options.bounceEasing);\n        self.loading = false;\n\n        self._setCaption(self.options.down.contentdown, true);\n\n        setTimeout(function () {\n          self.loading || self.topPocket.classList.remove(CLASS_VISIBILITY);\n        }, 350);\n      }\n    },\n    pullupLoading: function pullupLoading(callback, x, time) {\n      x = x || 0;\n      this.scrollTo(x, this.maxScrollY, time, this.options.bounceEasing);\n\n      if (this.loading) {\n        return;\n      }\n\n      this._initPullupRefresh();\n\n      this._setCaption(this.options.up.contentrefresh);\n\n      this.indicators.map(function (indicator) {\n        indicator.fade(0);\n      });\n      this.loading = true;\n      callback = callback || this.options.up.callback;\n      callback && callback.call(this);\n    },\n    endPullupToRefresh: function endPullupToRefresh(finished) {\n      var self = this;\n\n      if (self.bottomPocket) {\n        // && self.loading && !this.pulldown\n        self.loading = false;\n\n        if (finished) {\n          this.finished = true;\n\n          self._setCaption(self.options.up.contentnomore); //\t\t\t\t\tself.bottomPocket.classList.remove(CLASS_VISIBILITY);\n          //\t\t\t\t\tself.bottomPocket.classList.add(CLASS_HIDDEN);\n\n\n          self.wrapper.removeEventListener('scrollbottom', self);\n        } else {\n          self._setCaption(self.options.up.contentdown); //\t\t\t\t\tsetTimeout(function() {\n\n\n          self.loading || self.bottomPocket.classList.remove(CLASS_VISIBILITY); //\t\t\t\t\t}, 300);\n        }\n      }\n    },\n    disablePullupToRefresh: function disablePullupToRefresh() {\n      this._initPullupRefresh();\n\n      this.bottomPocket.className = 'mui-pull-bottom-pocket' + ' ' + CLASS_HIDDEN;\n      this.wrapper.removeEventListener('scrollbottom', this);\n    },\n    enablePullupToRefresh: function enablePullupToRefresh() {\n      this._initPullupRefresh();\n\n      this.bottomPocket.classList.remove(CLASS_HIDDEN);\n\n      this._setCaption(this.options.up.contentdown);\n\n      this.wrapper.addEventListener('scrollbottom', this);\n    },\n    refresh: function refresh(isReset) {\n      if (isReset && this.finished) {\n        this.enablePullupToRefresh();\n        this.finished = false;\n      }\n\n      this._super();\n    }\n  }, $.PullRefresh));\n\n  $.fn.pullRefresh = function (options) {\n    if (this.length === 1) {\n      var self = this[0];\n      var pullRefreshApi = null;\n      var id = self.getAttribute('data-pullrefresh');\n\n      if (!id && typeof options === 'undefined') {\n        return false;\n      }\n\n      options = options || {};\n\n      if (!id) {\n        id = ++$.uuid;\n        $.data[id] = pullRefreshApi = new PullRefresh(self, options);\n        self.setAttribute('data-pullrefresh', id);\n      } else {\n        pullRefreshApi = $.data[id];\n      }\n\n      if (options.down && options.down.auto) {\n        //如果设置了auto，则自动下拉一次\n        pullRefreshApi.pulldownLoading(options.down.autoY);\n      } else if (options.up && options.up.auto) {\n        //如果设置了auto，则自动上拉一次\n        pullRefreshApi.pullupLoading();\n      } //暂不提供这种调用方式吧\t\t\t\n      //\t\t\tif (typeof options === 'string') {\n      //\t\t\t\tvar methodValue = pullRefreshApi[options].apply(pullRefreshApi, $.slice.call(arguments, 1));\n      //\t\t\t\tif (methodValue !== undefined) {\n      //\t\t\t\t\treturn methodValue;\n      //\t\t\t\t}\n      //\t\t\t}\n\n\n      return pullRefreshApi;\n    }\n  };\n})(mui, window, document);\n/**\r\n * snap 重构\r\n * @param {Object} $\r\n * @param {Object} window\r\n */\n\n\n(function ($, window) {\n  var CLASS_SLIDER = 'mui-slider';\n  var CLASS_SLIDER_GROUP = 'mui-slider-group';\n  var CLASS_SLIDER_LOOP = 'mui-slider-loop';\n  var CLASS_SLIDER_INDICATOR = 'mui-slider-indicator';\n  var CLASS_ACTION_PREVIOUS = 'mui-action-previous';\n  var CLASS_ACTION_NEXT = 'mui-action-next';\n  var CLASS_SLIDER_ITEM = 'mui-slider-item';\n  var CLASS_ACTIVE = 'mui-active';\n  var SELECTOR_SLIDER_ITEM = '.' + CLASS_SLIDER_ITEM;\n  var SELECTOR_SLIDER_INDICATOR = '.' + CLASS_SLIDER_INDICATOR;\n  var SELECTOR_SLIDER_PROGRESS_BAR = '.mui-slider-progress-bar';\n  var Slider = $.Slider = $.Scroll.extend({\n    init: function init(element, options) {\n      this._super(element, $.extend(true, {\n        fingers: 1,\n        interval: 0,\n        //设置为0，则不定时轮播\n        scrollY: false,\n        scrollX: true,\n        indicators: false,\n        scrollTime: 1000,\n        startX: false,\n        slideTime: 0,\n        //滑动动画时间\n        snap: SELECTOR_SLIDER_ITEM\n      }, options));\n\n      if (this.options.startX) {//\t\t\t\t$.trigger(this.wrapper, 'scrollend', this);\n      }\n    },\n    _init: function _init() {\n      this._reInit();\n\n      if (this.scroller) {\n        this.scrollerStyle = this.scroller.style;\n        this.progressBar = this.wrapper.querySelector(SELECTOR_SLIDER_PROGRESS_BAR);\n\n        if (this.progressBar) {\n          this.progressBarWidth = this.progressBar.offsetWidth;\n          this.progressBarStyle = this.progressBar.style;\n        } //忘记这个代码是干什么的了？\n        //\t\t\t\tthis.x = this._getScroll();\n        //\t\t\t\tif (this.options.startX === false) {\n        //\t\t\t\t\tthis.options.startX = this.x;\n        //\t\t\t\t}\n        //根据active修正startX\n\n\n        this._super();\n\n        this._initTimer();\n      }\n    },\n    _triggerSlide: function _triggerSlide() {\n      var self = this;\n      self.isInTransition = false;\n      var page = self.currentPage;\n      self.slideNumber = self._fixedSlideNumber();\n\n      if (self.loop) {\n        if (self.slideNumber === 0) {\n          self.setTranslate(self.pages[1][0].x, 0);\n        } else if (self.slideNumber === self.itemLength - 3) {\n          self.setTranslate(self.pages[self.itemLength - 2][0].x, 0);\n        }\n      }\n\n      if (self.lastSlideNumber != self.slideNumber) {\n        self.lastSlideNumber = self.slideNumber;\n        self.lastPage = self.currentPage;\n        $.trigger(self.wrapper, 'slide', {\n          slideNumber: self.slideNumber\n        });\n      }\n\n      self._initTimer();\n    },\n    _handleSlide: function _handleSlide(e) {\n      var self = this;\n\n      if (e.target !== self.wrapper) {\n        return;\n      }\n\n      var detail = e.detail;\n      detail.slideNumber = detail.slideNumber || 0;\n      var temps = self.scroller.querySelectorAll(SELECTOR_SLIDER_ITEM);\n      var items = [];\n\n      for (var i = 0, len = temps.length; i < len; i++) {\n        var item = temps[i];\n\n        if (item.parentNode === self.scroller) {\n          items.push(item);\n        }\n      }\n\n      var _slideNumber = detail.slideNumber;\n\n      if (self.loop) {\n        _slideNumber += 1;\n      }\n\n      if (!self.wrapper.classList.contains('mui-segmented-control')) {\n        for (var i = 0, len = items.length; i < len; i++) {\n          var item = items[i];\n\n          if (item.parentNode === self.scroller) {\n            if (i === _slideNumber) {\n              item.classList.add(CLASS_ACTIVE);\n            } else {\n              item.classList.remove(CLASS_ACTIVE);\n            }\n          }\n        }\n      }\n\n      var indicatorWrap = self.wrapper.querySelector('.mui-slider-indicator');\n\n      if (indicatorWrap) {\n        if (indicatorWrap.getAttribute('data-scroll')) {\n          //scroll\n          $(indicatorWrap).scroll().gotoPage(detail.slideNumber);\n        }\n\n        var indicators = indicatorWrap.querySelectorAll('.mui-indicator');\n\n        if (indicators.length > 0) {\n          //图片轮播\n          for (var i = 0, len = indicators.length; i < len; i++) {\n            indicators[i].classList[i === detail.slideNumber ? 'add' : 'remove'](CLASS_ACTIVE);\n          }\n        } else {\n          var number = indicatorWrap.querySelector('.mui-number span');\n\n          if (number) {\n            //图文表格\n            number.innerText = detail.slideNumber + 1;\n          } else {\n            //segmented controls\n            var controlItems = indicatorWrap.querySelectorAll('.mui-control-item');\n\n            for (var i = 0, len = controlItems.length; i < len; i++) {\n              controlItems[i].classList[i === detail.slideNumber ? 'add' : 'remove'](CLASS_ACTIVE);\n            }\n          }\n        }\n      }\n\n      e.stopPropagation();\n    },\n    _handleTabShow: function _handleTabShow(e) {\n      var self = this;\n      self.gotoItem(e.detail.tabNumber || 0, self.options.slideTime);\n    },\n    _handleIndicatorTap: function _handleIndicatorTap(event) {\n      var self = this;\n      var target = event.target;\n\n      if (target.classList.contains(CLASS_ACTION_PREVIOUS) || target.classList.contains(CLASS_ACTION_NEXT)) {\n        self[target.classList.contains(CLASS_ACTION_PREVIOUS) ? 'prevItem' : 'nextItem']();\n        event.stopPropagation();\n      }\n    },\n    _initEvent: function _initEvent(detach) {\n      var self = this;\n\n      self._super(detach);\n\n      var action = detach ? 'removeEventListener' : 'addEventListener';\n      self.wrapper[action]('slide', this);\n      self.wrapper[action]($.eventName('shown', 'tab'), this);\n    },\n    handleEvent: function handleEvent(e) {\n      this._super(e);\n\n      switch (e.type) {\n        case 'slide':\n          this._handleSlide(e);\n\n          break;\n\n        case $.eventName('shown', 'tab'):\n          if (~this.snaps.indexOf(e.target)) {\n            //避免嵌套监听错误的tab show\n            this._handleTabShow(e);\n          }\n\n          break;\n      }\n    },\n    _scrollend: function _scrollend(e) {\n      this._super(e);\n\n      this._triggerSlide(e);\n    },\n    _drag: function _drag(e) {\n      this._super(e);\n\n      var direction = e.detail.direction;\n\n      if (direction === 'left' || direction === 'right') {\n        //拖拽期间取消定时\n        var slidershowTimer = this.wrapper.getAttribute('data-slidershowTimer');\n        slidershowTimer && window.clearTimeout(slidershowTimer);\n        e.stopPropagation();\n      }\n    },\n    _initTimer: function _initTimer() {\n      var self = this;\n      var slider = self.wrapper;\n      var interval = self.options.interval;\n      var slidershowTimer = slider.getAttribute('data-slidershowTimer');\n      slidershowTimer && window.clearTimeout(slidershowTimer);\n\n      if (interval) {\n        slidershowTimer = window.setTimeout(function () {\n          if (!slider) {\n            return;\n          } //仅slider显示状态进行自动轮播\n\n\n          if (!!(slider.offsetWidth || slider.offsetHeight)) {\n            self.nextItem(true); //下一个\n          }\n\n          self._initTimer();\n        }, interval);\n        slider.setAttribute('data-slidershowTimer', slidershowTimer);\n      }\n    },\n    _fixedSlideNumber: function _fixedSlideNumber(page) {\n      page = page || this.currentPage;\n      var slideNumber = page.pageX;\n\n      if (this.loop) {\n        if (page.pageX === 0) {\n          slideNumber = this.itemLength - 3;\n        } else if (page.pageX === this.itemLength - 1) {\n          slideNumber = 0;\n        } else {\n          slideNumber = page.pageX - 1;\n        }\n      }\n\n      return slideNumber;\n    },\n    _reLayout: function _reLayout() {\n      this.hasHorizontalScroll = true;\n      this.loop = this.scroller.classList.contains(CLASS_SLIDER_LOOP);\n\n      this._super();\n    },\n    _getScroll: function _getScroll() {\n      var result = $.parseTranslateMatrix($.getStyles(this.scroller, 'webkitTransform'));\n      return result ? result.x : 0;\n    },\n    _transitionEnd: function _transitionEnd(e) {\n      if (e.target !== this.scroller || !this.isInTransition) {\n        return;\n      }\n\n      this._transitionTime();\n\n      this.isInTransition = false;\n      $.trigger(this.wrapper, 'scrollend', this);\n    },\n    _flick: function _flick(e) {\n      if (!this.moved) {\n        //无moved\n        return;\n      }\n\n      var detail = e.detail;\n      var direction = detail.direction;\n\n      this._clearRequestAnimationFrame();\n\n      this.isInTransition = true; //\t\t\tif (direction === 'up' || direction === 'down') {\n      //\t\t\t\tthis.resetPosition(this.options.bounceTime);\n      //\t\t\t\treturn;\n      //\t\t\t}\n\n      if (e.type === 'flick') {\n        if (detail.deltaTime < 200) {\n          //flick，太容易触发，额外校验一下deltaTime\n          this.x = this._getPage(this.slideNumber + (direction === 'right' ? -1 : 1), true).x;\n        }\n\n        this.resetPosition(this.options.bounceTime);\n      } else if (e.type === 'dragend' && !detail.flick) {\n        this.resetPosition(this.options.bounceTime);\n      }\n\n      e.stopPropagation();\n    },\n    _initSnap: function _initSnap() {\n      this.scrollerWidth = this.itemLength * this.scrollerWidth;\n      this.maxScrollX = Math.min(this.wrapperWidth - this.scrollerWidth, 0);\n\n      this._super();\n\n      if (!this.currentPage.x) {\n        //当slider处于隐藏状态时，导致snap计算是错误的，临时先这么判断一下，后续要考虑解决所有scroll在隐藏状态下初始化属性不正确的问题\n        var currentPage = this.pages[this.loop ? 1 : 0];\n        currentPage = currentPage || this.pages[0];\n\n        if (!currentPage) {\n          return;\n        }\n\n        this.currentPage = currentPage[0];\n        this.slideNumber = 0;\n        this.lastSlideNumber = typeof this.lastSlideNumber === 'undefined' ? 0 : this.lastSlideNumber;\n      } else {\n        this.slideNumber = this._fixedSlideNumber();\n        this.lastSlideNumber = typeof this.lastSlideNumber === 'undefined' ? this.slideNumber : this.lastSlideNumber;\n      }\n\n      this.options.startX = this.currentPage.x || 0;\n    },\n    _getSnapX: function _getSnapX(offsetLeft) {\n      return Math.max(-offsetLeft, this.maxScrollX);\n    },\n    _getPage: function _getPage(slideNumber, isFlick) {\n      if (this.loop) {\n        if (slideNumber > this.itemLength - (isFlick ? 2 : 3)) {\n          slideNumber = 1;\n          time = 0;\n        } else if (slideNumber < (isFlick ? -1 : 0)) {\n          slideNumber = this.itemLength - 2;\n          time = 0;\n        } else {\n          slideNumber += 1;\n        }\n      } else {\n        if (!isFlick) {\n          if (slideNumber > this.itemLength - 1) {\n            slideNumber = 0;\n            time = 0;\n          } else if (slideNumber < 0) {\n            slideNumber = this.itemLength - 1;\n            time = 0;\n          }\n        }\n\n        slideNumber = Math.min(Math.max(0, slideNumber), this.itemLength - 1);\n      }\n\n      return this.pages[slideNumber][0];\n    },\n    _gotoItem: function _gotoItem(slideNumber, time) {\n      this.currentPage = this._getPage(slideNumber, true); //此处传true。可保证程序切换时，动画与人手操作一致(第一张，最后一张的切换动画)\n\n      this.scrollTo(this.currentPage.x, 0, time, this.options.scrollEasing);\n\n      if (time === 0) {\n        $.trigger(this.wrapper, 'scrollend', this);\n      }\n    },\n    //API\n    setTranslate: function setTranslate(x, y) {\n      this._super(x, y);\n\n      var progressBar = this.progressBar;\n\n      if (progressBar) {\n        this.progressBarStyle.webkitTransform = this._getTranslateStr(-x * (this.progressBarWidth / this.wrapperWidth), 0);\n      }\n    },\n    resetPosition: function resetPosition(time) {\n      time = time || 0;\n\n      if (this.x > 0) {\n        this.x = 0;\n      } else if (this.x < this.maxScrollX) {\n        this.x = this.maxScrollX;\n      }\n\n      this.currentPage = this._nearestSnap(this.x);\n      this.scrollTo(this.currentPage.x, 0, time, this.options.scrollEasing);\n      return true;\n    },\n    gotoItem: function gotoItem(slideNumber, time) {\n      this._gotoItem(slideNumber, typeof time === 'undefined' ? this.options.scrollTime : time);\n    },\n    nextItem: function nextItem() {\n      this._gotoItem(this.slideNumber + 1, this.options.scrollTime);\n    },\n    prevItem: function prevItem() {\n      this._gotoItem(this.slideNumber - 1, this.options.scrollTime);\n    },\n    getSlideNumber: function getSlideNumber() {\n      return this.slideNumber || 0;\n    },\n    _reInit: function _reInit() {\n      var groups = this.wrapper.querySelectorAll('.' + CLASS_SLIDER_GROUP);\n\n      for (var i = 0, len = groups.length; i < len; i++) {\n        if (groups[i].parentNode === this.wrapper) {\n          this.scroller = groups[i];\n          break;\n        }\n      }\n\n      this.scrollerStyle = this.scroller && this.scroller.style;\n\n      if (this.progressBar) {\n        this.progressBarWidth = this.progressBar.offsetWidth;\n        this.progressBarStyle = this.progressBar.style;\n      }\n    },\n    refresh: function refresh(options) {\n      if (options) {\n        $.extend(this.options, options);\n\n        this._super();\n\n        this._initTimer();\n      } else {\n        this._super();\n      }\n    },\n    destroy: function destroy() {\n      this._initEvent(true); //detach\n\n\n      delete $.data[this.wrapper.getAttribute('data-slider')];\n      this.wrapper.setAttribute('data-slider', '');\n    }\n  });\n\n  $.fn.slider = function (options) {\n    var slider = null;\n    this.each(function () {\n      var sliderElement = this;\n\n      if (!this.classList.contains(CLASS_SLIDER)) {\n        sliderElement = this.querySelector('.' + CLASS_SLIDER);\n      }\n\n      if (sliderElement && sliderElement.querySelector(SELECTOR_SLIDER_ITEM)) {\n        var id = sliderElement.getAttribute('data-slider');\n\n        if (!id) {\n          id = ++$.uuid;\n          $.data[id] = slider = new Slider(sliderElement, options);\n          sliderElement.setAttribute('data-slider', id);\n        } else {\n          slider = $.data[id];\n\n          if (slider && options) {\n            slider.refresh(options);\n          }\n        }\n      }\n    });\n    return slider;\n  };\n\n  $.ready(function () {\n    //\t\tsetTimeout(function() {\n    $('.mui-slider').slider();\n    $('.mui-scroll-wrapper.mui-slider-indicator.mui-segmented-control').scroll({\n      scrollY: false,\n      scrollX: true,\n      indicators: false,\n      snap: '.mui-control-item'\n    }); //\t\t}, 500); //临时处理slider宽度计算不正确的问题(初步确认是scrollbar导致的)\n  });\n})(mui, window);\n/**\r\n * pullRefresh 5+\r\n * @param {type} $\r\n * @returns {undefined}\r\n */\n\n\n(function ($, document) {\n  if (!$.os.plus) {\n    //仅在5+android支持多webview的使用\n    return;\n  }\n\n  $.plusReady(function () {\n    if (window.__NWin_Enable__ === false) {\n      //不支持多webview，则不用5+下拉刷新\n      return;\n    }\n\n    var CLASS_PLUS_PULLREFRESH = 'mui-plus-pullrefresh';\n    var CLASS_VISIBILITY = 'mui-visibility';\n    var CLASS_HIDDEN = 'mui-hidden';\n    var CLASS_BLOCK = 'mui-block';\n    var CLASS_PULL_CAPTION = 'mui-pull-caption';\n    var CLASS_PULL_CAPTION_DOWN = 'mui-pull-caption-down';\n    var CLASS_PULL_CAPTION_REFRESH = 'mui-pull-caption-refresh';\n    var CLASS_PULL_CAPTION_NOMORE = 'mui-pull-caption-nomore';\n    var PlusPullRefresh = $.Class.extend({\n      init: function init(element, options) {\n        this.element = element;\n        this.options = options;\n        this.wrapper = this.scroller = element;\n\n        this._init();\n\n        this._initPulldownRefreshEvent();\n      },\n      _init: function _init() {\n        var self = this; //document.addEventListener('plusscrollbottom', this);\n\n        window.addEventListener('dragup', self);\n        document.addEventListener(\"plusscrollbottom\", self);\n        self.scrollInterval = window.setInterval(function () {\n          if (self.isScroll && !self.loading) {\n            if (window.pageYOffset + window.innerHeight + 10 >= document.documentElement.scrollHeight) {\n              self.isScroll = false; //放在这里是因为快速滚动的话，有可能检测时，还没到底，所以只要有滚动，没到底之前一直检测高度变化\n\n              if (self.bottomPocket) {\n                self.pullupLoading();\n              }\n            }\n          }\n        }, 100);\n      },\n      _initPulldownRefreshEvent: function _initPulldownRefreshEvent() {\n        var self = this;\n        $.plusReady(function () {\n          if (self.options.down.style == \"circle\") {\n            //单webview、原生转圈\n            self.options.webview = plus.webview.currentWebview();\n            self.options.webview.setPullToRefresh({\n              support: true,\n              color: self.options.down.color || '#2BD009',\n              height: self.options.down.height || '50px',\n              range: self.options.down.range || '100px',\n              style: 'circle',\n              offset: self.options.down.offset || '0px'\n            }, function () {\n              self.options.down.callback();\n            });\n          } else if (self.topPocket && self.options.webviewId) {\n            var webview = plus.webview.getWebviewById(self.options.webviewId); //子窗口\n\n            if (!webview) {\n              return;\n            }\n\n            self.options.webview = webview;\n            var downOptions = self.options.down;\n            var height = downOptions.height;\n            webview.addEventListener('close', function () {\n              var attrWebviewId = self.options.webviewId && self.options.webviewId.replace(/\\//g, \"_\"); //替换所有\"/\" \n\n              self.element.removeAttribute('data-pullrefresh-plus-' + attrWebviewId);\n            });\n            webview.addEventListener(\"dragBounce\", function (e) {\n              if (!self.pulldown) {\n                self._initPulldownRefresh();\n              } else {\n                self.pullPocket.classList.add(CLASS_BLOCK);\n              }\n\n              switch (e.status) {\n                case \"beforeChangeOffset\":\n                  //下拉可刷新状态\n                  self._setCaption(downOptions.contentdown);\n\n                  break;\n\n                case \"afterChangeOffset\":\n                  //松开可刷新状态\n                  self._setCaption(downOptions.contentover);\n\n                  break;\n\n                case \"dragEndAfterChangeOffset\":\n                  //正在刷新状态\n                  //执行下拉刷新所在webview的回调函数\n                  webview.evalJS(\"window.mui&&mui.options.pullRefresh.down.callback()\");\n\n                  self._setCaption(downOptions.contentrefresh);\n\n                  break;\n\n                default:\n                  break;\n              }\n            }, false);\n            webview.setBounce({\n              position: {\n                top: height * 2 + 'px'\n              },\n              changeoffset: {\n                top: height + 'px'\n              }\n            });\n          }\n        });\n      },\n      handleEvent: function handleEvent(e) {\n        var self = this;\n\n        if (self.stopped) {\n          return;\n        }\n\n        self.isScroll = false;\n\n        if (e.type === 'dragup' || e.type === 'plusscrollbottom') {\n          self.isScroll = true;\n          setTimeout(function () {\n            self.isScroll = false;\n          }, 1000);\n        }\n      }\n    }).extend($.extend({\n      setStopped: function setStopped(stopped) {\n        //该方法是子页面调用的\n        this.stopped = !!stopped; //TODO 此处需要设置当前webview的bounce为none,目前5+有BUG\n\n        var webview = plus.webview.currentWebview();\n\n        if (this.stopped) {\n          webview.setStyle({\n            bounce: 'none'\n          });\n          webview.setBounce({\n            position: {\n              top: 'none'\n            }\n          });\n        } else {\n          var height = this.options.down.height;\n          webview.setStyle({\n            bounce: 'vertical'\n          });\n          webview.setBounce({\n            position: {\n              top: height * 2 + 'px'\n            },\n            changeoffset: {\n              top: height + 'px'\n            }\n          });\n        }\n      },\n      beginPulldown: function beginPulldown() {\n        var self = this;\n        $.plusReady(function () {\n          //这里延时的目的是为了保证下拉刷新组件初始化完成，后续应该做成有状态的\n          setTimeout(function () {\n            if (self.options.down.style == \"circle\") {\n              //单webview下拉刷新\n              plus.webview.currentWebview().beginPullToRefresh();\n            } else {\n              //双webview模式\n              var webview = self.options.webview;\n\n              if (webview) {\n                webview.setBounce({\n                  offset: {\n                    top: self.options.down.height + \"px\"\n                  }\n                });\n              }\n            }\n          }, 15);\n        }.bind(this));\n      },\n      pulldownLoading: function pulldownLoading() {\n        //该方法是子页面调用的，兼容老的历史API\n        this.beginPulldown();\n      },\n      _pulldownLoading: function _pulldownLoading() {\n        //该方法是父页面调用的\n        var self = this;\n        $.plusReady(function () {\n          var childWebview = plus.webview.getWebviewById(self.options.webviewId);\n          childWebview && childWebview.setBounce({\n            offset: {\n              top: self.options.down.height + \"px\"\n            }\n          });\n        });\n      },\n      endPulldown: function endPulldown() {\n        var _wv = plus.webview.currentWebview(); //双webview的下拉刷新，需要修改父窗口提示信息\n\n\n        if (_wv.parent() && this.options.down.style !== \"circle\") {\n          _wv.parent().evalJS(\"mui&&mui(document.querySelector('.mui-content')).pullRefresh('\" + JSON.stringify({\n            webviewId: _wv.id\n          }) + \"')._endPulldownToRefresh()\");\n        } else {\n          _wv.endPullToRefresh();\n        }\n      },\n      endPulldownToRefresh: function endPulldownToRefresh() {\n        //该方法是子页面调用的，兼容老的历史API\n        this.endPulldown();\n      },\n      _endPulldownToRefresh: function _endPulldownToRefresh() {\n        //该方法是父页面调用的\n        var self = this;\n\n        if (self.topPocket && self.options.webview) {\n          self.options.webview.endPullToRefresh(); //下拉刷新所在webview回弹\n\n          self.loading = false;\n\n          self._setCaption(self.options.down.contentdown, true);\n\n          setTimeout(function () {\n            self.loading || self.topPocket.classList.remove(CLASS_BLOCK);\n          }, 350);\n        }\n      },\n      beginPullup: function beginPullup(callback) {\n        //开始上拉加载\n        var self = this;\n        if (self.isLoading) return;\n        self.isLoading = true;\n\n        if (self.pulldown !== false) {\n          self._initPullupRefresh();\n        } else {\n          this.pullPocket.classList.add(CLASS_BLOCK);\n        }\n\n        setTimeout(function () {\n          self.pullLoading.classList.add(CLASS_VISIBILITY);\n          self.pullLoading.classList.remove(CLASS_HIDDEN);\n          self.pullCaption.innerHTML = ''; //修正5+里边第一次加载时，文字显示的bug(还会显示出来个“多”,猜测应该是渲染问题导致的)\n\n          self.pullCaption.className = CLASS_PULL_CAPTION + ' ' + CLASS_PULL_CAPTION_REFRESH;\n          self.pullCaption.innerHTML = self.options.up.contentrefresh;\n          callback = callback || self.options.up.callback;\n          callback && callback.call(self);\n        }, 300);\n      },\n      pullupLoading: function pullupLoading(callback) {\n        //兼容老的API\n        this.beginPullup(callback);\n      },\n      endPullup: function endPullup(finished) {\n        //上拉加载结束\n        var self = this;\n\n        if (self.pullLoading) {\n          self.pullLoading.classList.remove(CLASS_VISIBILITY);\n          self.pullLoading.classList.add(CLASS_HIDDEN);\n          self.isLoading = false;\n\n          if (finished) {\n            self.finished = true;\n            self.pullCaption.className = CLASS_PULL_CAPTION + ' ' + CLASS_PULL_CAPTION_NOMORE;\n            self.pullCaption.innerHTML = self.options.up.contentnomore; //取消5+的plusscrollbottom事件\n\n            document.removeEventListener('plusscrollbottom', self);\n            window.removeEventListener('dragup', self);\n          } else {\n            //初始化时隐藏，后续不再隐藏\n            self.pullCaption.className = CLASS_PULL_CAPTION + ' ' + CLASS_PULL_CAPTION_DOWN;\n            self.pullCaption.innerHTML = self.options.up.contentdown;\n          }\n        }\n      },\n      endPullupToRefresh: function endPullupToRefresh(finished) {\n        //上拉加载结束，兼容老的API\n        this.endPullup(finished);\n      },\n      disablePullupToRefresh: function disablePullupToRefresh() {\n        this._initPullupRefresh();\n\n        this.bottomPocket.className = 'mui-pull-bottom-pocket' + ' ' + CLASS_HIDDEN;\n        window.removeEventListener('dragup', this);\n      },\n      enablePullupToRefresh: function enablePullupToRefresh() {\n        this._initPullupRefresh();\n\n        this.bottomPocket.classList.remove(CLASS_HIDDEN);\n        this.pullCaption.className = CLASS_PULL_CAPTION + ' ' + CLASS_PULL_CAPTION_DOWN;\n        this.pullCaption.innerHTML = this.options.up.contentdown;\n        document.addEventListener(\"plusscrollbottom\", this);\n        window.addEventListener('dragup', this);\n      },\n      scrollTo: function scrollTo(x, y, time) {\n        $.scrollTo(y, time);\n      },\n      scrollToBottom: function scrollToBottom(time) {\n        $.scrollTo(document.documentElement.scrollHeight, time);\n      },\n      refresh: function refresh(isReset) {\n        if (isReset && this.finished) {\n          this.enablePullupToRefresh();\n          this.finished = false;\n        }\n      }\n    }, $.PullRefresh)); //override h5 pullRefresh\n\n    $.fn.pullRefresh_native = function (options) {\n      var self;\n\n      if (this.length === 0) {\n        self = document.createElement('div');\n        self.className = 'mui-content';\n        document.body.appendChild(self);\n      } else {\n        self = this[0];\n      }\n\n      var args = options; //一个父需要支持多个子下拉刷新\n\n      options = options || {};\n\n      if (typeof options === 'string') {\n        options = $.parseJSON(options);\n      }\n\n      ;\n      !options.webviewId && (options.webviewId = plus.webview.currentWebview().id || plus.webview.currentWebview().getURL());\n      var pullRefreshApi = null;\n      var attrWebviewId = options.webviewId && options.webviewId.replace(/\\//g, \"_\"); //替换所有\"/\"\n\n      var id = self.getAttribute('data-pullrefresh-plus-' + attrWebviewId);\n\n      if (!id && typeof args === 'undefined') {\n        return false;\n      }\n\n      if (!id) {\n        //避免重复初始化5+ pullrefresh\n        id = ++$.uuid;\n        self.setAttribute('data-pullrefresh-plus-' + attrWebviewId, id);\n        document.body.classList.add(CLASS_PLUS_PULLREFRESH);\n        $.data[id] = pullRefreshApi = new PlusPullRefresh(self, options);\n      } else {\n        pullRefreshApi = $.data[id];\n      }\n\n      if (options.down && options.down.auto) {\n        //如果设置了auto，则自动下拉一次\n        //pullRefreshApi._pulldownLoading(); //parent webview\n        pullRefreshApi.beginPulldown();\n      } else if (options.up && options.up.auto) {\n        //如果设置了auto，则自动上拉一次\n        pullRefreshApi.beginPullup();\n      }\n\n      return pullRefreshApi;\n    };\n  });\n})(mui, document);\n/**\r\n * off-canvas\r\n * @param {type} $\r\n * @param {type} window\r\n * @param {type} document\r\n * @param {type} action\r\n * @returns {undefined}\r\n */\n\n\n(function ($, window, document, name) {\n  var CLASS_OFF_CANVAS_LEFT = 'mui-off-canvas-left';\n  var CLASS_OFF_CANVAS_RIGHT = 'mui-off-canvas-right';\n  var CLASS_ACTION_BACKDROP = 'mui-off-canvas-backdrop';\n  var CLASS_OFF_CANVAS_WRAP = 'mui-off-canvas-wrap';\n  var CLASS_SLIDE_IN = 'mui-slide-in';\n  var CLASS_ACTIVE = 'mui-active';\n  var CLASS_TRANSITIONING = 'mui-transitioning';\n  var SELECTOR_INNER_WRAP = '.mui-inner-wrap';\n  var OffCanvas = $.Class.extend({\n    init: function init(element, options) {\n      this.wrapper = this.element = element;\n      this.scroller = this.wrapper.querySelector(SELECTOR_INNER_WRAP);\n      this.classList = this.wrapper.classList;\n\n      if (this.scroller) {\n        this.options = $.extend(true, {\n          dragThresholdX: 10,\n          scale: 0.8,\n          opacity: 0.1,\n          preventDefaultException: {\n            tagName: /^(INPUT|TEXTAREA|BUTTON|SELECT|VIDEO)$/\n          }\n        }, options);\n        document.body.classList.add('mui-fullscreen'); //fullscreen\n\n        this.refresh();\n        this.initEvent();\n      }\n    },\n    _preventDefaultException: function _preventDefaultException(el, exceptions) {\n      for (var i in exceptions) {\n        if (exceptions[i].test(el[i])) {\n          return true;\n        }\n      }\n\n      return false;\n    },\n    refresh: function refresh(offCanvas) {\n      //\t\t\toffCanvas && !offCanvas.classList.contains(CLASS_ACTIVE) && this.classList.remove(CLASS_ACTIVE);\n      this.slideIn = this.classList.contains(CLASS_SLIDE_IN);\n      this.scalable = this.classList.contains('mui-scalable') && !this.slideIn;\n      this.scroller = this.wrapper.querySelector(SELECTOR_INNER_WRAP); //\t\t\t!offCanvas && this.scroller.classList.remove(CLASS_TRANSITIONING);\n      //\t\t\t!offCanvas && this.scroller.setAttribute('style', '');\n\n      this.offCanvasLefts = this.wrapper.querySelectorAll('.' + CLASS_OFF_CANVAS_LEFT);\n      this.offCanvasRights = this.wrapper.querySelectorAll('.' + CLASS_OFF_CANVAS_RIGHT);\n\n      if (offCanvas) {\n        if (offCanvas.classList.contains(CLASS_OFF_CANVAS_LEFT)) {\n          this.offCanvasLeft = offCanvas;\n        } else if (offCanvas.classList.contains(CLASS_OFF_CANVAS_RIGHT)) {\n          this.offCanvasRight = offCanvas;\n        }\n      } else {\n        this.offCanvasRight = this.wrapper.querySelector('.' + CLASS_OFF_CANVAS_RIGHT);\n        this.offCanvasLeft = this.wrapper.querySelector('.' + CLASS_OFF_CANVAS_LEFT);\n      }\n\n      this.offCanvasRightWidth = this.offCanvasLeftWidth = 0;\n      this.offCanvasLeftSlideIn = this.offCanvasRightSlideIn = false;\n\n      if (this.offCanvasRight) {\n        this.offCanvasRightWidth = this.offCanvasRight.offsetWidth;\n        this.offCanvasRightSlideIn = this.slideIn && this.offCanvasRight.parentNode === this.wrapper; //\t\t\t\tthis.offCanvasRight.classList.remove(CLASS_TRANSITIONING);\n        //\t\t\t\tthis.offCanvasRight.classList.remove(CLASS_ACTIVE);\n        //\t\t\t\tthis.offCanvasRight.setAttribute('style', '');\n      }\n\n      if (this.offCanvasLeft) {\n        this.offCanvasLeftWidth = this.offCanvasLeft.offsetWidth;\n        this.offCanvasLeftSlideIn = this.slideIn && this.offCanvasLeft.parentNode === this.wrapper; //\t\t\t\tthis.offCanvasLeft.classList.remove(CLASS_TRANSITIONING);\n        //\t\t\t\tthis.offCanvasLeft.classList.remove(CLASS_ACTIVE);\n        //\t\t\t\tthis.offCanvasLeft.setAttribute('style', '');\n      }\n\n      this.backdrop = this.scroller.querySelector('.' + CLASS_ACTION_BACKDROP);\n      this.options.dragThresholdX = this.options.dragThresholdX || 10;\n      this.visible = false;\n      this.startX = null;\n      this.lastX = null;\n      this.offsetX = null;\n      this.lastTranslateX = null;\n    },\n    handleEvent: function handleEvent(e) {\n      switch (e.type) {\n        case $.EVENT_START:\n          e.target && !this._preventDefaultException(e.target, this.options.preventDefaultException) && e.preventDefault();\n          break;\n\n        case 'webkitTransitionEnd':\n          //有个bug需要处理，需要考虑假设没有触发webkitTransitionEnd的情况\n          if (e.target === this.scroller) {\n            this._dispatchEvent();\n          }\n\n          break;\n\n        case 'drag':\n          var detail = e.detail;\n\n          if (!this.startX) {\n            this.startX = detail.center.x;\n            this.lastX = this.startX;\n          } else {\n            this.lastX = detail.center.x;\n          }\n\n          if (!this.isDragging && Math.abs(this.lastX - this.startX) > this.options.dragThresholdX && (detail.direction === 'left' || detail.direction === 'right')) {\n            if (this.slideIn) {\n              this.scroller = this.wrapper.querySelector(SELECTOR_INNER_WRAP);\n\n              if (this.classList.contains(CLASS_ACTIVE)) {\n                if (this.offCanvasRight && this.offCanvasRight.classList.contains(CLASS_ACTIVE)) {\n                  this.offCanvas = this.offCanvasRight;\n                  this.offCanvasWidth = this.offCanvasRightWidth;\n                } else {\n                  this.offCanvas = this.offCanvasLeft;\n                  this.offCanvasWidth = this.offCanvasLeftWidth;\n                }\n              } else {\n                if (detail.direction === 'left' && this.offCanvasRight) {\n                  this.offCanvas = this.offCanvasRight;\n                  this.offCanvasWidth = this.offCanvasRightWidth;\n                } else if (detail.direction === 'right' && this.offCanvasLeft) {\n                  this.offCanvas = this.offCanvasLeft;\n                  this.offCanvasWidth = this.offCanvasLeftWidth;\n                } else {\n                  this.scroller = null;\n                }\n              }\n            } else {\n              if (this.classList.contains(CLASS_ACTIVE)) {\n                if (detail.direction === 'left') {\n                  this.offCanvas = this.offCanvasLeft;\n                  this.offCanvasWidth = this.offCanvasLeftWidth;\n                } else {\n                  this.offCanvas = this.offCanvasRight;\n                  this.offCanvasWidth = this.offCanvasRightWidth;\n                }\n              } else {\n                if (detail.direction === 'right') {\n                  this.offCanvas = this.offCanvasLeft;\n                  this.offCanvasWidth = this.offCanvasLeftWidth;\n                } else {\n                  this.offCanvas = this.offCanvasRight;\n                  this.offCanvasWidth = this.offCanvasRightWidth;\n                }\n              }\n            }\n\n            if (this.offCanvas && this.scroller) {\n              this.startX = this.lastX;\n              this.isDragging = true;\n              $.gestures.session.lockDirection = true; //锁定方向\n\n              $.gestures.session.startDirection = detail.direction;\n              this.offCanvas.classList.remove(CLASS_TRANSITIONING);\n              this.scroller.classList.remove(CLASS_TRANSITIONING);\n              this.offsetX = this.getTranslateX();\n\n              this._initOffCanvasVisible();\n            }\n          }\n\n          if (this.isDragging) {\n            this.updateTranslate(this.offsetX + (this.lastX - this.startX));\n            detail.gesture.preventDefault();\n            e.stopPropagation();\n          }\n\n          break;\n\n        case 'dragend':\n          if (this.isDragging) {\n            var detail = e.detail;\n            var direction = detail.direction;\n            this.isDragging = false;\n            this.offCanvas.classList.add(CLASS_TRANSITIONING);\n            this.scroller.classList.add(CLASS_TRANSITIONING);\n            var ratio = 0;\n            var x = this.getTranslateX();\n\n            if (!this.slideIn) {\n              if (x >= 0) {\n                ratio = this.offCanvasLeftWidth && x / this.offCanvasLeftWidth || 0;\n              } else {\n                ratio = this.offCanvasRightWidth && x / this.offCanvasRightWidth || 0;\n              }\n\n              if (ratio === 0) {\n                this.openPercentage(0);\n\n                this._dispatchEvent(); //此处不触发webkitTransitionEnd,所以手动dispatch\n\n\n                return;\n              }\n\n              if (direction === 'right' && ratio >= 0 && (ratio >= 0.5 || detail.swipe)) {\n                //右滑打开\n                this.openPercentage(100);\n              } else if (direction === 'right' && ratio < 0 && (ratio > -0.5 || detail.swipe)) {\n                //右滑关闭\n                this.openPercentage(0);\n              } else if (direction === 'right' && ratio > 0 && ratio < 0.5) {\n                //右滑还原关闭\n                this.openPercentage(0);\n              } else if (direction === 'right' && ratio < 0.5) {\n                //右滑还原打开\n                this.openPercentage(-100);\n              } else if (direction === 'left' && ratio <= 0 && (ratio <= -0.5 || detail.swipe)) {\n                //左滑打开\n                this.openPercentage(-100);\n              } else if (direction === 'left' && ratio > 0 && (ratio <= 0.5 || detail.swipe)) {\n                //左滑关闭\n                this.openPercentage(0);\n              } else if (direction === 'left' && ratio < 0 && ratio >= -0.5) {\n                //左滑还原关闭\n                this.openPercentage(0);\n              } else if (direction === 'left' && ratio > 0.5) {\n                //左滑还原打开\n                this.openPercentage(100);\n              } else {\n                //默认关闭\n                this.openPercentage(0);\n              }\n\n              if (ratio === 1 || ratio === -1) {\n                //此处不触发webkitTransitionEnd,所以手动dispatch\n                this._dispatchEvent();\n              }\n            } else {\n              if (x >= 0) {\n                ratio = this.offCanvasRightWidth && x / this.offCanvasRightWidth || 0;\n              } else {\n                ratio = this.offCanvasLeftWidth && x / this.offCanvasLeftWidth || 0;\n              }\n\n              if (direction === 'right' && ratio <= 0 && (ratio >= -0.5 || detail.swipe)) {\n                //右滑打开\n                this.openPercentage(100);\n              } else if (direction === 'right' && ratio > 0 && (ratio >= 0.5 || detail.swipe)) {\n                //右滑关闭\n                this.openPercentage(0);\n              } else if (direction === 'right' && ratio <= -0.5) {\n                //右滑还原关闭\n                this.openPercentage(0);\n              } else if (direction === 'right' && ratio > 0 && ratio <= 0.5) {\n                //右滑还原打开\n                this.openPercentage(-100);\n              } else if (direction === 'left' && ratio >= 0 && (ratio <= 0.5 || detail.swipe)) {\n                //左滑打开\n                this.openPercentage(-100);\n              } else if (direction === 'left' && ratio < 0 && (ratio <= -0.5 || detail.swipe)) {\n                //左滑关闭\n                this.openPercentage(0);\n              } else if (direction === 'left' && ratio >= 0.5) {\n                //左滑还原关闭\n                this.openPercentage(0);\n              } else if (direction === 'left' && ratio >= -0.5 && ratio < 0) {\n                //左滑还原打开\n                this.openPercentage(100);\n              } else {\n                this.openPercentage(0);\n              }\n\n              if (ratio === 1 || ratio === -1 || ratio === 0) {\n                this._dispatchEvent();\n\n                return;\n              }\n            }\n          }\n\n          break;\n      }\n    },\n    _dispatchEvent: function _dispatchEvent() {\n      if (this.classList.contains(CLASS_ACTIVE)) {\n        $.trigger(this.wrapper, 'shown', this);\n      } else {\n        $.trigger(this.wrapper, 'hidden', this);\n      }\n    },\n    _initOffCanvasVisible: function _initOffCanvasVisible() {\n      if (!this.visible) {\n        this.visible = true;\n\n        if (this.offCanvasLeft) {\n          this.offCanvasLeft.style.visibility = 'visible';\n        }\n\n        if (this.offCanvasRight) {\n          this.offCanvasRight.style.visibility = 'visible';\n        }\n      }\n    },\n    initEvent: function initEvent() {\n      var self = this;\n\n      if (self.backdrop) {\n        self.backdrop.addEventListener('tap', function (e) {\n          self.close();\n          e.detail.gesture.preventDefault();\n        });\n      }\n\n      if (this.classList.contains('mui-draggable')) {\n        this.wrapper.addEventListener($.EVENT_START, this); //临时处理\n\n        this.wrapper.addEventListener('drag', this);\n        this.wrapper.addEventListener('dragend', this);\n      }\n\n      this.wrapper.addEventListener('webkitTransitionEnd', this);\n    },\n    openPercentage: function openPercentage(percentage) {\n      var p = percentage / 100;\n\n      if (!this.slideIn) {\n        if (this.offCanvasLeft && percentage >= 0) {\n          this.updateTranslate(this.offCanvasLeftWidth * p);\n          this.offCanvasLeft.classList[p !== 0 ? 'add' : 'remove'](CLASS_ACTIVE);\n        } else if (this.offCanvasRight && percentage <= 0) {\n          this.updateTranslate(this.offCanvasRightWidth * p);\n          this.offCanvasRight.classList[p !== 0 ? 'add' : 'remove'](CLASS_ACTIVE);\n        }\n\n        this.classList[p !== 0 ? 'add' : 'remove'](CLASS_ACTIVE);\n      } else {\n        if (this.offCanvasLeft && percentage >= 0) {\n          p = p === 0 ? -1 : 0;\n          this.updateTranslate(this.offCanvasLeftWidth * p);\n          this.offCanvasLeft.classList[percentage !== 0 ? 'add' : 'remove'](CLASS_ACTIVE);\n        } else if (this.offCanvasRight && percentage <= 0) {\n          p = p === 0 ? 1 : 0;\n          this.updateTranslate(this.offCanvasRightWidth * p);\n          this.offCanvasRight.classList[percentage !== 0 ? 'add' : 'remove'](CLASS_ACTIVE);\n        }\n\n        this.classList[percentage !== 0 ? 'add' : 'remove'](CLASS_ACTIVE);\n      }\n    },\n    updateTranslate: function updateTranslate(x) {\n      if (x !== this.lastTranslateX) {\n        if (!this.slideIn) {\n          if (!this.offCanvasLeft && x > 0 || !this.offCanvasRight && x < 0) {\n            this.setTranslateX(0);\n            return;\n          }\n\n          if (this.leftShowing && x > this.offCanvasLeftWidth) {\n            this.setTranslateX(this.offCanvasLeftWidth);\n            return;\n          }\n\n          if (this.rightShowing && x < -this.offCanvasRightWidth) {\n            this.setTranslateX(-this.offCanvasRightWidth);\n            return;\n          }\n\n          this.setTranslateX(x);\n\n          if (x >= 0) {\n            this.leftShowing = true;\n            this.rightShowing = false;\n\n            if (x > 0) {\n              if (this.offCanvasLeft) {\n                $.each(this.offCanvasLefts, function (index, offCanvas) {\n                  if (offCanvas === this.offCanvasLeft) {\n                    this.offCanvasLeft.style.zIndex = 0;\n                  } else {\n                    offCanvas.style.zIndex = -1;\n                  }\n                }.bind(this));\n              }\n\n              if (this.offCanvasRight) {\n                this.offCanvasRight.style.zIndex = -1;\n              }\n            }\n          } else {\n            this.rightShowing = true;\n            this.leftShowing = false;\n\n            if (this.offCanvasRight) {\n              $.each(this.offCanvasRights, function (index, offCanvas) {\n                if (offCanvas === this.offCanvasRight) {\n                  offCanvas.style.zIndex = 0;\n                } else {\n                  offCanvas.style.zIndex = -1;\n                }\n              }.bind(this));\n            }\n\n            if (this.offCanvasLeft) {\n              this.offCanvasLeft.style.zIndex = -1;\n            }\n          }\n        } else {\n          if (this.offCanvas.classList.contains(CLASS_OFF_CANVAS_RIGHT)) {\n            if (x < 0) {\n              this.setTranslateX(0);\n              return;\n            }\n\n            if (x > this.offCanvasRightWidth) {\n              this.setTranslateX(this.offCanvasRightWidth);\n              return;\n            }\n          } else {\n            if (x > 0) {\n              this.setTranslateX(0);\n              return;\n            }\n\n            if (x < -this.offCanvasLeftWidth) {\n              this.setTranslateX(-this.offCanvasLeftWidth);\n              return;\n            }\n          }\n\n          this.setTranslateX(x);\n        }\n\n        this.lastTranslateX = x;\n      }\n    },\n    setTranslateX: $.animationFrame(function (x) {\n      if (this.scroller) {\n        if (this.scalable && this.offCanvas.parentNode === this.wrapper) {\n          var percent = Math.abs(x) / this.offCanvasWidth;\n          var zoomOutScale = 1 - (1 - this.options.scale) * percent;\n          var zoomInScale = this.options.scale + (1 - this.options.scale) * percent;\n          var zoomOutOpacity = 1 - (1 - this.options.opacity) * percent;\n          var zoomInOpacity = this.options.opacity + (1 - this.options.opacity) * percent;\n\n          if (this.offCanvas.classList.contains(CLASS_OFF_CANVAS_LEFT)) {\n            this.offCanvas.style.webkitTransformOrigin = '-100%';\n            this.scroller.style.webkitTransformOrigin = 'left';\n          } else {\n            this.offCanvas.style.webkitTransformOrigin = '200%';\n            this.scroller.style.webkitTransformOrigin = 'right';\n          }\n\n          this.offCanvas.style.opacity = zoomInOpacity;\n          this.offCanvas.style.webkitTransform = 'translate3d(0,0,0) scale(' + zoomInScale + ')';\n          this.scroller.style.webkitTransform = 'translate3d(' + x + 'px,0,0) scale(' + zoomOutScale + ')';\n        } else {\n          if (this.slideIn) {\n            this.offCanvas.style.webkitTransform = 'translate3d(' + x + 'px,0,0)';\n          } else {\n            this.scroller.style.webkitTransform = 'translate3d(' + x + 'px,0,0)';\n          }\n        }\n      }\n    }),\n    getTranslateX: function getTranslateX() {\n      if (this.offCanvas) {\n        var scroller = this.slideIn ? this.offCanvas : this.scroller;\n        var result = $.parseTranslateMatrix($.getStyles(scroller, 'webkitTransform'));\n        return result && result.x || 0;\n      }\n\n      return 0;\n    },\n    isShown: function isShown(direction) {\n      var shown = false;\n\n      if (!this.slideIn) {\n        var x = this.getTranslateX();\n\n        if (direction === 'right') {\n          shown = this.classList.contains(CLASS_ACTIVE) && x < 0;\n        } else if (direction === 'left') {\n          shown = this.classList.contains(CLASS_ACTIVE) && x > 0;\n        } else {\n          shown = this.classList.contains(CLASS_ACTIVE) && x !== 0;\n        }\n      } else {\n        if (direction === 'left') {\n          shown = this.classList.contains(CLASS_ACTIVE) && this.wrapper.querySelector('.' + CLASS_OFF_CANVAS_LEFT + '.' + CLASS_ACTIVE);\n        } else if (direction === 'right') {\n          shown = this.classList.contains(CLASS_ACTIVE) && this.wrapper.querySelector('.' + CLASS_OFF_CANVAS_RIGHT + '.' + CLASS_ACTIVE);\n        } else {\n          shown = this.classList.contains(CLASS_ACTIVE) && (this.wrapper.querySelector('.' + CLASS_OFF_CANVAS_LEFT + '.' + CLASS_ACTIVE) || this.wrapper.querySelector('.' + CLASS_OFF_CANVAS_RIGHT + '.' + CLASS_ACTIVE));\n        }\n      }\n\n      return shown;\n    },\n    close: function close() {\n      this._initOffCanvasVisible();\n\n      this.offCanvas = this.wrapper.querySelector('.' + CLASS_OFF_CANVAS_RIGHT + '.' + CLASS_ACTIVE) || this.wrapper.querySelector('.' + CLASS_OFF_CANVAS_LEFT + '.' + CLASS_ACTIVE);\n      this.offCanvasWidth = this.offCanvas.offsetWidth;\n\n      if (this.scroller) {\n        this.offCanvas.offsetHeight;\n        this.offCanvas.classList.add(CLASS_TRANSITIONING);\n        this.scroller.classList.add(CLASS_TRANSITIONING);\n        this.openPercentage(0);\n      }\n    },\n    show: function show(direction) {\n      this._initOffCanvasVisible();\n\n      if (this.isShown(direction)) {\n        return false;\n      }\n\n      if (!direction) {\n        direction = this.wrapper.querySelector('.' + CLASS_OFF_CANVAS_RIGHT) ? 'right' : 'left';\n      }\n\n      if (direction === 'right') {\n        this.offCanvas = this.offCanvasRight;\n        this.offCanvasWidth = this.offCanvasRightWidth;\n      } else {\n        this.offCanvas = this.offCanvasLeft;\n        this.offCanvasWidth = this.offCanvasLeftWidth;\n      }\n\n      if (this.scroller) {\n        this.offCanvas.offsetHeight;\n        this.offCanvas.classList.add(CLASS_TRANSITIONING);\n        this.scroller.classList.add(CLASS_TRANSITIONING);\n        this.openPercentage(direction === 'left' ? 100 : -100);\n      }\n\n      return true;\n    },\n    toggle: function toggle(directionOrOffCanvas) {\n      var direction = directionOrOffCanvas;\n\n      if (directionOrOffCanvas && directionOrOffCanvas.classList) {\n        direction = directionOrOffCanvas.classList.contains(CLASS_OFF_CANVAS_LEFT) ? 'left' : 'right';\n        this.refresh(directionOrOffCanvas);\n      }\n\n      if (!this.show(direction)) {\n        this.close();\n      }\n    }\n  }); //hash to offcanvas\n\n  var findOffCanvasContainer = function findOffCanvasContainer(target) {\n    parentNode = target.parentNode;\n\n    if (parentNode) {\n      if (parentNode.classList.contains(CLASS_OFF_CANVAS_WRAP)) {\n        return parentNode;\n      } else {\n        parentNode = parentNode.parentNode;\n\n        if (parentNode.classList.contains(CLASS_OFF_CANVAS_WRAP)) {\n          return parentNode;\n        }\n      }\n    }\n  };\n\n  var handle = function handle(event, target) {\n    if (target.tagName === 'A' && target.hash) {\n      var offcanvas = document.getElementById(target.hash.replace('#', ''));\n\n      if (offcanvas) {\n        var container = findOffCanvasContainer(offcanvas);\n\n        if (container) {\n          $.targets._container = container;\n          return offcanvas;\n        }\n      }\n    }\n\n    return false;\n  };\n\n  $.registerTarget({\n    name: name,\n    index: 60,\n    handle: handle,\n    target: false,\n    isReset: false,\n    isContinue: true\n  });\n  window.addEventListener('tap', function (e) {\n    if (!$.targets.offcanvas) {\n      return;\n    } //TODO 此处类型的代码后续考虑统一优化(target机制)，现在的实现费力不讨好\n\n\n    var target = e.target;\n\n    for (; target && target !== document; target = target.parentNode) {\n      if (target.tagName === 'A' && target.hash && target.hash === '#' + $.targets.offcanvas.id) {\n        e.detail && e.detail.gesture && e.detail.gesture.preventDefault(); //fixed hashchange\n\n        $($.targets._container).offCanvas().toggle($.targets.offcanvas);\n        $.targets.offcanvas = $.targets._container = null;\n        break;\n      }\n    }\n  });\n\n  $.fn.offCanvas = function (options) {\n    var offCanvasApis = [];\n    this.each(function () {\n      var offCanvasApi = null;\n      var self = this; //hack old version\n\n      if (!self.classList.contains(CLASS_OFF_CANVAS_WRAP)) {\n        self = findOffCanvasContainer(self);\n      }\n\n      var id = self.getAttribute('data-offCanvas');\n\n      if (!id) {\n        id = ++$.uuid;\n        $.data[id] = offCanvasApi = new OffCanvas(self, options);\n        self.setAttribute('data-offCanvas', id);\n      } else {\n        offCanvasApi = $.data[id];\n      }\n\n      if (options === 'show' || options === 'close' || options === 'toggle') {\n        offCanvasApi.toggle();\n      }\n\n      offCanvasApis.push(offCanvasApi);\n    });\n    return offCanvasApis.length === 1 ? offCanvasApis[0] : offCanvasApis;\n  };\n\n  $.ready(function () {\n    $('.mui-off-canvas-wrap').offCanvas();\n  });\n})(mui, window, document, 'offcanvas');\n/**\r\n * actions\r\n * @param {type} $\r\n * @param {type} name\r\n * @returns {undefined}\r\n */\n\n\n(function ($, name) {\n  var CLASS_ACTION = 'mui-action';\n\n  var handle = function handle(event, target) {\n    var className = target.className || '';\n\n    if (typeof className !== 'string') {\n      //svg className(SVGAnimatedString)\n      className = '';\n    }\n\n    if (className && ~className.indexOf(CLASS_ACTION)) {\n      if (target.classList.contains('mui-action-back')) {\n        event.preventDefault();\n      }\n\n      return target;\n    }\n\n    return false;\n  };\n\n  $.registerTarget({\n    name: name,\n    index: 50,\n    handle: handle,\n    target: false,\n    isContinue: true\n  });\n})(mui, 'action');\n/**\r\n * Modals\r\n * @param {type} $\r\n * @param {type} window\r\n * @param {type} document\r\n * @param {type} name\r\n * @returns {undefined}\r\n */\n\n\n(function ($, window, document, name) {\n  var CLASS_MODAL = 'mui-modal';\n\n  var handle = function handle(event, target) {\n    if (target.tagName === 'A' && target.hash) {\n      var modal = document.getElementById(target.hash.replace('#', ''));\n\n      if (modal && modal.classList.contains(CLASS_MODAL)) {\n        return modal;\n      }\n    }\n\n    return false;\n  };\n\n  $.registerTarget({\n    name: name,\n    index: 50,\n    handle: handle,\n    target: false,\n    isReset: false,\n    isContinue: true\n  });\n  window.addEventListener('tap', function (event) {\n    if ($.targets.modal) {\n      event.detail.gesture.preventDefault(); //fixed hashchange\n\n      $.targets.modal.classList.toggle('mui-active');\n    }\n  });\n})(mui, window, document, 'modal');\n/**\r\n * Popovers\r\n * @param {type} $\r\n * @param {type} window\r\n * @param {type} document\r\n * @param {type} name\r\n * @param {type} undefined\r\n * @returns {undefined}\r\n */\n\n\n(function ($, window, document, name) {\n  var CLASS_POPOVER = 'mui-popover';\n  var CLASS_POPOVER_ARROW = 'mui-popover-arrow';\n  var CLASS_ACTION_POPOVER = 'mui-popover-action';\n  var CLASS_BACKDROP = 'mui-backdrop';\n  var CLASS_BAR_POPOVER = 'mui-bar-popover';\n  var CLASS_BAR_BACKDROP = 'mui-bar-backdrop';\n  var CLASS_ACTION_BACKDROP = 'mui-backdrop-action';\n  var CLASS_ACTIVE = 'mui-active';\n  var CLASS_BOTTOM = 'mui-bottom';\n\n  var handle = function handle(event, target) {\n    if (target.tagName === 'A' && target.hash) {\n      $.targets._popover = document.getElementById(target.hash.replace('#', ''));\n\n      if ($.targets._popover && $.targets._popover.classList.contains(CLASS_POPOVER)) {\n        return target;\n      } else {\n        $.targets._popover = null;\n      }\n    }\n\n    return false;\n  };\n\n  $.registerTarget({\n    name: name,\n    index: 60,\n    handle: handle,\n    target: false,\n    isReset: false,\n    isContinue: true\n  });\n\n  var onPopoverShown = function onPopoverShown(e) {\n    this.removeEventListener('webkitTransitionEnd', onPopoverShown);\n    this.addEventListener($.EVENT_MOVE, $.preventDefault);\n    $.trigger(this, 'shown', this);\n  };\n\n  var onPopoverHidden = function onPopoverHidden(e) {\n    setStyle(this, 'none');\n    this.removeEventListener('webkitTransitionEnd', onPopoverHidden);\n    this.removeEventListener($.EVENT_MOVE, $.preventDefault);\n    $.trigger(this, 'hidden', this);\n  };\n\n  var backdrop = function () {\n    var element = document.createElement('div');\n    element.classList.add(CLASS_BACKDROP);\n    element.addEventListener($.EVENT_MOVE, $.preventDefault);\n    element.addEventListener('tap', function (e) {\n      var popover = $.targets._popover;\n\n      if (popover) {\n        popover.addEventListener('webkitTransitionEnd', onPopoverHidden);\n        popover.classList.remove(CLASS_ACTIVE);\n        removeBackdrop(popover);\n      }\n    });\n    return element;\n  }();\n\n  var removeBackdropTimer;\n\n  var removeBackdrop = function removeBackdrop(popover) {\n    backdrop.setAttribute('style', 'opacity:0');\n    $.targets.popover = $.targets._popover = null; //reset\n\n    removeBackdropTimer = $.later(function () {\n      if (!popover.classList.contains(CLASS_ACTIVE) && backdrop.parentNode && backdrop.parentNode === document.body) {\n        document.body.removeChild(backdrop);\n      }\n    }, 350);\n  };\n\n  window.addEventListener('tap', function (e) {\n    if (!$.targets.popover) {\n      return;\n    }\n\n    var toggle = false;\n    var target = e.target;\n\n    for (; target && target !== document; target = target.parentNode) {\n      if (target === $.targets.popover) {\n        toggle = true;\n      }\n    }\n\n    if (toggle) {\n      e.detail.gesture.preventDefault(); //fixed hashchange\n\n      togglePopover($.targets._popover, $.targets.popover);\n    }\n  });\n\n  var togglePopover = function togglePopover(popover, anchor, state) {\n    if (state === 'show' && popover.classList.contains(CLASS_ACTIVE) || state === 'hide' && !popover.classList.contains(CLASS_ACTIVE)) {\n      return;\n    }\n\n    removeBackdropTimer && removeBackdropTimer.cancel(); //取消remove的timer\n    //remove一遍，以免来回快速切换，导致webkitTransitionEnd不触发，无法remove\n\n    popover.removeEventListener('webkitTransitionEnd', onPopoverShown);\n    popover.removeEventListener('webkitTransitionEnd', onPopoverHidden);\n    backdrop.classList.remove(CLASS_BAR_BACKDROP);\n    backdrop.classList.remove(CLASS_ACTION_BACKDROP);\n\n    var _popover = document.querySelector('.mui-popover.mui-active');\n\n    if (_popover) {\n      //\t\t\t_popover.setAttribute('style', '');\n      _popover.addEventListener('webkitTransitionEnd', onPopoverHidden);\n\n      _popover.classList.remove(CLASS_ACTIVE); //\t\t\t_popover.removeEventListener('webkitTransitionEnd', onPopoverHidden);\n      //同一个弹出则直接返回，解决同一个popover的toggle\n\n\n      if (popover === _popover) {\n        removeBackdrop(_popover);\n        return;\n      }\n    }\n\n    var isActionSheet = false;\n\n    if (popover.classList.contains(CLASS_BAR_POPOVER) || popover.classList.contains(CLASS_ACTION_POPOVER)) {\n      //navBar\n      if (popover.classList.contains(CLASS_ACTION_POPOVER)) {\n        //action sheet popover\n        isActionSheet = true;\n        backdrop.classList.add(CLASS_ACTION_BACKDROP);\n      } else {\n        //bar popover\n        backdrop.classList.add(CLASS_BAR_BACKDROP); //\t\t\t\tif (anchor) {\n        //\t\t\t\t\tif (anchor.parentNode) {\n        //\t\t\t\t\t\tvar offsetWidth = anchor.offsetWidth;\n        //\t\t\t\t\t\tvar offsetLeft = anchor.offsetLeft;\n        //\t\t\t\t\t\tvar innerWidth = window.innerWidth;\n        //\t\t\t\t\t\tpopover.style.left = (Math.min(Math.max(offsetLeft, defaultPadding), innerWidth - offsetWidth - defaultPadding)) + \"px\";\n        //\t\t\t\t\t} else {\n        //\t\t\t\t\t\t//TODO anchor is position:{left,top,bottom,right}\n        //\t\t\t\t\t}\n        //\t\t\t\t}\n      }\n    }\n\n    setStyle(popover, 'block'); //actionsheet transform\n\n    popover.offsetHeight;\n    popover.classList.add(CLASS_ACTIVE);\n    backdrop.setAttribute('style', '');\n    document.body.appendChild(backdrop);\n    calPosition(popover, anchor, isActionSheet); //position\n\n    backdrop.classList.add(CLASS_ACTIVE);\n    popover.addEventListener('webkitTransitionEnd', onPopoverShown);\n  };\n\n  var setStyle = function setStyle(popover, display, top, left) {\n    var style = popover.style;\n    if (typeof display !== 'undefined') style.display = display;\n    if (typeof top !== 'undefined') style.top = top + 'px';\n    if (typeof left !== 'undefined') style.left = left + 'px';\n  };\n\n  var calPosition = function calPosition(popover, anchor, isActionSheet) {\n    if (!popover || !anchor) {\n      return;\n    }\n\n    if (isActionSheet) {\n      //actionsheet\n      setStyle(popover, 'block');\n      return;\n    }\n\n    var wWidth = window.innerWidth;\n    var wHeight = window.innerHeight;\n    var pWidth = popover.offsetWidth;\n    var pHeight = popover.offsetHeight;\n    var aWidth = anchor.offsetWidth;\n    var aHeight = anchor.offsetHeight;\n    var offset = $.offset(anchor);\n    var arrow = popover.querySelector('.' + CLASS_POPOVER_ARROW);\n\n    if (!arrow) {\n      arrow = document.createElement('div');\n      arrow.className = CLASS_POPOVER_ARROW;\n      popover.appendChild(arrow);\n    }\n\n    var arrowSize = arrow && arrow.offsetWidth / 2 || 0;\n    var pTop = 0;\n    var pLeft = 0;\n    var diff = 0;\n    var arrowLeft = 0;\n    var defaultPadding = popover.classList.contains(CLASS_ACTION_POPOVER) ? 0 : 5;\n    var position = 'top';\n\n    if (pHeight + arrowSize < offset.top - window.pageYOffset) {\n      //top\n      pTop = offset.top - pHeight - arrowSize;\n    } else if (pHeight + arrowSize < wHeight - (offset.top - window.pageYOffset) - aHeight) {\n      //bottom\n      position = 'bottom';\n      pTop = offset.top + aHeight + arrowSize;\n    } else {\n      //middle\n      position = 'middle';\n      pTop = Math.max((wHeight - pHeight) / 2 + window.pageYOffset, 0);\n      pLeft = Math.max((wWidth - pWidth) / 2 + window.pageXOffset, 0);\n    }\n\n    if (position === 'top' || position === 'bottom') {\n      pLeft = aWidth / 2 + offset.left - pWidth / 2;\n      diff = pLeft;\n      if (pLeft < defaultPadding) pLeft = defaultPadding;\n      if (pLeft + pWidth > wWidth) pLeft = wWidth - pWidth - defaultPadding;\n\n      if (arrow) {\n        if (position === 'top') {\n          arrow.classList.add(CLASS_BOTTOM);\n        } else {\n          arrow.classList.remove(CLASS_BOTTOM);\n        }\n\n        diff = diff - pLeft;\n        arrowLeft = pWidth / 2 - arrowSize / 2 + diff;\n        arrowLeft = Math.max(Math.min(arrowLeft, pWidth - arrowSize * 2 - 6), 6);\n        arrow.setAttribute('style', 'left:' + arrowLeft + 'px');\n      }\n    } else if (position === 'middle') {\n      arrow.setAttribute('style', 'display:none');\n    }\n\n    setStyle(popover, 'block', pTop, pLeft);\n  };\n\n  $.createMask = function (callback) {\n    var element = document.createElement('div');\n    element.classList.add(CLASS_BACKDROP);\n    element.addEventListener($.EVENT_MOVE, $.preventDefault);\n    element.addEventListener('tap', function () {\n      mask.close();\n    });\n    var mask = [element];\n    mask._show = false;\n\n    mask.show = function () {\n      mask._show = true;\n      element.setAttribute('style', 'opacity:1');\n      document.body.appendChild(element);\n      return mask;\n    };\n\n    mask._remove = function () {\n      if (mask._show) {\n        mask._show = false;\n        element.setAttribute('style', 'opacity:0');\n        $.later(function () {\n          var body = document.body;\n          element.parentNode === body && body.removeChild(element);\n        }, 350);\n      }\n\n      return mask;\n    };\n\n    mask.close = function () {\n      if (callback) {\n        if (callback() !== false) {\n          mask._remove();\n        }\n      } else {\n        mask._remove();\n      }\n    };\n\n    return mask;\n  };\n\n  $.fn.popover = function () {\n    var args = arguments;\n    this.each(function () {\n      $.targets._popover = this;\n\n      if (args[0] === 'show' || args[0] === 'hide' || args[0] === 'toggle') {\n        togglePopover(this, args[1], args[0]);\n      }\n    });\n  };\n})(mui, window, document, 'popover');\n/**\r\n * segmented-controllers\r\n * @param {type} $\r\n * @param {type} window\r\n * @param {type} document\r\n * @param {type} undefined\r\n * @returns {undefined}\r\n */\n\n\n(function ($, window, document, name, undefined) {\n  var CLASS_CONTROL_ITEM = 'mui-control-item';\n  var CLASS_SEGMENTED_CONTROL = 'mui-segmented-control';\n  var CLASS_SEGMENTED_CONTROL_VERTICAL = 'mui-segmented-control-vertical';\n  var CLASS_CONTROL_CONTENT = 'mui-control-content';\n  var CLASS_TAB_BAR = 'mui-bar-tab';\n  var CLASS_TAB_ITEM = 'mui-tab-item';\n  var CLASS_SLIDER_ITEM = 'mui-slider-item';\n\n  var handle = function handle(event, target) {\n    if (target.classList && (target.classList.contains(CLASS_CONTROL_ITEM) || target.classList.contains(CLASS_TAB_ITEM))) {\n      if (target.parentNode && target.parentNode.classList && target.parentNode.classList.contains(CLASS_SEGMENTED_CONTROL_VERTICAL)) {//vertical 如果preventDefault会导致无法滚动\n      } else {\n        event.preventDefault(); //stop hash change\t\t\t\t\n      } //\t\t\tif (target.hash) {\n\n\n      return target; //\t\t\t}\n    }\n\n    return false;\n  };\n\n  $.registerTarget({\n    name: name,\n    index: 80,\n    handle: handle,\n    target: false\n  });\n  window.addEventListener('tap', function (e) {\n    var targetTab = $.targets.tab;\n\n    if (!targetTab) {\n      return;\n    }\n\n    var activeTab;\n    var activeBodies;\n    var targetBody;\n    var className = 'mui-active';\n    var classSelector = '.' + className;\n    var segmentedControl = targetTab.parentNode;\n\n    for (; segmentedControl && segmentedControl !== document; segmentedControl = segmentedControl.parentNode) {\n      if (segmentedControl.classList.contains(CLASS_SEGMENTED_CONTROL)) {\n        activeTab = segmentedControl.querySelector(classSelector + '.' + CLASS_CONTROL_ITEM);\n        break;\n      } else if (segmentedControl.classList.contains(CLASS_TAB_BAR)) {\n        activeTab = segmentedControl.querySelector(classSelector + '.' + CLASS_TAB_ITEM);\n      }\n    }\n\n    if (activeTab) {\n      activeTab.classList.remove(className);\n    }\n\n    var isLastActive = targetTab === activeTab;\n\n    if (targetTab) {\n      targetTab.classList.add(className);\n    }\n\n    if (!targetTab.hash) {\n      return;\n    }\n\n    targetBody = document.getElementById(targetTab.hash.replace('#', ''));\n\n    if (!targetBody) {\n      return;\n    }\n\n    if (!targetBody.classList.contains(CLASS_CONTROL_CONTENT)) {\n      //tab bar popover\n      targetTab.classList[isLastActive ? 'remove' : 'add'](className);\n      return;\n    }\n\n    if (isLastActive) {\n      //same\n      return;\n    }\n\n    var parentNode = targetBody.parentNode;\n    activeBodies = parentNode.querySelectorAll('.' + CLASS_CONTROL_CONTENT + classSelector);\n\n    for (var i = 0; i < activeBodies.length; i++) {\n      var activeBody = activeBodies[i];\n      activeBody.parentNode === parentNode && activeBody.classList.remove(className);\n    }\n\n    targetBody.classList.add(className);\n    var contents = [];\n\n    var _contents = parentNode.querySelectorAll('.' + CLASS_CONTROL_CONTENT);\n\n    for (var i = 0; i < _contents.length; i++) {\n      //查找直属子节点\n      _contents[i].parentNode === parentNode && contents.push(_contents[i]);\n    }\n\n    $.trigger(targetBody, $.eventName('shown', name), {\n      tabNumber: Array.prototype.indexOf.call(contents, targetBody)\n    });\n    e.detail && e.detail.gesture.preventDefault(); //fixed hashchange\n  });\n})(mui, window, document, 'tab');\n/**\r\n * Toggles switch\r\n * @param {type} $\r\n * @param {type} window\r\n * @param {type} name\r\n * @returns {undefined}\r\n */\n\n\n(function ($, window, name) {\n  var CLASS_SWITCH = 'mui-switch';\n  var CLASS_SWITCH_HANDLE = 'mui-switch-handle';\n  var CLASS_ACTIVE = 'mui-active';\n  var CLASS_DRAGGING = 'mui-dragging';\n  var CLASS_DISABLED = 'mui-disabled';\n  var SELECTOR_SWITCH_HANDLE = '.' + CLASS_SWITCH_HANDLE;\n\n  var handle = function handle(event, target) {\n    if (target.classList && target.classList.contains(CLASS_SWITCH)) {\n      return target;\n    }\n\n    return false;\n  };\n\n  $.registerTarget({\n    name: name,\n    index: 100,\n    handle: handle,\n    target: false\n  });\n\n  var Toggle = function Toggle(element) {\n    this.element = element;\n    this.classList = this.element.classList;\n    this.handle = this.element.querySelector(SELECTOR_SWITCH_HANDLE);\n    this.init();\n    this.initEvent();\n  };\n\n  Toggle.prototype.init = function () {\n    this.toggleWidth = this.element.offsetWidth;\n    this.handleWidth = this.handle.offsetWidth;\n    this.handleX = this.toggleWidth - this.handleWidth - 3;\n  };\n\n  Toggle.prototype.initEvent = function () {\n    this.element.addEventListener($.EVENT_START, this);\n    this.element.addEventListener('drag', this);\n    this.element.addEventListener('swiperight', this);\n    this.element.addEventListener($.EVENT_END, this);\n    this.element.addEventListener($.EVENT_CANCEL, this);\n  };\n\n  Toggle.prototype.handleEvent = function (e) {\n    if (this.classList.contains(CLASS_DISABLED)) {\n      return;\n    }\n\n    switch (e.type) {\n      case $.EVENT_START:\n        this.start(e);\n        break;\n\n      case 'drag':\n        this.drag(e);\n        break;\n\n      case 'swiperight':\n        this.swiperight();\n        break;\n\n      case $.EVENT_END:\n      case $.EVENT_CANCEL:\n        this.end(e);\n        break;\n    }\n  };\n\n  Toggle.prototype.start = function (e) {\n    this.handle.style.webkitTransitionDuration = this.element.style.webkitTransitionDuration = '.2s';\n    this.classList.add(CLASS_DRAGGING);\n\n    if (this.toggleWidth === 0 || this.handleWidth === 0) {\n      //当switch处于隐藏状态时，width为0，需要重新初始化\n      this.init();\n    }\n  };\n\n  Toggle.prototype.drag = function (e) {\n    var detail = e.detail;\n\n    if (!this.isDragging) {\n      if (detail.direction === 'left' || detail.direction === 'right') {\n        this.isDragging = true;\n        this.lastChanged = undefined;\n        this.initialState = this.classList.contains(CLASS_ACTIVE);\n      }\n    }\n\n    if (this.isDragging) {\n      this.setTranslateX(detail.deltaX);\n      e.stopPropagation();\n      detail.gesture.preventDefault();\n    }\n  };\n\n  Toggle.prototype.swiperight = function (e) {\n    if (this.isDragging) {\n      e.stopPropagation();\n    }\n  };\n\n  Toggle.prototype.end = function (e) {\n    this.classList.remove(CLASS_DRAGGING);\n\n    if (this.isDragging) {\n      this.isDragging = false;\n      e.stopPropagation();\n      $.trigger(this.element, 'toggle', {\n        isActive: this.classList.contains(CLASS_ACTIVE)\n      });\n    } else {\n      this.toggle();\n    }\n  };\n\n  Toggle.prototype.toggle = function (animate) {\n    var classList = this.classList;\n\n    if (animate === false) {\n      this.handle.style.webkitTransitionDuration = this.element.style.webkitTransitionDuration = '0s';\n    } else {\n      this.handle.style.webkitTransitionDuration = this.element.style.webkitTransitionDuration = '.2s';\n    }\n\n    if (classList.contains(CLASS_ACTIVE)) {\n      classList.remove(CLASS_ACTIVE);\n      this.handle.style.webkitTransform = 'translate(0,0)';\n    } else {\n      classList.add(CLASS_ACTIVE);\n      this.handle.style.webkitTransform = 'translate(' + this.handleX + 'px,0)';\n    }\n\n    $.trigger(this.element, 'toggle', {\n      isActive: this.classList.contains(CLASS_ACTIVE)\n    });\n  };\n\n  Toggle.prototype.setTranslateX = $.animationFrame(function (x) {\n    if (!this.isDragging) {\n      return;\n    }\n\n    var isChanged = false;\n\n    if (this.initialState && -x > this.handleX / 2 || !this.initialState && x > this.handleX / 2) {\n      isChanged = true;\n    }\n\n    if (this.lastChanged !== isChanged) {\n      if (isChanged) {\n        this.handle.style.webkitTransform = 'translate(' + (this.initialState ? 0 : this.handleX) + 'px,0)';\n        this.classList[this.initialState ? 'remove' : 'add'](CLASS_ACTIVE);\n      } else {\n        this.handle.style.webkitTransform = 'translate(' + (this.initialState ? this.handleX : 0) + 'px,0)';\n        this.classList[this.initialState ? 'add' : 'remove'](CLASS_ACTIVE);\n      }\n\n      this.lastChanged = isChanged;\n    }\n  });\n\n  $.fn['switch'] = function (options) {\n    var switchApis = [];\n    this.each(function () {\n      var switchApi = null;\n      var id = this.getAttribute('data-switch');\n\n      if (!id) {\n        id = ++$.uuid;\n        $.data[id] = new Toggle(this);\n        this.setAttribute('data-switch', id);\n      } else {\n        switchApi = $.data[id];\n      }\n\n      switchApis.push(switchApi);\n    });\n    return switchApis.length > 1 ? switchApis : switchApis[0];\n  };\n\n  $.ready(function () {\n    $('.' + CLASS_SWITCH)['switch']();\n  });\n})(mui, window, 'toggle');\n/**\r\n * Tableviews\r\n * @param {type} $\r\n * @param {type} window\r\n * @param {type} document\r\n * @returns {undefined}\r\n */\n\n\n(function ($, window, document) {\n  var CLASS_ACTIVE = 'mui-active';\n  var CLASS_SELECTED = 'mui-selected';\n  var CLASS_GRID_VIEW = 'mui-grid-view';\n  var CLASS_RADIO_VIEW = 'mui-table-view-radio';\n  var CLASS_TABLE_VIEW_CELL = 'mui-table-view-cell';\n  var CLASS_COLLAPSE_CONTENT = 'mui-collapse-content';\n  var CLASS_DISABLED = 'mui-disabled';\n  var CLASS_TOGGLE = 'mui-switch';\n  var CLASS_BTN = 'mui-btn';\n  var CLASS_SLIDER_HANDLE = 'mui-slider-handle';\n  var CLASS_SLIDER_LEFT = 'mui-slider-left';\n  var CLASS_SLIDER_RIGHT = 'mui-slider-right';\n  var CLASS_TRANSITIONING = 'mui-transitioning';\n  var SELECTOR_SLIDER_HANDLE = '.' + CLASS_SLIDER_HANDLE;\n  var SELECTOR_SLIDER_LEFT = '.' + CLASS_SLIDER_LEFT;\n  var SELECTOR_SLIDER_RIGHT = '.' + CLASS_SLIDER_RIGHT;\n  var SELECTOR_SELECTED = '.' + CLASS_SELECTED;\n  var SELECTOR_BUTTON = '.' + CLASS_BTN;\n  var overFactor = 0.8;\n  var cell, a;\n  var isMoved = isOpened = openedActions = progress = false;\n  var sliderHandle = sliderActionLeft = sliderActionRight = buttonsLeft = buttonsRight = sliderDirection = sliderRequestAnimationFrame = false;\n  var timer = translateX = lastTranslateX = sliderActionLeftWidth = sliderActionRightWidth = 0;\n\n  var toggleActive = function toggleActive(isActive) {\n    if (isActive) {\n      if (a) {\n        a.classList.add(CLASS_ACTIVE);\n      } else if (cell) {\n        cell.classList.add(CLASS_ACTIVE);\n      }\n    } else {\n      timer && timer.cancel();\n\n      if (a) {\n        a.classList.remove(CLASS_ACTIVE);\n      } else if (cell) {\n        cell.classList.remove(CLASS_ACTIVE);\n      }\n    }\n  };\n\n  var updateTranslate = function updateTranslate() {\n    if (translateX !== lastTranslateX) {\n      if (buttonsRight && buttonsRight.length > 0) {\n        progress = translateX / sliderActionRightWidth;\n\n        if (translateX < -sliderActionRightWidth) {\n          translateX = -sliderActionRightWidth - Math.pow(-translateX - sliderActionRightWidth, overFactor);\n        }\n\n        for (var i = 0, len = buttonsRight.length; i < len; i++) {\n          var buttonRight = buttonsRight[i];\n\n          if (typeof buttonRight._buttonOffset === 'undefined') {\n            buttonRight._buttonOffset = buttonRight.offsetLeft;\n          }\n\n          buttonOffset = buttonRight._buttonOffset;\n          setTranslate(buttonRight, translateX - buttonOffset * (1 + Math.max(progress, -1)));\n        }\n      }\n\n      if (buttonsLeft && buttonsLeft.length > 0) {\n        progress = translateX / sliderActionLeftWidth;\n\n        if (translateX > sliderActionLeftWidth) {\n          translateX = sliderActionLeftWidth + Math.pow(translateX - sliderActionLeftWidth, overFactor);\n        }\n\n        for (var i = 0, len = buttonsLeft.length; i < len; i++) {\n          var buttonLeft = buttonsLeft[i];\n\n          if (typeof buttonLeft._buttonOffset === 'undefined') {\n            buttonLeft._buttonOffset = sliderActionLeftWidth - buttonLeft.offsetLeft - buttonLeft.offsetWidth;\n          }\n\n          buttonOffset = buttonLeft._buttonOffset;\n\n          if (buttonsLeft.length > 1) {\n            buttonLeft.style.zIndex = buttonsLeft.length - i;\n          }\n\n          setTranslate(buttonLeft, translateX + buttonOffset * (1 - Math.min(progress, 1)));\n        }\n      }\n\n      setTranslate(sliderHandle, translateX);\n      lastTranslateX = translateX;\n    }\n\n    sliderRequestAnimationFrame = requestAnimationFrame(function () {\n      updateTranslate();\n    });\n  };\n\n  var setTranslate = function setTranslate(element, x) {\n    if (element) {\n      element.style.webkitTransform = 'translate(' + x + 'px,0)';\n    }\n  };\n\n  window.addEventListener($.EVENT_START, function (event) {\n    if (cell) {\n      toggleActive(false);\n    }\n\n    cell = a = false;\n    isMoved = isOpened = openedActions = false;\n    var target = event.target;\n    var isDisabled = false;\n\n    for (; target && target !== document; target = target.parentNode) {\n      if (target.classList) {\n        var classList = target.classList;\n\n        if (target.tagName === 'INPUT' && target.type !== 'radio' && target.type !== 'checkbox' || target.tagName === 'BUTTON' || classList.contains(CLASS_TOGGLE) || classList.contains(CLASS_BTN) || classList.contains(CLASS_DISABLED)) {\n          isDisabled = true;\n        }\n\n        if (classList.contains(CLASS_COLLAPSE_CONTENT)) {\n          //collapse content\n          break;\n        }\n\n        if (classList.contains(CLASS_TABLE_VIEW_CELL)) {\n          cell = target; //TODO swipe to delete close\n\n          var selected = cell.parentNode.querySelector(SELECTOR_SELECTED);\n\n          if (!cell.parentNode.classList.contains(CLASS_RADIO_VIEW) && selected && selected !== cell) {\n            $.swipeoutClose(selected);\n            cell = isDisabled = false;\n            return;\n          }\n\n          if (!cell.parentNode.classList.contains(CLASS_GRID_VIEW)) {\n            var link = cell.querySelector('a');\n\n            if (link && link.parentNode === cell) {\n              //li>a\n              a = link;\n            }\n          }\n\n          var handle = cell.querySelector(SELECTOR_SLIDER_HANDLE);\n\n          if (handle) {\n            toggleEvents(cell);\n            event.stopPropagation();\n          }\n\n          if (!isDisabled) {\n            if (handle) {\n              if (timer) {\n                timer.cancel();\n              }\n\n              timer = $.later(function () {\n                toggleActive(true);\n              }, 100);\n            } else {\n              toggleActive(true);\n            }\n          }\n\n          break;\n        }\n      }\n    }\n  });\n  window.addEventListener($.EVENT_MOVE, function (event) {\n    toggleActive(false);\n  });\n  var handleEvent = {\n    handleEvent: function handleEvent(event) {\n      switch (event.type) {\n        case 'drag':\n          this.drag(event);\n          break;\n\n        case 'dragend':\n          this.dragend(event);\n          break;\n\n        case 'flick':\n          this.flick(event);\n          break;\n\n        case 'swiperight':\n          this.swiperight(event);\n          break;\n\n        case 'swipeleft':\n          this.swipeleft(event);\n          break;\n      }\n    },\n    drag: function drag(event) {\n      if (!cell) {\n        return;\n      }\n\n      if (!isMoved) {\n        //init\n        sliderHandle = sliderActionLeft = sliderActionRight = buttonsLeft = buttonsRight = sliderDirection = sliderRequestAnimationFrame = false;\n        sliderHandle = cell.querySelector(SELECTOR_SLIDER_HANDLE);\n\n        if (sliderHandle) {\n          sliderActionLeft = cell.querySelector(SELECTOR_SLIDER_LEFT);\n          sliderActionRight = cell.querySelector(SELECTOR_SLIDER_RIGHT);\n\n          if (sliderActionLeft) {\n            sliderActionLeftWidth = sliderActionLeft.offsetWidth;\n            buttonsLeft = sliderActionLeft.querySelectorAll(SELECTOR_BUTTON);\n          }\n\n          if (sliderActionRight) {\n            sliderActionRightWidth = sliderActionRight.offsetWidth;\n            buttonsRight = sliderActionRight.querySelectorAll(SELECTOR_BUTTON);\n          }\n\n          cell.classList.remove(CLASS_TRANSITIONING);\n          isOpened = cell.classList.contains(CLASS_SELECTED);\n\n          if (isOpened) {\n            openedActions = cell.querySelector(SELECTOR_SLIDER_LEFT + SELECTOR_SELECTED) ? 'left' : 'right';\n          }\n        }\n      }\n\n      var detail = event.detail;\n      var direction = detail.direction;\n      var angle = detail.angle;\n\n      if (direction === 'left' && (angle > 150 || angle < -150)) {\n        if (buttonsRight || buttonsLeft && isOpened) {\n          //存在右侧按钮或存在左侧按钮且是已打开状态\n          isMoved = true;\n        }\n      } else if (direction === 'right' && angle > -30 && angle < 30) {\n        if (buttonsLeft || buttonsRight && isOpened) {\n          //存在左侧按钮或存在右侧按钮且是已打开状态\n          isMoved = true;\n        }\n      }\n\n      if (isMoved) {\n        event.stopPropagation();\n        event.detail.gesture.preventDefault();\n        var translate = event.detail.deltaX;\n\n        if (isOpened) {\n          if (openedActions === 'right') {\n            translate = translate - sliderActionRightWidth;\n          } else {\n            translate = translate + sliderActionLeftWidth;\n          }\n        }\n\n        if (translate > 0 && !buttonsLeft || translate < 0 && !buttonsRight) {\n          if (!isOpened) {\n            return;\n          }\n\n          translate = 0;\n        }\n\n        if (translate < 0) {\n          sliderDirection = 'toLeft';\n        } else if (translate > 0) {\n          sliderDirection = 'toRight';\n        } else {\n          if (!sliderDirection) {\n            sliderDirection = 'toLeft';\n          }\n        }\n\n        if (!sliderRequestAnimationFrame) {\n          updateTranslate();\n        }\n\n        translateX = translate;\n      }\n    },\n    flick: function flick(event) {\n      if (isMoved) {\n        event.stopPropagation();\n      }\n    },\n    swipeleft: function swipeleft(event) {\n      if (isMoved) {\n        event.stopPropagation();\n      }\n    },\n    swiperight: function swiperight(event) {\n      if (isMoved) {\n        event.stopPropagation();\n      }\n    },\n    dragend: function dragend(event) {\n      if (!isMoved) {\n        return;\n      }\n\n      event.stopPropagation();\n\n      if (sliderRequestAnimationFrame) {\n        cancelAnimationFrame(sliderRequestAnimationFrame);\n        sliderRequestAnimationFrame = null;\n      }\n\n      var detail = event.detail;\n      isMoved = false;\n      var action = 'close';\n      var actionsWidth = sliderDirection === 'toLeft' ? sliderActionRightWidth : sliderActionLeftWidth;\n      var isToggle = detail.swipe || Math.abs(translateX) > actionsWidth / 2;\n\n      if (isToggle) {\n        if (!isOpened) {\n          action = 'open';\n        } else if (detail.direction === 'left' && openedActions === 'right') {\n          action = 'open';\n        } else if (detail.direction === 'right' && openedActions === 'left') {\n          action = 'open';\n        }\n      }\n\n      cell.classList.add(CLASS_TRANSITIONING);\n      var buttons;\n\n      if (action === 'open') {\n        var newTranslate = sliderDirection === 'toLeft' ? -actionsWidth : actionsWidth;\n        setTranslate(sliderHandle, newTranslate);\n        buttons = sliderDirection === 'toLeft' ? buttonsRight : buttonsLeft;\n\n        if (typeof buttons !== 'undefined') {\n          var button = null;\n\n          for (var i = 0; i < buttons.length; i++) {\n            button = buttons[i];\n            setTranslate(button, newTranslate);\n          }\n\n          button.parentNode.classList.add(CLASS_SELECTED);\n          cell.classList.add(CLASS_SELECTED);\n\n          if (!isOpened) {\n            $.trigger(cell, sliderDirection === 'toLeft' ? 'slideleft' : 'slideright');\n          }\n        }\n      } else {\n        setTranslate(sliderHandle, 0);\n        sliderActionLeft && sliderActionLeft.classList.remove(CLASS_SELECTED);\n        sliderActionRight && sliderActionRight.classList.remove(CLASS_SELECTED);\n        cell.classList.remove(CLASS_SELECTED);\n      }\n\n      var buttonOffset;\n\n      if (buttonsLeft && buttonsLeft.length > 0 && buttonsLeft !== buttons) {\n        for (var i = 0, len = buttonsLeft.length; i < len; i++) {\n          var buttonLeft = buttonsLeft[i];\n          buttonOffset = buttonLeft._buttonOffset;\n\n          if (typeof buttonOffset === 'undefined') {\n            buttonLeft._buttonOffset = sliderActionLeftWidth - buttonLeft.offsetLeft - buttonLeft.offsetWidth;\n          }\n\n          setTranslate(buttonLeft, buttonOffset);\n        }\n      }\n\n      if (buttonsRight && buttonsRight.length > 0 && buttonsRight !== buttons) {\n        for (var i = 0, len = buttonsRight.length; i < len; i++) {\n          var buttonRight = buttonsRight[i];\n          buttonOffset = buttonRight._buttonOffset;\n\n          if (typeof buttonOffset === 'undefined') {\n            buttonRight._buttonOffset = buttonRight.offsetLeft;\n          }\n\n          setTranslate(buttonRight, -buttonOffset);\n        }\n      }\n    }\n  };\n\n  function toggleEvents(element, isRemove) {\n    var method = !!isRemove ? 'removeEventListener' : 'addEventListener';\n    element[method]('drag', handleEvent);\n    element[method]('dragend', handleEvent);\n    element[method]('swiperight', handleEvent);\n    element[method]('swipeleft', handleEvent);\n    element[method]('flick', handleEvent);\n  }\n\n  ;\n  /**\r\n   * 打开滑动菜单\r\n   * @param {Object} el\r\n   * @param {Object} direction\r\n   */\n\n  $.swipeoutOpen = function (el, direction) {\n    if (!el) return;\n    var classList = el.classList;\n    if (classList.contains(CLASS_SELECTED)) return;\n\n    if (!direction) {\n      if (el.querySelector(SELECTOR_SLIDER_RIGHT)) {\n        direction = 'right';\n      } else {\n        direction = 'left';\n      }\n    }\n\n    var swipeoutAction = el.querySelector($.classSelector(\".slider-\" + direction));\n    if (!swipeoutAction) return;\n    swipeoutAction.classList.add(CLASS_SELECTED);\n    classList.add(CLASS_SELECTED);\n    classList.remove(CLASS_TRANSITIONING);\n    var buttons = swipeoutAction.querySelectorAll(SELECTOR_BUTTON);\n    var swipeoutWidth = swipeoutAction.offsetWidth;\n    var translate = direction === 'right' ? -swipeoutWidth : swipeoutWidth;\n    var length = buttons.length;\n    var button;\n\n    for (var i = 0; i < length; i++) {\n      button = buttons[i];\n\n      if (direction === 'right') {\n        setTranslate(button, -button.offsetLeft);\n      } else {\n        setTranslate(button, swipeoutWidth - button.offsetWidth - button.offsetLeft);\n      }\n    }\n\n    classList.add(CLASS_TRANSITIONING);\n\n    for (var i = 0; i < length; i++) {\n      setTranslate(buttons[i], translate);\n    }\n\n    setTranslate(el.querySelector(SELECTOR_SLIDER_HANDLE), translate);\n  };\n  /**\r\n   * 关闭滑动菜单\r\n   * @param {Object} el\r\n   */\n\n\n  $.swipeoutClose = function (el) {\n    if (!el) return;\n    var classList = el.classList;\n    if (!classList.contains(CLASS_SELECTED)) return;\n    var direction = el.querySelector(SELECTOR_SLIDER_RIGHT + SELECTOR_SELECTED) ? 'right' : 'left';\n    var swipeoutAction = el.querySelector($.classSelector(\".slider-\" + direction));\n    if (!swipeoutAction) return;\n    swipeoutAction.classList.remove(CLASS_SELECTED);\n    classList.remove(CLASS_SELECTED);\n    classList.add(CLASS_TRANSITIONING);\n    var buttons = swipeoutAction.querySelectorAll(SELECTOR_BUTTON);\n    var swipeoutWidth = swipeoutAction.offsetWidth;\n    var length = buttons.length;\n    var button;\n    setTranslate(el.querySelector(SELECTOR_SLIDER_HANDLE), 0);\n\n    for (var i = 0; i < length; i++) {\n      button = buttons[i];\n\n      if (direction === 'right') {\n        setTranslate(button, -button.offsetLeft);\n      } else {\n        setTranslate(button, swipeoutWidth - button.offsetWidth - button.offsetLeft);\n      }\n    }\n  };\n\n  window.addEventListener($.EVENT_END, function (event) {\n    //使用touchend来取消高亮，避免一次点击既不触发tap，doubletap，longtap的事件\n    if (!cell) {\n      return;\n    }\n\n    toggleActive(false);\n    sliderHandle && toggleEvents(cell, true);\n  });\n  window.addEventListener($.EVENT_CANCEL, function (event) {\n    //使用touchcancel来取消高亮，避免一次点击既不触发tap，doubletap，longtap的事件\n    if (!cell) {\n      return;\n    }\n\n    toggleActive(false);\n    sliderHandle && toggleEvents(cell, true);\n  });\n\n  var radioOrCheckboxClick = function radioOrCheckboxClick(event) {\n    var type = event.target && event.target.type || '';\n\n    if (type === 'radio' || type === 'checkbox') {\n      return;\n    }\n\n    var classList = cell.classList;\n\n    if (classList.contains('mui-radio')) {\n      var input = cell.querySelector('input[type=radio]');\n\n      if (input) {\n        //\t\t\t\tinput.click();\n        if (!input.disabled && !input.readOnly) {\n          input.checked = !input.checked;\n          $.trigger(input, 'change');\n        }\n      }\n    } else if (classList.contains('mui-checkbox')) {\n      var input = cell.querySelector('input[type=checkbox]');\n\n      if (input) {\n        //\t\t\t\tinput.click();\n        if (!input.disabled && !input.readOnly) {\n          input.checked = !input.checked;\n          $.trigger(input, 'change');\n        }\n      }\n    }\n  }; //fixed hashchange(android)\n\n\n  window.addEventListener($.EVENT_CLICK, function (e) {\n    if (cell && cell.classList.contains('mui-collapse')) {\n      e.preventDefault();\n    }\n  });\n  window.addEventListener('doubletap', function (event) {\n    if (cell) {\n      radioOrCheckboxClick(event);\n    }\n  });\n  var preventDefaultException = /^(INPUT|TEXTAREA|BUTTON|SELECT)$/;\n  window.addEventListener('tap', function (event) {\n    if (!cell) {\n      return;\n    }\n\n    var isExpand = false;\n    var classList = cell.classList;\n    var ul = cell.parentNode;\n\n    if (ul && ul.classList.contains(CLASS_RADIO_VIEW)) {\n      if (classList.contains(CLASS_SELECTED)) {\n        return;\n      }\n\n      var selected = ul.querySelector('li' + SELECTOR_SELECTED);\n\n      if (selected) {\n        selected.classList.remove(CLASS_SELECTED);\n      }\n\n      classList.add(CLASS_SELECTED);\n      $.trigger(cell, 'selected', {\n        el: cell\n      });\n      return;\n    }\n\n    if (classList.contains('mui-collapse') && !cell.parentNode.classList.contains('mui-unfold')) {\n      if (!preventDefaultException.test(event.target.tagName)) {\n        event.detail.gesture.preventDefault();\n      }\n\n      if (!classList.contains(CLASS_ACTIVE)) {\n        //展开时,需要收缩其他同类\n        var collapse = cell.parentNode.querySelector('.mui-collapse.mui-active');\n\n        if (collapse) {\n          collapse.classList.remove(CLASS_ACTIVE);\n        }\n\n        isExpand = true;\n      }\n\n      classList.toggle(CLASS_ACTIVE);\n\n      if (isExpand) {\n        //触发展开事件\n        $.trigger(cell, 'expand'); //scroll\n        //暂不滚动\n        // var offsetTop = $.offset(cell).top;\n        // var scrollTop = document.body.scrollTop;\n        // var height = window.innerHeight;\n        // var offsetHeight = cell.offsetHeight;\n        // var cellHeight = (offsetTop - scrollTop + offsetHeight);\n        // if (offsetHeight > height) {\n        // \t$.scrollTo(offsetTop, 300);\n        // } else if (cellHeight > height) {\n        // \t$.scrollTo(cellHeight - height + scrollTop, 300);\n        // }\n      }\n    } else {\n      radioOrCheckboxClick(event);\n    }\n  });\n})(mui, window, document);\n\n(function ($, window) {\n  /**\r\n   * 警告消息框\r\n   */\n  $.alert = function (message, title, btnValue, callback) {\n    if ($.os.plus) {\n      if (typeof message === 'undefined') {\n        return;\n      } else {\n        if (typeof title === 'function') {\n          callback = title;\n          title = null;\n          btnValue = '确定';\n        } else if (typeof btnValue === 'function') {\n          callback = btnValue;\n          btnValue = null;\n        }\n\n        $.plusReady(function () {\n          plus.nativeUI.alert(message, callback, title, btnValue);\n        });\n      }\n    } else {\n      //TODO H5版本\n      window.alert(message);\n    }\n  };\n})(mui, window);\n\n(function ($, window) {\n  /**\r\n   * 确认消息框\r\n   */\n  $.confirm = function (message, title, btnArray, callback) {\n    if ($.os.plus) {\n      if (typeof message === 'undefined') {\n        return;\n      } else {\n        if (typeof title === 'function') {\n          callback = title;\n          title = null;\n          btnArray = null;\n        } else if (typeof btnArray === 'function') {\n          callback = btnArray;\n          btnArray = null;\n        }\n\n        $.plusReady(function () {\n          plus.nativeUI.confirm(message, callback, title, btnArray);\n        });\n      }\n    } else {\n      //H5版本，0为确认，1为取消\n      if (window.confirm(message)) {\n        callback({\n          index: 0\n        });\n      } else {\n        callback({\n          index: 1\n        });\n      }\n    }\n  };\n})(mui, window);\n\n(function ($, window) {\n  /**\r\n   * 输入对话框\r\n   */\n  $.prompt = function (text, defaultText, title, btnArray, callback) {\n    if ($.os.plus) {\n      if (typeof message === 'undefined') {\n        return;\n      } else {\n        if (typeof defaultText === 'function') {\n          callback = defaultText;\n          defaultText = null;\n          title = null;\n          btnArray = null;\n        } else if (typeof title === 'function') {\n          callback = title;\n          title = null;\n          btnArray = null;\n        } else if (typeof btnArray === 'function') {\n          callback = btnArray;\n          btnArray = null;\n        }\n\n        $.plusReady(function () {\n          plus.nativeUI.prompt(text, callback, title, defaultText, btnArray);\n        });\n      }\n    } else {\n      //H5版本(确认index为0，取消index为1)\n      var result = window.prompt(text);\n\n      if (result) {\n        callback({\n          index: 0,\n          value: result\n        });\n      } else {\n        callback({\n          index: 1,\n          value: ''\n        });\n      }\n    }\n  };\n})(mui, window);\n\n(function ($, window) {\n  var CLASS_ACTIVE = 'mui-active';\n  /**\r\n   * 自动消失提示框\r\n   */\n\n  $.toast = function (message, options) {\n    var durations = {\n      'long': 3500,\n      'short': 2000\n    }; //计算显示时间\n\n    options = $.extend({\n      duration: 'short'\n    }, options || {});\n\n    if ($.os.plus && options.type !== 'div') {\n      //默认显示在底部；\n      $.plusReady(function () {\n        plus.nativeUI.toast(message, {\n          verticalAlign: 'bottom',\n          duration: options.duration\n        });\n      });\n    } else {\n      if (typeof options.duration === 'number') {\n        duration = options.duration > 0 ? options.duration : durations['short'];\n      } else {\n        duration = durations[options.duration];\n      }\n\n      if (!duration) {\n        duration = durations['short'];\n      }\n\n      var toast = document.createElement('div');\n      toast.classList.add('mui-toast-container');\n      toast.innerHTML = '<div class=\"' + 'mui-toast-message' + '\">' + message + '</div>';\n      toast.addEventListener('webkitTransitionEnd', function () {\n        if (!toast.classList.contains(CLASS_ACTIVE)) {\n          toast.parentNode.removeChild(toast);\n          toast = null;\n        }\n      }); //点击则自动消失\n\n      toast.addEventListener('click', function () {\n        toast.parentNode.removeChild(toast);\n        toast = null;\n      });\n      document.body.appendChild(toast);\n      toast.offsetHeight;\n      toast.classList.add(CLASS_ACTIVE);\n      setTimeout(function () {\n        toast && toast.classList.remove(CLASS_ACTIVE);\n      }, duration);\n      return {\n        isVisible: function isVisible() {\n          return !!toast;\n        }\n      };\n    }\n  };\n})(mui, window);\n/**\r\n * Popup(alert,confirm,prompt)  \r\n * @param {Object} $\r\n * @param {Object} window\r\n * @param {Object} document\r\n */\n\n\n(function ($, window, document) {\n  var CLASS_POPUP = 'mui-popup';\n  var CLASS_POPUP_BACKDROP = 'mui-popup-backdrop';\n  var CLASS_POPUP_IN = 'mui-popup-in';\n  var CLASS_POPUP_OUT = 'mui-popup-out';\n  var CLASS_POPUP_INNER = 'mui-popup-inner';\n  var CLASS_POPUP_TITLE = 'mui-popup-title';\n  var CLASS_POPUP_TEXT = 'mui-popup-text';\n  var CLASS_POPUP_INPUT = 'mui-popup-input';\n  var CLASS_POPUP_BUTTONS = 'mui-popup-buttons';\n  var CLASS_POPUP_BUTTON = 'mui-popup-button';\n  var CLASS_POPUP_BUTTON_BOLD = 'mui-popup-button-bold';\n  var CLASS_POPUP_BACKDROP = 'mui-popup-backdrop';\n  var CLASS_ACTIVE = 'mui-active';\n  var popupStack = [];\n\n  var backdrop = function () {\n    var element = document.createElement('div');\n    element.classList.add(CLASS_POPUP_BACKDROP);\n    element.addEventListener($.EVENT_MOVE, $.preventDefault);\n    element.addEventListener('webkitTransitionEnd', function () {\n      if (!this.classList.contains(CLASS_ACTIVE)) {\n        element.parentNode && element.parentNode.removeChild(element);\n      }\n    });\n    return element;\n  }();\n\n  var createInput = function createInput(placeholder) {\n    return '<div class=\"' + CLASS_POPUP_INPUT + '\"><input type=\"text\" autofocus placeholder=\"' + (placeholder || '') + '\"/></div>';\n  };\n\n  var createInner = function createInner(message, title, extra) {\n    return '<div class=\"' + CLASS_POPUP_INNER + '\"><div class=\"' + CLASS_POPUP_TITLE + '\">' + title + '</div><div class=\"' + CLASS_POPUP_TEXT + '\">' + message.replace(/\\r\\n/g, \"<br/>\").replace(/\\n/g, \"<br/>\") + '</div>' + (extra || '') + '</div>';\n  };\n\n  var createButtons = function createButtons(btnArray) {\n    var length = btnArray.length;\n    var btns = [];\n\n    for (var i = 0; i < length; i++) {\n      btns.push('<span class=\"' + CLASS_POPUP_BUTTON + (i === length - 1 ? ' ' + CLASS_POPUP_BUTTON_BOLD : '') + '\">' + btnArray[i] + '</span>');\n    }\n\n    return '<div class=\"' + CLASS_POPUP_BUTTONS + '\">' + btns.join('') + '</div>';\n  };\n\n  var createPopup = function createPopup(html, callback) {\n    var popupElement = document.createElement('div');\n    popupElement.className = CLASS_POPUP;\n    popupElement.innerHTML = html;\n\n    var removePopupElement = function removePopupElement() {\n      popupElement.parentNode && popupElement.parentNode.removeChild(popupElement);\n      popupElement = null;\n    };\n\n    popupElement.addEventListener($.EVENT_MOVE, $.preventDefault);\n    popupElement.addEventListener('webkitTransitionEnd', function (e) {\n      if (popupElement && e.target === popupElement && popupElement.classList.contains(CLASS_POPUP_OUT)) {\n        removePopupElement();\n      }\n    });\n    popupElement.style.display = 'block';\n    document.body.appendChild(popupElement);\n    popupElement.offsetHeight;\n    popupElement.classList.add(CLASS_POPUP_IN);\n\n    if (!backdrop.classList.contains(CLASS_ACTIVE)) {\n      backdrop.style.display = 'block';\n      document.body.appendChild(backdrop);\n      backdrop.offsetHeight;\n      backdrop.classList.add(CLASS_ACTIVE);\n    }\n\n    var btns = $.qsa('.' + CLASS_POPUP_BUTTON, popupElement);\n    var input = popupElement.querySelector('.' + CLASS_POPUP_INPUT + ' input');\n    var popup = {\n      element: popupElement,\n      close: function close(index, animate) {\n        if (popupElement) {\n          var result = callback && callback({\n            index: index || 0,\n            value: input && input.value || ''\n          });\n\n          if (result === false) {\n            //返回false则不关闭当前popup\n            return;\n          }\n\n          if (animate !== false) {\n            popupElement.classList.remove(CLASS_POPUP_IN);\n            popupElement.classList.add(CLASS_POPUP_OUT);\n          } else {\n            removePopupElement();\n          }\n\n          popupStack.pop(); //如果还有其他popup，则不remove backdrop\n\n          if (popupStack.length) {\n            popupStack[popupStack.length - 1]['show'](animate);\n          } else {\n            backdrop.classList.remove(CLASS_ACTIVE);\n          }\n        }\n      }\n    };\n\n    var handleEvent = function handleEvent(e) {\n      popup.close(btns.indexOf(e.target));\n    };\n\n    $(popupElement).on('tap', '.' + CLASS_POPUP_BUTTON, handleEvent);\n\n    if (popupStack.length) {\n      popupStack[popupStack.length - 1]['hide']();\n    }\n\n    popupStack.push({\n      close: popup.close,\n      show: function show(animate) {\n        popupElement.style.display = 'block';\n        popupElement.offsetHeight;\n        popupElement.classList.add(CLASS_POPUP_IN);\n      },\n      hide: function hide() {\n        popupElement.style.display = 'none';\n        popupElement.classList.remove(CLASS_POPUP_IN);\n      }\n    });\n    return popup;\n  };\n\n  var createAlert = function createAlert(message, title, btnValue, callback, type) {\n    if (typeof message === 'undefined') {\n      return;\n    } else {\n      if (typeof title === 'function') {\n        callback = title;\n        type = btnValue;\n        title = null;\n        btnValue = null;\n      } else if (typeof btnValue === 'function') {\n        type = callback;\n        callback = btnValue;\n        btnValue = null;\n      }\n    }\n\n    if (!$.os.plus || type === 'div') {\n      return createPopup(createInner(message, title || '提示') + createButtons([btnValue || '确定']), callback);\n    }\n\n    return plus.nativeUI.alert(message, callback, title || '提示', btnValue || '确定');\n  };\n\n  var createConfirm = function createConfirm(message, title, btnArray, callback, type) {\n    if (typeof message === 'undefined') {\n      return;\n    } else {\n      if (typeof title === 'function') {\n        callback = title;\n        type = btnArray;\n        title = null;\n        btnArray = null;\n      } else if (typeof btnArray === 'function') {\n        type = callback;\n        callback = btnArray;\n        btnArray = null;\n      }\n    }\n\n    if (!$.os.plus || type === 'div') {\n      return createPopup(createInner(message, title || '提示') + createButtons(btnArray || ['取消', '确认']), callback);\n    }\n\n    return plus.nativeUI.confirm(message, callback, title, btnArray || ['取消', '确认']);\n  };\n\n  var createPrompt = function createPrompt(message, placeholder, title, btnArray, callback, type) {\n    if (typeof message === 'undefined') {\n      return;\n    } else {\n      if (typeof placeholder === 'function') {\n        callback = placeholder;\n        type = title;\n        placeholder = null;\n        title = null;\n        btnArray = null;\n      } else if (typeof title === 'function') {\n        callback = title;\n        type = btnArray;\n        title = null;\n        btnArray = null;\n      } else if (typeof btnArray === 'function') {\n        type = callback;\n        callback = btnArray;\n        btnArray = null;\n      }\n    }\n\n    if (!$.os.plus || type === 'div') {\n      return createPopup(createInner(message, title || '提示', createInput(placeholder)) + createButtons(btnArray || ['取消', '确认']), callback);\n    }\n\n    return plus.nativeUI.prompt(message, callback, title || '提示', placeholder, btnArray || ['取消', '确认']);\n  };\n\n  var closePopup = function closePopup() {\n    if (popupStack.length) {\n      popupStack[popupStack.length - 1]['close']();\n      return true;\n    } else {\n      return false;\n    }\n  };\n\n  var closePopups = function closePopups() {\n    while (popupStack.length) {\n      popupStack[popupStack.length - 1]['close']();\n    }\n  };\n\n  $.closePopup = closePopup;\n  $.closePopups = closePopups;\n  $.alert = createAlert;\n  $.confirm = createConfirm;\n  $.prompt = createPrompt;\n})(mui, window, document);\n\n(function ($, document) {\n  var CLASS_PROGRESSBAR = 'mui-progressbar';\n  var CLASS_PROGRESSBAR_IN = 'mui-progressbar-in';\n  var CLASS_PROGRESSBAR_OUT = 'mui-progressbar-out';\n  var CLASS_PROGRESSBAR_INFINITE = 'mui-progressbar-infinite';\n  var SELECTOR_PROGRESSBAR = '.mui-progressbar';\n\n  var _findProgressbar = function _findProgressbar(container) {\n    container = $(container || 'body');\n    if (container.length === 0) return;\n    container = container[0];\n\n    if (container.classList.contains(CLASS_PROGRESSBAR)) {\n      return container;\n    }\n\n    var progressbars = container.querySelectorAll(SELECTOR_PROGRESSBAR);\n\n    if (progressbars) {\n      for (var i = 0, len = progressbars.length; i < len; i++) {\n        var progressbar = progressbars[i];\n\n        if (progressbar.parentNode === container) {\n          return progressbar;\n        }\n      }\n    }\n  };\n  /**\r\n   * 创建并显示进度条 \r\n   * @param {Object} container  可选，默认body，支持selector,DOM Node,mui wrapper\r\n   * @param {Object} progress 可选，undefined表示循环，数字表示具体进度\r\n   * @param {Object} color 可选，指定颜色样式(目前暂未提供实际样式，可暂时不暴露此参数)\r\n   */\n\n\n  var showProgressbar = function showProgressbar(container, progress, color) {\n    if (typeof container === 'number') {\n      color = progress;\n      progress = container;\n      container = 'body';\n    }\n\n    container = $(container || 'body');\n    if (container.length === 0) return;\n    container = container[0];\n    var progressbar;\n\n    if (container.classList.contains(CLASS_PROGRESSBAR)) {\n      progressbar = container;\n    } else {\n      var progressbars = container.querySelectorAll(SELECTOR_PROGRESSBAR + ':not(.' + CLASS_PROGRESSBAR_OUT + ')');\n\n      if (progressbars) {\n        for (var i = 0, len = progressbars.length; i < len; i++) {\n          var _progressbar = progressbars[i];\n\n          if (_progressbar.parentNode === container) {\n            progressbar = _progressbar;\n            break;\n          }\n        }\n      }\n\n      if (!progressbar) {\n        progressbar = document.createElement('span');\n        progressbar.className = CLASS_PROGRESSBAR + ' ' + CLASS_PROGRESSBAR_IN + (typeof progress !== 'undefined' ? '' : ' ' + CLASS_PROGRESSBAR_INFINITE) + (color ? ' ' + CLASS_PROGRESSBAR + '-' + color : '');\n\n        if (typeof progress !== 'undefined') {\n          progressbar.innerHTML = '<span></span>';\n        }\n\n        container.appendChild(progressbar);\n      } else {\n        progressbar.classList.add(CLASS_PROGRESSBAR_IN);\n      }\n    }\n\n    if (progress) setProgressbar(container, progress);\n    return progressbar;\n  };\n  /**\r\n   * 关闭进度条 \r\n   * @param {Object} container 可选，默认body，支持selector,DOM Node,mui wrapper\r\n   */\n\n\n  var hideProgressbar = function hideProgressbar(container) {\n    var progressbar = _findProgressbar(container);\n\n    if (!progressbar) {\n      return;\n    }\n\n    var classList = progressbar.classList;\n\n    if (!classList.contains(CLASS_PROGRESSBAR_IN) || classList.contains(CLASS_PROGRESSBAR_OUT)) {\n      return;\n    }\n\n    classList.remove(CLASS_PROGRESSBAR_IN);\n    classList.add(CLASS_PROGRESSBAR_OUT);\n    progressbar.addEventListener('webkitAnimationEnd', function () {\n      progressbar.parentNode && progressbar.parentNode.removeChild(progressbar);\n      progressbar = null;\n    });\n    return;\n  };\n  /**\r\n   * 设置指定进度条进度 \r\n   * @param {Object} container  可选，默认body，支持selector,DOM Node,mui wrapper\r\n   * @param {Object} progress 可选，默认0 取值范围[0-100]\r\n   * @param {Object} speed 进度条动画时间\r\n   */\n\n\n  var setProgressbar = function setProgressbar(container, progress, speed) {\n    if (typeof container === 'number') {\n      speed = progress;\n      progress = container;\n      container = false;\n    }\n\n    var progressbar = _findProgressbar(container);\n\n    if (!progressbar || progressbar.classList.contains(CLASS_PROGRESSBAR_INFINITE)) {\n      return;\n    }\n\n    if (progress) progress = Math.min(Math.max(progress, 0), 100);\n    progressbar.offsetHeight;\n    var span = progressbar.querySelector('span');\n\n    if (span) {\n      var style = span.style;\n      style.webkitTransform = 'translate3d(' + (-100 + progress) + '%,0,0)';\n\n      if (typeof speed !== 'undefined') {\n        style.webkitTransitionDuration = speed + 'ms';\n      } else {\n        style.webkitTransitionDuration = '';\n      }\n    }\n\n    return progressbar;\n  };\n\n  $.fn.progressbar = function (options) {\n    var progressbarApis = [];\n    options = options || {};\n    this.each(function () {\n      var self = this;\n      var progressbarApi = self.mui_plugin_progressbar;\n\n      if (!progressbarApi) {\n        self.mui_plugin_progressbar = progressbarApi = {\n          options: options,\n          setOptions: function setOptions(options) {\n            this.options = options;\n          },\n          show: function show() {\n            return showProgressbar(self, this.options.progress, this.options.color);\n          },\n          setProgress: function setProgress(progress) {\n            return setProgressbar(self, progress);\n          },\n          hide: function hide() {\n            return hideProgressbar(self);\n          }\n        };\n      } else if (options) {\n        progressbarApi.setOptions(options);\n      }\n\n      progressbarApis.push(progressbarApi);\n    });\n    return progressbarApis.length === 1 ? progressbarApis[0] : progressbarApis;\n  }; //\t$.setProgressbar = setProgressbar;\n  //\t$.showProgressbar = showProgressbar;\n  //\t$.hideProgressbar = hideProgressbar;\n\n})(mui, document);\n/**\r\n * Input(TODO resize)\r\n * @param {type} $\r\n * @param {type} window\r\n * @param {type} document\r\n * @returns {undefined}\r\n */\n\n\n(function ($, window, document) {\n  var CLASS_ICON = 'mui-icon';\n  var CLASS_ICON_CLEAR = 'mui-icon-clear';\n  var CLASS_ICON_SPEECH = 'mui-icon-speech';\n  var CLASS_ICON_SEARCH = 'mui-icon-search';\n  var CLASS_ICON_PASSWORD = 'mui-icon-eye';\n  var CLASS_INPUT_ROW = 'mui-input-row';\n  var CLASS_PLACEHOLDER = 'mui-placeholder';\n  var CLASS_TOOLTIP = 'mui-tooltip';\n  var CLASS_HIDDEN = 'mui-hidden';\n  var CLASS_FOCUSIN = 'mui-focusin';\n  var SELECTOR_ICON_CLOSE = '.' + CLASS_ICON_CLEAR;\n  var SELECTOR_ICON_SPEECH = '.' + CLASS_ICON_SPEECH;\n  var SELECTOR_ICON_PASSWORD = '.' + CLASS_ICON_PASSWORD;\n  var SELECTOR_PLACEHOLDER = '.' + CLASS_PLACEHOLDER;\n  var SELECTOR_TOOLTIP = '.' + CLASS_TOOLTIP;\n\n  var findRow = function findRow(target) {\n    for (; target && target !== document; target = target.parentNode) {\n      if (target.classList && target.classList.contains(CLASS_INPUT_ROW)) {\n        return target;\n      }\n    }\n\n    return null;\n  };\n\n  var Input = function Input(element, options) {\n    this.element = element;\n    this.options = options || {\n      actions: 'clear'\n    };\n\n    if (~this.options.actions.indexOf('slider')) {\n      //slider\n      this.sliderActionClass = CLASS_TOOLTIP + ' ' + CLASS_HIDDEN;\n      this.sliderActionSelector = SELECTOR_TOOLTIP;\n    } else {\n      //clear,speech,search\n      if (~this.options.actions.indexOf('clear')) {\n        this.clearActionClass = CLASS_ICON + ' ' + CLASS_ICON_CLEAR + ' ' + CLASS_HIDDEN;\n        this.clearActionSelector = SELECTOR_ICON_CLOSE;\n      }\n\n      if (~this.options.actions.indexOf('speech')) {\n        //only for 5+\n        this.speechActionClass = CLASS_ICON + ' ' + CLASS_ICON_SPEECH;\n        this.speechActionSelector = SELECTOR_ICON_SPEECH;\n      }\n\n      if (~this.options.actions.indexOf('search')) {\n        this.searchActionClass = CLASS_PLACEHOLDER;\n        this.searchActionSelector = SELECTOR_PLACEHOLDER;\n      }\n\n      if (~this.options.actions.indexOf('password')) {\n        this.passwordActionClass = CLASS_ICON + ' ' + CLASS_ICON_PASSWORD;\n        this.passwordActionSelector = SELECTOR_ICON_PASSWORD;\n      }\n    }\n\n    this.init();\n  };\n\n  Input.prototype.init = function () {\n    this.initAction();\n    this.initElementEvent();\n  };\n\n  Input.prototype.initAction = function () {\n    var self = this;\n    var row = self.element.parentNode;\n\n    if (row) {\n      if (self.sliderActionClass) {\n        self.sliderAction = self.createAction(row, self.sliderActionClass, self.sliderActionSelector);\n      } else {\n        if (self.searchActionClass) {\n          self.searchAction = self.createAction(row, self.searchActionClass, self.searchActionSelector);\n          self.searchAction.addEventListener('tap', function (e) {\n            $.focus(self.element);\n            e.stopPropagation();\n          });\n        }\n\n        if (self.speechActionClass) {\n          self.speechAction = self.createAction(row, self.speechActionClass, self.speechActionSelector);\n          self.speechAction.addEventListener('click', $.stopPropagation);\n          self.speechAction.addEventListener('tap', function (event) {\n            self.speechActionClick(event);\n          });\n        }\n\n        if (self.clearActionClass) {\n          self.clearAction = self.createAction(row, self.clearActionClass, self.clearActionSelector);\n          self.clearAction.addEventListener('tap', function (event) {\n            self.clearActionClick(event);\n          });\n        }\n\n        if (self.passwordActionClass) {\n          self.passwordAction = self.createAction(row, self.passwordActionClass, self.passwordActionSelector);\n          self.passwordAction.addEventListener('tap', function (event) {\n            self.passwordActionClick(event);\n          });\n        }\n      }\n    }\n  };\n\n  Input.prototype.createAction = function (row, actionClass, actionSelector) {\n    var action = row.querySelector(actionSelector);\n\n    if (!action) {\n      var action = document.createElement('span');\n      action.className = actionClass;\n\n      if (actionClass === this.searchActionClass) {\n        action.innerHTML = '<span class=\"' + CLASS_ICON + ' ' + CLASS_ICON_SEARCH + '\"></span><span>' + this.element.getAttribute('placeholder') + '</span>';\n        this.element.setAttribute('placeholder', '');\n\n        if (this.element.value.trim()) {\n          row.classList.add('mui-active');\n        }\n      }\n\n      row.insertBefore(action, this.element.nextSibling);\n    }\n\n    return action;\n  };\n\n  Input.prototype.initElementEvent = function () {\n    var element = this.element;\n\n    if (this.sliderActionClass) {\n      var tooltip = this.sliderAction;\n      var timer = null;\n\n      var showTip = function showTip() {\n        //每次重新计算是因为控件可能被隐藏，初始化时计算是不正确的\n        tooltip.classList.remove(CLASS_HIDDEN);\n        var offsetLeft = element.offsetLeft;\n        var width = element.offsetWidth - 28;\n        var tooltipWidth = tooltip.offsetWidth;\n        var distince = Math.abs(element.max - element.min);\n        var scaleWidth = width / distince * Math.abs(element.value - element.min);\n        tooltip.style.left = 14 + offsetLeft + scaleWidth - tooltipWidth / 2 + 'px';\n        tooltip.innerText = element.value;\n\n        if (timer) {\n          clearTimeout(timer);\n        }\n\n        timer = setTimeout(function () {\n          tooltip.classList.add(CLASS_HIDDEN);\n        }, 1000);\n      };\n\n      element.addEventListener('input', showTip);\n      element.addEventListener('tap', showTip);\n      element.addEventListener($.EVENT_MOVE, function (e) {\n        e.stopPropagation();\n      });\n    } else {\n      if (this.clearActionClass) {\n        var action = this.clearAction;\n\n        if (!action) {\n          return;\n        }\n\n        $.each(['keyup', 'change', 'input', 'focus', 'cut', 'paste'], function (index, type) {\n          (function (type) {\n            element.addEventListener(type, function () {\n              action.classList[element.value.trim() ? 'remove' : 'add'](CLASS_HIDDEN);\n            });\n          })(type);\n        });\n        element.addEventListener('blur', function () {\n          action.classList.add(CLASS_HIDDEN);\n        });\n      }\n\n      if (this.searchActionClass) {\n        element.addEventListener('focus', function () {\n          element.parentNode.classList.add('mui-active');\n        });\n        element.addEventListener('blur', function () {\n          if (!element.value.trim()) {\n            element.parentNode.classList.remove('mui-active');\n          }\n        });\n      }\n    }\n  };\n\n  Input.prototype.setPlaceholder = function (text) {\n    if (this.searchActionClass) {\n      var placeholder = this.element.parentNode.querySelector(SELECTOR_PLACEHOLDER);\n      placeholder && (placeholder.getElementsByTagName('span')[1].innerText = text);\n    } else {\n      this.element.setAttribute('placeholder', text);\n    }\n  };\n\n  Input.prototype.passwordActionClick = function (event) {\n    if (this.element.type === 'text') {\n      this.element.type = 'password';\n    } else {\n      this.element.type = 'text';\n    }\n\n    this.passwordAction.classList.toggle('mui-active');\n    event.preventDefault();\n  };\n\n  Input.prototype.clearActionClick = function (event) {\n    var self = this;\n    self.element.value = '';\n    $.focus(self.element);\n    self.clearAction.classList.add(CLASS_HIDDEN);\n    event.preventDefault();\n  };\n\n  Input.prototype.speechActionClick = function (event) {\n    if (window.plus) {\n      var self = this;\n      var oldValue = self.element.value;\n      self.element.value = '';\n      document.body.classList.add(CLASS_FOCUSIN);\n      plus.speech.startRecognize({\n        engine: 'iFly'\n      }, function (s) {\n        self.element.value += s;\n        $.focus(self.element);\n        plus.speech.stopRecognize();\n        $.trigger(self.element, 'recognized', {\n          value: self.element.value\n        });\n\n        if (oldValue !== self.element.value) {\n          $.trigger(self.element, 'change');\n          $.trigger(self.element, 'input');\n        } // document.body.classList.remove(CLASS_FOCUSIN);\n\n      }, function (e) {\n        document.body.classList.remove(CLASS_FOCUSIN);\n      });\n    } else {\n      alert('only for 5+');\n    }\n\n    event.preventDefault();\n  };\n\n  $.fn.input = function (options) {\n    var inputApis = [];\n    this.each(function () {\n      var inputApi = null;\n      var actions = [];\n      var row = findRow(this.parentNode);\n\n      if (this.type === 'range' && row.classList.contains('mui-input-range')) {\n        actions.push('slider');\n      } else {\n        var classList = this.classList;\n\n        if (classList.contains('mui-input-clear')) {\n          actions.push('clear');\n        }\n\n        if (!($.os.android && $.os.stream) && classList.contains('mui-input-speech')) {\n          actions.push('speech');\n        }\n\n        if (classList.contains('mui-input-password')) {\n          actions.push('password');\n        }\n\n        if (this.type === 'search' && row.classList.contains('mui-search')) {\n          actions.push('search');\n        }\n      }\n\n      var id = this.getAttribute('data-input-' + actions[0]);\n\n      if (!id) {\n        id = ++$.uuid;\n        inputApi = $.data[id] = new Input(this, {\n          actions: actions.join(',')\n        });\n\n        for (var i = 0, len = actions.length; i < len; i++) {\n          this.setAttribute('data-input-' + actions[i], id);\n        }\n      } else {\n        inputApi = $.data[id];\n      }\n\n      inputApis.push(inputApi);\n    });\n    return inputApis.length === 1 ? inputApis[0] : inputApis;\n  };\n\n  $.ready(function () {\n    $('.mui-input-row input').input();\n  });\n})(mui, window, document);\n\n(function ($, window) {\n  var CLASS_ACTIVE = 'mui-active';\n  var rgbaRegex = /^rgba\\((\\d{1,3}),\\s*(\\d{1,3}),\\s*(\\d{1,3}),\\s*(\\d*(?:\\.\\d+)?)\\)$/;\n\n  var getColor = function getColor(colorStr) {\n    var matches = colorStr.match(rgbaRegex);\n\n    if (matches && matches.length === 5) {\n      return [matches[1], matches[2], matches[3], matches[4]];\n    }\n\n    return [];\n  };\n\n  var Transparent = function Transparent(element, options) {\n    this.element = element;\n    this.options = $.extend({\n      top: 0,\n      //距离顶部高度(到达该高度即触发)\n      offset: 150,\n      //滚动透明距离\n      duration: 16,\n      //过渡时间\n      scrollby: window //监听滚动距离容器\n\n    }, options || {});\n    this.scrollByElem = this.options.scrollby || window;\n\n    if (!this.scrollByElem) {\n      throw new Error(\"监听滚动的元素不存在\");\n    }\n\n    this.isNativeScroll = false;\n\n    if (this.scrollByElem === window) {\n      this.isNativeScroll = true;\n    } else if (!~this.scrollByElem.className.indexOf('mui-scroll-wrapper')) {\n      this.isNativeScroll = true;\n    }\n\n    this._style = this.element.style;\n    this._bgColor = this._style.backgroundColor;\n    var color = getColor(mui.getStyles(this.element, 'backgroundColor'));\n\n    if (color.length) {\n      this._R = color[0];\n      this._G = color[1];\n      this._B = color[2];\n      this._A = parseFloat(color[3]);\n      this.lastOpacity = this._A;\n      this._bufferFn = $.buffer(this.handleScroll, this.options.duration, this);\n      this.initEvent();\n    } else {\n      throw new Error(\"元素背景颜色必须为RGBA\");\n    }\n  };\n\n  Transparent.prototype.initEvent = function () {\n    this.scrollByElem.addEventListener('scroll', this._bufferFn);\n\n    if (this.isNativeScroll) {\n      //原生scroll\n      this.scrollByElem.addEventListener($.EVENT_MOVE, this._bufferFn);\n    }\n  };\n\n  Transparent.prototype.handleScroll = function (e) {\n    var y = window.scrollY;\n\n    if (!this.isNativeScroll && e && e.detail) {\n      y = -e.detail.y;\n    }\n\n    var opacity = (y - this.options.top) / this.options.offset + this._A;\n    opacity = Math.min(Math.max(this._A, opacity), 1);\n    this._style.backgroundColor = 'rgba(' + this._R + ',' + this._G + ',' + this._B + ',' + opacity + ')';\n\n    if (opacity > this._A) {\n      this.element.classList.add(CLASS_ACTIVE);\n    } else {\n      this.element.classList.remove(CLASS_ACTIVE);\n    }\n\n    if (this.lastOpacity !== opacity) {\n      $.trigger(this.element, 'alpha', {\n        alpha: opacity\n      });\n      this.lastOpacity = opacity;\n    }\n  };\n\n  Transparent.prototype.destory = function () {\n    this.scrollByElem.removeEventListener('scroll', this._bufferFn);\n    this.scrollByElem.removeEventListener($.EVENT_MOVE, this._bufferFn);\n    this.element.style.backgroundColor = this._bgColor;\n    this.element.mui_plugin_transparent = null;\n  };\n\n  $.fn.transparent = function (options) {\n    options = options || {};\n    var transparentApis = [];\n    this.each(function () {\n      var transparentApi = this.mui_plugin_transparent;\n\n      if (!transparentApi) {\n        var top = this.getAttribute('data-top');\n        var offset = this.getAttribute('data-offset');\n        var duration = this.getAttribute('data-duration');\n        var scrollby = this.getAttribute('data-scrollby');\n\n        if (top !== null && typeof options.top === 'undefined') {\n          options.top = top;\n        }\n\n        if (offset !== null && typeof options.offset === 'undefined') {\n          options.offset = offset;\n        }\n\n        if (duration !== null && typeof options.duration === 'undefined') {\n          options.duration = duration;\n        }\n\n        if (scrollby !== null && typeof options.scrollby === 'undefined') {\n          options.scrollby = document.querySelector(scrollby) || window;\n        }\n\n        transparentApi = this.mui_plugin_transparent = new Transparent(this, options);\n      }\n\n      transparentApis.push(transparentApi);\n    });\n    return transparentApis.length === 1 ? transparentApis[0] : transparentApis;\n  };\n\n  $.ready(function () {\n    $('.mui-bar-transparent').transparent();\n  });\n})(mui, window);\n/**\r\n * 数字输入框\r\n * varstion 1.0.1\r\n * by Houfeng\r\n * Houfeng@DCloud.io\r\n */\n\n\n(function ($) {\n  var touchSupport = 'ontouchstart' in document;\n  var tapEventName = touchSupport ? 'tap' : 'click';\n  var changeEventName = 'change';\n  var holderClassName = 'mui-numbox';\n  var plusClassSelector = '.mui-btn-numbox-plus,.mui-numbox-btn-plus';\n  var minusClassSelector = '.mui-btn-numbox-minus,.mui-numbox-btn-minus';\n  var inputClassSelector = '.mui-input-numbox,.mui-numbox-input';\n  var Numbox = $.Numbox = $.Class.extend({\n    /**\r\n     * 构造函数\r\n     **/\n    init: function init(holder, options) {\n      var self = this;\n\n      if (!holder) {\n        throw \"构造 numbox 时缺少容器元素\";\n      }\n\n      self.holder = holder;\n      options = options || {};\n      options.step = parseInt(options.step || 1);\n      self.options = options;\n      self.input = $.qsa(inputClassSelector, self.holder)[0];\n      self.plus = $.qsa(plusClassSelector, self.holder)[0];\n      self.minus = $.qsa(minusClassSelector, self.holder)[0];\n      self.checkValue();\n      self.initEvent();\n    },\n\n    /**\r\n     * 初始化事件绑定\r\n     **/\n    initEvent: function initEvent() {\n      var self = this;\n      self.plus.addEventListener(tapEventName, function (event) {\n        var val = parseInt(self.input.value) + self.options.step;\n        self.input.value = val.toString();\n        $.trigger(self.input, changeEventName, null);\n      });\n      self.minus.addEventListener(tapEventName, function (event) {\n        var val = parseInt(self.input.value) - self.options.step;\n        self.input.value = val.toString();\n        $.trigger(self.input, changeEventName, null);\n      });\n      self.input.addEventListener(changeEventName, function (event) {\n        self.checkValue();\n        var val = parseInt(self.input.value); //触发顶层容器\n\n        $.trigger(self.holder, changeEventName, {\n          value: val\n        });\n      });\n    },\n\n    /**\r\n     * 获取当前值\r\n     **/\n    getValue: function getValue() {\n      var self = this;\n      return parseInt(self.input.value);\n    },\n\n    /**\r\n     * 验证当前值是法合法\r\n     **/\n    checkValue: function checkValue() {\n      var self = this;\n      var val = self.input.value;\n\n      if (val == null || val == '' || isNaN(val)) {\n        self.input.value = self.options.min || 0;\n        self.minus.disabled = self.options.min != null;\n      } else {\n        var val = parseInt(val);\n\n        if (self.options.max != null && !isNaN(self.options.max) && val >= parseInt(self.options.max)) {\n          val = self.options.max;\n          self.plus.disabled = true;\n        } else {\n          self.plus.disabled = false;\n        }\n\n        if (self.options.min != null && !isNaN(self.options.min) && val <= parseInt(self.options.min)) {\n          val = self.options.min;\n          self.minus.disabled = true;\n        } else {\n          self.minus.disabled = false;\n        }\n\n        self.input.value = val;\n      }\n    },\n\n    /**\r\n     * 更新选项\r\n     **/\n    setOption: function setOption(name, value) {\n      var self = this;\n      self.options[name] = value;\n    },\n\n    /**\r\n     * 动态设置新值\r\n     **/\n    setValue: function setValue(value) {\n      this.input.value = value;\n      this.checkValue();\n    }\n  });\n\n  $.fn.numbox = function (options) {\n    var instanceArray = []; //遍历选择的元素\n\n    this.each(function (i, element) {\n      if (element.numbox) {\n        return;\n      }\n\n      if (options) {\n        element.numbox = new Numbox(element, options);\n      } else {\n        var optionsText = element.getAttribute('data-numbox-options');\n        var options = optionsText ? JSON.parse(optionsText) : {};\n        options.step = element.getAttribute('data-numbox-step') || options.step;\n        options.min = element.getAttribute('data-numbox-min') || options.min;\n        options.max = element.getAttribute('data-numbox-max') || options.max;\n        element.numbox = new Numbox(element, options);\n      }\n    });\n    return this[0] ? this[0].numbox : null;\n  }; //自动处理 class='mui-locker' 的 dom\n\n\n  $.ready(function () {\n    $('.' + holderClassName).numbox();\n  });\n})(mui);\n/**\r\n * Button\r\n * @param {type} $\r\n * @param {type} window\r\n * @param {type} document\r\n * @returns {undefined}\r\n */\n\n\n(function ($, window, document) {\n  var CLASS_ICON = 'mui-icon';\n  var CLASS_DISABLED = 'mui-disabled';\n  var STATE_RESET = 'reset';\n  var STATE_LOADING = 'loading';\n  var defaultOptions = {\n    loadingText: 'Loading...',\n    //文案\n    loadingIcon: 'mui-spinner' + ' ' + 'mui-spinner-white',\n    //图标，可为空\n    loadingIconPosition: 'left' //图标所处位置，仅支持left|right\n\n  };\n\n  var Button = function Button(element, options) {\n    this.element = element;\n    this.options = $.extend({}, defaultOptions, options);\n\n    if (!this.options.loadingText) {\n      this.options.loadingText = defaultOptions.loadingText;\n    }\n\n    if (this.options.loadingIcon === null) {\n      this.options.loadingIcon = 'mui-spinner';\n\n      if ($.getStyles(this.element, 'color') === 'rgb(255, 255, 255)') {\n        this.options.loadingIcon += ' ' + 'mui-spinner-white';\n      }\n    }\n\n    this.isInput = this.element.tagName === 'INPUT';\n    this.resetHTML = this.isInput ? this.element.value : this.element.innerHTML;\n    this.state = '';\n  };\n\n  Button.prototype.loading = function () {\n    this.setState(STATE_LOADING);\n  };\n\n  Button.prototype.reset = function () {\n    this.setState(STATE_RESET);\n  };\n\n  Button.prototype.setState = function (state) {\n    if (this.state === state) {\n      return false;\n    }\n\n    this.state = state;\n\n    if (state === STATE_RESET) {\n      this.element.disabled = false;\n      this.element.classList.remove(CLASS_DISABLED);\n      this.setHtml(this.resetHTML);\n    } else if (state === STATE_LOADING) {\n      this.element.disabled = true;\n      this.element.classList.add(CLASS_DISABLED);\n      var html = this.isInput ? this.options.loadingText : '<span>' + this.options.loadingText + '</span>';\n\n      if (this.options.loadingIcon && !this.isInput) {\n        if (this.options.loadingIconPosition === 'right') {\n          html += '&nbsp;<span class=\"' + this.options.loadingIcon + '\"></span>';\n        } else {\n          html = '<span class=\"' + this.options.loadingIcon + '\"></span>&nbsp;' + html;\n        }\n      }\n\n      this.setHtml(html);\n    }\n  };\n\n  Button.prototype.setHtml = function (html) {\n    if (this.isInput) {\n      this.element.value = html;\n    } else {\n      this.element.innerHTML = html;\n    }\n  };\n\n  $.fn.button = function (state) {\n    var buttonApis = [];\n    this.each(function () {\n      var buttonApi = this.mui_plugin_button;\n\n      if (!buttonApi) {\n        var loadingText = this.getAttribute('data-loading-text');\n        var loadingIcon = this.getAttribute('data-loading-icon');\n        var loadingIconPosition = this.getAttribute('data-loading-icon-position');\n        this.mui_plugin_button = buttonApi = new Button(this, {\n          loadingText: loadingText,\n          loadingIcon: loadingIcon,\n          loadingIconPosition: loadingIconPosition\n        });\n      }\n\n      if (state === STATE_LOADING || state === STATE_RESET) {\n        buttonApi.setState(state);\n      }\n\n      buttonApis.push(buttonApi);\n    });\n    return buttonApis.length === 1 ? buttonApis[0] : buttonApis;\n  };\n})(mui, window, document);\n\nwindow.mui = mui;",{"version":3,"sources":["C:\\xampp\\htdocs\\xiuse_jie\\vue_cil\\src\\lib\\mui\\js\\mui.js"],"names":["mui","document","undefined","readyRE","idSelectorRE","classSelectorRE","tagSelectorRE","translateRE","translateMatrixRE","$","selector","context","wrap","isArrayLike","slice","call","ready","trim","test","found","getElementById","RegExp","$1","qsa","e","dom","Object","setPrototypeOf","fn","uuid","data","extend","options","name","src","copy","copyIsArray","clone","target","arguments","i","length","deep","isFunction","isPlainObject","isArray","noop","filter","type","obj","String","class2type","toString","Array","object","isWindow","window","isObject","getPrototypeOf","prototype","isEmptyObject","o","p","value","getElementsByClassName","getElementsByTagName","querySelectorAll","callback","readyState","addEventListener","buffer","ms","timer","lastStart","lastEnd","run","cancel","now","apply","later","stop","each","elements","hasOwnProperty","every","el","idx","key","focus","element","os","ios","setTimeout","trigger","eventType","eventData","dispatchEvent","CustomEvent","detail","bubbles","cancelable","getStyles","property","styles","ownerDocument","defaultView","getComputedStyle","getPropertyValue","parseTranslate","translateString","position","result","match","split","x","parseFloat","y","z","parseTranslateMatrix","matrix","is3D","push","hooks","addAction","hook","index","sort","a","b","doAction","handle","when","m","d","f","r","id","clearTimeout","Date","toLowerCase","JSON","parseJSON","parse","define","amd","detect","ua","funcs","wechat","version","replace","android","isBadAndroid","navigator","appVersion","iphone","ipad","func","userAgent","plus","body","classList","add","stream","isTouchable","EVENT_START","EVENT_MOVE","EVENT_END","EVENT_CANCEL","EVENT_CLICK","_mid","delegates","eventMethods","preventDefault","stopImmediatePropagation","stopPropagation","returnTrue","returnFalse","compatible","event","currentTarget","predicate","sourceMethod","mid","delegateFns","delegateFn","callbackObjs","handlerQueue","selectorAlls","parentNode","indexOf","disabled","contains","matches","callbacks","handlers","handler","tagName","gesture","isPropagationStopped","findDelegateFn","delegateCallbacks","filterFn","preventDefaultException","on","isAddEventListener","delegateEvents","delegateCallbackObjs","delegateFnArray","delegateCallback","href","off","splice","forEach","removeEventListener","bind","targets","targetHandles","registerTarget","founds","isFound","targetHandle","isContinue","isReset","proto","params","evt","createEvent","initEvent","Event","Function","to","partial","bound","args","concat","documentElement","defineProperty","HTMLElement","get","self","update","classes","className","join","ret","remove","toggle","item","requestAnimationFrame","lastTime","webkitRequestAnimationFrame","currTime","getTime","timeToCall","Math","max","cancelAnimationFrame","webkitCancelAnimationFrame","webkitCancelRequestAnimationFrame","FastClick","querySelector","targetElement","click","clickEvent","touch","activeElement","blur","changedTouches","initMouseEvent","screenX","screenY","clientX","clientY","forwardedTouchEvent","propagationStopped","CLASS_FOCUSIN","CLASS_BAR_TAB","CLASS_BAR_FOOTER","CLASS_BAR_FOOTER_SECONDARY","CLASS_BAR_FOOTER_SECONDARY_TAB","webview","currentWebview","children","readOnly","isFooter","scrollTop","scrollHeight","scrollLeft","scrollTo","namespace","classNamePrefix","classSelectorPrefix","classSelector","eventName","module","gestures","session","addGesture","round","abs","sqrt","atan","atan2","getDistance","p1","p2","props","getScale","starts","moves","getAngle","PI","getDirection","getRotation","start","end","getVelocity","deltaTime","stoped","gestureConfig","hasParent","node","parent","uniqueArray","results","values","val","sortUniqueArray","getMultiCenter","touches","touchesLength","pageX","pageY","multiTouch","pinch","copySimpleTouchData","timestamp","center","deltaX","deltaY","calDelta","offset","offsetDelta","prevDelta","prevTouch","calTouchData","firstTouch","firstMultiTouch","offsetCenter","angle","distance","offsetDirection","scale","rotation","calIntervalTouchData","CAL_INTERVAL","last","lastInterval","velocity","velocityX","velocityY","direction","v","targetIds","convertTouches","getTouches","allTouches","targetTouches","changedTargetTouches","identifier","sessionTarget","changedTouchesLength","isFirst","isFinal","handleTouchEvent","popover","tab","offcanvas","modal","isScrolling","scrollingTimeout","flickStartTime","flickStart","flick","flickMaxTime","flickMinDistince","flickTime","flickDistanceX","flickDistanceY","swipe","swipeMaxTime","swipeMinDistince","lockDirection","startDirection","drag","fingers","lastTarget","lastTapTime","tapMaxDistance","tapMaxTime","doubletap","tapMaxInterval","holdTimeout","holdThreshold","hold","lastScale","scaleDiff","minRotationAngle","global","tap","longtap","initGlobal","inits","init","isInit","repeat","addInit","subpages","createIframe","wrapper","createElement","top","bottom","style","iframe","url","appendChild","handleScroll","location","localStorage","getItem","onload","setInterval","_scrollTop","scrollY","setItem","osObj","classArray","defaultOptions","swipeBack","preloadPages","preloadLimit","keyEventBind","backbutton","menubutton","titleConfig","height","backgroundColor","bottomBorderColor","title","text","left","width","color","align","family","size","weight","fontSrc","back","image","base64Data","imgSrc","sprite","defaultShow","autoShow","duration","aniShow","extras","show","waitingOptions","showOptions","windowOptions","scalable","bounce","plusReady","fire","evalJS","stringify","receive","triggerPreload","preloaded","list","timeChecked","openWindow","webviewCache","nShow","nWaiting","webviews","getWebviewById","createNew","afterShowMethodName","Error","waitingConfig","waiting","nativeUI","showWaiting","createWindow","showWebview","close","openWindowWithTitle","tid","view","nativeObj","View","dock","drawRect","_b","parseInt","_title","drawText","_back","backClick","_backImage","right","bitmap","Bitmap","loadBase64Data","load","drawBitmap","setTouchEventRect","interceptTouchEvent","append","isCreate","preload","getURL","create","subpage","subpageId","subWebview","preloads","first","shift","closeAll","closeOpened","opened","len","openedWebview","open_open","createWindows","option","appendWebview","runtime","appid","statusBarBackground","setStatusBarBackground","display","supportStatusbarOffset","addBack","history","beforeback","action","_popover","offCanvas","previewImage","getPreviewImage","isShown","closePopup","__back__first","wobj","canBack","toast","quit","hide","menu","__back","__menu","pullRefreshOptions","pullRefresh","hasPulldown","down","hasPullup","up","container","$container","pullRefresh_native","__NWin_Enable__","upOptions","webviewId","downOptions","jsonType","htmlType","rscript","scriptTypeRE","xmlTypeRE","blankRE","ajaxSettings","beforeSend","success","error","complete","xhr","protocol","XMLHttpRequest","accepts","script","json","xml","html","timeout","processData","cache","ajaxBeforeSend","settings","ajaxSuccess","ajaxComplete","ajaxError","status","serialize","traditional","scope","array","hash","serializeData","contentType","headers","param","toUpperCase","appendQuery","query","mimeToDataType","mime","parseArguments","dataType","ajax","setHeader","nativeSetHeader","setRequestHeader","abortTimeout","mimeType","overrideMimeType","onreadystatechange","isLocal","responseText","getResponseHeader","eval","responseXML","statusText","abort","xhrFields","async","open","username","password","send","k","encodeURIComponent","post","getJSON","parts","response","div","innerHTML","selectorDiv","childs","originAnchor","crossDomain","net","urlAnchor","host","webkit","messageHandlers","box","getBoundingClientRect","pageYOffset","clientTop","pageXOffset","clientLeft","scroll","distaince","animationFrame","cb","isQueued","initializing","fnTest","xyz","Class","prop","_super","tmp","constructor","callee","CLASS_PULL_TOP_POCKET","CLASS_PULL_BOTTOM_POCKET","CLASS_PULL","CLASS_PULL_LOADING","CLASS_PULL_CAPTION","CLASS_PULL_CAPTION_DOWN","CLASS_PULL_CAPTION_REFRESH","CLASS_PULL_CAPTION_NOMORE","CLASS_ICON","CLASS_SPINNER","CLASS_ICON_PULLDOWN","CLASS_BLOCK","CLASS_HIDDEN","CLASS_VISIBILITY","CLASS_LOADING_UP","CLASS_LOADING_DOWN","CLASS_LOADING","pocketHtml","PullRefresh","scrollX","indicators","deceleration","contentinit","contentdown","contentover","contentrefresh","auto","contentnomore","_init","_initPocket","_initPulldownRefresh","pulldown","topPocket","pullPocket","pullCaption","topCaption","pullLoading","topLoading","_initPullupRefresh","bottomPocket","bottomCaption","bottomLoading","scroller","_createPocket","insertBefore","firstChild","clazz","iconClass","pocket","_resetPullDownLoading","loading","webkitTransition","webkitTransform","webkitAnimation","_setCaptionClass","isPulldown","caption","_setCaption","reset","lastTitle","CLASS_SCROLL","CLASS_SCROLLBAR","CLASS_INDICATOR","CLASS_SCROLLBAR_VERTICAL","CLASS_SCROLLBAR_HORIZONTAL","CLASS_ACTIVE","ease","quadratic","circular","outCirc","outCubic","Scroll","scrollerStyle","stopped","startX","startY","hardwareAccelerated","fixedBadAndorid","momentum","snapX","snap","bounceTime","bounceEasing","scrollTime","scrollEasing","directionLockThreshold","parallaxElement","parallaxRatio","translateZ","refresh","_initParallax","_initIndicators","_initEvent","parallaxStyle","parallaxHeight","offsetHeight","parallaxImgStyle","indicator","_createScrollBar","listenX","listenY","Indicator","_initSnap","currentPage","pages","snaps","n","leftX","rightX","offsetLeft","offsetWidth","_getSnapX","maxScrollX","min","wrapperWidth","_gotoPage","_nearestSnap","nearestX","detach","segmentedControl","_handleIndicatorScrollend","map","fade","_handleIndicatorScrollstart","_handleIndicatorRefresh","handleEvent","resetPosition","_start","_drag","_flick","_end","transitionTimer","_transitionEnd","_scrollend","_resize","moved","needReset","_transitionTime","isInTransition","pos","setTranslate","reLayout","_getDirectionByAngle","innerHeight","isPreventDefault","isReturn","absDeltaX","absDeltaY","hasHorizontalScroll","hasVerticalScroll","newX","newY","maxScrollY","_updateTranslate","_clearRequestAnimationFrame","time","easing","momentumX","_momentum","destination","momentumY","wrapperHeight","that","resizeTimeout","resizePolling","transitionTime","_transitionTimingFunction","transitionTimingFunction","_translate","lastX","lastY","scrollbar","scrollbarY","scrollbarIndicatorY","scrollbarX","scrollbarIndicatorX","_preventDefaultException","exceptions","_reLayout","scrollerWidth","scrollerHeight","items","itemLength","current","lowerMargin","wrapperSize","speed","_getTranslateStr","setStopped","parallaxY","updatePosition","paddingLeft","paddingRight","paddingTop","paddingBottom","clientWidth","clientHeight","_reInit","groups","scrollToBottom","gotoPage","destroy","getAttribute","setAttribute","wrapperStyle","indicatorStyle","speedRatioX","speedRatioY","sizeRatioX","sizeRatioY","maxPosX","maxPosY","opacity","indicatorWidth","minBoundaryX","maxBoundaryX","indicatorHeight","minBoundaryY","maxBoundaryY","visible","fadeTimeout","delay","scrollApis","scrollApi","_options","_scrollbottom","pullupLoading","pulldownLoading","endPulldownToRefresh","endPullupToRefresh","finished","disablePullupToRefresh","enablePullupToRefresh","pullRefreshApi","autoY","CLASS_SLIDER","CLASS_SLIDER_GROUP","CLASS_SLIDER_LOOP","CLASS_SLIDER_INDICATOR","CLASS_ACTION_PREVIOUS","CLASS_ACTION_NEXT","CLASS_SLIDER_ITEM","SELECTOR_SLIDER_ITEM","SELECTOR_SLIDER_INDICATOR","SELECTOR_SLIDER_PROGRESS_BAR","Slider","interval","slideTime","progressBar","progressBarWidth","progressBarStyle","_initTimer","_triggerSlide","page","slideNumber","_fixedSlideNumber","loop","lastSlideNumber","lastPage","_handleSlide","temps","_slideNumber","indicatorWrap","number","innerText","controlItems","_handleTabShow","gotoItem","tabNumber","_handleIndicatorTap","slidershowTimer","slider","nextItem","_getScroll","_getPage","isFlick","_gotoItem","prevItem","getSlideNumber","sliderElement","CLASS_PLUS_PULLREFRESH","PlusPullRefresh","_initPulldownRefreshEvent","scrollInterval","isScroll","setPullToRefresh","support","range","attrWebviewId","removeAttribute","setBounce","changeoffset","setStyle","beginPulldown","beginPullToRefresh","_pulldownLoading","childWebview","endPulldown","_wv","endPullToRefresh","_endPulldownToRefresh","beginPullup","isLoading","endPullup","CLASS_OFF_CANVAS_LEFT","CLASS_OFF_CANVAS_RIGHT","CLASS_ACTION_BACKDROP","CLASS_OFF_CANVAS_WRAP","CLASS_SLIDE_IN","CLASS_TRANSITIONING","SELECTOR_INNER_WRAP","OffCanvas","dragThresholdX","slideIn","offCanvasLefts","offCanvasRights","offCanvasLeft","offCanvasRight","offCanvasRightWidth","offCanvasLeftWidth","offCanvasLeftSlideIn","offCanvasRightSlideIn","backdrop","offsetX","lastTranslateX","_dispatchEvent","isDragging","offCanvasWidth","getTranslateX","_initOffCanvasVisible","updateTranslate","ratio","openPercentage","visibility","percentage","setTranslateX","leftShowing","rightShowing","zIndex","percent","zoomOutScale","zoomInScale","zoomOutOpacity","zoomInOpacity","webkitTransformOrigin","shown","directionOrOffCanvas","findOffCanvasContainer","_container","offCanvasApis","offCanvasApi","CLASS_ACTION","CLASS_MODAL","CLASS_POPOVER","CLASS_POPOVER_ARROW","CLASS_ACTION_POPOVER","CLASS_BACKDROP","CLASS_BAR_POPOVER","CLASS_BAR_BACKDROP","CLASS_BOTTOM","onPopoverShown","onPopoverHidden","removeBackdrop","removeBackdropTimer","removeChild","togglePopover","anchor","state","isActionSheet","calPosition","wWidth","innerWidth","wHeight","pWidth","pHeight","aWidth","aHeight","arrow","arrowSize","pTop","pLeft","diff","arrowLeft","defaultPadding","createMask","mask","_show","_remove","CLASS_CONTROL_ITEM","CLASS_SEGMENTED_CONTROL","CLASS_SEGMENTED_CONTROL_VERTICAL","CLASS_CONTROL_CONTENT","CLASS_TAB_BAR","CLASS_TAB_ITEM","targetTab","activeTab","activeBodies","targetBody","isLastActive","activeBody","contents","_contents","CLASS_SWITCH","CLASS_SWITCH_HANDLE","CLASS_DRAGGING","CLASS_DISABLED","SELECTOR_SWITCH_HANDLE","Toggle","toggleWidth","handleWidth","handleX","swiperight","webkitTransitionDuration","lastChanged","initialState","isActive","animate","isChanged","switchApis","switchApi","CLASS_SELECTED","CLASS_GRID_VIEW","CLASS_RADIO_VIEW","CLASS_TABLE_VIEW_CELL","CLASS_COLLAPSE_CONTENT","CLASS_TOGGLE","CLASS_BTN","CLASS_SLIDER_HANDLE","CLASS_SLIDER_LEFT","CLASS_SLIDER_RIGHT","SELECTOR_SLIDER_HANDLE","SELECTOR_SLIDER_LEFT","SELECTOR_SLIDER_RIGHT","SELECTOR_SELECTED","SELECTOR_BUTTON","overFactor","cell","isMoved","isOpened","openedActions","progress","sliderHandle","sliderActionLeft","sliderActionRight","buttonsLeft","buttonsRight","sliderDirection","sliderRequestAnimationFrame","translateX","sliderActionLeftWidth","sliderActionRightWidth","toggleActive","pow","buttonRight","_buttonOffset","buttonOffset","buttonLeft","isDisabled","selected","swipeoutClose","link","toggleEvents","dragend","swipeleft","translate","actionsWidth","isToggle","buttons","newTranslate","button","isRemove","method","swipeoutOpen","swipeoutAction","swipeoutWidth","radioOrCheckboxClick","input","checked","isExpand","ul","collapse","alert","message","btnValue","confirm","btnArray","prompt","defaultText","durations","verticalAlign","isVisible","CLASS_POPUP","CLASS_POPUP_BACKDROP","CLASS_POPUP_IN","CLASS_POPUP_OUT","CLASS_POPUP_INNER","CLASS_POPUP_TITLE","CLASS_POPUP_TEXT","CLASS_POPUP_INPUT","CLASS_POPUP_BUTTONS","CLASS_POPUP_BUTTON","CLASS_POPUP_BUTTON_BOLD","popupStack","createInput","placeholder","createInner","extra","createButtons","btns","createPopup","popupElement","removePopupElement","popup","pop","createAlert","createConfirm","createPrompt","closePopups","CLASS_PROGRESSBAR","CLASS_PROGRESSBAR_IN","CLASS_PROGRESSBAR_OUT","CLASS_PROGRESSBAR_INFINITE","SELECTOR_PROGRESSBAR","_findProgressbar","progressbars","progressbar","showProgressbar","_progressbar","setProgressbar","hideProgressbar","span","progressbarApis","progressbarApi","mui_plugin_progressbar","setOptions","setProgress","CLASS_ICON_CLEAR","CLASS_ICON_SPEECH","CLASS_ICON_SEARCH","CLASS_ICON_PASSWORD","CLASS_INPUT_ROW","CLASS_PLACEHOLDER","CLASS_TOOLTIP","SELECTOR_ICON_CLOSE","SELECTOR_ICON_SPEECH","SELECTOR_ICON_PASSWORD","SELECTOR_PLACEHOLDER","SELECTOR_TOOLTIP","findRow","Input","actions","sliderActionClass","sliderActionSelector","clearActionClass","clearActionSelector","speechActionClass","speechActionSelector","searchActionClass","searchActionSelector","passwordActionClass","passwordActionSelector","initAction","initElementEvent","row","sliderAction","createAction","searchAction","speechAction","speechActionClick","clearAction","clearActionClick","passwordAction","passwordActionClick","actionClass","actionSelector","nextSibling","tooltip","showTip","tooltipWidth","distince","scaleWidth","setPlaceholder","oldValue","speech","startRecognize","engine","s","stopRecognize","inputApis","inputApi","rgbaRegex","getColor","colorStr","Transparent","scrollby","scrollByElem","isNativeScroll","_style","_bgColor","_R","_G","_B","_A","lastOpacity","_bufferFn","alpha","destory","mui_plugin_transparent","transparent","transparentApis","transparentApi","touchSupport","tapEventName","changeEventName","holderClassName","plusClassSelector","minusClassSelector","inputClassSelector","Numbox","holder","step","minus","checkValue","getValue","isNaN","setOption","setValue","numbox","instanceArray","optionsText","STATE_RESET","STATE_LOADING","loadingText","loadingIcon","loadingIconPosition","Button","isInput","resetHTML","setState","setHtml","buttonApis","buttonApi","mui_plugin_button"],"mappings":"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","sourcesContent":["/*!\r\n * =====================================================\r\n * Mui v3.7.0 (http://dev.dcloud.net.cn/mui)\r\n * =====================================================\r\n */\r\n/**\r\n * MUI核心JS\r\n * @type _L4.$|Function\r\n */\r\nvar mui = (function(document, undefined) {\r\n\tvar readyRE = /complete|loaded|interactive/;\r\n\tvar idSelectorRE = /^#([\\w-]+)$/;\r\n\tvar classSelectorRE = /^\\.([\\w-]+)$/;\r\n\tvar tagSelectorRE = /^[\\w-]+$/;\r\n\tvar translateRE = /translate(?:3d)?\\((.+?)\\)/;\r\n\tvar translateMatrixRE = /matrix(3d)?\\((.+?)\\)/;\r\n\r\n\tvar $ = function(selector, context) {\r\n\t\tcontext = context || document;\r\n\t\tif (!selector)\r\n\t\t\treturn wrap();\r\n\t\tif (typeof selector === 'object')\r\n\t\t\tif ($.isArrayLike(selector)) {\r\n\t\t\t\treturn wrap($.slice.call(selector), null);\r\n\t\t\t} else {\r\n\t\t\t\treturn wrap([selector], null);\r\n\t\t\t}\r\n\t\tif (typeof selector === 'function')\r\n\t\t\treturn $.ready(selector);\r\n\t\tif (typeof selector === 'string') {\r\n\t\t\ttry {\r\n\t\t\t\tselector = selector.trim();\r\n\t\t\t\tif (idSelectorRE.test(selector)) {\r\n\t\t\t\t\tvar found = document.getElementById(RegExp.$1);\r\n\t\t\t\t\treturn wrap(found ? [found] : []);\r\n\t\t\t\t}\r\n\t\t\t\treturn wrap($.qsa(selector, context), selector);\r\n\t\t\t} catch (e) {}\r\n\t\t}\r\n\t\treturn wrap();\r\n\t};\r\n\r\n\tvar wrap = function(dom, selector) {\r\n\t\tdom = dom || [];\r\n\t\tObject.setPrototypeOf(dom, $.fn);\r\n\t\tdom.selector = selector || '';\r\n\t\treturn dom;\r\n\t};\r\n\r\n\t$.uuid = 0;\r\n\r\n\t$.data = {};\r\n\t/**\r\n\t * extend(simple)\r\n\t * @param {type} target\r\n\t * @param {type} source\r\n\t * @param {type} deep\r\n\t * @returns {unresolved}\r\n\t */\r\n\t$.extend = function() { //from jquery2\r\n\t\tvar options, name, src, copy, copyIsArray, clone,\r\n\t\t\ttarget = arguments[0] || {},\r\n\t\t\ti = 1,\r\n\t\t\tlength = arguments.length,\r\n\t\t\tdeep = false;\r\n\r\n\t\tif (typeof target === \"boolean\") {\r\n\t\t\tdeep = target;\r\n\r\n\t\t\ttarget = arguments[i] || {};\r\n\t\t\ti++;\r\n\t\t}\r\n\r\n\t\tif (typeof target !== \"object\" && !$.isFunction(target)) {\r\n\t\t\ttarget = {};\r\n\t\t}\r\n\r\n\t\tif (i === length) {\r\n\t\t\ttarget = this;\r\n\t\t\ti--;\r\n\t\t}\r\n\r\n\t\tfor (; i < length; i++) {\r\n\t\t\tif ((options = arguments[i]) != null) {\r\n\t\t\t\tfor (name in options) {\r\n\t\t\t\t\tsrc = target[name];\r\n\t\t\t\t\tcopy = options[name];\r\n\r\n\t\t\t\t\tif (target === copy) {\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (deep && copy && ($.isPlainObject(copy) || (copyIsArray = $.isArray(copy)))) {\r\n\t\t\t\t\t\tif (copyIsArray) {\r\n\t\t\t\t\t\t\tcopyIsArray = false;\r\n\t\t\t\t\t\t\tclone = src && $.isArray(src) ? src : [];\r\n\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tclone = src && $.isPlainObject(src) ? src : {};\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\ttarget[name] = $.extend(deep, clone, copy);\r\n\r\n\t\t\t\t\t} else if (copy !== undefined) {\r\n\t\t\t\t\t\ttarget[name] = copy;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn target;\r\n\t};\r\n\t/**\r\n\t * mui noop(function)\r\n\t */\r\n\t$.noop = function() {};\r\n\t/**\r\n\t * mui slice(array)\r\n\t */\r\n\t$.slice = [].slice;\r\n\t/**\r\n\t * mui filter(array)\r\n\t */\r\n\t$.filter = [].filter;\r\n\r\n\t$.type = function(obj) {\r\n\t\treturn obj == null ? String(obj) : class2type[{}.toString.call(obj)] || \"object\";\r\n\t};\r\n\t/**\r\n\t * mui isArray\r\n\t */\r\n\t$.isArray = Array.isArray ||\r\n\t\tfunction(object) {\r\n\t\t\treturn object instanceof Array;\r\n\t\t};\r\n\t/**\r\n\t * mui isArrayLike \r\n\t * @param {Object} obj\r\n\t */\r\n\t$.isArrayLike = function(obj) {\r\n\t\tvar length = !!obj && \"length\" in obj && obj.length;\r\n\t\tvar type = $.type(obj);\r\n\t\tif (type === \"function\" || $.isWindow(obj)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn type === \"array\" || length === 0 ||\r\n\t\t\ttypeof length === \"number\" && length > 0 && (length - 1) in obj;\r\n\t};\r\n\t/**\r\n\t * mui isWindow(需考虑obj为undefined的情况)\r\n\t */\r\n\t$.isWindow = function(obj) {\r\n\t\treturn obj != null && obj === obj.window;\r\n\t};\r\n\t/**\r\n\t * mui isObject\r\n\t */\r\n\t$.isObject = function(obj) {\r\n\t\treturn $.type(obj) === \"object\";\r\n\t};\r\n\t/**\r\n\t * mui isPlainObject\r\n\t */\r\n\t$.isPlainObject = function(obj) {\r\n\t\treturn $.isObject(obj) && !$.isWindow(obj) && Object.getPrototypeOf(obj) === Object.prototype;\r\n\t};\r\n\t/**\r\n\t * mui isEmptyObject\r\n\t * @param {Object} o\r\n\t */\r\n\t$.isEmptyObject = function(o) {\r\n\t\tfor (var p in o) {\r\n\t\t\tif (p !== undefined) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn true;\r\n\t};\r\n\t/**\r\n\t * mui isFunction\r\n\t */\r\n\t$.isFunction = function(value) {\r\n\t\treturn $.type(value) === \"function\";\r\n\t};\r\n\t/**\r\n\t * mui querySelectorAll\r\n\t * @param {type} selector\r\n\t * @param {type} context\r\n\t * @returns {Array}\r\n\t */\r\n\t$.qsa = function(selector, context) {\r\n\t\tcontext = context || document;\r\n\t\treturn $.slice.call(classSelectorRE.test(selector) ? context.getElementsByClassName(RegExp.$1) : tagSelectorRE.test(selector) ? context.getElementsByTagName(selector) : context.querySelectorAll(selector));\r\n\t};\r\n\t/**\r\n\t * ready(DOMContentLoaded)\r\n\t * @param {type} callback\r\n\t * @returns {_L6.$}\r\n\t */\r\n\t$.ready = function(callback) {\r\n\t\tif (readyRE.test(document.readyState)) {\r\n\t\t\tcallback($);\r\n\t\t} else {\r\n\t\t\tdocument.addEventListener('DOMContentLoaded', function() {\r\n\t\t\t\tcallback($);\r\n\t\t\t}, false);\r\n\t\t}\r\n\t\treturn this;\r\n\t};\r\n\t/**\r\n\t * 将 fn 缓存一段时间后, 再被调用执行\r\n\t * 此方法为了避免在 ms 段时间内, 执行 fn 多次. 常用于 resize , scroll , mousemove 等连续性事件中;\r\n\t * 当 ms 设置为 -1, 表示立即执行 fn, 即和直接调用 fn 一样;\r\n\t * 调用返回函数的 stop 停止最后一次的 buffer 效果\r\n\t * @param {Object} fn\r\n\t * @param {Object} ms\r\n\t * @param {Object} context\r\n\t */\r\n\t$.buffer = function(fn, ms, context) {\r\n\t\tvar timer;\r\n\t\tvar lastStart = 0;\r\n\t\tvar lastEnd = 0;\r\n\t\tvar ms = ms || 150;\r\n\r\n\t\tfunction run() {\r\n\t\t\tif (timer) {\r\n\t\t\t\ttimer.cancel();\r\n\t\t\t\ttimer = 0;\r\n\t\t\t}\r\n\t\t\tlastStart = $.now();\r\n\t\t\tfn.apply(context || this, arguments);\r\n\t\t\tlastEnd = $.now();\r\n\t\t}\r\n\r\n\t\treturn $.extend(function() {\r\n\t\t\tif (\r\n\t\t\t\t(!lastStart) || // 从未运行过\r\n\t\t\t\t(lastEnd >= lastStart && $.now() - lastEnd > ms) || // 上次运行成功后已经超过ms毫秒\r\n\t\t\t\t(lastEnd < lastStart && $.now() - lastStart > ms * 8) // 上次运行或未完成，后8*ms毫秒\r\n\t\t\t) {\r\n\t\t\t\trun.apply(this, arguments);\r\n\t\t\t} else {\r\n\t\t\t\tif (timer) {\r\n\t\t\t\t\ttimer.cancel();\r\n\t\t\t\t}\r\n\t\t\t\ttimer = $.later(run, ms, null, $.slice.call(arguments));\r\n\t\t\t}\r\n\t\t}, {\r\n\t\t\tstop: function() {\r\n\t\t\t\tif (timer) {\r\n\t\t\t\t\ttimer.cancel();\r\n\t\t\t\t\ttimer = 0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\t/**\r\n\t * each\r\n\t * @param {type} elements\r\n\t * @param {type} callback\r\n\t * @returns {_L8.$}\r\n\t */\r\n\t$.each = function(elements, callback, hasOwnProperty) {\r\n\t\tif (!elements) {\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\tif (typeof elements.length === 'number') {\r\n\t\t\t[].every.call(elements, function(el, idx) {\r\n\t\t\t\treturn callback.call(el, idx, el) !== false;\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tfor (var key in elements) {\r\n\t\t\t\tif (hasOwnProperty) {\r\n\t\t\t\t\tif (elements.hasOwnProperty(key)) {\r\n\t\t\t\t\t\tif (callback.call(elements[key], key, elements[key]) === false) return elements;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (callback.call(elements[key], key, elements[key]) === false) return elements;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn this;\r\n\t};\r\n\t$.focus = function(element) {\r\n\t\tif ($.os.ios) {\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\telement.focus();\r\n\t\t\t}, 10);\r\n\t\t} else {\r\n\t\t\telement.focus();\r\n\t\t}\r\n\t};\r\n\t/**\r\n\t * trigger event\r\n\t * @param {type} element\r\n\t * @param {type} eventType\r\n\t * @param {type} eventData\r\n\t * @returns {_L8.$}\r\n\t */\r\n\t$.trigger = function(element, eventType, eventData) {\r\n\t\telement.dispatchEvent(new CustomEvent(eventType, {\r\n\t\t\tdetail: eventData,\r\n\t\t\tbubbles: true,\r\n\t\t\tcancelable: true\r\n\t\t}));\r\n\t\treturn this;\r\n\t};\r\n\t/**\r\n\t * getStyles\r\n\t * @param {type} element\r\n\t * @param {type} property\r\n\t * @returns {styles}\r\n\t */\r\n\t$.getStyles = function(element, property) {\r\n\t\tvar styles = element.ownerDocument.defaultView.getComputedStyle(element, null);\r\n\t\tif (property) {\r\n\t\t\treturn styles.getPropertyValue(property) || styles[property];\r\n\t\t}\r\n\t\treturn styles;\r\n\t};\r\n\t/**\r\n\t * parseTranslate\r\n\t * @param {type} translateString\r\n\t * @param {type} position\r\n\t * @returns {Object}\r\n\t */\r\n\t$.parseTranslate = function(translateString, position) {\r\n\t\tvar result = translateString.match(translateRE || '');\r\n\t\tif (!result || !result[1]) {\r\n\t\t\tresult = ['', '0,0,0'];\r\n\t\t}\r\n\t\tresult = result[1].split(\",\");\r\n\t\tresult = {\r\n\t\t\tx: parseFloat(result[0]),\r\n\t\t\ty: parseFloat(result[1]),\r\n\t\t\tz: parseFloat(result[2])\r\n\t\t};\r\n\t\tif (position && result.hasOwnProperty(position)) {\r\n\t\t\treturn result[position];\r\n\t\t}\r\n\t\treturn result;\r\n\t};\r\n\t/**\r\n\t * parseTranslateMatrix\r\n\t * @param {type} translateString\r\n\t * @param {type} position\r\n\t * @returns {Object}\r\n\t */\r\n\t$.parseTranslateMatrix = function(translateString, position) {\r\n\t\tvar matrix = translateString.match(translateMatrixRE);\r\n\t\tvar is3D = matrix && matrix[1];\r\n\t\tif (matrix) {\r\n\t\t\tmatrix = matrix[2].split(\",\");\r\n\t\t\tif (is3D === \"3d\")\r\n\t\t\t\tmatrix = matrix.slice(12, 15);\r\n\t\t\telse {\r\n\t\t\t\tmatrix.push(0);\r\n\t\t\t\tmatrix = matrix.slice(4, 7);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tmatrix = [0, 0, 0];\r\n\t\t}\r\n\t\tvar result = {\r\n\t\t\tx: parseFloat(matrix[0]),\r\n\t\t\ty: parseFloat(matrix[1]),\r\n\t\t\tz: parseFloat(matrix[2])\r\n\t\t};\r\n\t\tif (position && result.hasOwnProperty(position)) {\r\n\t\t\treturn result[position];\r\n\t\t}\r\n\t\treturn result;\r\n\t};\r\n\t$.hooks = {};\r\n\t$.addAction = function(type, hook) {\r\n\t\tvar hooks = $.hooks[type];\r\n\t\tif (!hooks) {\r\n\t\t\thooks = [];\r\n\t\t}\r\n\t\thook.index = hook.index || 1000;\r\n\t\thooks.push(hook);\r\n\t\thooks.sort(function(a, b) {\r\n\t\t\treturn a.index - b.index;\r\n\t\t});\r\n\t\t$.hooks[type] = hooks;\r\n\t\treturn $.hooks[type];\r\n\t};\r\n\t$.doAction = function(type, callback) {\r\n\t\tif ($.isFunction(callback)) { //指定了callback\r\n\t\t\t$.each($.hooks[type], callback);\r\n\t\t} else { //未指定callback，直接执行\r\n\t\t\t$.each($.hooks[type], function(index, hook) {\r\n\t\t\t\treturn !hook.handle();\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\t/**\r\n\t * setTimeout封装\r\n\t * @param {Object} fn\r\n\t * @param {Object} when\r\n\t * @param {Object} context\r\n\t * @param {Object} data\r\n\t */\r\n\t$.later = function(fn, when, context, data) {\r\n\t\twhen = when || 0;\r\n\t\tvar m = fn;\r\n\t\tvar d = data;\r\n\t\tvar f;\r\n\t\tvar r;\r\n\r\n\t\tif (typeof fn === 'string') {\r\n\t\t\tm = context[fn];\r\n\t\t}\r\n\r\n\t\tf = function() {\r\n\t\t\tm.apply(context, $.isArray(d) ? d : [d]);\r\n\t\t};\r\n\r\n\t\tr = setTimeout(f, when);\r\n\r\n\t\treturn {\r\n\t\t\tid: r,\r\n\t\t\tcancel: function() {\r\n\t\t\t\tclearTimeout(r);\r\n\t\t\t}\r\n\t\t};\r\n\t};\r\n\t$.now = Date.now || function() {\r\n\t\treturn +new Date();\r\n\t};\r\n\tvar class2type = {};\r\n\t$.each(['Boolean', 'Number', 'String', 'Function', 'Array', 'Date', 'RegExp', 'Object', 'Error'], function(i, name) {\r\n\t\tclass2type[\"[object \" + name + \"]\"] = name.toLowerCase();\r\n\t});\r\n\tif (window.JSON) {\r\n\t\t$.parseJSON = JSON.parse;\r\n\t}\r\n\t/**\r\n\t * $.fn\r\n\t */\r\n\t$.fn = {\r\n\t\teach: function(callback) {\r\n\t\t\t[].every.call(this, function(el, idx) {\r\n\t\t\t\treturn callback.call(el, idx, el) !== false;\r\n\t\t\t});\r\n\t\t\treturn this;\r\n\t\t}\r\n\t};\r\n\r\n\t/**\r\n\t * 兼容 AMD 模块\r\n\t **/\r\n\tif (typeof define === 'function' && define.amd) {\r\n\t\tdefine('mui', [], function() {\r\n\t\t\treturn $;\r\n\t\t});\r\n\t}\r\n\r\n\treturn $;\r\n})(document);\r\n//window.mui = mui;\r\n//'$' in window || (window.$ = mui);\r\n/**\r\n * $.os\r\n * @param {type} $\r\n * @returns {undefined}\r\n */\r\n(function($, window) {\r\n\tfunction detect(ua) {\r\n\t\tthis.os = {};\r\n\t\tvar funcs = [\r\n\r\n\t\t\tfunction() { //wechat\r\n\t\t\t\tvar wechat = ua.match(/(MicroMessenger)\\/([\\d\\.]+)/i);\r\n\t\t\t\tif (wechat) { //wechat\r\n\t\t\t\t\tthis.os.wechat = {\r\n\t\t\t\t\t\tversion: wechat[2].replace(/_/g, '.')\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\tfunction() { //android\r\n\t\t\t\tvar android = ua.match(/(Android);?[\\s\\/]+([\\d.]+)?/);\r\n\t\t\t\tif (android) {\r\n\t\t\t\t\tthis.os.android = true;\r\n\t\t\t\t\tthis.os.version = android[2];\r\n\r\n\t\t\t\t\tthis.os.isBadAndroid = !(/Chrome\\/\\d/.test(window.navigator.appVersion));\r\n\t\t\t\t}\r\n\t\t\t\treturn this.os.android === true;\r\n\t\t\t},\r\n\t\t\tfunction() { //ios\r\n\t\t\t\tvar iphone = ua.match(/(iPhone\\sOS)\\s([\\d_]+)/);\r\n\t\t\t\tif (iphone) { //iphone\r\n\t\t\t\t\tthis.os.ios = this.os.iphone = true;\r\n\t\t\t\t\tthis.os.version = iphone[2].replace(/_/g, '.');\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar ipad = ua.match(/(iPad).*OS\\s([\\d_]+)/);\r\n\t\t\t\t\tif (ipad) { //ipad\r\n\t\t\t\t\t\tthis.os.ios = this.os.ipad = true;\r\n\t\t\t\t\t\tthis.os.version = ipad[2].replace(/_/g, '.');\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn this.os.ios === true;\r\n\t\t\t}\r\n\t\t];\r\n\t\t[].every.call(funcs, function(func) {\r\n\t\t\treturn !func.call($);\r\n\t\t});\r\n\t}\r\n\tdetect.call($, navigator.userAgent);\r\n})(mui, window);\r\n/**\r\n * $.os.plus\r\n * @param {type} $\r\n * @returns {undefined}\r\n */\r\n(function($, document) {\r\n\tfunction detect(ua) {\r\n\t\tthis.os = this.os || {};\r\n\t\tvar plus = ua.match(/Html5Plus/i); //TODO 5\\+Browser?\r\n\t\tif (plus) {\r\n\t\t\tthis.os.plus = true;\r\n\t\t\t$(function() {\r\n\t\t\t\tdocument.body.classList.add('mui-plus');\r\n\t\t\t});\r\n\t\t\tif (ua.match(/StreamApp/i)) { //TODO 最好有流应用自己的标识\r\n\t\t\t\tthis.os.stream = true;\r\n\t\t\t\t$(function() {\r\n\t\t\t\t\tdocument.body.classList.add('mui-plus-stream');\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tdetect.call($, navigator.userAgent);\r\n})(mui, document);\r\n/**\r\n * 仅提供简单的on，off(仅支持事件委托，不支持当前元素绑定，当前元素绑定请直接使用addEventListener,removeEventListener)\r\n * @param {Object} $\r\n */\r\n(function($) {\r\n\tif ('ontouchstart' in window) {\r\n\t\t$.isTouchable = true;\r\n\t\t$.EVENT_START = 'touchstart';\r\n\t\t$.EVENT_MOVE = 'touchmove';\r\n\t\t$.EVENT_END = 'touchend';\r\n\t} else {\r\n\t\t$.isTouchable = false;\r\n\t\t$.EVENT_START = 'mousedown';\r\n\t\t$.EVENT_MOVE = 'mousemove';\r\n\t\t$.EVENT_END = 'mouseup';\r\n\t}\r\n\t$.EVENT_CANCEL = 'touchcancel';\r\n\t$.EVENT_CLICK = 'click';\r\n\r\n\tvar _mid = 1;\r\n\tvar delegates = {};\r\n\t//需要wrap的函数\r\n\tvar eventMethods = {\r\n\t\tpreventDefault: 'isDefaultPrevented',\r\n\t\tstopImmediatePropagation: 'isImmediatePropagationStopped',\r\n\t\tstopPropagation: 'isPropagationStopped'\r\n\t};\r\n\t//默认true返回函数\r\n\tvar returnTrue = function() {\r\n\t\treturn true\r\n\t};\r\n\t//默认false返回函数\r\n\tvar returnFalse = function() {\r\n\t\treturn false\r\n\t};\r\n\t//wrap浏览器事件\r\n\tvar compatible = function(event, target) {\r\n\t\tif (!event.detail) {\r\n\t\t\tevent.detail = {\r\n\t\t\t\tcurrentTarget: target\r\n\t\t\t};\r\n\t\t} else {\r\n\t\t\tevent.detail.currentTarget = target;\r\n\t\t}\r\n\t\t$.each(eventMethods, function(name, predicate) {\r\n\t\t\tvar sourceMethod = event[name];\r\n\t\t\tevent[name] = function() {\r\n\t\t\t\tthis[predicate] = returnTrue;\r\n\t\t\t\treturn sourceMethod && sourceMethod.apply(event, arguments)\r\n\t\t\t}\r\n\t\t\tevent[predicate] = returnFalse;\r\n\t\t}, true);\r\n\t\treturn event;\r\n\t};\r\n\t//简单的wrap对象_mid\r\n\tvar mid = function(obj) {\r\n\t\treturn obj && (obj._mid || (obj._mid = _mid++));\r\n\t};\r\n\t//事件委托对象绑定的事件回调列表\r\n\tvar delegateFns = {};\r\n\t//返回事件委托的wrap事件回调\r\n\tvar delegateFn = function(element, event, selector, callback) {\r\n\t\treturn function(e) {\r\n\t\t\t//same event\r\n\t\t\tvar callbackObjs = delegates[element._mid][event];\r\n\t\t\tvar handlerQueue = [];\r\n\t\t\tvar target = e.target;\r\n\t\t\tvar selectorAlls = {};\r\n\t\t\tfor (; target && target !== document; target = target.parentNode) {\r\n\t\t\t\tif (target === element) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tif (~['click', 'tap', 'doubletap', 'longtap', 'hold'].indexOf(event) && (target.disabled || target.classList.contains('mui-disabled'))) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tvar matches = {};\r\n\t\t\t\t$.each(callbackObjs, function(selector, callbacks) { //same selector\r\n\t\t\t\t\tselectorAlls[selector] || (selectorAlls[selector] = $.qsa(selector, element));\r\n\t\t\t\t\tif (selectorAlls[selector] && ~(selectorAlls[selector]).indexOf(target)) {\r\n\t\t\t\t\t\tif (!matches[selector]) {\r\n\t\t\t\t\t\t\tmatches[selector] = callbacks;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}, true);\r\n\t\t\t\tif (!$.isEmptyObject(matches)) {\r\n\t\t\t\t\thandlerQueue.push({\r\n\t\t\t\t\t\telement: target,\r\n\t\t\t\t\t\thandlers: matches\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tselectorAlls = null;\r\n\t\t\te = compatible(e); //compatible event\r\n\t\t\t$.each(handlerQueue, function(index, handler) {\r\n\t\t\t\ttarget = handler.element;\r\n\t\t\t\tvar tagName = target.tagName;\r\n\t\t\t\tif (event === 'tap' && (tagName !== 'INPUT' && tagName !== 'TEXTAREA' && tagName !== 'SELECT')) {\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\te.detail && e.detail.gesture && e.detail.gesture.preventDefault();\r\n\t\t\t\t}\r\n\t\t\t\t$.each(handler.handlers, function(index, handler) {\r\n\t\t\t\t\t$.each(handler, function(index, callback) {\r\n\t\t\t\t\t\tif (callback.call(target, e) === false) {\r\n\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, true);\r\n\t\t\t\t}, true)\r\n\t\t\t\tif (e.isPropagationStopped()) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}, true);\r\n\t\t};\r\n\t};\r\n\tvar findDelegateFn = function(element, event) {\r\n\t\tvar delegateCallbacks = delegateFns[mid(element)];\r\n\t\tvar result = [];\r\n\t\tif (delegateCallbacks) {\r\n\t\t\tresult = [];\r\n\t\t\tif (event) {\r\n\t\t\t\tvar filterFn = function(fn) {\r\n\t\t\t\t\treturn fn.type === event;\r\n\t\t\t\t}\r\n\t\t\t\treturn delegateCallbacks.filter(filterFn);\r\n\t\t\t} else {\r\n\t\t\t\tresult = delegateCallbacks;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t};\r\n\tvar preventDefaultException = /^(INPUT|TEXTAREA|BUTTON|SELECT)$/;\r\n\t/**\r\n\t * mui delegate events\r\n\t * @param {type} event\r\n\t * @param {type} selector\r\n\t * @param {type} callback\r\n\t * @returns {undefined}\r\n\t */\r\n\t$.fn.on = function(event, selector, callback) { //仅支持简单的事件委托,主要是tap事件使用，类似mouse,focus之类暂不封装支持\r\n\t\treturn this.each(function() {\r\n\t\t\tvar element = this;\r\n\t\t\tmid(element);\r\n\t\t\tmid(callback);\r\n\t\t\tvar isAddEventListener = false;\r\n\t\t\tvar delegateEvents = delegates[element._mid] || (delegates[element._mid] = {});\r\n\t\t\tvar delegateCallbackObjs = delegateEvents[event] || ((delegateEvents[event] = {}));\r\n\t\t\tif ($.isEmptyObject(delegateCallbackObjs)) {\r\n\t\t\t\tisAddEventListener = true;\r\n\t\t\t}\r\n\t\t\tvar delegateCallbacks = delegateCallbackObjs[selector] || (delegateCallbackObjs[selector] = []);\r\n\t\t\tdelegateCallbacks.push(callback);\r\n\t\t\tif (isAddEventListener) {\r\n\t\t\t\tvar delegateFnArray = delegateFns[mid(element)];\r\n\t\t\t\tif (!delegateFnArray) {\r\n\t\t\t\t\tdelegateFnArray = [];\r\n\t\t\t\t}\r\n\t\t\t\tvar delegateCallback = delegateFn(element, event, selector, callback);\r\n\t\t\t\tdelegateFnArray.push(delegateCallback);\r\n\t\t\t\tdelegateCallback.i = delegateFnArray.length - 1;\r\n\t\t\t\tdelegateCallback.type = event;\r\n\t\t\t\tdelegateFns[mid(element)] = delegateFnArray;\r\n\t\t\t\telement.addEventListener(event, delegateCallback);\r\n\t\t\t\tif (event === 'tap') { //TODO 需要找个更好的解决方案\r\n\t\t\t\t\telement.addEventListener('click', function(e) {\r\n\t\t\t\t\t\tif (e.target) {\r\n\t\t\t\t\t\t\tvar tagName = e.target.tagName;\r\n\t\t\t\t\t\t\tif (!preventDefaultException.test(tagName)) {\r\n\t\t\t\t\t\t\t\tif (tagName === 'A') {\r\n\t\t\t\t\t\t\t\t\tvar href = e.target.href;\r\n\t\t\t\t\t\t\t\t\tif (!(href && ~href.indexOf('tel:'))) {\r\n\t\t\t\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\t$.fn.off = function(event, selector, callback) {\r\n\t\treturn this.each(function() {\r\n\t\t\tvar _mid = mid(this);\r\n\t\t\tif (!event) { //mui(selector).off();\r\n\t\t\t\tdelegates[_mid] && delete delegates[_mid];\r\n\t\t\t} else if (!selector) { //mui(selector).off(event);\r\n\t\t\t\tdelegates[_mid] && delete delegates[_mid][event];\r\n\t\t\t} else if (!callback) { //mui(selector).off(event,selector);\r\n\t\t\t\tdelegates[_mid] && delegates[_mid][event] && delete delegates[_mid][event][selector];\r\n\t\t\t} else { //mui(selector).off(event,selector,callback);\r\n\t\t\t\tvar delegateCallbacks = delegates[_mid] && delegates[_mid][event] && delegates[_mid][event][selector];\r\n\t\t\t\t$.each(delegateCallbacks, function(index, delegateCallback) {\r\n\t\t\t\t\tif (mid(delegateCallback) === mid(callback)) {\r\n\t\t\t\t\t\tdelegateCallbacks.splice(index, 1);\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}, true);\r\n\t\t\t}\r\n\t\t\tif (delegates[_mid]) {\r\n\t\t\t\t//如果off掉了所有当前element的指定的event事件，则remove掉当前element的delegate回调\r\n\t\t\t\tif ((!delegates[_mid][event] || $.isEmptyObject(delegates[_mid][event]))) {\r\n\t\t\t\t\tfindDelegateFn(this, event).forEach(function(fn) {\r\n\t\t\t\t\t\tthis.removeEventListener(fn.type, fn);\r\n\t\t\t\t\t\tdelete delegateFns[_mid][fn.i];\r\n\t\t\t\t\t}.bind(this));\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\t//如果delegates[_mid]已不存在，删除所有\r\n\t\t\t\tfindDelegateFn(this).forEach(function(fn) {\r\n\t\t\t\t\tthis.removeEventListener(fn.type, fn);\r\n\t\t\t\t\tdelete delegateFns[_mid][fn.i];\r\n\t\t\t\t}.bind(this));\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t};\r\n})(mui);\r\n/**\r\n * mui target(action>popover>modal>tab>toggle)\r\n */\r\n(function($, window, document) {\r\n\t/**\r\n\t * targets\r\n\t */\r\n\t$.targets = {};\r\n\t/**\r\n\t * target handles\r\n\t */\r\n\t$.targetHandles = [];\r\n\t/**\r\n\t * register target\r\n\t * @param {type} target\r\n\t * @returns {$.targets}\r\n\t */\r\n\t$.registerTarget = function(target) {\r\n\r\n\t\ttarget.index = target.index || 1000;\r\n\r\n\t\t$.targetHandles.push(target);\r\n\r\n\t\t$.targetHandles.sort(function(a, b) {\r\n\t\t\treturn a.index - b.index;\r\n\t\t});\r\n\r\n\t\treturn $.targetHandles;\r\n\t};\r\n\twindow.addEventListener($.EVENT_START, function(event) {\r\n\t\tvar target = event.target;\r\n\t\tvar founds = {};\r\n\t\tfor (; target && target !== document; target = target.parentNode) {\r\n\t\t\tvar isFound = false;\r\n\t\t\t$.each($.targetHandles, function(index, targetHandle) {\r\n\t\t\t\tvar name = targetHandle.name;\r\n\t\t\t\tif (!isFound && !founds[name] && targetHandle.hasOwnProperty('handle')) {\r\n\t\t\t\t\t$.targets[name] = targetHandle.handle(event, target);\r\n\t\t\t\t\tif ($.targets[name]) {\r\n\t\t\t\t\t\tfounds[name] = true;\r\n\t\t\t\t\t\tif (targetHandle.isContinue !== true) {\r\n\t\t\t\t\t\t\tisFound = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (!founds[name]) {\r\n\t\t\t\t\t\tif (targetHandle.isReset !== false)\r\n\t\t\t\t\t\t\t$.targets[name] = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tif (isFound) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n\twindow.addEventListener('click', function(event) { //解决touch与click的target不一致的问题(比如链接边缘点击时，touch的target为html，而click的target为A)\r\n\t\tvar target = event.target;\r\n\t\tvar isFound = false;\r\n\t\tfor (; target && target !== document; target = target.parentNode) {\r\n\t\t\tif (target.tagName === 'A') {\r\n\t\t\t\t$.each($.targetHandles, function(index, targetHandle) {\r\n\t\t\t\t\tvar name = targetHandle.name;\r\n\t\t\t\t\tif (targetHandle.hasOwnProperty('handle')) {\r\n\t\t\t\t\t\tif (targetHandle.handle(event, target)) {\r\n\t\t\t\t\t\t\tisFound = true;\r\n\t\t\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tif (isFound) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n})(mui, window, document);\r\n/**\r\n * fixed trim\r\n * @param {type} undefined\r\n * @returns {undefined}\r\n */\r\n(function(undefined) {\r\n\tif (String.prototype.trim === undefined) { // fix for iOS 3.2\r\n\t\tString.prototype.trim = function() {\r\n\t\t\treturn this.replace(/^\\s+|\\s+$/g, '');\r\n\t\t};\r\n\t}\r\n\tObject.setPrototypeOf = Object.setPrototypeOf || function(obj, proto) {\r\n\t\tobj['__proto__'] = proto;\r\n\t\treturn obj;\r\n\t};\r\n\r\n})();\r\n/**\r\n * fixed CustomEvent\r\n */\r\n(function() {\r\n\tif (typeof window.CustomEvent === 'undefined') {\r\n\t\tfunction CustomEvent(event, params) {\r\n\t\t\tparams = params || {\r\n\t\t\t\tbubbles: false,\r\n\t\t\t\tcancelable: false,\r\n\t\t\t\tdetail: undefined\r\n\t\t\t};\r\n\t\t\tvar evt = document.createEvent('Events');\r\n\t\t\tvar bubbles = true;\r\n\t\t\tfor (var name in params) {\r\n\t\t\t\t(name === 'bubbles') ? (bubbles = !!params[name]) : (evt[name] = params[name]);\r\n\t\t\t}\r\n\t\t\tevt.initEvent(event, bubbles, true);\r\n\t\t\treturn evt;\r\n\t\t};\r\n\t\tCustomEvent.prototype = window.Event.prototype;\r\n\t\twindow.CustomEvent = CustomEvent;\r\n\t}\r\n})();\r\n/*\r\n\tA shim for non ES5 supporting browsers.\r\n\tAdds function bind to Function prototype, so that you can do partial application.\r\n\tWorks even with the nasty thing, where the first word is the opposite of extranet, the second one is the profession of Columbus, and the version number is 9, flipped 180 degrees.\r\n*/\r\n\r\nFunction.prototype.bind = Function.prototype.bind || function(to) {\r\n\t// Make an array of our arguments, starting from second argument\r\n\tvar partial = Array.prototype.splice.call(arguments, 1),\r\n\t\t// We'll need the original function.\r\n\t\tfn = this;\r\n\tvar bound = function() {\r\n\t\t\t// Join the already applied arguments to the now called ones (after converting to an array again).\r\n\t\t\tvar args = partial.concat(Array.prototype.splice.call(arguments, 0));\r\n\t\t\t// If not being called as a constructor\r\n\t\t\tif (!(this instanceof bound)) {\r\n\t\t\t\t// return the result of the function called bound to target and partially applied.\r\n\t\t\t\treturn fn.apply(to, args);\r\n\t\t\t}\r\n\t\t\t// If being called as a constructor, apply the function bound to self.\r\n\t\t\tfn.apply(this, args);\r\n\t\t}\r\n\t\t// Attach the prototype of the function to our newly created function.\r\n\tbound.prototype = fn.prototype;\r\n\treturn bound;\r\n};\r\n/**\r\n * mui fixed classList\r\n * @param {type} document\r\n * @returns {undefined}\r\n */\r\n(function(document) {\r\n    if (!(\"classList\" in document.documentElement) && Object.defineProperty && typeof HTMLElement !== 'undefined') {\r\n\r\n        Object.defineProperty(HTMLElement.prototype, 'classList', {\r\n            get: function() {\r\n                var self = this;\r\n                function update(fn) {\r\n                    return function(value) {\r\n                        var classes = self.className.split(/\\s+/),\r\n                                index = classes.indexOf(value);\r\n\r\n                        fn(classes, index, value);\r\n                        self.className = classes.join(\" \");\r\n                    };\r\n                }\r\n\r\n                var ret = {\r\n                    add: update(function(classes, index, value) {\r\n                        ~index || classes.push(value);\r\n                    }),\r\n                    remove: update(function(classes, index) {\r\n                        ~index && classes.splice(index, 1);\r\n                    }),\r\n                    toggle: update(function(classes, index, value) {\r\n                        ~index ? classes.splice(index, 1) : classes.push(value);\r\n                    }),\r\n                    contains: function(value) {\r\n                        return !!~self.className.split(/\\s+/).indexOf(value);\r\n                    },\r\n                    item: function(i) {\r\n                        return self.className.split(/\\s+/)[i] || null;\r\n                    }\r\n                };\r\n\r\n                Object.defineProperty(ret, 'length', {\r\n                    get: function() {\r\n                        return self.className.split(/\\s+/).length;\r\n                    }\r\n                });\r\n\r\n                return ret;\r\n            }\r\n        });\r\n    }\r\n})(document);\r\n\r\n/**\r\n * mui fixed requestAnimationFrame\r\n * @param {type} window\r\n * @returns {undefined}\r\n */\r\n(function(window) {\r\n\tif (!window.requestAnimationFrame) {\r\n\t\tvar lastTime = 0;\r\n\t\twindow.requestAnimationFrame = window.webkitRequestAnimationFrame || function(callback, element) {\r\n\t\t\tvar currTime = new Date().getTime();\r\n\t\t\tvar timeToCall = Math.max(0, 16.7 - (currTime - lastTime));\r\n\t\t\tvar id = window.setTimeout(function() {\r\n\t\t\t\tcallback(currTime + timeToCall);\r\n\t\t\t}, timeToCall);\r\n\t\t\tlastTime = currTime + timeToCall;\r\n\t\t\treturn id;\r\n\t\t};\r\n\t\twindow.cancelAnimationFrame = window.webkitCancelAnimationFrame || window.webkitCancelRequestAnimationFrame || function(id) {\r\n\t\t\tclearTimeout(id);\r\n\t\t};\r\n\t};\r\n}(window));\r\n/**\r\n * fastclick(only for radio,checkbox)\r\n */\r\n(function($, window, name) {\r\n\tif (!$.os.android && !$.os.ios) { //目前仅识别android和ios\r\n\t\treturn;\r\n\t}\r\n\tif (window.FastClick) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tvar handle = function(event, target) {\r\n\t\tif (target.tagName === 'LABEL') {\r\n\t\t\tif (target.parentNode) {\r\n\t\t\t\ttarget = target.parentNode.querySelector('input');\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (target && (target.type === 'radio' || target.type === 'checkbox')) {\r\n\t\t\tif (!target.disabled) { //disabled\r\n\t\t\t\treturn target;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t};\r\n\r\n\t$.registerTarget({\r\n\t\tname: name,\r\n\t\tindex: 40,\r\n\t\thandle: handle,\r\n\t\ttarget: false\r\n\t});\r\n\tvar dispatchEvent = function(event) {\r\n\t\tvar targetElement = $.targets.click;\r\n\t\tif (targetElement) {\r\n\t\t\tvar clickEvent, touch;\r\n\t\t\t// On some Android devices activeElement needs to be blurred otherwise the synthetic click will have no effect\r\n\t\t\tif (document.activeElement && document.activeElement !== targetElement) {\r\n\t\t\t\tdocument.activeElement.blur();\r\n\t\t\t}\r\n\t\t\ttouch = event.detail.gesture.changedTouches[0];\r\n\t\t\t// Synthesise a click event, with an extra attribute so it can be tracked\r\n\t\t\tclickEvent = document.createEvent('MouseEvents');\r\n\t\t\tclickEvent.initMouseEvent('click', true, true, window, 1, touch.screenX, touch.screenY, touch.clientX, touch.clientY, false, false, false, false, 0, null);\r\n\t\t\tclickEvent.forwardedTouchEvent = true;\r\n\t\t\ttargetElement.dispatchEvent(clickEvent);\r\n\t\t\tevent.detail && event.detail.gesture.preventDefault();\r\n\t\t}\r\n\t};\r\n\twindow.addEventListener('tap', dispatchEvent);\r\n\twindow.addEventListener('doubletap', dispatchEvent);\r\n\t//捕获\r\n\twindow.addEventListener('click', function(event) {\r\n\t\tif ($.targets.click) {\r\n\t\t\tif (!event.forwardedTouchEvent) { //stop click\r\n\t\t\t\tif (event.stopImmediatePropagation) {\r\n\t\t\t\t\tevent.stopImmediatePropagation();\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Part of the hack for browsers that don't support Event#stopImmediatePropagation\r\n\t\t\t\t\tevent.propagationStopped = true;\r\n\t\t\t\t}\r\n\t\t\t\tevent.stopPropagation();\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t}, true);\r\n\r\n})(mui, window, 'click');\r\n(function($, document) {\r\n\t$(function() {\r\n\t\tif (!$.os.ios) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar CLASS_FOCUSIN = 'mui-focusin';\r\n\t\tvar CLASS_BAR_TAB = 'mui-bar-tab';\r\n\t\tvar CLASS_BAR_FOOTER = 'mui-bar-footer';\r\n\t\tvar CLASS_BAR_FOOTER_SECONDARY = 'mui-bar-footer-secondary';\r\n\t\tvar CLASS_BAR_FOOTER_SECONDARY_TAB = 'mui-bar-footer-secondary-tab';\r\n\t\t// var content = document.querySelector('.' + CLASS_CONTENT);\r\n\t\t// if (content) {\r\n\t\t// \tdocument.body.insertBefore(content, document.body.firstElementChild);\r\n\t\t// }\r\n\t\tdocument.addEventListener('focusin', function(e) {\r\n\t\t\tif ($.os.plus) { //在父webview里边不fix\r\n\t\t\t\tif (window.plus) {\r\n\t\t\t\t\tif (plus.webview.currentWebview().children().length > 0) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar target = e.target;\r\n\t\t\t//TODO 需考虑所有键盘弹起的情况\r\n\t\t\tif (target.tagName && (target.tagName === 'TEXTAREA' || (target.tagName === 'INPUT' && (target.type === 'text' || target.type === 'search' || target.type === 'number')))) {\r\n\t\t\t\tif (target.disabled || target.readOnly) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tdocument.body.classList.add(CLASS_FOCUSIN);\r\n\t\t\t\tvar isFooter = false;\r\n\t\t\t\tfor (; target && target !== document; target = target.parentNode) {\r\n\t\t\t\t\tvar classList = target.classList;\r\n\t\t\t\t\tif (classList && classList.contains(CLASS_BAR_TAB) || classList.contains(CLASS_BAR_FOOTER) || classList.contains(CLASS_BAR_FOOTER_SECONDARY) || classList.contains(CLASS_BAR_FOOTER_SECONDARY_TAB)) {\r\n\t\t\t\t\t\tisFooter = true;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (isFooter) {\r\n\t\t\t\t\tvar scrollTop = document.body.scrollHeight;\r\n\t\t\t\t\tvar scrollLeft = document.body.scrollLeft;\r\n\t\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t\twindow.scrollTo(scrollLeft, scrollTop);\r\n\t\t\t\t\t}, 20);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\tdocument.addEventListener('focusout', function(e) {\r\n\t\t\tvar classList = document.body.classList;\r\n\t\t\tif (classList.contains(CLASS_FOCUSIN)) {\r\n\t\t\t\tclassList.remove(CLASS_FOCUSIN);\r\n\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\twindow.scrollTo(document.body.scrollLeft, document.body.scrollTop);\r\n\t\t\t\t}, 20);\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n})(mui, document);\r\n/**\r\n * mui namespace(optimization)\r\n * @param {type} $\r\n * @returns {undefined}\r\n */\r\n(function($) {\r\n\t$.namespace = 'mui';\r\n\t$.classNamePrefix = $.namespace + '-';\r\n\t$.classSelectorPrefix = '.' + $.classNamePrefix;\r\n\t/**\r\n\t * 返回正确的className\r\n\t * @param {type} className\r\n\t * @returns {String}\r\n\t */\r\n\t$.className = function(className) {\r\n\t\treturn $.classNamePrefix + className;\r\n\t};\r\n\t/**\r\n\t * 返回正确的classSelector\r\n\t * @param {type} classSelector\r\n\t * @returns {String}\r\n\t */\r\n\t$.classSelector = function(classSelector) {\r\n\t\treturn classSelector.replace(/\\./g, $.classSelectorPrefix);\r\n\t};\r\n\t/**\r\n         * 返回正确的eventName\r\n         * @param {type} event\r\n         * @param {type} module\r\n         * @returns {String}\r\n         */\r\n\t$.eventName = function(event, module) {\r\n\t\treturn event + ($.namespace ? ('.' + $.namespace) : '') + ( module ? ('.' + module) : '');\r\n\t};\r\n})(mui);\r\n\r\n/**\r\n * mui gestures\r\n * @param {type} $\r\n * @param {type} window\r\n * @returns {undefined}\r\n */\r\n(function($, window) {\r\n\t$.gestures = {\r\n\t\tsession: {}\r\n\t};\r\n\t/**\r\n\t * Gesture preventDefault\r\n\t * @param {type} e\r\n\t * @returns {undefined}\r\n\t */\r\n\t$.preventDefault = function(e) {\r\n\t\te.preventDefault();\r\n\t};\r\n\t/**\r\n\t * Gesture stopPropagation\r\n\t * @param {type} e\r\n\t * @returns {undefined}\r\n\t */\r\n\t$.stopPropagation = function(e) {\r\n\t\te.stopPropagation();\r\n\t};\r\n\r\n\t/**\r\n\t * register gesture\r\n\t * @param {type} gesture\r\n\t * @returns {$.gestures}\r\n\t */\r\n\t$.addGesture = function(gesture) {\r\n\t\treturn $.addAction('gestures', gesture);\r\n\r\n\t};\r\n\r\n\tvar round = Math.round;\r\n\tvar abs = Math.abs;\r\n\tvar sqrt = Math.sqrt;\r\n\tvar atan = Math.atan;\r\n\tvar atan2 = Math.atan2;\r\n\t/**\r\n\t * distance\r\n\t * @param {type} p1\r\n\t * @param {type} p2\r\n\t * @returns {Number}\r\n\t */\r\n\tvar getDistance = function(p1, p2, props) {\r\n\t\tif (!props) {\r\n\t\t\tprops = ['x', 'y'];\r\n\t\t}\r\n\t\tvar x = p2[props[0]] - p1[props[0]];\r\n\t\tvar y = p2[props[1]] - p1[props[1]];\r\n\t\treturn sqrt((x * x) + (y * y));\r\n\t};\r\n\t/**\r\n\t * scale\r\n\t * @param {Object} starts\r\n\t * @param {Object} moves\r\n\t */\r\n\tvar getScale = function(starts, moves) {\r\n\t\tif (starts.length >= 2 && moves.length >= 2) {\r\n\t\t\tvar props = ['pageX', 'pageY'];\r\n\t\t\treturn getDistance(moves[1], moves[0], props) / getDistance(starts[1], starts[0], props);\r\n\t\t}\r\n\t\treturn 1;\r\n\t};\r\n\t/**\r\n\t * angle\r\n\t * @param {type} p1\r\n\t * @param {type} p2\r\n\t * @returns {Number}\r\n\t */\r\n\tvar getAngle = function(p1, p2, props) {\r\n\t\tif (!props) {\r\n\t\t\tprops = ['x', 'y'];\r\n\t\t}\r\n\t\tvar x = p2[props[0]] - p1[props[0]];\r\n\t\tvar y = p2[props[1]] - p1[props[1]];\r\n\t\treturn atan2(y, x) * 180 / Math.PI;\r\n\t};\r\n\t/**\r\n\t * direction\r\n\t * @param {Object} x\r\n\t * @param {Object} y\r\n\t */\r\n\tvar getDirection = function(x, y) {\r\n\t\tif (x === y) {\r\n\t\t\treturn '';\r\n\t\t}\r\n\t\tif (abs(x) >= abs(y)) {\r\n\t\t\treturn x > 0 ? 'left' : 'right';\r\n\t\t}\r\n\t\treturn y > 0 ? 'up' : 'down';\r\n\t};\r\n\t/**\r\n\t * rotation\r\n\t * @param {Object} start\r\n\t * @param {Object} end\r\n\t */\r\n\tvar getRotation = function(start, end) {\r\n\t\tvar props = ['pageX', 'pageY'];\r\n\t\treturn getAngle(end[1], end[0], props) - getAngle(start[1], start[0], props);\r\n\t};\r\n\t/**\r\n\t * px per ms\r\n\t * @param {Object} deltaTime\r\n\t * @param {Object} x\r\n\t * @param {Object} y\r\n\t */\r\n\tvar getVelocity = function(deltaTime, x, y) {\r\n\t\treturn {\r\n\t\t\tx: x / deltaTime || 0,\r\n\t\t\ty: y / deltaTime || 0\r\n\t\t};\r\n\t};\r\n\t/**\r\n\t * detect gestures\r\n\t * @param {type} event\r\n\t * @param {type} touch\r\n\t * @returns {undefined}\r\n\t */\r\n\tvar detect = function(event, touch) {\r\n\t\tif ($.gestures.stoped) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t$.doAction('gestures', function(index, gesture) {\r\n\t\t\tif (!$.gestures.stoped) {\r\n\t\t\t\tif ($.options.gestureConfig[gesture.name] !== false) {\r\n\t\t\t\t\tgesture.handle(event, touch);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\t/**\r\n\t * 暂时无用\r\n\t * @param {Object} node\r\n\t * @param {Object} parent\r\n\t */\r\n\tvar hasParent = function(node, parent) {\r\n\t\twhile (node) {\r\n\t\t\tif (node == parent) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tnode = node.parentNode;\r\n\t\t}\r\n\t\treturn false;\r\n\t};\r\n\r\n\tvar uniqueArray = function(src, key, sort) {\r\n\t\tvar results = [];\r\n\t\tvar values = [];\r\n\t\tvar i = 0;\r\n\r\n\t\twhile (i < src.length) {\r\n\t\t\tvar val = key ? src[i][key] : src[i];\r\n\t\t\tif (values.indexOf(val) < 0) {\r\n\t\t\t\tresults.push(src[i]);\r\n\t\t\t}\r\n\t\t\tvalues[i] = val;\r\n\t\t\ti++;\r\n\t\t}\r\n\r\n\t\tif (sort) {\r\n\t\t\tif (!key) {\r\n\t\t\t\tresults = results.sort();\r\n\t\t\t} else {\r\n\t\t\t\tresults = results.sort(function sortUniqueArray(a, b) {\r\n\t\t\t\t\treturn a[key] > b[key];\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn results;\r\n\t};\r\n\tvar getMultiCenter = function(touches) {\r\n\t\tvar touchesLength = touches.length;\r\n\t\tif (touchesLength === 1) {\r\n\t\t\treturn {\r\n\t\t\t\tx: round(touches[0].pageX),\r\n\t\t\t\ty: round(touches[0].pageY)\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tvar x = 0;\r\n\t\tvar y = 0;\r\n\t\tvar i = 0;\r\n\t\twhile (i < touchesLength) {\r\n\t\t\tx += touches[i].pageX;\r\n\t\t\ty += touches[i].pageY;\r\n\t\t\ti++;\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\tx: round(x / touchesLength),\r\n\t\t\ty: round(y / touchesLength)\r\n\t\t};\r\n\t};\r\n\tvar multiTouch = function() {\r\n\t\treturn $.options.gestureConfig.pinch;\r\n\t};\r\n\tvar copySimpleTouchData = function(touch) {\r\n\t\tvar touches = [];\r\n\t\tvar i = 0;\r\n\t\twhile (i < touch.touches.length) {\r\n\t\t\ttouches[i] = {\r\n\t\t\t\tpageX: round(touch.touches[i].pageX),\r\n\t\t\t\tpageY: round(touch.touches[i].pageY)\r\n\t\t\t};\r\n\t\t\ti++;\r\n\t\t}\r\n\t\treturn {\r\n\t\t\ttimestamp: $.now(),\r\n\t\t\tgesture: touch.gesture,\r\n\t\t\ttouches: touches,\r\n\t\t\tcenter: getMultiCenter(touch.touches),\r\n\t\t\tdeltaX: touch.deltaX,\r\n\t\t\tdeltaY: touch.deltaY\r\n\t\t};\r\n\t};\r\n\r\n\tvar calDelta = function(touch) {\r\n\t\tvar session = $.gestures.session;\r\n\t\tvar center = touch.center;\r\n\t\tvar offset = session.offsetDelta || {};\r\n\t\tvar prevDelta = session.prevDelta || {};\r\n\t\tvar prevTouch = session.prevTouch || {};\r\n\r\n\t\tif (touch.gesture.type === $.EVENT_START || touch.gesture.type === $.EVENT_END) {\r\n\t\t\tprevDelta = session.prevDelta = {\r\n\t\t\t\tx: prevTouch.deltaX || 0,\r\n\t\t\t\ty: prevTouch.deltaY || 0\r\n\t\t\t};\r\n\r\n\t\t\toffset = session.offsetDelta = {\r\n\t\t\t\tx: center.x,\r\n\t\t\t\ty: center.y\r\n\t\t\t};\r\n\t\t}\r\n\t\ttouch.deltaX = prevDelta.x + (center.x - offset.x);\r\n\t\ttouch.deltaY = prevDelta.y + (center.y - offset.y);\r\n\t};\r\n\tvar calTouchData = function(touch) {\r\n\t\tvar session = $.gestures.session;\r\n\t\tvar touches = touch.touches;\r\n\t\tvar touchesLength = touches.length;\r\n\r\n\t\tif (!session.firstTouch) {\r\n\t\t\tsession.firstTouch = copySimpleTouchData(touch);\r\n\t\t}\r\n\r\n\t\tif (multiTouch() && touchesLength > 1 && !session.firstMultiTouch) {\r\n\t\t\tsession.firstMultiTouch = copySimpleTouchData(touch);\r\n\t\t} else if (touchesLength === 1) {\r\n\t\t\tsession.firstMultiTouch = false;\r\n\t\t}\r\n\r\n\t\tvar firstTouch = session.firstTouch;\r\n\t\tvar firstMultiTouch = session.firstMultiTouch;\r\n\t\tvar offsetCenter = firstMultiTouch ? firstMultiTouch.center : firstTouch.center;\r\n\r\n\t\tvar center = touch.center = getMultiCenter(touches);\r\n\t\ttouch.timestamp = $.now();\r\n\t\ttouch.deltaTime = touch.timestamp - firstTouch.timestamp;\r\n\r\n\t\ttouch.angle = getAngle(offsetCenter, center);\r\n\t\ttouch.distance = getDistance(offsetCenter, center);\r\n\r\n\t\tcalDelta(touch);\r\n\r\n\t\ttouch.offsetDirection = getDirection(touch.deltaX, touch.deltaY);\r\n\r\n\t\ttouch.scale = firstMultiTouch ? getScale(firstMultiTouch.touches, touches) : 1;\r\n\t\ttouch.rotation = firstMultiTouch ? getRotation(firstMultiTouch.touches, touches) : 0;\r\n\r\n\t\tcalIntervalTouchData(touch);\r\n\r\n\t};\r\n\tvar CAL_INTERVAL = 25;\r\n\tvar calIntervalTouchData = function(touch) {\r\n\t\tvar session = $.gestures.session;\r\n\t\tvar last = session.lastInterval || touch;\r\n\t\tvar deltaTime = touch.timestamp - last.timestamp;\r\n\t\tvar velocity;\r\n\t\tvar velocityX;\r\n\t\tvar velocityY;\r\n\t\tvar direction;\r\n\r\n\t\tif (touch.gesture.type != $.EVENT_CANCEL && (deltaTime > CAL_INTERVAL || last.velocity === undefined)) {\r\n\t\t\tvar deltaX = last.deltaX - touch.deltaX;\r\n\t\t\tvar deltaY = last.deltaY - touch.deltaY;\r\n\r\n\t\t\tvar v = getVelocity(deltaTime, deltaX, deltaY);\r\n\t\t\tvelocityX = v.x;\r\n\t\t\tvelocityY = v.y;\r\n\t\t\tvelocity = (abs(v.x) > abs(v.y)) ? v.x : v.y;\r\n\t\t\tdirection = getDirection(deltaX, deltaY) || last.direction;\r\n\r\n\t\t\tsession.lastInterval = touch;\r\n\t\t} else {\r\n\t\t\tvelocity = last.velocity;\r\n\t\t\tvelocityX = last.velocityX;\r\n\t\t\tvelocityY = last.velocityY;\r\n\t\t\tdirection = last.direction;\r\n\t\t}\r\n\r\n\t\ttouch.velocity = velocity;\r\n\t\ttouch.velocityX = velocityX;\r\n\t\ttouch.velocityY = velocityY;\r\n\t\ttouch.direction = direction;\r\n\t};\r\n\tvar targetIds = {};\r\n\tvar convertTouches = function(touches) {\r\n\t\tfor (var i = 0; i < touches.length; i++) {\r\n\t\t\t!touches['identifier'] && (touches['identifier'] = 0);\r\n\t\t}\r\n\t\treturn touches;\r\n\t};\r\n\tvar getTouches = function(event, touch) {\r\n\t\tvar allTouches = convertTouches($.slice.call(event.touches || [event]));\r\n\r\n\t\tvar type = event.type;\r\n\r\n\t\tvar targetTouches = [];\r\n\t\tvar changedTargetTouches = [];\r\n\r\n\t\t//当touchstart或touchmove且touches长度为1，直接获得all和changed\r\n\t\tif ((type === $.EVENT_START || type === $.EVENT_MOVE) && allTouches.length === 1) {\r\n\t\t\ttargetIds[allTouches[0].identifier] = true;\r\n\t\t\ttargetTouches = allTouches;\r\n\t\t\tchangedTargetTouches = allTouches;\r\n\t\t\ttouch.target = event.target;\r\n\t\t} else {\r\n\t\t\tvar i = 0;\r\n\t\t\tvar targetTouches = [];\r\n\t\t\tvar changedTargetTouches = [];\r\n\t\t\tvar changedTouches = convertTouches($.slice.call(event.changedTouches || [event]));\r\n\r\n\t\t\ttouch.target = event.target;\r\n\t\t\tvar sessionTarget = $.gestures.session.target || event.target;\r\n\t\t\ttargetTouches = allTouches.filter(function(touch) {\r\n\t\t\t\treturn hasParent(touch.target, sessionTarget);\r\n\t\t\t});\r\n\r\n\t\t\tif (type === $.EVENT_START) {\r\n\t\t\t\ti = 0;\r\n\t\t\t\twhile (i < targetTouches.length) {\r\n\t\t\t\t\ttargetIds[targetTouches[i].identifier] = true;\r\n\t\t\t\t\ti++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\ti = 0;\r\n\t\t\twhile (i < changedTouches.length) {\r\n\t\t\t\tif (targetIds[changedTouches[i].identifier]) {\r\n\t\t\t\t\tchangedTargetTouches.push(changedTouches[i]);\r\n\t\t\t\t}\r\n\t\t\t\tif (type === $.EVENT_END || type === $.EVENT_CANCEL) {\r\n\t\t\t\t\tdelete targetIds[changedTouches[i].identifier];\r\n\t\t\t\t}\r\n\t\t\t\ti++;\r\n\t\t\t}\r\n\r\n\t\t\tif (!changedTargetTouches.length) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\ttargetTouches = uniqueArray(targetTouches.concat(changedTargetTouches), 'identifier', true);\r\n\t\tvar touchesLength = targetTouches.length;\r\n\t\tvar changedTouchesLength = changedTargetTouches.length;\r\n\t\tif (type === $.EVENT_START && touchesLength - changedTouchesLength === 0) { //first\r\n\t\t\ttouch.isFirst = true;\r\n\t\t\t$.gestures.touch = $.gestures.session = {\r\n\t\t\t\ttarget: event.target\r\n\t\t\t};\r\n\t\t}\r\n\t\ttouch.isFinal = ((type === $.EVENT_END || type === $.EVENT_CANCEL) && (touchesLength - changedTouchesLength === 0));\r\n\r\n\t\ttouch.touches = targetTouches;\r\n\t\ttouch.changedTouches = changedTargetTouches;\r\n\t\treturn true;\r\n\r\n\t};\r\n\tvar handleTouchEvent = function(event) {\r\n\t\tvar touch = {\r\n\t\t\tgesture: event\r\n\t\t};\r\n\t\tvar touches = getTouches(event, touch);\r\n\t\tif (!touches) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tcalTouchData(touch);\r\n\t\tdetect(event, touch);\r\n\t\t$.gestures.session.prevTouch = touch;\r\n\t\tif (event.type === $.EVENT_END && !$.isTouchable) {\r\n\t\t\t$.gestures.touch = $.gestures.session = {};\r\n\t\t}\r\n\t};\r\n\twindow.addEventListener($.EVENT_START, handleTouchEvent);\r\n\twindow.addEventListener($.EVENT_MOVE, handleTouchEvent);\r\n\twindow.addEventListener($.EVENT_END, handleTouchEvent);\r\n\twindow.addEventListener($.EVENT_CANCEL, handleTouchEvent);\r\n\t//fixed hashchange(android)\r\n\twindow.addEventListener($.EVENT_CLICK, function(e) {\r\n\t\t//TODO 应该判断当前target是不是在targets.popover内部，而不是非要相等\r\n\t\tif (($.os.android || $.os.ios) && (($.targets.popover && e.target === $.targets.popover) || ($.targets.tab) || $.targets.offcanvas || $.targets.modal)) {\r\n\t\t\te.preventDefault();\r\n\t\t}\r\n\t}, true);\r\n\r\n\r\n\t//增加原生滚动识别\r\n\t$.isScrolling = false;\r\n\tvar scrollingTimeout = null;\r\n\twindow.addEventListener('scroll', function() {\r\n\t\t$.isScrolling = true;\r\n\t\tscrollingTimeout && clearTimeout(scrollingTimeout);\r\n\t\tscrollingTimeout = setTimeout(function() {\r\n\t\t\t$.isScrolling = false;\r\n\t\t}, 250);\r\n\t});\r\n})(mui, window);\r\n/**\r\n * mui gesture flick[left|right|up|down]\r\n * @param {type} $\r\n * @param {type} name\r\n * @returns {undefined}\r\n */\r\n(function($, name) {\r\n\tvar flickStartTime = 0;\r\n\tvar handle = function(event, touch) {\r\n\t\tvar session = $.gestures.session;\r\n\t\tvar options = this.options;\r\n\t\tvar now = $.now();\r\n\t\tswitch (event.type) {\r\n\t\t\tcase $.EVENT_MOVE:\r\n\t\t\t\tif (now - flickStartTime > 300) {\r\n\t\t\t\t\tflickStartTime = now;\r\n\t\t\t\t\tsession.flickStart = touch.center;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase $.EVENT_END:\r\n\t\t\tcase $.EVENT_CANCEL:\r\n\t\t\t\ttouch.flick = false;\r\n\t\t\t\tif (session.flickStart && options.flickMaxTime > (now - flickStartTime) && touch.distance > options.flickMinDistince) {\r\n\t\t\t\t\ttouch.flick = true;\r\n\t\t\t\t\ttouch.flickTime = now - flickStartTime;\r\n\t\t\t\t\ttouch.flickDistanceX = touch.center.x - session.flickStart.x;\r\n\t\t\t\t\ttouch.flickDistanceY = touch.center.y - session.flickStart.y;\r\n\t\t\t\t\t$.trigger(session.target, name, touch);\r\n\t\t\t\t\t$.trigger(session.target, name + touch.direction, touch);\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t};\r\n\t/**\r\n\t * mui gesture flick\r\n\t */\r\n\t$.addGesture({\r\n\t\tname: name,\r\n\t\tindex: 5,\r\n\t\thandle: handle,\r\n\t\toptions: {\r\n\t\t\tflickMaxTime: 200,\r\n\t\t\tflickMinDistince: 10\r\n\t\t}\r\n\t});\r\n})(mui, 'flick');\r\n/**\r\n * mui gesture swipe[left|right|up|down]\r\n * @param {type} $\r\n * @param {type} name\r\n * @returns {undefined}\r\n */\r\n(function($, name) {\r\n\tvar handle = function(event, touch) {\r\n\t\tvar session = $.gestures.session;\r\n\t\tif (event.type === $.EVENT_END || event.type === $.EVENT_CANCEL) {\r\n\t\t\tvar options = this.options;\r\n\t\t\ttouch.swipe = false;\r\n\t\t\t//TODO 后续根据velocity计算\r\n\t\t\tif (touch.direction && options.swipeMaxTime > touch.deltaTime && touch.distance > options.swipeMinDistince) {\r\n\t\t\t\ttouch.swipe = true;\r\n\t\t\t\t$.trigger(session.target, name, touch);\r\n\t\t\t\t$.trigger(session.target, name + touch.direction, touch);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\t/**\r\n\t * mui gesture swipe\r\n\t */\r\n\t$.addGesture({\r\n\t\tname: name,\r\n\t\tindex: 10,\r\n\t\thandle: handle,\r\n\t\toptions: {\r\n\t\t\tswipeMaxTime: 300,\r\n\t\t\tswipeMinDistince: 18\r\n\t\t}\r\n\t});\r\n})(mui, 'swipe');\r\n/**\r\n * mui gesture drag[start|left|right|up|down|end]\r\n * @param {type} $\r\n * @param {type} name\r\n * @returns {undefined}\r\n */\r\n(function($, name) {\r\n\tvar handle = function(event, touch) {\r\n\t\tvar session = $.gestures.session;\r\n\t\tswitch (event.type) {\r\n\t\t\tcase $.EVENT_START:\r\n\t\t\t\tbreak;\r\n\t\t\tcase $.EVENT_MOVE:\r\n\t\t\t\tif (!touch.direction || !session.target) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t//修正direction,可在session期间自行锁定拖拽方向，方便开发scroll类不同方向拖拽插件嵌套\r\n\t\t\t\tif (session.lockDirection && session.startDirection) {\r\n\t\t\t\t\tif (session.startDirection && session.startDirection !== touch.direction) {\r\n\t\t\t\t\t\tif (session.startDirection === 'up' || session.startDirection === 'down') {\r\n\t\t\t\t\t\t\ttouch.direction = touch.deltaY < 0 ? 'up' : 'down';\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\ttouch.direction = touch.deltaX < 0 ? 'left' : 'right';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (!session.drag) {\r\n\t\t\t\t\tsession.drag = true;\r\n\t\t\t\t\t$.trigger(session.target, name + 'start', touch);\r\n\t\t\t\t}\r\n\t\t\t\t$.trigger(session.target, name, touch);\r\n\t\t\t\t$.trigger(session.target, name + touch.direction, touch);\r\n\t\t\t\tbreak;\r\n\t\t\tcase $.EVENT_END:\r\n\t\t\tcase $.EVENT_CANCEL:\r\n\t\t\t\tif (session.drag && touch.isFinal) {\r\n\t\t\t\t\t$.trigger(session.target, name + 'end', touch);\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t};\r\n\t/**\r\n\t * mui gesture drag\r\n\t */\r\n\t$.addGesture({\r\n\t\tname: name,\r\n\t\tindex: 20,\r\n\t\thandle: handle,\r\n\t\toptions: {\r\n\t\t\tfingers: 1\r\n\t\t}\r\n\t});\r\n})(mui, 'drag');\r\n/**\r\n * mui gesture tap and doubleTap\r\n * @param {type} $\r\n * @param {type} name\r\n * @returns {undefined}\r\n */\r\n(function($, name) {\r\n\tvar lastTarget;\r\n\tvar lastTapTime;\r\n\tvar handle = function(event, touch) {\r\n\t\tvar session = $.gestures.session;\r\n\t\tvar options = this.options;\r\n\t\tswitch (event.type) {\r\n\t\t\tcase $.EVENT_END:\r\n\t\t\t\tif (!touch.isFinal) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tvar target = session.target;\r\n\t\t\t\tif (!target || (target.disabled || (target.classList && target.classList.contains('mui-disabled')))) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (touch.distance < options.tapMaxDistance && touch.deltaTime < options.tapMaxTime) {\r\n\t\t\t\t\tif ($.options.gestureConfig.doubletap && lastTarget && (lastTarget === target)) { //same target\r\n\t\t\t\t\t\tif (lastTapTime && (touch.timestamp - lastTapTime) < options.tapMaxInterval) {\r\n\t\t\t\t\t\t\t$.trigger(target, 'doubletap', touch);\r\n\t\t\t\t\t\t\tlastTapTime = $.now();\r\n\t\t\t\t\t\t\tlastTarget = target;\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t$.trigger(target, name, touch);\r\n\t\t\t\t\tlastTapTime = $.now();\r\n\t\t\t\t\tlastTarget = target;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t};\r\n\t/**\r\n\t * mui gesture tap\r\n\t */\r\n\t$.addGesture({\r\n\t\tname: name,\r\n\t\tindex: 30,\r\n\t\thandle: handle,\r\n\t\toptions: {\r\n\t\t\tfingers: 1,\r\n\t\t\ttapMaxInterval: 300,\r\n\t\t\ttapMaxDistance: 5,\r\n\t\t\ttapMaxTime: 250\r\n\t\t}\r\n\t});\r\n})(mui, 'tap');\r\n/**\r\n * mui gesture longtap\r\n * @param {type} $\r\n * @param {type} name\r\n * @returns {undefined}\r\n */\r\n(function($, name) {\r\n\tvar timer;\r\n\tvar handle = function(event, touch) {\r\n\t\tvar session = $.gestures.session;\r\n\t\tvar options = this.options;\r\n\t\tswitch (event.type) {\r\n\t\t\tcase $.EVENT_START:\r\n\t\t\t\tclearTimeout(timer);\r\n\t\t\t\ttimer = setTimeout(function() {\r\n\t\t\t\t\t$.trigger(session.target, name, touch);\r\n\t\t\t\t}, options.holdTimeout);\r\n\t\t\t\tbreak;\r\n\t\t\tcase $.EVENT_MOVE:\r\n\t\t\t\tif (touch.distance > options.holdThreshold) {\r\n\t\t\t\t\tclearTimeout(timer);\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase $.EVENT_END:\r\n\t\t\tcase $.EVENT_CANCEL:\r\n\t\t\t\tclearTimeout(timer);\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t};\r\n\t/**\r\n\t * mui gesture longtap\r\n\t */\r\n\t$.addGesture({\r\n\t\tname: name,\r\n\t\tindex: 10,\r\n\t\thandle: handle,\r\n\t\toptions: {\r\n\t\t\tfingers: 1,\r\n\t\t\tholdTimeout: 500,\r\n\t\t\tholdThreshold: 2\r\n\t\t}\r\n\t});\r\n})(mui, 'longtap');\r\n/**\r\n * mui gesture hold\r\n * @param {type} $\r\n * @param {type} name\r\n * @returns {undefined}\r\n */\r\n(function($, name) {\r\n\tvar timer;\r\n\tvar handle = function(event, touch) {\r\n\t\tvar session = $.gestures.session;\r\n\t\tvar options = this.options;\r\n\t\tswitch (event.type) {\r\n\t\t\tcase $.EVENT_START:\r\n\t\t\t\tif ($.options.gestureConfig.hold) {\r\n\t\t\t\t\ttimer && clearTimeout(timer);\r\n\t\t\t\t\ttimer = setTimeout(function() {\r\n\t\t\t\t\t\ttouch.hold = true;\r\n\t\t\t\t\t\t$.trigger(session.target, name, touch);\r\n\t\t\t\t\t}, options.holdTimeout);\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase $.EVENT_MOVE:\r\n\t\t\t\tbreak;\r\n\t\t\tcase $.EVENT_END:\r\n\t\t\tcase $.EVENT_CANCEL:\r\n\t\t\t\tif (timer) {\r\n\t\t\t\t\tclearTimeout(timer) && (timer = null);\r\n\t\t\t\t\t$.trigger(session.target, 'release', touch);\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t};\r\n\t/**\r\n\t * mui gesture hold\r\n\t */\r\n\t$.addGesture({\r\n\t\tname: name,\r\n\t\tindex: 10,\r\n\t\thandle: handle,\r\n\t\toptions: {\r\n\t\t\tfingers: 1,\r\n\t\t\tholdTimeout: 0\r\n\t\t}\r\n\t});\r\n})(mui, 'hold');\r\n/**\r\n * mui gesture pinch\r\n * @param {type} $\r\n * @param {type} name\r\n * @returns {undefined}\r\n */\r\n(function($, name) {\r\n\tvar handle = function(event, touch) {\r\n\t\tvar options = this.options;\r\n\t\tvar session = $.gestures.session;\r\n\t\tswitch (event.type) {\r\n\t\t\tcase $.EVENT_START:\r\n\t\t\t\tbreak;\r\n\t\t\tcase $.EVENT_MOVE:\r\n\t\t\t\tif ($.options.gestureConfig.pinch) {\r\n\t\t\t\t\tif (touch.touches.length < 2) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!session.pinch) { //start\r\n\t\t\t\t\t\tsession.pinch = true;\r\n\t\t\t\t\t\t$.trigger(session.target, name + 'start', touch);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t$.trigger(session.target, name, touch);\r\n\t\t\t\t\tvar scale = touch.scale;\r\n\t\t\t\t\tvar rotation = touch.rotation;\r\n\t\t\t\t\tvar lastScale = typeof touch.lastScale === 'undefined' ? 1 : touch.lastScale;\r\n\t\t\t\t\tvar scaleDiff = 0.000000000001; //防止scale与lastScale相等，不触发事件的情况。\r\n\t\t\t\t\tif (scale > lastScale) { //out\r\n\t\t\t\t\t\tlastScale = scale - scaleDiff;\r\n\t\t\t\t\t\t$.trigger(session.target, name + 'out', touch);\r\n\t\t\t\t\t} //in\r\n\t\t\t\t\telse if (scale < lastScale) {\r\n\t\t\t\t\t\tlastScale = scale + scaleDiff;\r\n\t\t\t\t\t\t$.trigger(session.target, name + 'in', touch);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (Math.abs(rotation) > options.minRotationAngle) {\r\n\t\t\t\t\t\t$.trigger(session.target, 'rotate', touch);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase $.EVENT_END:\r\n\t\t\tcase $.EVENT_CANCEL:\r\n\t\t\t\tif ($.options.gestureConfig.pinch && session.pinch && touch.touches.length === 2) {\r\n\t\t\t\t\tsession.pinch = false;\r\n\t\t\t\t\t$.trigger(session.target, name + 'end', touch);\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t};\r\n\t/**\r\n\t * mui gesture pinch\r\n\t */\r\n\t$.addGesture({\r\n\t\tname: name,\r\n\t\tindex: 10,\r\n\t\thandle: handle,\r\n\t\toptions: {\r\n\t\t\tminRotationAngle: 0\r\n\t\t}\r\n\t});\r\n})(mui, 'pinch');\r\n/**\r\n * mui.init\r\n * @param {type} $\r\n * @returns {undefined}\r\n */\r\n(function($) {\r\n\t$.global = $.options = {\r\n\t\tgestureConfig: {\r\n\t\t\ttap: true,\r\n\t\t\tdoubletap: false,\r\n\t\t\tlongtap: false,\r\n\t\t\thold: false,\r\n\t\t\tflick: true,\r\n\t\t\tswipe: true,\r\n\t\t\tdrag: true,\r\n\t\t\tpinch: false\r\n\t\t}\r\n\t};\r\n\t/**\r\n\t *\r\n\t * @param {type} options\r\n\t * @returns {undefined}\r\n\t */\r\n\t$.initGlobal = function(options) {\r\n\t\t$.options = $.extend(true, $.global, options);\r\n\t\treturn this;\r\n\t};\r\n\tvar inits = {};\r\n\r\n\t/**\r\n\t * 单页配置 初始化\r\n\t * @param {object} options\r\n\t */\r\n\t$.init = function(options) {\r\n\t\t$.options = $.extend(true, $.global, options || {});\r\n\t\t$.ready(function() {\r\n\t\t\t$.doAction('inits', function(index, init) {\r\n\t\t\t\tvar isInit = !!(!inits[init.name] || init.repeat);\r\n\t\t\t\tif (isInit) {\r\n\t\t\t\t\tinit.handle.call($);\r\n\t\t\t\t\tinits[init.name] = true;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t\treturn this;\r\n\t};\r\n\r\n\t/**\r\n\t * 增加初始化执行流程\r\n\t * @param {function} init\r\n\t */\r\n\t$.addInit = function(init) {\r\n\t\treturn $.addAction('inits', init);\r\n\t};\r\n\t/**\r\n\t * 处理html5版本subpages \r\n\t */\r\n\t$.addInit({\r\n\t\tname: 'iframe',\r\n\t\tindex: 100,\r\n\t\thandle: function() {\r\n\t\t\tvar options = $.options;\r\n\t\t\tvar subpages = options.subpages || [];\r\n\t\t\tif (!$.os.plus && subpages.length) {\r\n\t\t\t\t//暂时只处理单个subpage。后续可以考虑支持多个subpage\r\n\t\t\t\tcreateIframe(subpages[0]);\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n\tvar createIframe = function(options) {\r\n\t\tvar wrapper = document.createElement('div');\r\n\t\twrapper.className = 'mui-iframe-wrapper';\r\n\t\tvar styles = options.styles || {};\r\n\t\tif (typeof styles.top !== 'string') {\r\n\t\t\tstyles.top = '0px';\r\n\t\t}\r\n\t\tif (typeof styles.bottom !== 'string') {\r\n\t\t\tstyles.bottom = '0px';\r\n\t\t}\r\n\t\twrapper.style.top = styles.top;\r\n\t\twrapper.style.bottom = styles.bottom;\r\n\t\tvar iframe = document.createElement('iframe');\r\n\t\tiframe.src = options.url;\r\n\t\tiframe.id = options.id || options.url;\r\n\t\tiframe.name = iframe.id;\r\n\t\twrapper.appendChild(iframe);\r\n\t\tdocument.body.appendChild(wrapper);\r\n\t\t//目前仅处理微信\r\n\t\t$.os.wechat && handleScroll(wrapper, iframe);\r\n\t};\r\n\r\n\tfunction handleScroll(wrapper, iframe) {\r\n\t\tvar key = 'MUI_SCROLL_POSITION_' + document.location.href + '_' + iframe.src;\r\n\t\tvar scrollTop = (parseFloat(localStorage.getItem(key)) || 0);\r\n\t\tif (scrollTop) {\r\n\t\t\t(function(y) {\r\n\t\t\t\tiframe.onload = function() {\r\n\t\t\t\t\twindow.scrollTo(0, y);\r\n\t\t\t\t};\r\n\t\t\t})(scrollTop);\r\n\t\t}\r\n\t\tsetInterval(function() {\r\n\t\t\tvar _scrollTop = window.scrollY;\r\n\t\t\tif (scrollTop !== _scrollTop) {\r\n\t\t\t\tlocalStorage.setItem(key, _scrollTop + '');\r\n\t\t\t\tscrollTop = _scrollTop;\r\n\t\t\t}\r\n\t\t}, 100);\r\n\t};\r\n\t$(function() {\r\n\t\tvar classList = document.body.classList;\r\n\t\tvar os = [];\r\n\t\tif ($.os.ios) {\r\n\t\t\tos.push({\r\n\t\t\t\tos: 'ios',\r\n\t\t\t\tversion: $.os.version\r\n\t\t\t});\r\n\t\t\tclassList.add('mui-ios');\r\n\t\t} else if ($.os.android) {\r\n\t\t\tos.push({\r\n\t\t\t\tos: 'android',\r\n\t\t\t\tversion: $.os.version\r\n\t\t\t});\r\n\t\t\tclassList.add('mui-android');\r\n\t\t}\r\n\t\tif ($.os.wechat) {\r\n\t\t\tos.push({\r\n\t\t\t\tos: 'wechat',\r\n\t\t\t\tversion: $.os.wechat.version\r\n\t\t\t});\r\n\t\t\tclassList.add('mui-wechat');\r\n\t\t}\r\n\t\tif (os.length) {\r\n\t\t\t$.each(os, function(index, osObj) {\r\n\t\t\t\tvar version = '';\r\n\t\t\t\tvar classArray = [];\r\n\t\t\t\tif (osObj.version) {\r\n\t\t\t\t\t$.each(osObj.version.split('.'), function(i, v) {\r\n\t\t\t\t\t\tversion = version + (version ? '-' : '') + v;\r\n\t\t\t\t\t\tclassList.add($.className(osObj.os + '-' + version));\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t});\r\n})(mui);\r\n/**\r\n * mui.init 5+\r\n * @param {type} $\r\n * @returns {undefined}\r\n */\r\n(function($) {\r\n\tvar defaultOptions = {\r\n\t\tswipeBack: false,\r\n\t\tpreloadPages: [], //5+ lazyLoad webview\r\n\t\tpreloadLimit: 10, //预加载窗口的数量限制(一旦超出，先进先出)\r\n\t\tkeyEventBind: {\r\n\t\t\tbackbutton: true,\r\n\t\t\tmenubutton: true\r\n\t\t},\r\n\t\ttitleConfig: {\r\n\t\t\theight: \"44px\",\r\n\t\t\tbackgroundColor: \"#f7f7f7\", //导航栏背景色\r\n\t\t\tbottomBorderColor: \"#cccccc\", //底部边线颜色\r\n\t\t\ttitle: { //标题配置\r\n\t\t\t\ttext: \"\", //标题文字\r\n\t\t\t\tposition: {\r\n\t\t\t\t\ttop: 0,\r\n\t\t\t\t\tleft: 0,\r\n\t\t\t\t\twidth: \"100%\",\r\n\t\t\t\t\theight: \"100%\"\r\n\t\t\t\t},\r\n\t\t\t\tstyles: {\r\n\t\t\t\t\tcolor: \"#000000\",\r\n\t\t\t\t\talign: \"center\",\r\n\t\t\t\t\tfamily: \"'Helvetica Neue',Helvetica,sans-serif\",\r\n\t\t\t\t\tsize: \"17px\",\r\n\t\t\t\t\tstyle: \"normal\",\r\n\t\t\t\t\tweight: \"normal\",\r\n\t\t\t\t\tfontSrc: \"\"\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tback: {\r\n\t\t\t\timage: {\r\n\t\t\t\t\tbase64Data: '',\r\n\t\t\t\t\timgSrc: '',\r\n\t\t\t\t\tsprite: {\r\n\t\t\t\t\t\ttop: '0px',\r\n\t\t\t\t\t\tleft: '0px',\r\n\t\t\t\t\t\twidth: '100%',\r\n\t\t\t\t\t\theight: '100%'\r\n\t\t\t\t\t},\r\n\t\t\t\t\tposition: {\r\n\t\t\t\t\t\ttop: \"10px\",\r\n\t\t\t\t\t\tleft: \"10px\",\r\n\t\t\t\t\t\twidth: \"24px\",\r\n\t\t\t\t\t\theight: \"24px\"\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\t//默认页面动画\r\n\tvar defaultShow = {\r\n\t\tevent:\"titleUpdate\",\r\n\t\tautoShow: true,\r\n\t\tduration: 300,\r\n\t\taniShow: 'slide-in-right',\r\n\t\textras:{}\r\n\t};\r\n\t//若执行了显示动画初始化操作，则要覆盖默认配置\r\n\tif($.options.show) {\r\n\t\tdefaultShow = $.extend(true, defaultShow, $.options.show);\r\n\t}\r\n\r\n\t$.currentWebview = null;\r\n\r\n\t$.extend(true, $.global, defaultOptions);\r\n\t$.extend(true, $.options, defaultOptions);\r\n\t/**\r\n\t * 等待动画配置\r\n\t * @param {type} options\r\n\t * @returns {Object}\r\n\t */\r\n\t$.waitingOptions = function(options) {\r\n\t\treturn $.extend(true, {}, {\r\n\t\t\tautoShow: true,\r\n\t\t\ttitle: '',\r\n\t\t\tmodal: false\r\n\t\t}, options);\r\n\t};\r\n\t/**\r\n\t * 窗口显示配置\r\n\t * @param {type} options\r\n\t * @returns {Object}\r\n\t */\r\n\t$.showOptions = function(options) {\r\n\t\treturn $.extend(true, {}, defaultShow, options);\r\n\t};\r\n\t/**\r\n\t * 窗口默认配置\r\n\t * @param {type} options\r\n\t * @returns {Object}\r\n\t */\r\n\t$.windowOptions = function(options) {\r\n\t\treturn $.extend({\r\n\t\t\tscalable: false,\r\n\t\t\tbounce: \"\" //vertical\r\n\t\t}, options);\r\n\t};\r\n\t/**\r\n\t * plusReady\r\n\t * @param {type} callback\r\n\t * @returns {_L6.$}\r\n\t */\r\n\t$.plusReady = function(callback) {\r\n\t\tif(window.plus) {\r\n\t\t\tsetTimeout(function() { //解决callback与plusready事件的执行时机问题(典型案例:showWaiting,closeWaiting)\r\n\t\t\t\tcallback();\r\n\t\t\t}, 0);\r\n\t\t} else {\r\n\t\t\tdocument.addEventListener(\"plusready\", function() {\r\n\t\t\t\tcallback();\r\n\t\t\t}, false);\r\n\t\t}\r\n\t\treturn this;\r\n\t};\r\n\t/**\r\n\t * 5+ event(5+没提供之前我自己实现)\r\n\t * @param {type} webview\r\n\t * @param {type} eventType\r\n\t * @param {type} data\r\n\t * @returns {undefined}\r\n\t */\r\n\t$.fire = function(webview, eventType, data) {\r\n\t\tif(webview) {\r\n\t\t\tif(typeof data === 'undefined') {\r\n\t\t\t\tdata = '';\r\n\t\t\t} else if(typeof data === 'boolean' || typeof data === 'number') {\r\n\t\t\t\twebview.evalJS(\"typeof mui!=='undefined'&&mui.receive('\" + eventType + \"',\" + data + \")\");\r\n\t\t\t\treturn;\r\n\t\t\t} else if($.isPlainObject(data) || $.isArray(data)) {\r\n\t\t\t\tdata = JSON.stringify(data || {}).replace(/\\'/g, \"\\\\u0027\").replace(/\\\\/g, \"\\\\u005c\");\r\n\t\t\t}\r\n\t\t\twebview.evalJS(\"typeof mui!=='undefined'&&mui.receive('\" + eventType + \"','\" + data + \"')\");\r\n\t\t}\r\n\t};\r\n\t/**\r\n\t * 5+ event(5+没提供之前我自己实现)\r\n\t * @param {type} eventType\r\n\t * @param {type} data\r\n\t * @returns {undefined}\r\n\t */\r\n\t$.receive = function(eventType, data) {\r\n\t\tif(eventType) {\r\n\t\t\ttry {\r\n\t\t\t\tif(data && typeof data === 'string') {\r\n\t\t\t\t\tdata = JSON.parse(data);\r\n\t\t\t\t}\r\n\t\t\t} catch(e) {}\r\n\t\t\t$.trigger(document, eventType, data);\r\n\t\t}\r\n\t};\r\n\tvar triggerPreload = function(webview) {\r\n\t\tif(!webview.preloaded) { //保证仅触发一次\r\n\t\t\t$.fire(webview, 'preload');\r\n\t\t\tvar list = webview.children();\r\n\t\t\tfor(var i = 0; i < list.length; i++) {\r\n\t\t\t\t$.fire(list[i], 'preload');\r\n\t\t\t}\r\n\t\t\twebview.preloaded = true;\r\n\t\t}\r\n\t};\r\n\tvar trigger = function(webview, eventType, timeChecked) {\r\n\t\tif(timeChecked) {\r\n\t\t\tif(!webview[eventType + 'ed']) {\r\n\t\t\t\t$.fire(webview, eventType);\r\n\t\t\t\tvar list = webview.children();\r\n\t\t\t\tfor(var i = 0; i < list.length; i++) {\r\n\t\t\t\t\t$.fire(list[i], eventType);\r\n\t\t\t\t}\r\n\t\t\t\twebview[eventType + 'ed'] = true;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\t$.fire(webview, eventType);\r\n\t\t\tvar list = webview.children();\r\n\t\t\tfor(var i = 0; i < list.length; i++) {\r\n\t\t\t\t$.fire(list[i], eventType);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t};\r\n\t/**\r\n\t * 打开新窗口\r\n\t * @param {string} url 要打开的页面地址\r\n\t * @param {string} id 指定页面ID\r\n\t * @param {object} options 可选:参数,等待,窗口,显示配置{params:{},waiting:{},styles:{},show:{}}\r\n\t */\r\n\t$.openWindow = function(url, id, options) {\r\n\t\tif(typeof url === 'object') {\r\n\t\t\toptions = url;\r\n\t\t\turl = options.url;\r\n\t\t\tid = options.id || url;\r\n\t\t} else {\r\n\t\t\tif(typeof id === 'object') {\r\n\t\t\t\toptions = id;\r\n\t\t\t\tid = options.id || url;\r\n\t\t\t} else {\r\n\t\t\t\tid = id || url;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(!$.os.plus) {\r\n\t\t\t//TODO 先临时这么处理：手机上顶层跳，PC上parent跳\r\n\t\t\tif($.os.ios || $.os.android) {\r\n\t\t\t\twindow.top.location.href = url;\r\n\t\t\t} else {\r\n\t\t\t\twindow.parent.location.href = url;\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif(!window.plus) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\toptions = options || {};\r\n\t\tvar params = options.params || {};\r\n\t\tvar webview = null,\r\n\t\t\twebviewCache = null,\r\n\t\t\tnShow, nWaiting;\r\n\r\n\t\tif($.webviews[id]) {\r\n\t\t\twebviewCache = $.webviews[id];\r\n\t\t\t//webview真实存在，才能获取\r\n\t\t\tif(plus.webview.getWebviewById(id)) {\r\n\t\t\t\twebview = webviewCache.webview;\r\n\t\t\t}\r\n\t\t} else if(options.createNew !== true) {\r\n\t\t\twebview = plus.webview.getWebviewById(id);\r\n\t\t}\r\n\r\n\t\tif(webview) { //已缓存\r\n\t\t\t//每次show都需要传递动画参数；\r\n\t\t\t//预加载的动画参数优先级：openWindow配置>preloadPages配置>mui默认配置；\r\n\t\t\tnShow = webviewCache ? webviewCache.show : defaultShow;\r\n\t\t\tnShow = options.show ? $.extend(nShow, options.show) : nShow;\r\n\t\t\tnShow.autoShow && webview.show(nShow.aniShow, nShow.duration, function() {\r\n\t\t\t\ttriggerPreload(webview);\r\n\t\t\t\ttrigger(webview, 'pagebeforeshow', false);\r\n\t\t\t});\r\n\t\t\tif(webviewCache) {\r\n\t\t\t\twebviewCache.afterShowMethodName && webview.evalJS(webviewCache.afterShowMethodName + '(\\'' + JSON.stringify(params) + '\\')');\r\n\t\t\t}\r\n\t\t\treturn webview;\r\n\t\t} else { //新窗口\r\n\t\t\tif(!url) {\r\n\t\t\t\tthrow new Error('webview[' + id + '] does not exist');\r\n\t\t\t}\r\n\r\n\t\t\t//显示waiting\r\n\t\t\tvar waitingConfig = $.waitingOptions(options.waiting);\r\n\t\t\tif(waitingConfig.autoShow) {\r\n\t\t\t\tnWaiting = plus.nativeUI.showWaiting(waitingConfig.title, waitingConfig.options);\r\n\t\t\t}\r\n\r\n\t\t\t//创建页面\r\n\t\t\toptions = $.extend(options, {\r\n\t\t\t\tid: id,\r\n\t\t\t\turl: url\r\n\t\t\t});\r\n\r\n\t\t\twebview = $.createWindow(options);\r\n\r\n\t\t\t//显示\r\n\t\t\tnShow = $.showOptions(options.show);\r\n\t\t\tif(nShow.autoShow) {\r\n\t\t\t\tvar showWebview = function() {\r\n\t\t\t\t\t//关闭等待框\r\n\t\t\t\t\tif(nWaiting) {\r\n\t\t\t\t\t\tnWaiting.close();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//显示页面\r\n\t\t\t\t\twebview.show(nShow.aniShow, nShow.duration, function() {},nShow.extras);\r\n\t\t\t\t\toptions.afterShowMethodName && webview.evalJS(options.afterShowMethodName + '(\\'' + JSON.stringify(params) + '\\')');\r\n\t\t\t\t};\r\n\t\t\t\t//titleUpdate触发时机早于loaded，更换为titleUpdate后，可以更早的显示webview\r\n\t\t\t\twebview.addEventListener(nShow.event, showWebview, false);\r\n\t\t\t\t//loaded事件发生后，触发预加载和pagebeforeshow事件\r\n\t\t\t\twebview.addEventListener(\"loaded\", function() {\r\n\t\t\t\t\ttriggerPreload(webview);\r\n\t\t\t\t\ttrigger(webview, 'pagebeforeshow', false);\r\n\t\t\t\t}, false);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn webview;\r\n\t};\r\n\r\n\t$.openWindowWithTitle = function(options, titleConfig) {\r\n\t\toptions = options || {};\r\n\t\tvar url = options.url;\r\n\t\tvar id = options.id || url;\r\n\r\n\t\tif(!$.os.plus) {\r\n\t\t\t//TODO 先临时这么处理：手机上顶层跳，PC上parent跳\r\n\t\t\tif($.os.ios || $.os.android) {\r\n\t\t\t\twindow.top.location.href = url;\r\n\t\t\t} else {\r\n\t\t\t\twindow.parent.location.href = url;\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif(!window.plus) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar params = options.params || {};\r\n\t\tvar webview = null,\r\n\t\t\twebviewCache = null,\r\n\t\t\tnShow, nWaiting;\r\n\r\n\t\tif($.webviews[id]) {\r\n\t\t\twebviewCache = $.webviews[id];\r\n\t\t\t//webview真实存在，才能获取\r\n\t\t\tif(plus.webview.getWebviewById(id)) {\r\n\t\t\t\twebview = webviewCache.webview;\r\n\t\t\t}\r\n\t\t} else if(options.createNew !== true) {\r\n\t\t\twebview = plus.webview.getWebviewById(id);\r\n\t\t}\r\n\r\n\t\tif(webview) { //已缓存\r\n\t\t\t//每次show都需要传递动画参数；\r\n\t\t\t//预加载的动画参数优先级：openWindow配置>preloadPages配置>mui默认配置；\r\n\t\t\tnShow = webviewCache ? webviewCache.show : defaultShow;\r\n\t\t\tnShow = options.show ? $.extend(nShow, options.show) : nShow;\r\n\t\t\tnShow.autoShow && webview.show(nShow.aniShow, nShow.duration, function() {\r\n\t\t\t\ttriggerPreload(webview);\r\n\t\t\t\ttrigger(webview, 'pagebeforeshow', false);\r\n\t\t\t});\r\n\t\t\tif(webviewCache) {\r\n\t\t\t\twebviewCache.afterShowMethodName && webview.evalJS(webviewCache.afterShowMethodName + '(\\'' + JSON.stringify(params) + '\\')');\r\n\t\t\t}\r\n\t\t\treturn webview;\r\n\t\t} else { //新窗口\r\n\t\t\tif(!url) {\r\n\t\t\t\tthrow new Error('webview[' + id + '] does not exist');\r\n\t\t\t}\r\n\r\n\t\t\t//显示waiting\r\n\t\t\tvar waitingConfig = $.waitingOptions(options.waiting);\r\n\t\t\tif(waitingConfig.autoShow) {\r\n\t\t\t\tnWaiting = plus.nativeUI.showWaiting(waitingConfig.title, waitingConfig.options);\r\n\t\t\t}\r\n\r\n\t\t\t//创建页面\r\n\t\t\toptions = $.extend(options, {\r\n\t\t\t\tid: id,\r\n\t\t\t\turl: url\r\n\t\t\t});\r\n\r\n\t\t\twebview = $.createWindow(options);\r\n\r\n\t\t\tif(titleConfig) { //处理原生头\r\n\t\t\t\t$.extend(true, $.options.titleConfig, titleConfig);\r\n\t\t\t\tvar tid = $.options.titleConfig.id ? $.options.titleConfig.id : id + \"_title\";\r\n\t\t\t\tvar view = new plus.nativeObj.View(tid, {\r\n\t\t\t\t\ttop: 0,\r\n\t\t\t\t\theight: $.options.titleConfig.height,\r\n\t\t\t\t\twidth: \"100%\",\r\n\t\t\t\t\tdock: \"top\",\r\n\t\t\t\t\tposition: \"dock\"\r\n\t\t\t\t});\r\n\t\t\t\tview.drawRect($.options.titleConfig.backgroundColor); //绘制背景色\r\n\t\t\t\tvar _b = parseInt($.options.titleConfig.height) - 1;\r\n\t\t\t\tview.drawRect($.options.titleConfig.bottomBorderColor, {\r\n\t\t\t\t\ttop: _b + \"px\",\r\n\t\t\t\t\tleft: \"0px\"\r\n\t\t\t\t}); //绘制底部边线\r\n\r\n\t\t\t\t//绘制文字\r\n\t\t\t\tif($.options.titleConfig.title.text){\r\n\t\t\t\t\tvar _title = $.options.titleConfig.title;\r\n\t\t\t\t\tview.drawText(_title.text,_title.position , _title.styles);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t//返回图标绘制\r\n\t\t\t\tvar _back = $.options.titleConfig.back;\r\n\t\t\t\tvar backClick = null;\r\n\t\t\t\t//优先字体\r\n\r\n\t\t\t\t//其次是图片\r\n\t\t\t\tvar _backImage = _back.image;\r\n\t\t\t\tif(_backImage.base64Data || _backImage.imgSrc) {\r\n\t\t\t\t\t//TODO 此处需要处理百分比的情况\r\n\t\t\t\t\tbackClick = {\r\n\t\t\t\t\t\tleft:parseInt(_backImage.position.left),\r\n\t\t\t\t\t\tright:parseInt(_backImage.position.left) + parseInt(_backImage.position.width)\r\n\t\t\t\t\t};\r\n\t\t\t\t\tvar bitmap = new plus.nativeObj.Bitmap(id + \"_back\");\r\n\t\t\t\t\tif(_backImage.base64Data) { //优先base64编码字符串\r\n\t\t\t\t\t\tbitmap.loadBase64Data(_backImage.base64Data);\r\n\t\t\t\t\t} else { //其次加载图片文件\r\n\t\t\t\t\t\tbitmap.load(_backImage.imgSrc);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tview.drawBitmap(bitmap,_backImage.sprite , _backImage.position);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//处理点击事件\r\n\t\t\t\tview.setTouchEventRect({\r\n\t\t\t\t\ttop: \"0px\",\r\n\t\t\t\t\tleft: \"0px\",\r\n\t\t\t\t\twidth: \"100%\",\r\n\t\t\t\t\theight: \"100%\"\r\n\t\t\t\t});\r\n\t\t\t\tview.interceptTouchEvent(true);\r\n\t\t\t\tview.addEventListener(\"click\", function(e) {\r\n\t\t\t\t\tvar x = e.clientX;\r\n\t\t\t\t\t\r\n\t\t\t\t\t//返回按钮点击\r\n\t\t\t\t\tif(backClick&& x > backClick.left && x < backClick.right){\r\n\t\t\t\t\t\tif( _back.click && $.isFunction(_back.click)){\r\n\t\t\t\t\t\t\t_back.click();\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\twebview.evalJS(\"window.mui&&mui.back();\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}, false);\r\n\t\t\t\twebview.append(view);\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//显示\r\n\t\t\tnShow = $.showOptions(options.show);\r\n\t\t\tif(nShow.autoShow) {\r\n\t\t\t\t//titleUpdate触发时机早于loaded，更换为titleUpdate后，可以更早的显示webview\r\n\t\t\t\twebview.addEventListener(nShow.event, function () {\r\n\t\t\t\t\t//关闭等待框\r\n\t\t\t\t\tif(nWaiting) {\r\n\t\t\t\t\t\tnWaiting.close();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//显示页面\r\n\t\t\t\t\twebview.show(nShow.aniShow, nShow.duration, function() {},nShow.extras);\r\n\t\t\t\t}, false);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn webview;\r\n\t};\r\n\r\n\t/**\r\n\t * 根据配置信息创建一个webview\r\n\t * @param {type} options\r\n\t * @param {type} isCreate\r\n\t * @returns {webview}\r\n\t */\r\n\t$.createWindow = function(options, isCreate) {\r\n\t\tif(!window.plus) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar id = options.id || options.url;\r\n\t\tvar webview;\r\n\t\tif(options.preload) {\r\n\t\t\tif($.webviews[id] && $.webviews[id].webview.getURL()) { //已经cache\r\n\t\t\t\twebview = $.webviews[id].webview;\r\n\t\t\t} else { //新增预加载窗口\r\n\t\t\t\t//判断是否携带createNew参数，默认为false\r\n\t\t\t\tif(options.createNew !== true) {\r\n\t\t\t\t\twebview = plus.webview.getWebviewById(id);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//之前没有，那就新创建\t\r\n\t\t\t\tif(!webview) {\r\n\t\t\t\t\twebview = plus.webview.create(options.url, id, $.windowOptions(options.styles), $.extend({\r\n\t\t\t\t\t\tpreload: true\r\n\t\t\t\t\t}, options.extras));\r\n\t\t\t\t\tif(options.subpages) {\r\n\t\t\t\t\t\t$.each(options.subpages, function(index, subpage) {\r\n\t\t\t\t\t\t\tvar subpageId = subpage.id || subpage.url;\r\n\t\t\t\t\t\t\tif(subpageId) { //过滤空对象\r\n\t\t\t\t\t\t\t\tvar subWebview = plus.webview.getWebviewById(subpageId);\r\n\t\t\t\t\t\t\t\tif(!subWebview) { //如果该webview不存在，则创建\r\n\t\t\t\t\t\t\t\t\tsubWebview = plus.webview.create(subpage.url, subpageId, $.windowOptions(subpage.styles), $.extend({\r\n\t\t\t\t\t\t\t\t\t\tpreload: true\r\n\t\t\t\t\t\t\t\t\t}, subpage.extras));\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\twebview.append(subWebview);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t//TODO 理论上，子webview也应该计算到预加载队列中，但这样就麻烦了，要退必须退整体，否则可能出现问题；\r\n\t\t\t$.webviews[id] = {\r\n\t\t\t\twebview: webview, //目前仅preload的缓存webview\r\n\t\t\t\tpreload: true,\r\n\t\t\t\tshow: $.showOptions(options.show),\r\n\t\t\t\tafterShowMethodName: options.afterShowMethodName //就不应该用evalJS。应该是通过事件消息通讯\r\n\t\t\t};\r\n\t\t\t//索引该预加载窗口\r\n\t\t\tvar preloads = $.data.preloads;\r\n\t\t\tvar index = preloads.indexOf(id);\r\n\t\t\tif(~index) { //删除已存在的(变相调整插入位置)\r\n\t\t\t\tpreloads.splice(index, 1);\r\n\t\t\t}\r\n\t\t\tpreloads.push(id);\r\n\t\t\tif(preloads.length > $.options.preloadLimit) {\r\n\t\t\t\t//先进先出\r\n\t\t\t\tvar first = $.data.preloads.shift();\r\n\t\t\t\tvar webviewCache = $.webviews[first];\r\n\t\t\t\tif(webviewCache && webviewCache.webview) {\r\n\t\t\t\t\t//需要将自己打开的所有页面，全部close；\r\n\t\t\t\t\t//关闭该预加载webview\t\r\n\t\t\t\t\t$.closeAll(webviewCache.webview);\r\n\t\t\t\t}\r\n\t\t\t\t//删除缓存\r\n\t\t\t\tdelete $.webviews[first];\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif(isCreate !== false) { //直接创建非预加载窗口\r\n\t\t\t\twebview = plus.webview.create(options.url, id, $.windowOptions(options.styles), options.extras);\r\n\t\t\t\tif(options.subpages) {\r\n\t\t\t\t\t$.each(options.subpages, function(index, subpage) {\r\n\t\t\t\t\t\tvar subpageId = subpage.id || subpage.url;\r\n\t\t\t\t\t\tvar subWebview = plus.webview.getWebviewById(subpageId);\r\n\t\t\t\t\t\tif(!subWebview) {\r\n\t\t\t\t\t\t\tsubWebview = plus.webview.create(subpage.url, subpageId, $.windowOptions(subpage.styles), subpage.extras);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\twebview.append(subWebview);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn webview;\r\n\t};\r\n\r\n\t/**\r\n\t * 预加载\r\n\t */\r\n\t$.preload = function(options) {\r\n\t\t//调用预加载函数，不管是否传递preload参数，强制变为true\r\n\t\tif(!options.preload) {\r\n\t\t\toptions.preload = true;\r\n\t\t}\r\n\t\treturn $.createWindow(options);\r\n\t};\r\n\r\n\t/**\r\n\t *关闭当前webview打开的所有webview；\r\n\t */\r\n\t$.closeOpened = function(webview) {\r\n\t\tvar opened = webview.opened();\r\n\t\tif(opened) {\r\n\t\t\tfor(var i = 0, len = opened.length; i < len; i++) {\r\n\t\t\t\tvar openedWebview = opened[i];\r\n\t\t\t\tvar open_open = openedWebview.opened();\r\n\t\t\t\tif(open_open && open_open.length > 0) {\r\n\t\t\t\t\t//关闭打开的webview\r\n\t\t\t\t\t$.closeOpened(openedWebview);\r\n\t\t\t\t\t//关闭自己\r\n\t\t\t\t\topenedWebview.close(\"none\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\t//如果直接孩子节点，就不用关闭了，因为父关闭的时候，会自动关闭子；\r\n\t\t\t\t\tif(openedWebview.parent() !== webview) {\r\n\t\t\t\t\t\topenedWebview.close('none');\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\t$.closeAll = function(webview, aniShow) {\r\n\t\t$.closeOpened(webview);\r\n\t\tif(aniShow) {\r\n\t\t\twebview.close(aniShow);\r\n\t\t} else {\r\n\t\t\twebview.close();\r\n\t\t}\r\n\t};\r\n\r\n\t/**\r\n\t * 批量创建webview\r\n\t * @param {type} options\r\n\t * @returns {undefined}\r\n\t */\r\n\t$.createWindows = function(options) {\r\n\t\t$.each(options, function(index, option) {\r\n\t\t\t//初始化预加载窗口(创建)和非预加载窗口(仅配置，不创建)\r\n\t\t\t$.createWindow(option, false);\r\n\t\t});\r\n\t};\r\n\t/**\r\n\t * 创建当前页面的子webview\r\n\t * @param {type} options\r\n\t * @returns {webview}\r\n\t */\r\n\t$.appendWebview = function(options) {\r\n\t\tif(!window.plus) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar id = options.id || options.url;\r\n\t\tvar webview;\r\n\t\tif(!$.webviews[id]) { //保证执行一遍\r\n\t\t\t//TODO 这里也有隐患，比如某个webview不是作为subpage创建的，而是作为target webview的话；\r\n\t\t\tif(!plus.webview.getWebviewById(id)) {\r\n\t\t\t\twebview = plus.webview.create(options.url, id, options.styles, options.extras);\r\n\t\t\t}\r\n\t\t\t//之前的实现方案：子窗口loaded之后再append到父窗口中；\r\n\t\t\t//问题：部分子窗口loaded事件发生较晚，此时执行父窗口的children方法会返回空，导致父子通讯失败；\r\n\t\t\t//     比如父页面执行完preload事件后，需触发子页面的preload事件，此时未append的话，就无法触发；\r\n\t\t\t//修改方式：不再监控loaded事件，直接append\r\n\t\t\t//by chb@20150521\r\n\t\t\t// webview.addEventListener('loaded', function() {\r\n\t\t\tplus.webview.currentWebview().append(webview);\r\n\t\t\t// });\r\n\t\t\t$.webviews[id] = options;\r\n\r\n\t\t}\r\n\t\treturn webview;\r\n\t};\r\n\r\n\t//全局webviews\r\n\t$.webviews = {};\r\n\t//预加载窗口索引\r\n\t$.data.preloads = [];\r\n\t//$.currentWebview\r\n\t$.plusReady(function() {\r\n\t\t$.currentWebview = plus.webview.currentWebview();\r\n\t});\r\n\t$.addInit({\r\n\t\tname: '5+',\r\n\t\tindex: 100,\r\n\t\thandle: function() {\r\n\t\t\tvar options = $.options;\r\n\t\t\tvar subpages = options.subpages || [];\r\n\t\t\tif($.os.plus) {\r\n\t\t\t\t$.plusReady(function() {\r\n\t\t\t\t\t//TODO  这里需要判断一下，最好等子窗口加载完毕后，再调用主窗口的show方法；\r\n\t\t\t\t\t//或者：在openwindow方法中，监听实现；\r\n\t\t\t\t\t$.each(subpages, function(index, subpage) {\r\n\t\t\t\t\t\t$.appendWebview(subpage);\r\n\t\t\t\t\t});\r\n\t\t\t\t\t//判断是否首页\r\n\t\t\t\t\tif(plus.webview.currentWebview() === plus.webview.getWebviewById(plus.runtime.appid)) {\r\n\t\t\t\t\t\t//首页需要自己激活预加载；\r\n\t\t\t\t\t\t//timeout因为子页面loaded之后才append的，防止子页面尚未append、从而导致其preload未触发的问题；\r\n\t\t\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t\t\ttriggerPreload(plus.webview.currentWebview());\r\n\t\t\t\t\t\t}, 300);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//设置ios顶部状态栏颜色；\r\n\t\t\t\t\tif($.os.ios && $.options.statusBarBackground) {\r\n\t\t\t\t\t\tplus.navigator.setStatusBarBackground($.options.statusBarBackground);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif($.os.android && parseFloat($.os.version) < 4.4) {\r\n\t\t\t\t\t\t//解决Android平台4.4版本以下，resume后，父窗体标题延迟渲染的问题；\r\n\t\t\t\t\t\tif(plus.webview.currentWebview().parent() == null) {\r\n\t\t\t\t\t\t\tdocument.addEventListener(\"resume\", function() {\r\n\t\t\t\t\t\t\t\tvar body = document.body;\r\n\t\t\t\t\t\t\t\tbody.style.display = 'none';\r\n\t\t\t\t\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t\t\t\t\tbody.style.display = '';\r\n\t\t\t\t\t\t\t\t}, 10);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\t//已支持iframe嵌入\r\n\t\t\t\t//\t\t\t\tif (subpages.length > 0) {\r\n\t\t\t\t//\t\t\t\t\tvar err = document.createElement('div');\r\n\t\t\t\t//\t\t\t\t\terr.className = 'mui-error';\r\n\t\t\t\t//\t\t\t\t\t//文字描述\r\n\t\t\t\t//\t\t\t\t\tvar span = document.createElement('span');\r\n\t\t\t\t//\t\t\t\t\tspan.innerHTML = '在该浏览器下，不支持创建子页面，具体参考';\r\n\t\t\t\t//\t\t\t\t\terr.appendChild(span);\r\n\t\t\t\t//\t\t\t\t\tvar a = document.createElement('a');\r\n\t\t\t\t//\t\t\t\t\ta.innerHTML = '\"mui框架适用场景\"';\r\n\t\t\t\t//\t\t\t\t\ta.href = 'http://ask.dcloud.net.cn/article/113';\r\n\t\t\t\t//\t\t\t\t\terr.appendChild(a);\r\n\t\t\t\t//\t\t\t\t\tdocument.body.appendChild(err);\r\n\t\t\t\t//\t\t\t\t\tconsole.log('在该浏览器下，不支持创建子页面');\r\n\t\t\t\t//\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t});\r\n\twindow.addEventListener('preload', function() {\r\n\t\t//处理预加载部分\r\n\t\tvar webviews = $.options.preloadPages || [];\r\n\t\t$.plusReady(function() {\r\n\t\t\t$.each(webviews, function(index, webview) {\r\n\t\t\t\t$.createWindow($.extend(webview, {\r\n\t\t\t\t\tpreload: true\r\n\t\t\t\t}));\r\n\t\t\t});\r\n\r\n\t\t});\r\n\t});\r\n\t$.supportStatusbarOffset = function() {\r\n\t\treturn $.os.plus && $.os.ios && parseFloat($.os.version) >= 7;\r\n\t};\r\n\t$.ready(function() {\r\n\t\t//标识当前环境支持statusbar\r\n\t\tif($.supportStatusbarOffset()) {\r\n\t\t\tdocument.body.classList.add('mui-statusbar');\r\n\t\t}\r\n\t});\r\n})(mui);\r\n\r\n/**\r\n * mui back\r\n * @param {type} $\r\n * @param {type} window\r\n * @returns {undefined}\r\n */\r\n(function($, window) {\r\n\t/**\r\n\t * register back\r\n\t * @param {type} back\r\n\t * @returns {$.gestures}\r\n\t */\r\n\t$.addBack = function(back) {\r\n\t\treturn $.addAction('backs', back);\r\n\t};\r\n\t/**\r\n\t * default\r\n\t */\r\n\t$.addBack({\r\n\t\tname: 'browser',\r\n\t\tindex: 100,\r\n\t\thandle: function() {\r\n\t\t\tif (window.history.length > 1) {\r\n\t\t\t\twindow.history.back();\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t}\r\n\t});\r\n\t/**\r\n\t * 后退\r\n\t */\r\n\t$.back = function() {\r\n\t\tif (typeof $.options.beforeback === 'function') {\r\n\t\t\tif ($.options.beforeback() === false) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\t\t$.doAction('backs');\r\n\t};\r\n\twindow.addEventListener('tap', function(e) {\r\n\t\tvar action = $.targets.action;\r\n\t\tif (action && action.classList.contains('mui-action-back')) {\r\n\t\t\t$.back();\r\n\t\t\t$.targets.action = false;\r\n\t\t}\r\n\t});\r\n\twindow.addEventListener('swiperight', function(e) {\r\n\t\tvar detail = e.detail;\r\n\t\tif ($.options.swipeBack === true && Math.abs(detail.angle) < 3) {\r\n\t\t\t$.back();\r\n\t\t}\r\n\t});\r\n\r\n})(mui, window);\r\n/**\r\n * mui back 5+\r\n * @param {type} $\r\n * @param {type} window\r\n * @returns {undefined}\r\n */\r\n(function($, window) {\r\n\tif ($.os.plus && $.os.android) {\r\n\t\t$.addBack({\r\n\t\t\tname: 'mui',\r\n\t\t\tindex: 5,\r\n\t\t\thandle: function() {\r\n\t\t\t\t//后续重新设计此处，将back放到各个空间内部实现\r\n\t\t\t\t//popover\r\n\t\t\t\tif ($.targets._popover && $.targets._popover.classList.contains('mui-active')) {\r\n\t\t\t\t\t$($.targets._popover).popover('hide');\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t\t//offcanvas\r\n\t\t\t\tvar offCanvas = document.querySelector('.mui-off-canvas-wrap.mui-active');\r\n\t\t\t\tif (offCanvas) {\r\n\t\t\t\t\t$(offCanvas).offCanvas('close');\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t\tvar previewImage = $.isFunction($.getPreviewImage) && $.getPreviewImage();\r\n\t\t\t\tif (previewImage && previewImage.isShown()) {\r\n\t\t\t\t\tpreviewImage.close();\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t\t//popup\r\n\t\t\t\treturn $.closePopup();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t//首次按下back按键的时间\r\n\t$.__back__first = null;\r\n\t/**\r\n\t * 5+ back\r\n\t */\r\n\t$.addBack({\r\n\t\tname: '5+',\r\n\t\tindex: 10,\r\n\t\thandle: function() {\r\n\t\t\tif (!window.plus) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tvar wobj = plus.webview.currentWebview();\r\n\t\t\tvar parent = wobj.parent();\r\n\t\t\tif (parent) {\r\n\t\t\t\tparent.evalJS('mui&&mui.back();');\r\n\t\t\t} else {\r\n\t\t\t\twobj.canBack(function(e) {\r\n\t\t\t\t\t//by chb 暂时注释，在碰到类似popover之类的锚点的时候，需多次点击才能返回；\r\n\t\t\t\t\tif (e.canBack) { //webview history back\r\n\t\t\t\t\t\twindow.history.back();\r\n\t\t\t\t\t} else { //webview close or hide\r\n\t\t\t\t\t\t//fixed by fxy 此处不应该用opener判断，因为用户有可能自己close掉当前窗口的opener。这样的话。opener就为空了，导致不能执行close\r\n\t\t\t\t\t\tif (wobj.id === plus.runtime.appid) { //首页\r\n\t\t\t\t\t\t\t//首页不存在opener的情况下，后退实际上应该是退出应用；\r\n\t\t\t\t\t\t\t//首次按键，提示‘再按一次退出应用’\r\n\t\t\t\t\t\t\tif (!$.__back__first) {\r\n\t\t\t\t\t\t\t\t$.__back__first = new Date().getTime();\r\n\t\t\t\t\t\t\t\tmui.toast('再按一次退出应用');\r\n\t\t\t\t\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t\t\t\t\t$.__back__first = null;\r\n\t\t\t\t\t\t\t\t}, 2000);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tif (new Date().getTime() - $.__back__first < 2000) {\r\n\t\t\t\t\t\t\t\t\tplus.runtime.quit();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else { //其他页面，\r\n\t\t\t\t\t\t\tif (wobj.preload) {\r\n\t\t\t\t\t\t\t\twobj.hide(\"auto\");\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t//关闭页面时，需要将其打开的所有子页面全部关闭；\r\n\t\t\t\t\t\t\t\t$.closeAll(wobj);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t}\r\n\t});\r\n\r\n\r\n\t$.menu = function() {\r\n\t\tvar menu = document.querySelector('.mui-action-menu');\r\n\t\tif (menu) {\r\n\t\t\t$.trigger(menu, $.EVENT_START); //临时处理menu无touchstart的话，找不到当前targets的问题\r\n\t\t\t$.trigger(menu, 'tap');\r\n\t\t} else { //执行父窗口的menu\r\n\t\t\tif (window.plus) {\r\n\t\t\t\tvar wobj = $.currentWebview;\r\n\t\t\t\tvar parent = wobj.parent();\r\n\t\t\t\tif (parent) { //又得evalJS\r\n\t\t\t\t\tparent.evalJS('mui&&mui.menu();');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\tvar __back = function() {\r\n\t\t$.back();\r\n\t};\r\n\tvar __menu = function() {\r\n\t\t$.menu();\r\n\t};\r\n\t//默认监听\r\n\t$.plusReady(function() {\r\n\t\tif ($.options.keyEventBind.backbutton) {\r\n\t\t\tplus.key.addEventListener('backbutton', __back, false);\r\n\t\t}\r\n\t\tif ($.options.keyEventBind.menubutton) {\r\n\t\t\tplus.key.addEventListener('menubutton', __menu, false);\r\n\t\t}\r\n\t});\r\n\t//处理按键监听事件\r\n\t$.addInit({\r\n\t\tname: 'keyEventBind',\r\n\t\tindex: 1000,\r\n\t\thandle: function() {\r\n\t\t\t$.plusReady(function() {\r\n\t\t\t\t//如果不为true，则移除默认监听\r\n\t\t\t\tif (!$.options.keyEventBind.backbutton) {\r\n\t\t\t\t\tplus.key.removeEventListener('backbutton', __back);\r\n\t\t\t\t}\r\n\t\t\t\tif (!$.options.keyEventBind.menubutton) {\r\n\t\t\t\t\tplus.key.removeEventListener('menubutton', __menu);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t});\r\n})(mui, window);\r\n/**\r\n * mui.init pulldownRefresh\r\n * @param {type} $\r\n * @returns {undefined}\r\n */\r\n(function($) {\r\n\t$.addInit({\r\n\t\tname: 'pullrefresh',\r\n\t\tindex: 1000,\r\n\t\thandle: function() {\r\n\t\t\tvar options = $.options;\r\n\t\t\tvar pullRefreshOptions = options.pullRefresh || {};\r\n\t\t\tvar hasPulldown = pullRefreshOptions.down && pullRefreshOptions.down.hasOwnProperty('callback');\r\n\t\t\tvar hasPullup = pullRefreshOptions.up && pullRefreshOptions.up.hasOwnProperty('callback');\r\n\t\t\tif(hasPulldown || hasPullup) {\r\n\t\t\t\tvar container = pullRefreshOptions.container;\r\n\t\t\t\tif(container) {\r\n\t\t\t\t\tvar $container = $(container);\r\n\t\t\t\t\tif($container.length === 1) {\r\n\t\t\t\t\t\tif($.os.plus) { //5+环境\r\n\t\t\t\t\t\t\tif(hasPulldown && pullRefreshOptions.down.style == \"circle\") { //原生转圈\r\n\t\t\t\t\t\t\t\t$.plusReady(function() {\r\n\t\t\t\t\t\t\t\t\t//这里改写$.fn.pullRefresh\r\n\t\t\t\t\t\t\t\t\t$.fn.pullRefresh = $.fn.pullRefresh_native;\r\n\t\t\t\t\t\t\t\t\t$container.pullRefresh(pullRefreshOptions);\r\n\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t} else if($.os.android) { //非原生转圈，但是Android环境\r\n\t\t\t\t\t\t\t\t$.plusReady(function() {\r\n\t\t\t\t\t\t\t\t\t//这里改写$.fn.pullRefresh\r\n\t\t\t\t\t\t\t\t\t$.fn.pullRefresh = $.fn.pullRefresh_native\r\n\t\t\t\t\t\t\t\t\tvar webview = plus.webview.currentWebview();\r\n\t\t\t\t\t\t\t\t\tif(window.__NWin_Enable__ === false) { //不支持多webview\r\n\t\t\t\t\t\t\t\t\t\t$container.pullRefresh(pullRefreshOptions);\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tif(hasPullup) {\r\n\t\t\t\t\t\t\t\t\t\t\t//当前页面初始化pullup\r\n\t\t\t\t\t\t\t\t\t\t\tvar upOptions = {};\r\n\t\t\t\t\t\t\t\t\t\t\tupOptions.up = pullRefreshOptions.up;\r\n\t\t\t\t\t\t\t\t\t\t\tupOptions.webviewId = webview.id || webview.getURL();\r\n\t\t\t\t\t\t\t\t\t\t\t$container.pullRefresh(upOptions);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tif(hasPulldown) {\r\n\t\t\t\t\t\t\t\t\t\t\tvar parent = webview.parent();\r\n\t\t\t\t\t\t\t\t\t\t\tvar id = webview.id || webview.getURL();\r\n\t\t\t\t\t\t\t\t\t\t\tif(parent) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tif(!hasPullup) { //如果没有上拉加载，需要手动初始化一个默认的pullRefresh，以便当前页面容器可以调用endPulldownToRefresh等方法\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t$container.pullRefresh({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twebviewId: id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\tvar downOptions = {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twebviewId: id//子页面id\r\n\t\t\t\t\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\t\t\t\t\tdownOptions.down = $.extend({}, pullRefreshOptions.down);\r\n\t\t\t\t\t\t\t\t\t\t\t\tdownOptions.down.callback = '_CALLBACK';\r\n\t\t\t\t\t\t\t\t\t\t\t\t//改写父页面的$.fn.pullRefresh\r\n\t\t\t\t\t\t\t\t\t\t\t\tparent.evalJS(\"mui.fn.pullRefresh=mui.fn.pullRefresh_native\");\r\n\t\t\t\t\t\t\t\t\t\t\t\t//父页面初始化pulldown\r\n\t\t\t\t\t\t\t\t\t\t\t\tparent.evalJS(\"mui&&mui(document.querySelector('.mui-content')).pullRefresh('\" + JSON.stringify(downOptions) + \"')\");\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t} else { //非原生转圈，iOS环境\r\n\t\t\t\t\t\t\t\t$container.pullRefresh(pullRefreshOptions);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t$container.pullRefresh(pullRefreshOptions);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n})(mui);\r\n/**\r\n * mui ajax\r\n * @param {type} $\r\n * @returns {undefined}\r\n */\r\n(function($, window, undefined) {\r\n\r\n\tvar jsonType = 'application/json';\r\n\tvar htmlType = 'text/html';\r\n\tvar rscript = /<script\\b[^<]*(?:(?!<\\/script>)<[^<]*)*<\\/script>/gi;\r\n\tvar scriptTypeRE = /^(?:text|application)\\/javascript/i;\r\n\tvar xmlTypeRE = /^(?:text|application)\\/xml/i;\r\n\tvar blankRE = /^\\s*$/;\r\n\r\n\t$.ajaxSettings = {\r\n\t\ttype: 'GET',\r\n\t\tbeforeSend: $.noop,\r\n\t\tsuccess: $.noop,\r\n\t\terror: $.noop,\r\n\t\tcomplete: $.noop,\r\n\t\tcontext: null,\r\n\t\txhr: function(protocol) {\r\n\t\t\treturn new window.XMLHttpRequest();\r\n\t\t},\r\n\t\taccepts: {\r\n\t\t\tscript: 'text/javascript, application/javascript, application/x-javascript',\r\n\t\t\tjson: jsonType,\r\n\t\t\txml: 'application/xml, text/xml',\r\n\t\t\thtml: htmlType,\r\n\t\t\ttext: 'text/plain'\r\n\t\t},\r\n\t\ttimeout: 0,\r\n\t\tprocessData: true,\r\n\t\tcache: true\r\n\t};\r\n\tvar ajaxBeforeSend = function(xhr, settings) {\r\n\t\tvar context = settings.context\r\n\t\tif(settings.beforeSend.call(context, xhr, settings) === false) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t};\r\n\tvar ajaxSuccess = function(data, xhr, settings) {\r\n\t\tsettings.success.call(settings.context, data, 'success', xhr);\r\n\t\tajaxComplete('success', xhr, settings);\r\n\t};\r\n\t// type: \"timeout\", \"error\", \"abort\", \"parsererror\"\r\n\tvar ajaxError = function(error, type, xhr, settings) {\r\n\t\tsettings.error.call(settings.context, xhr, type, error);\r\n\t\tajaxComplete(type, xhr, settings);\r\n\t};\r\n\t// status: \"success\", \"notmodified\", \"error\", \"timeout\", \"abort\", \"parsererror\"\r\n\tvar ajaxComplete = function(status, xhr, settings) {\r\n\t\tsettings.complete.call(settings.context, xhr, status);\r\n\t};\r\n\r\n\tvar serialize = function(params, obj, traditional, scope) {\r\n\t\tvar type, array = $.isArray(obj),\r\n\t\t\thash = $.isPlainObject(obj);\r\n\t\t$.each(obj, function(key, value) {\r\n\t\t\ttype = $.type(value);\r\n\t\t\tif(scope) {\r\n\t\t\t\tkey = traditional ? scope :\r\n\t\t\t\t\tscope + '[' + (hash || type === 'object' || type === 'array' ? key : '') + ']';\r\n\t\t\t}\r\n\t\t\t// handle data in serializeArray() format\r\n\t\t\tif(!scope && array) {\r\n\t\t\t\tparams.add(value.name, value.value);\r\n\t\t\t}\r\n\t\t\t// recurse into nested objects\r\n\t\t\telse if(type === \"array\" || (!traditional && type === \"object\")) {\r\n\t\t\t\tserialize(params, value, traditional, key);\r\n\t\t\t} else {\r\n\t\t\t\tparams.add(key, value);\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\tvar serializeData = function(options) {\r\n\t\tif(options.processData && options.data && typeof options.data !== \"string\") {\r\n\t\t\tvar contentType = options.contentType;\r\n\t\t\tif(!contentType && options.headers) {\r\n\t\t\t\tcontentType = options.headers['Content-Type'];\r\n\t\t\t}\r\n\t\t\tif(contentType && ~contentType.indexOf(jsonType)) { //application/json\r\n\t\t\t\toptions.data = JSON.stringify(options.data);\r\n\t\t\t} else {\r\n\t\t\t\toptions.data = $.param(options.data, options.traditional);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(options.data && (!options.type || options.type.toUpperCase() === 'GET')) {\r\n\t\t\toptions.url = appendQuery(options.url, options.data);\r\n\t\t\toptions.data = undefined;\r\n\t\t}\r\n\t};\r\n\tvar appendQuery = function(url, query) {\r\n\t\tif(query === '') {\r\n\t\t\treturn url;\r\n\t\t}\r\n\t\treturn(url + '&' + query).replace(/[&?]{1,2}/, '?');\r\n\t};\r\n\tvar mimeToDataType = function(mime) {\r\n\t\tif(mime) {\r\n\t\t\tmime = mime.split(';', 2)[0];\r\n\t\t}\r\n\t\treturn mime && (mime === htmlType ? 'html' :\r\n\t\t\tmime === jsonType ? 'json' :\r\n\t\t\tscriptTypeRE.test(mime) ? 'script' :\r\n\t\t\txmlTypeRE.test(mime) && 'xml') || 'text';\r\n\t};\r\n\tvar parseArguments = function(url, data, success, dataType) {\r\n\t\tif($.isFunction(data)) {\r\n\t\t\tdataType = success, success = data, data = undefined;\r\n\t\t}\r\n\t\tif(!$.isFunction(success)) {\r\n\t\t\tdataType = success, success = undefined;\r\n\t\t}\r\n\t\treturn {\r\n\t\t\turl: url,\r\n\t\t\tdata: data,\r\n\t\t\tsuccess: success,\r\n\t\t\tdataType: dataType\r\n\t\t};\r\n\t};\r\n\t$.ajax = function(url, options) {\r\n\t\tif(typeof url === \"object\") {\r\n\t\t\toptions = url;\r\n\t\t\turl = undefined;\r\n\t\t}\r\n\t\tvar settings = options || {};\r\n\t\tsettings.url = url || settings.url;\r\n\t\tfor(var key in $.ajaxSettings) {\r\n\t\t\tif(settings[key] === undefined) {\r\n\t\t\t\tsettings[key] = $.ajaxSettings[key];\r\n\t\t\t}\r\n\t\t}\r\n\t\tserializeData(settings);\r\n\t\tvar dataType = settings.dataType;\r\n\r\n\t\tif(settings.cache === false || ((!options || options.cache !== true) && ('script' === dataType))) {\r\n\t\t\tsettings.url = appendQuery(settings.url, '_=' + $.now());\r\n\t\t}\r\n\t\tvar mime = settings.accepts[dataType && dataType.toLowerCase()];\r\n\t\tvar headers = {};\r\n\t\tvar setHeader = function(name, value) {\r\n\t\t\theaders[name.toLowerCase()] = [name, value];\r\n\t\t};\r\n\t\tvar protocol = /^([\\w-]+:)\\/\\//.test(settings.url) ? RegExp.$1 : window.location.protocol;\r\n\t\tvar xhr = settings.xhr(settings);\r\n\t\tvar nativeSetHeader = xhr.setRequestHeader;\r\n\t\tvar abortTimeout;\r\n\r\n\t\tsetHeader('X-Requested-With', 'XMLHttpRequest');\r\n\t\tsetHeader('Accept', mime || '*/*');\r\n\t\tif(!!(mime = settings.mimeType || mime)) {\r\n\t\t\tif(mime.indexOf(',') > -1) {\r\n\t\t\t\tmime = mime.split(',', 2)[0];\r\n\t\t\t}\r\n\t\t\txhr.overrideMimeType && xhr.overrideMimeType(mime);\r\n\t\t}\r\n\t\tif(settings.contentType || (settings.contentType !== false && settings.data && settings.type.toUpperCase() !== 'GET')) {\r\n\t\t\tsetHeader('Content-Type', settings.contentType || 'application/x-www-form-urlencoded');\r\n\t\t}\r\n\t\tif(settings.headers) {\r\n\t\t\tfor(var name in settings.headers)\r\n\t\t\t\tsetHeader(name, settings.headers[name]);\r\n\t\t}\r\n\t\txhr.setRequestHeader = setHeader;\r\n\r\n\t\txhr.onreadystatechange = function() {\r\n\t\t\tif(xhr.readyState === 4) {\r\n\t\t\t\txhr.onreadystatechange = $.noop;\r\n\t\t\t\tclearTimeout(abortTimeout);\r\n\t\t\t\tvar result, error = false;\r\n\t\t\t\tvar isLocal = protocol === 'file:';\r\n\t\t\t\tif((xhr.status >= 200 && xhr.status < 300) || xhr.status === 304 || (xhr.status === 0 && isLocal && xhr.responseText)) {\r\n\t\t\t\t\tdataType = dataType || mimeToDataType(settings.mimeType || xhr.getResponseHeader('content-type'));\r\n\t\t\t\t\tresult = xhr.responseText;\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\t// http://perfectionkills.com/global-eval-what-are-the-options/\r\n\t\t\t\t\t\tif(dataType === 'script') {\r\n\t\t\t\t\t\t\t(1, eval)(result);\r\n\t\t\t\t\t\t} else if(dataType === 'xml') {\r\n\t\t\t\t\t\t\tresult = xhr.responseXML;\r\n\t\t\t\t\t\t} else if(dataType === 'json') {\r\n\t\t\t\t\t\t\tresult = blankRE.test(result) ? null : $.parseJSON(result);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch(e) {\r\n\t\t\t\t\t\terror = e;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif(error) {\r\n\t\t\t\t\t\tajaxError(error, 'parsererror', xhr, settings);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tajaxSuccess(result, xhr, settings);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar status = xhr.status ? 'error' : 'abort';\r\n\t\t\t\t\tvar statusText = xhr.statusText || null;\r\n\t\t\t\t\tif(isLocal) {\r\n\t\t\t\t\t\tstatus = 'error';\r\n\t\t\t\t\t\tstatusText = '404';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tajaxError(statusText, status, xhr, settings);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t\tif(ajaxBeforeSend(xhr, settings) === false) {\r\n\t\t\txhr.abort();\r\n\t\t\tajaxError(null, 'abort', xhr, settings);\r\n\t\t\treturn xhr;\r\n\t\t}\r\n\r\n\t\tif(settings.xhrFields) {\r\n\t\t\tfor(var name in settings.xhrFields) {\r\n\t\t\t\txhr[name] = settings.xhrFields[name];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar async = 'async' in settings ? settings.async : true;\r\n\r\n\t\txhr.open(settings.type.toUpperCase(), settings.url, async, settings.username, settings.password);\r\n\r\n\t\tfor(var name in headers) {\r\n\t\t\tif(headers.hasOwnProperty(name)) {\r\n\t\t\t\tnativeSetHeader.apply(xhr, headers[name]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(settings.timeout > 0) {\r\n\t\t\tabortTimeout = setTimeout(function() {\r\n\t\t\t\txhr.onreadystatechange = $.noop;\r\n\t\t\t\txhr.abort();\r\n\t\t\t\tajaxError(null, 'timeout', xhr, settings);\r\n\t\t\t}, settings.timeout);\r\n\t\t}\r\n\t\txhr.send(settings.data ? settings.data : null);\r\n\t\treturn xhr;\r\n\t};\r\n\r\n\t$.param = function(obj, traditional) {\r\n\t\tvar params = [];\r\n\t\tparams.add = function(k, v) {\r\n\t\t\tthis.push(encodeURIComponent(k) + '=' + encodeURIComponent(v));\r\n\t\t};\r\n\t\tserialize(params, obj, traditional);\r\n\t\treturn params.join('&').replace(/%20/g, '+');\r\n\t};\r\n\t$.get = function( /* url, data, success, dataType */ ) {\r\n\t\treturn $.ajax(parseArguments.apply(null, arguments));\r\n\t};\r\n\r\n\t$.post = function( /* url, data, success, dataType */ ) {\r\n\t\tvar options = parseArguments.apply(null, arguments);\r\n\t\toptions.type = 'POST';\r\n\t\treturn $.ajax(options);\r\n\t};\r\n\r\n\t$.getJSON = function( /* url, data, success */ ) {\r\n\t\tvar options = parseArguments.apply(null, arguments);\r\n\t\toptions.dataType = 'json';\r\n\t\treturn $.ajax(options);\r\n\t};\r\n\r\n\t$.fn.load = function(url, data, success) {\r\n\t\tif(!this.length)\r\n\t\t\treturn this;\r\n\t\tvar self = this,\r\n\t\t\tparts = url.split(/\\s/),\r\n\t\t\tselector,\r\n\t\t\toptions = parseArguments(url, data, success),\r\n\t\t\tcallback = options.success;\r\n\t\tif(parts.length > 1)\r\n\t\t\toptions.url = parts[0], selector = parts[1];\r\n\t\toptions.success = function(response) {\r\n\t\t\tif(selector) {\r\n\t\t\t\tvar div = document.createElement('div');\r\n\t\t\t\tdiv.innerHTML = response.replace(rscript, \"\");\r\n\t\t\t\tvar selectorDiv = document.createElement('div');\r\n\t\t\t\tvar childs = div.querySelectorAll(selector);\r\n\t\t\t\tif(childs && childs.length > 0) {\r\n\t\t\t\t\tfor(var i = 0, len = childs.length; i < len; i++) {\r\n\t\t\t\t\t\tselectorDiv.appendChild(childs[i]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tself[0].innerHTML = selectorDiv.innerHTML;\r\n\t\t\t} else {\r\n\t\t\t\tself[0].innerHTML = response;\r\n\t\t\t}\r\n\t\t\tcallback && callback.apply(self, arguments);\r\n\t\t};\r\n\t\t$.ajax(options);\r\n\t\treturn this;\r\n\t};\r\n\r\n})(mui, window);\r\n/**\r\n * 5+ ajax\r\n */\r\n(function($) {\r\n\tvar originAnchor = document.createElement('a');\r\n\toriginAnchor.href = window.location.href;\r\n\t$.plusReady(function() {\r\n\t\t$.ajaxSettings = $.extend($.ajaxSettings, {\r\n\t\t\txhr: function(settings) {\r\n\t\t\t\tif (settings.crossDomain) { //强制使用plus跨域\r\n\t\t\t\t\treturn new plus.net.XMLHttpRequest();\r\n\t\t\t\t}\r\n\t\t\t\t//仅在webview的url为远程文件，且ajax请求的资源不同源下使用plus.net.XMLHttpRequest\r\n\t\t\t\tif (originAnchor.protocol !== 'file:') {\r\n\t\t\t\t\tvar urlAnchor = document.createElement('a');\r\n\t\t\t\t\turlAnchor.href = settings.url;\r\n\t\t\t\t\turlAnchor.href = urlAnchor.href;\r\n\t\t\t\t\tsettings.crossDomain = (originAnchor.protocol + '//' + originAnchor.host) !== (urlAnchor.protocol + '//' + urlAnchor.host);\r\n\t\t\t\t\tif (settings.crossDomain) {\r\n\t\t\t\t\t\treturn new plus.net.XMLHttpRequest();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif ($.os.ios && window.webkit && window.webkit.messageHandlers) { //wkwebview下同样使用5+ xhr\r\n                    return new plus.net.XMLHttpRequest();\r\n                }\r\n\t\t\t\treturn new window.XMLHttpRequest();\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n})(mui);\r\n/**\r\n * mui layout(offset[,position,width,height...])\r\n * @param {type} $\r\n * @param {type} window\r\n * @param {type} undefined\r\n * @returns {undefined}\r\n */\r\n(function($, window, undefined) {\r\n\t$.offset = function(element) {\r\n\t\tvar box = {\r\n\t\t\ttop : 0,\r\n\t\t\tleft : 0\r\n\t\t};\r\n\t\tif ( typeof element.getBoundingClientRect !== undefined) {\r\n\t\t\tbox = element.getBoundingClientRect();\r\n\t\t}\r\n\t\treturn {\r\n\t\t\ttop : box.top + window.pageYOffset - element.clientTop,\r\n\t\t\tleft : box.left + window.pageXOffset - element.clientLeft\r\n\t\t};\r\n\t};\r\n})(mui, window); \r\n/**\r\n * mui animation\r\n */\r\n(function($, window) {\r\n\t/**\r\n\t * scrollTo\r\n\t */\r\n\t$.scrollTo = function(scrollTop, duration, callback) {\r\n\t\tduration = duration || 1000;\r\n\t\tvar scroll = function(duration) {\r\n\t\t\tif (duration <= 0) {\r\n\t\t\t\twindow.scrollTo(0, scrollTop);\r\n\t\t\t\tcallback && callback();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar distaince = scrollTop - window.scrollY;\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\twindow.scrollTo(0, window.scrollY + distaince / duration * 10);\r\n\t\t\t\tscroll(duration - 10);\r\n\t\t\t}, 16.7);\r\n\t\t};\r\n\t\tscroll(duration);\r\n\t};\r\n\t$.animationFrame = function(cb) {\r\n\t\tvar args, isQueued, context;\r\n\t\treturn function() {\r\n\t\t\targs = arguments;\r\n\t\t\tcontext = this;\r\n\t\t\tif (!isQueued) {\r\n\t\t\t\tisQueued = true;\r\n\t\t\t\trequestAnimationFrame(function() {\r\n\t\t\t\t\tcb.apply(context, args);\r\n\t\t\t\t\tisQueued = false;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t};\r\n\t};\r\n\r\n})(mui, window);\r\n(function($) {\r\n\tvar initializing = false,\r\n\t\tfnTest = /xyz/.test(function() {\r\n\t\t\txyz;\r\n\t\t}) ? /\\b_super\\b/ : /.*/;\r\n\r\n\tvar Class = function() {};\r\n\tClass.extend = function(prop) {\r\n\t\tvar _super = this.prototype;\r\n\t\tinitializing = true;\r\n\t\tvar prototype = new this();\r\n\t\tinitializing = false;\r\n\t\tfor (var name in prop) {\r\n\t\t\tprototype[name] = typeof prop[name] == \"function\" &&\r\n\t\t\t\ttypeof _super[name] == \"function\" && fnTest.test(prop[name]) ?\r\n\t\t\t\t(function(name, fn) {\r\n\t\t\t\t\treturn function() {\r\n\t\t\t\t\t\tvar tmp = this._super;\r\n\r\n\t\t\t\t\t\tthis._super = _super[name];\r\n\r\n\t\t\t\t\t\tvar ret = fn.apply(this, arguments);\r\n\t\t\t\t\t\tthis._super = tmp;\r\n\r\n\t\t\t\t\t\treturn ret;\r\n\t\t\t\t\t};\r\n\t\t\t\t})(name, prop[name]) :\r\n\t\t\t\tprop[name];\r\n\t\t}\r\n\t\tfunction Class() {\r\n\t\t\tif (!initializing && this.init)\r\n\t\t\t\tthis.init.apply(this, arguments);\r\n\t\t}\r\n\t\tClass.prototype = prototype;\r\n\t\tClass.prototype.constructor = Class;\r\n\t\tClass.extend = arguments.callee;\r\n\t\treturn Class;\r\n\t};\r\n\t$.Class = Class;\r\n})(mui);\r\n(function($, document, undefined) {\r\n    var CLASS_PULL_TOP_POCKET = 'mui-pull-top-pocket';\r\n    var CLASS_PULL_BOTTOM_POCKET = 'mui-pull-bottom-pocket';\r\n    var CLASS_PULL = 'mui-pull';\r\n    var CLASS_PULL_LOADING = 'mui-pull-loading';\r\n    var CLASS_PULL_CAPTION = 'mui-pull-caption';\r\n    var CLASS_PULL_CAPTION_DOWN = 'mui-pull-caption-down';\r\n    var CLASS_PULL_CAPTION_REFRESH = 'mui-pull-caption-refresh';\r\n    var CLASS_PULL_CAPTION_NOMORE = 'mui-pull-caption-nomore';\r\n\r\n    var CLASS_ICON = 'mui-icon';\r\n    var CLASS_SPINNER = 'mui-spinner';\r\n    var CLASS_ICON_PULLDOWN = 'mui-icon-pulldown';\r\n\r\n    var CLASS_BLOCK = 'mui-block';\r\n    var CLASS_HIDDEN = 'mui-hidden';\r\n    var CLASS_VISIBILITY = 'mui-visibility';\r\n\r\n    var CLASS_LOADING_UP = CLASS_PULL_LOADING + ' ' + CLASS_ICON + ' ' + CLASS_ICON_PULLDOWN;\r\n    var CLASS_LOADING_DOWN = CLASS_PULL_LOADING + ' ' + CLASS_ICON + ' ' + CLASS_ICON_PULLDOWN;\r\n    var CLASS_LOADING = CLASS_PULL_LOADING + ' ' + CLASS_ICON + ' ' + CLASS_SPINNER;\r\n\r\n    var pocketHtml = ['<div class=\"' + CLASS_PULL + '\">', '<div class=\"{icon}\"></div>', '<div class=\"' + CLASS_PULL_CAPTION + '\">{contentrefresh}</div>', '</div>'].join('');\r\n\r\n    var PullRefresh = {\r\n        init: function(element, options) {\r\n            this._super(element, $.extend(true, {\r\n                scrollY: true,\r\n                scrollX: false,\r\n                indicators: true,\r\n                deceleration: 0.003,\r\n                down: {\r\n                    height: 50,\r\n                    contentinit: '下拉可以刷新',\r\n                    contentdown: '下拉可以刷新',\r\n                    contentover: '释放立即刷新',\r\n                    contentrefresh: '正在刷新...'\r\n                },\r\n                up: {\r\n                    height: 50,\r\n                    auto: false,\r\n                    contentinit: '上拉显示更多',\r\n                    contentdown: '上拉显示更多',\r\n                    contentrefresh: '正在加载...',\r\n                    contentnomore: '没有更多数据了',\r\n                    duration: 300\r\n                }\r\n            }, options));\r\n        },\r\n        _init: function() {\r\n            this._super();\r\n            this._initPocket();\r\n        },\r\n        _initPulldownRefresh: function() {\r\n            this.pulldown = true;\r\n            if (this.topPocket) {\r\n                this.pullPocket = this.topPocket;\r\n                this.pullPocket.classList.add(CLASS_BLOCK);\r\n                this.pullPocket.classList.add(CLASS_VISIBILITY);\r\n                this.pullCaption = this.topCaption;\r\n                this.pullLoading = this.topLoading;\r\n            }\r\n        },\r\n        _initPullupRefresh: function() {\r\n            this.pulldown = false;\r\n            if (this.bottomPocket) {\r\n                this.pullPocket = this.bottomPocket;\r\n                this.pullPocket.classList.add(CLASS_BLOCK);\r\n                this.pullPocket.classList.add(CLASS_VISIBILITY);\r\n                this.pullCaption = this.bottomCaption;\r\n                this.pullLoading = this.bottomLoading;\r\n            }\r\n        },\r\n        _initPocket: function() {\r\n            var options = this.options;\r\n            if (options.down && options.down.hasOwnProperty('callback')) {\r\n                this.topPocket = this.scroller.querySelector('.' + CLASS_PULL_TOP_POCKET);\r\n                if (!this.topPocket) {\r\n                    this.topPocket = this._createPocket(CLASS_PULL_TOP_POCKET, options.down, CLASS_LOADING_DOWN);\r\n                    this.wrapper.insertBefore(this.topPocket, this.wrapper.firstChild);\r\n                }\r\n                this.topLoading = this.topPocket.querySelector('.' + CLASS_PULL_LOADING);\r\n                this.topCaption = this.topPocket.querySelector('.' + CLASS_PULL_CAPTION);\r\n            }\r\n            if (options.up && options.up.hasOwnProperty('callback')) {\r\n                this.bottomPocket = this.scroller.querySelector('.' + CLASS_PULL_BOTTOM_POCKET);\r\n                if (!this.bottomPocket) {\r\n                    this.bottomPocket = this._createPocket(CLASS_PULL_BOTTOM_POCKET, options.up, CLASS_LOADING);\r\n                    this.scroller.appendChild(this.bottomPocket);\r\n                }\r\n                this.bottomLoading = this.bottomPocket.querySelector('.' + CLASS_PULL_LOADING);\r\n                this.bottomCaption = this.bottomPocket.querySelector('.' + CLASS_PULL_CAPTION);\r\n                //TODO only for h5\r\n                this.wrapper.addEventListener('scrollbottom', this);\r\n            }\r\n        },\r\n        _createPocket: function(clazz, options, iconClass) {\r\n            var pocket = document.createElement('div');\r\n            pocket.className = clazz;\r\n            pocket.innerHTML = pocketHtml.replace('{contentrefresh}', options.contentinit).replace('{icon}', iconClass);\r\n            return pocket;\r\n        },\r\n        _resetPullDownLoading: function() {\r\n            var loading = this.pullLoading;\r\n            if (loading) {\r\n                this.pullCaption.innerHTML = this.options.down.contentdown;\r\n                loading.style.webkitTransition = \"\";\r\n                loading.style.webkitTransform = \"\";\r\n                loading.style.webkitAnimation = \"\";\r\n                loading.className = CLASS_LOADING_DOWN;\r\n            }\r\n        },\r\n        _setCaptionClass: function(isPulldown, caption, title) {\r\n            if (!isPulldown) {\r\n                switch (title) {\r\n                    case this.options.up.contentdown:\r\n                        caption.className = CLASS_PULL_CAPTION + ' ' + CLASS_PULL_CAPTION_DOWN;\r\n                        break;\r\n                    case this.options.up.contentrefresh:\r\n                        caption.className = CLASS_PULL_CAPTION + ' ' + CLASS_PULL_CAPTION_REFRESH\r\n                        break;\r\n                    case this.options.up.contentnomore:\r\n                        caption.className = CLASS_PULL_CAPTION + ' ' + CLASS_PULL_CAPTION_NOMORE;\r\n                        break;\r\n                }\r\n            }\r\n        },\r\n        _setCaption: function(title, reset) {\r\n            if (this.loading) {\r\n                return;\r\n            }\r\n            var options = this.options;\r\n            var pocket = this.pullPocket;\r\n            var caption = this.pullCaption;\r\n            var loading = this.pullLoading;\r\n            var isPulldown = this.pulldown;\r\n            var self = this;\r\n            if (pocket) {\r\n                if (reset) {\r\n                    setTimeout(function() {\r\n                        caption.innerHTML = self.lastTitle = title;\r\n                        if (isPulldown) {\r\n                            loading.className = CLASS_LOADING_DOWN;\r\n                        } else {\r\n                            self._setCaptionClass(false, caption, title);\r\n                            loading.className = CLASS_LOADING;\r\n                        }\r\n                        loading.style.webkitAnimation = \"\";\r\n                        loading.style.webkitTransition = \"\";\r\n                        loading.style.webkitTransform = \"\";\r\n                    }, 100);\r\n                } else {\r\n                    if (title !== this.lastTitle) {\r\n                        caption.innerHTML = title;\r\n                        if (isPulldown) {\r\n                            if (title === options.down.contentrefresh) {\r\n                                loading.className = CLASS_LOADING;\r\n                                loading.style.webkitAnimation = \"spinner-spin 1s step-end infinite\";\r\n                            } else if (title === options.down.contentover) {\r\n                                loading.className = CLASS_LOADING_UP;\r\n                                loading.style.webkitTransition = \"-webkit-transform 0.3s ease-in\";\r\n                                loading.style.webkitTransform = \"rotate(180deg)\";\r\n                            } else if (title === options.down.contentdown) {\r\n                                loading.className = CLASS_LOADING_DOWN;\r\n                                loading.style.webkitTransition = \"-webkit-transform 0.3s ease-in\";\r\n                                loading.style.webkitTransform = \"rotate(0deg)\";\r\n                            }\r\n                        } else {\r\n                            if (title === options.up.contentrefresh) {\r\n                                loading.className = CLASS_LOADING + ' ' + CLASS_VISIBILITY;\r\n                            } else {\r\n                                loading.className = CLASS_LOADING + ' ' + CLASS_HIDDEN;\r\n                            }\r\n                            self._setCaptionClass(false, caption, title);\r\n                        }\r\n                        this.lastTitle = title;\r\n                    }\r\n                }\r\n\r\n            }\r\n        }\r\n    };\r\n    $.PullRefresh = PullRefresh;\r\n})(mui, document);\r\n(function($, window, document, undefined) {\r\n\tvar CLASS_SCROLL = 'mui-scroll';\r\n\tvar CLASS_SCROLLBAR = 'mui-scrollbar';\r\n\tvar CLASS_INDICATOR = 'mui-scrollbar-indicator';\r\n\tvar CLASS_SCROLLBAR_VERTICAL = CLASS_SCROLLBAR + '-vertical';\r\n\tvar CLASS_SCROLLBAR_HORIZONTAL = CLASS_SCROLLBAR + '-horizontal';\r\n\r\n\tvar CLASS_ACTIVE = 'mui-active';\r\n\r\n\tvar ease = {\r\n\t\tquadratic: {\r\n\t\t\tstyle: 'cubic-bezier(0.25, 0.46, 0.45, 0.94)',\r\n\t\t\tfn: function(k) {\r\n\t\t\t\treturn k * (2 - k);\r\n\t\t\t}\r\n\t\t},\r\n\t\tcircular: {\r\n\t\t\tstyle: 'cubic-bezier(0.1, 0.57, 0.1, 1)',\r\n\t\t\tfn: function(k) {\r\n\t\t\t\treturn Math.sqrt(1 - (--k * k));\r\n\t\t\t}\r\n\t\t},\r\n\t\toutCirc: {\r\n\t\t\tstyle: 'cubic-bezier(0.075, 0.82, 0.165, 1)'\r\n\t\t},\r\n\t\toutCubic: {\r\n\t\t\tstyle: 'cubic-bezier(0.165, 0.84, 0.44, 1)'\r\n\t\t}\r\n\t}\r\n\tvar Scroll = $.Class.extend({\r\n\t\tinit: function(element, options) {\r\n\t\t\tthis.wrapper = this.element = element;\r\n\t\t\tthis.scroller = this.wrapper.children[0];\r\n\t\t\tthis.scrollerStyle = this.scroller && this.scroller.style;\r\n\t\t\tthis.stopped = false;\r\n\r\n\t\t\tthis.options = $.extend(true, {\r\n\t\t\t\tscrollY: true, //是否竖向滚动\r\n\t\t\t\tscrollX: false, //是否横向滚动\r\n\t\t\t\tstartX: 0, //初始化时滚动至x\r\n\t\t\t\tstartY: 0, //初始化时滚动至y\r\n\r\n\t\t\t\tindicators: true, //是否显示滚动条\r\n\t\t\t\tstopPropagation: false,\r\n\t\t\t\thardwareAccelerated: true,\r\n\t\t\t\tfixedBadAndorid: false,\r\n\t\t\t\tpreventDefaultException: {\r\n\t\t\t\t\ttagName: /^(INPUT|TEXTAREA|BUTTON|SELECT|VIDEO)$/\r\n\t\t\t\t},\r\n\t\t\t\tmomentum: true,\r\n\r\n\t\t\t\tsnapX: 0.5, //横向切换距离(以当前容器宽度为基准)\r\n\t\t\t\tsnap: false, //图片轮播，拖拽式选项卡\r\n\r\n\t\t\t\tbounce: true, //是否启用回弹\r\n\t\t\t\tbounceTime: 500, //回弹动画时间\r\n\t\t\t\tbounceEasing: ease.outCirc, //回弹动画曲线\r\n\r\n\t\t\t\tscrollTime: 500,\r\n\t\t\t\tscrollEasing: ease.outCubic, //轮播动画曲线\r\n\r\n\t\t\t\tdirectionLockThreshold: 5,\r\n\r\n\t\t\t\tparallaxElement: false, //视差元素\r\n\t\t\t\tparallaxRatio: 0.5\r\n\t\t\t}, options);\r\n\r\n\t\t\tthis.x = 0;\r\n\t\t\tthis.y = 0;\r\n\t\t\tthis.translateZ = this.options.hardwareAccelerated ? ' translateZ(0)' : '';\r\n\r\n\t\t\tthis._init();\r\n\t\t\tif (this.scroller) {\r\n\t\t\t\tthis.refresh();\r\n\t\t\t\t//\t\t\t\tif (this.options.startX !== 0 || this.options.startY !== 0) { //需要判断吗？后续根据实际情况再看看\r\n\t\t\t\tthis.scrollTo(this.options.startX, this.options.startY);\r\n\t\t\t\t//\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\t_init: function() {\r\n\t\t\tthis._initParallax();\r\n\t\t\tthis._initIndicators();\r\n\t\t\tthis._initEvent();\r\n\t\t},\r\n\t\t_initParallax: function() {\r\n\t\t\tif (this.options.parallaxElement) {\r\n\t\t\t\tthis.parallaxElement = document.querySelector(this.options.parallaxElement);\r\n\t\t\t\tthis.parallaxStyle = this.parallaxElement.style;\r\n\t\t\t\tthis.parallaxHeight = this.parallaxElement.offsetHeight;\r\n\t\t\t\tthis.parallaxImgStyle = this.parallaxElement.querySelector('img').style;\r\n\t\t\t}\r\n\t\t},\r\n\t\t_initIndicators: function() {\r\n\t\t\tvar self = this;\r\n\t\t\tself.indicators = [];\r\n\t\t\tif (!this.options.indicators) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar indicators = [],\r\n\t\t\t\tindicator;\r\n\r\n\t\t\t// Vertical scrollbar\r\n\t\t\tif (self.options.scrollY) {\r\n\t\t\t\tindicator = {\r\n\t\t\t\t\tel: this._createScrollBar(CLASS_SCROLLBAR_VERTICAL),\r\n\t\t\t\t\tlistenX: false\r\n\t\t\t\t};\r\n\r\n\t\t\t\tthis.wrapper.appendChild(indicator.el);\r\n\t\t\t\tindicators.push(indicator);\r\n\t\t\t}\r\n\r\n\t\t\t// Horizontal scrollbar\r\n\t\t\tif (this.options.scrollX) {\r\n\t\t\t\tindicator = {\r\n\t\t\t\t\tel: this._createScrollBar(CLASS_SCROLLBAR_HORIZONTAL),\r\n\t\t\t\t\tlistenY: false\r\n\t\t\t\t};\r\n\r\n\t\t\t\tthis.wrapper.appendChild(indicator.el);\r\n\t\t\t\tindicators.push(indicator);\r\n\t\t\t}\r\n\r\n\t\t\tfor (var i = indicators.length; i--;) {\r\n\t\t\t\tthis.indicators.push(new Indicator(this, indicators[i]));\r\n\t\t\t}\r\n\r\n\t\t},\r\n\t\t_initSnap: function() {\r\n\t\t\tthis.currentPage = {};\r\n\t\t\tthis.pages = [];\r\n\t\t\tvar snaps = this.snaps;\r\n\t\t\tvar length = snaps.length;\r\n\t\t\tvar m = 0;\r\n\t\t\tvar n = -1;\r\n\t\t\tvar x = 0;\r\n\t\t\tvar leftX = 0;\r\n\t\t\tvar rightX = 0;\r\n\t\t\tvar snapX = 0;\r\n\t\t\tfor (var i = 0; i < length; i++) {\r\n\t\t\t\tvar snap = snaps[i];\r\n\t\t\t\tvar offsetLeft = snap.offsetLeft;\r\n\t\t\t\tvar offsetWidth = snap.offsetWidth;\r\n\t\t\t\tif (i === 0 || offsetLeft <= snaps[i - 1].offsetLeft) {\r\n\t\t\t\t\tm = 0;\r\n\t\t\t\t\tn++;\r\n\t\t\t\t}\r\n\t\t\t\tif (!this.pages[m]) {\r\n\t\t\t\t\tthis.pages[m] = [];\r\n\t\t\t\t}\r\n\t\t\t\tx = this._getSnapX(offsetLeft);\r\n\t\t\t\tsnapX = Math.round((offsetWidth) * this.options.snapX);\r\n\t\t\t\tleftX = x - snapX;\r\n\t\t\t\trightX = x - offsetWidth + snapX;\r\n\t\t\t\tthis.pages[m][n] = {\r\n\t\t\t\t\tx: x,\r\n\t\t\t\t\tleftX: leftX,\r\n\t\t\t\t\trightX: rightX,\r\n\t\t\t\t\tpageX: m,\r\n\t\t\t\t\telement: snap\r\n\t\t\t\t}\r\n\t\t\t\tif (snap.classList.contains(CLASS_ACTIVE)) {\r\n\t\t\t\t\tthis.currentPage = this.pages[m][0];\r\n\t\t\t\t}\r\n\t\t\t\tif (x >= this.maxScrollX) {\r\n\t\t\t\t\tm++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.options.startX = this.currentPage.x || 0;\r\n\t\t},\r\n\t\t_getSnapX: function(offsetLeft) {\r\n\t\t\treturn Math.max(Math.min(0, -offsetLeft + (this.wrapperWidth / 2)), this.maxScrollX);\r\n\t\t},\r\n\t\t_gotoPage: function(index) {\r\n\t\t\tthis.currentPage = this.pages[Math.min(index, this.pages.length - 1)][0];\r\n\t\t\tfor (var i = 0, len = this.snaps.length; i < len; i++) {\r\n\t\t\t\tif (i === index) {\r\n\t\t\t\t\tthis.snaps[i].classList.add(CLASS_ACTIVE);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.snaps[i].classList.remove(CLASS_ACTIVE);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.scrollTo(this.currentPage.x, 0, this.options.scrollTime);\r\n\t\t},\r\n\t\t_nearestSnap: function(x) {\r\n\t\t\tif (!this.pages.length) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tx: 0,\r\n\t\t\t\t\tpageX: 0\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\tvar i = 0;\r\n\t\t\tvar length = this.pages.length;\r\n\t\t\tif (x > 0) {\r\n\t\t\t\tx = 0;\r\n\t\t\t} else if (x < this.maxScrollX) {\r\n\t\t\t\tx = this.maxScrollX;\r\n\t\t\t}\r\n\t\t\tfor (; i < length; i++) {\r\n\t\t\t\tvar nearestX = this.direction === 'left' ? this.pages[i][0].leftX : this.pages[i][0].rightX;\r\n\t\t\t\tif (x >= nearestX) {\r\n\t\t\t\t\treturn this.pages[i][0];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn {\r\n\t\t\t\tx: 0,\r\n\t\t\t\tpageX: 0\r\n\t\t\t};\r\n\t\t},\r\n\t\t_initEvent: function(detach) {\r\n\t\t\tvar action = detach ? 'removeEventListener' : 'addEventListener';\r\n\t\t\twindow[action]('orientationchange', this);\r\n\t\t\twindow[action]('resize', this);\r\n\r\n\t\t\tthis.scroller[action]('webkitTransitionEnd', this);\r\n\r\n\t\t\tthis.wrapper[action]($.EVENT_START, this);\r\n\t\t\tthis.wrapper[action]($.EVENT_CANCEL, this);\r\n\t\t\tthis.wrapper[action]($.EVENT_END, this);\r\n\t\t\tthis.wrapper[action]('drag', this);\r\n\t\t\tthis.wrapper[action]('dragend', this);\r\n\t\t\tthis.wrapper[action]('flick', this);\r\n\t\t\tthis.wrapper[action]('scrollend', this);\r\n\t\t\tif (this.options.scrollX) {\r\n\t\t\t\tthis.wrapper[action]('swiperight', this);\r\n\t\t\t}\r\n\t\t\tvar segmentedControl = this.wrapper.querySelector('.mui-segmented-control');\r\n\t\t\tif (segmentedControl) { //靠，这个bug排查了一下午，阻止hash跳转，一旦hash跳转会导致可拖拽选项卡的tab不见\r\n\t\t\t\tmui(segmentedControl)[detach ? 'off' : 'on']('click', 'a', $.preventDefault);\r\n\t\t\t}\r\n\r\n\t\t\tthis.wrapper[action]('scrollstart', this);\r\n\t\t\tthis.wrapper[action]('refresh', this);\r\n\t\t},\r\n\t\t_handleIndicatorScrollend: function() {\r\n\t\t\tthis.indicators.map(function(indicator) {\r\n\t\t\t\tindicator.fade();\r\n\t\t\t});\r\n\t\t},\r\n\t\t_handleIndicatorScrollstart: function() {\r\n\t\t\tthis.indicators.map(function(indicator) {\r\n\t\t\t\tindicator.fade(1);\r\n\t\t\t});\r\n\t\t},\r\n\t\t_handleIndicatorRefresh: function() {\r\n\t\t\tthis.indicators.map(function(indicator) {\r\n\t\t\t\tindicator.refresh();\r\n\t\t\t});\r\n\t\t},\r\n\t\thandleEvent: function(e) {\r\n\t\t\tif (this.stopped) {\r\n\t\t\t\tthis.resetPosition();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tswitch (e.type) {\r\n\t\t\t\tcase $.EVENT_START:\r\n\t\t\t\t\tthis._start(e);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'drag':\r\n\t\t\t\t\tthis.options.stopPropagation && e.stopPropagation();\r\n\t\t\t\t\tthis._drag(e);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'dragend':\r\n\t\t\t\tcase 'flick':\r\n\t\t\t\t\tthis.options.stopPropagation && e.stopPropagation();\r\n\t\t\t\t\tthis._flick(e);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase $.EVENT_CANCEL:\r\n\t\t\t\tcase $.EVENT_END:\r\n\t\t\t\t\tthis._end(e);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'webkitTransitionEnd':\r\n\t\t\t\t\tthis.transitionTimer && this.transitionTimer.cancel();\r\n\t\t\t\t\tthis._transitionEnd(e);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'scrollstart':\r\n\t\t\t\t\tthis._handleIndicatorScrollstart(e);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'scrollend':\r\n\t\t\t\t\tthis._handleIndicatorScrollend(e);\r\n\t\t\t\t\tthis._scrollend(e);\r\n\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'orientationchange':\r\n\t\t\t\tcase 'resize':\r\n\t\t\t\t\tthis._resize();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'swiperight':\r\n\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'refresh':\r\n\t\t\t\t\tthis._handleIndicatorRefresh(e);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\t_start: function(e) {\r\n\t\t\tthis.moved = this.needReset = false;\r\n\t\t\tthis._transitionTime();\r\n\t\t\tif (this.isInTransition) {\r\n\t\t\t\tthis.needReset = true;\r\n\t\t\t\tthis.isInTransition = false;\r\n\t\t\t\tvar pos = $.parseTranslateMatrix($.getStyles(this.scroller, 'webkitTransform'));\r\n\t\t\t\tthis.setTranslate(Math.round(pos.x), Math.round(pos.y));\r\n\t\t\t\t//\t\t\t\tthis.resetPosition(); //reset\r\n\t\t\t\t$.trigger(this.scroller, 'scrollend', this);\r\n\t\t\t\t//\t\t\t\te.stopPropagation();\r\n\t\t\t\te.preventDefault();\r\n\t\t\t}\r\n\t\t\tthis.reLayout();\r\n\t\t\t$.trigger(this.scroller, 'beforescrollstart', this);\r\n\t\t},\r\n\t\t_getDirectionByAngle: function(angle) {\r\n\t\t\tif (angle < -80 && angle > -100) {\r\n\t\t\t\treturn 'up';\r\n\t\t\t} else if (angle >= 80 && angle < 100) {\r\n\t\t\t\treturn 'down';\r\n\t\t\t} else if (angle >= 170 || angle <= -170) {\r\n\t\t\t\treturn 'left';\r\n\t\t\t} else if (angle >= -35 && angle <= 10) {\r\n\t\t\t\treturn 'right';\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t},\r\n\t\t_drag: function(e) {\r\n\t\t\t//\t\t\tif (this.needReset) {\r\n\t\t\t//\t\t\t\te.stopPropagation(); //disable parent drag(nested scroller)\r\n\t\t\t//\t\t\t\treturn;\r\n\t\t\t//\t\t\t}\r\n\t\t\tvar detail = e.detail;\r\n\t\t\tif (this.options.scrollY || detail.direction === 'up' || detail.direction === 'down') { //如果是竖向滚动或手势方向是上或下\r\n\t\t\t\t//ios8 hack\r\n\t\t\t\tif ($.os.ios && parseFloat($.os.version) >= 8) { //多webview时，离开当前webview会导致后续touch事件不触发\r\n\t\t\t\t\tvar clientY = detail.gesture.touches[0].clientY;\r\n\t\t\t\t\t//下拉刷新 or 上拉加载\r\n\t\t\t\t\tif ((clientY + 10) > window.innerHeight || clientY < 10) {\r\n\t\t\t\t\t\tthis.resetPosition(this.options.bounceTime);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar isPreventDefault = isReturn = false;\r\n\t\t\tvar direction = this._getDirectionByAngle(detail.angle);\r\n\t\t\tif (detail.direction === 'left' || detail.direction === 'right') {\r\n\t\t\t\tif (this.options.scrollX) {\r\n\t\t\t\t\tisPreventDefault = true;\r\n\t\t\t\t\tif (!this.moved) { //识别角度(该角度导致轮播不灵敏)\r\n\t\t\t\t\t\t//\t\t\t\t\t\tif (direction !== 'left' && direction !== 'right') {\r\n\t\t\t\t\t\t//\t\t\t\t\t\t\tisReturn = true;\r\n\t\t\t\t\t\t//\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t$.gestures.session.lockDirection = true; //锁定方向\r\n\t\t\t\t\t\t$.gestures.session.startDirection = detail.direction;\r\n\t\t\t\t\t\t//\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (this.options.scrollY && !this.moved) {\r\n\t\t\t\t\tisReturn = true;\r\n\t\t\t\t}\r\n\t\t\t} else if (detail.direction === 'up' || detail.direction === 'down') {\r\n\t\t\t\tif (this.options.scrollY) {\r\n\t\t\t\t\tisPreventDefault = true;\r\n\t\t\t\t\t//\t\t\t\t\tif (!this.moved) { //识别角度,竖向滚动似乎没必要进行小角度验证\r\n\t\t\t\t\t//\t\t\t\t\t\tif (direction !== 'up' && direction !== 'down') {\r\n\t\t\t\t\t//\t\t\t\t\t\t\tisReturn = true;\r\n\t\t\t\t\t//\t\t\t\t\t\t}\r\n\t\t\t\t\t//\t\t\t\t\t}\r\n\t\t\t\t\tif (!this.moved) {\r\n\t\t\t\t\t\t$.gestures.session.lockDirection = true; //锁定方向\r\n\t\t\t\t\t\t$.gestures.session.startDirection = detail.direction;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (this.options.scrollX && !this.moved) {\r\n\t\t\t\t\tisReturn = true;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tisReturn = true;\r\n\t\t\t}\r\n\t\t\tif (this.moved || isPreventDefault) {\r\n\t\t\t\te.stopPropagation(); //阻止冒泡(scroll类嵌套)\r\n\t\t\t\tdetail.gesture && detail.gesture.preventDefault();\r\n\t\t\t}\r\n\t\t\tif (isReturn) { //禁止非法方向滚动\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (!this.moved) {\r\n\t\t\t\t$.trigger(this.scroller, 'scrollstart', this);\r\n\t\t\t} else {\r\n\t\t\t\te.stopPropagation(); //move期间阻止冒泡(scroll嵌套)\r\n\t\t\t}\r\n\t\t\tvar deltaX = 0;\r\n\t\t\tvar deltaY = 0;\r\n\t\t\tif (!this.moved) { //start\r\n\t\t\t\tdeltaX = detail.deltaX;\r\n\t\t\t\tdeltaY = detail.deltaY;\r\n\t\t\t} else { //move\r\n\t\t\t\tdeltaX = detail.deltaX - $.gestures.session.prevTouch.deltaX;\r\n\t\t\t\tdeltaY = detail.deltaY - $.gestures.session.prevTouch.deltaY;\r\n\t\t\t}\r\n\t\t\tvar absDeltaX = Math.abs(detail.deltaX);\r\n\t\t\tvar absDeltaY = Math.abs(detail.deltaY);\r\n\t\t\tif (absDeltaX > absDeltaY + this.options.directionLockThreshold) {\r\n\t\t\t\tdeltaY = 0;\r\n\t\t\t} else if (absDeltaY >= absDeltaX + this.options.directionLockThreshold) {\r\n\t\t\t\tdeltaX = 0;\r\n\t\t\t}\r\n\r\n\t\t\tdeltaX = this.hasHorizontalScroll ? deltaX : 0;\r\n\t\t\tdeltaY = this.hasVerticalScroll ? deltaY : 0;\r\n\t\t\tvar newX = this.x + deltaX;\r\n\t\t\tvar newY = this.y + deltaY;\r\n\t\t\t// Slow down if outside of the boundaries\r\n\t\t\tif (newX > 0 || newX < this.maxScrollX) {\r\n\t\t\t\tnewX = this.options.bounce ? this.x + deltaX / 3 : newX > 0 ? 0 : this.maxScrollX;\r\n\t\t\t}\r\n\t\t\tif (newY > 0 || newY < this.maxScrollY) {\r\n\t\t\t\tnewY = this.options.bounce ? this.y + deltaY / 3 : newY > 0 ? 0 : this.maxScrollY;\r\n\t\t\t}\r\n\r\n\t\t\tif (!this.requestAnimationFrame) {\r\n\t\t\t\tthis._updateTranslate();\r\n\t\t\t}\r\n\t\t\tthis.direction = detail.deltaX > 0 ? 'right' : 'left';\r\n\t\t\tthis.moved = true;\r\n\t\t\tthis.x = newX;\r\n\t\t\tthis.y = newY;\r\n\t\t\t$.trigger(this.scroller, 'scroll', this);\r\n\t\t},\r\n\t\t_flick: function(e) {\r\n\t\t\t//\t\t\tif (!this.moved || this.needReset) {\r\n\t\t\t//\t\t\t\treturn;\r\n\t\t\t//\t\t\t}\r\n\t\t\tif (!this.moved) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\te.stopPropagation();\r\n\t\t\tvar detail = e.detail;\r\n\t\t\tthis._clearRequestAnimationFrame();\r\n\t\t\tif (e.type === 'dragend' && detail.flick) { //dragend\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar newX = Math.round(this.x);\r\n\t\t\tvar newY = Math.round(this.y);\r\n\r\n\t\t\tthis.isInTransition = false;\r\n\t\t\t// reset if we are outside of the boundaries\r\n\t\t\tif (this.resetPosition(this.options.bounceTime)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tthis.scrollTo(newX, newY); // ensures that the last position is rounded\r\n\r\n\t\t\tif (e.type === 'dragend') { //dragend\r\n\t\t\t\t$.trigger(this.scroller, 'scrollend', this);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar time = 0;\r\n\t\t\tvar easing = '';\r\n\t\t\t// start momentum animation if needed\r\n\t\t\tif (this.options.momentum && detail.flickTime < 300) {\r\n\t\t\t\tmomentumX = this.hasHorizontalScroll ? this._momentum(this.x, detail.flickDistanceX, detail.flickTime, this.maxScrollX, this.options.bounce ? this.wrapperWidth : 0, this.options.deceleration) : {\r\n\t\t\t\t\tdestination: newX,\r\n\t\t\t\t\tduration: 0\r\n\t\t\t\t};\r\n\t\t\t\tmomentumY = this.hasVerticalScroll ? this._momentum(this.y, detail.flickDistanceY, detail.flickTime, this.maxScrollY, this.options.bounce ? this.wrapperHeight : 0, this.options.deceleration) : {\r\n\t\t\t\t\tdestination: newY,\r\n\t\t\t\t\tduration: 0\r\n\t\t\t\t};\r\n\t\t\t\tnewX = momentumX.destination;\r\n\t\t\t\tnewY = momentumY.destination;\r\n\t\t\t\ttime = Math.max(momentumX.duration, momentumY.duration);\r\n\t\t\t\tthis.isInTransition = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (newX != this.x || newY != this.y) {\r\n\t\t\t\tif (newX > 0 || newX < this.maxScrollX || newY > 0 || newY < this.maxScrollY) {\r\n\t\t\t\t\teasing = ease.quadratic;\r\n\t\t\t\t}\r\n\t\t\t\tthis.scrollTo(newX, newY, time, easing);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t$.trigger(this.scroller, 'scrollend', this);\r\n\t\t\t//\t\t\te.stopPropagation();\r\n\t\t},\r\n\t\t_end: function(e) {\r\n\t\t\tthis.needReset = false;\r\n\t\t\tif ((!this.moved && this.needReset) || e.type === $.EVENT_CANCEL) {\r\n\t\t\t\tthis.resetPosition();\r\n\t\t\t}\r\n\t\t},\r\n\t\t_transitionEnd: function(e) {\r\n\t\t\tif (e.target != this.scroller || !this.isInTransition) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis._transitionTime();\r\n\t\t\tif (!this.resetPosition(this.options.bounceTime)) {\r\n\t\t\t\tthis.isInTransition = false;\r\n\t\t\t\t$.trigger(this.scroller, 'scrollend', this);\r\n\t\t\t}\r\n\t\t},\r\n\t\t_scrollend: function(e) {\r\n\t\t\tif ((this.y === 0 && this.maxScrollY === 0) || (Math.abs(this.y) > 0 && this.y <= this.maxScrollY)) {\r\n\t\t\t\t$.trigger(this.scroller, 'scrollbottom', this);\r\n\t\t\t}\r\n\t\t},\r\n\t\t_resize: function() {\r\n\t\t\tvar that = this;\r\n\t\t\tclearTimeout(that.resizeTimeout);\r\n\t\t\tthat.resizeTimeout = setTimeout(function() {\r\n\t\t\t\tthat.refresh();\r\n\t\t\t}, that.options.resizePolling);\r\n\t\t},\r\n\t\t_transitionTime: function(time) {\r\n\t\t\ttime = time || 0;\r\n\t\t\tthis.scrollerStyle['webkitTransitionDuration'] = time + 'ms';\r\n\t\t\tif (this.parallaxElement && this.options.scrollY) { //目前仅支持竖向视差效果\r\n\t\t\t\tthis.parallaxStyle['webkitTransitionDuration'] = time + 'ms';\r\n\t\t\t}\r\n\t\t\tif (this.options.fixedBadAndorid && !time && $.os.isBadAndroid) {\r\n\t\t\t\tthis.scrollerStyle['webkitTransitionDuration'] = '0.001s';\r\n\t\t\t\tif (this.parallaxElement && this.options.scrollY) { //目前仅支持竖向视差效果\r\n\t\t\t\t\tthis.parallaxStyle['webkitTransitionDuration'] = '0.001s';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (this.indicators) {\r\n\t\t\t\tfor (var i = this.indicators.length; i--;) {\r\n\t\t\t\t\tthis.indicators[i].transitionTime(time);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (time) { //自定义timer，保证webkitTransitionEnd始终触发\r\n\t\t\t\tthis.transitionTimer && this.transitionTimer.cancel();\r\n\t\t\t\tthis.transitionTimer = $.later(function() {\r\n\t\t\t\t\t$.trigger(this.scroller, 'webkitTransitionEnd');\r\n\t\t\t\t}, time + 100, this);\r\n\t\t\t}\r\n\t\t},\r\n\t\t_transitionTimingFunction: function(easing) {\r\n\t\t\tthis.scrollerStyle['webkitTransitionTimingFunction'] = easing;\r\n\t\t\tif (this.parallaxElement && this.options.scrollY) { //目前仅支持竖向视差效果\r\n\t\t\t\tthis.parallaxStyle['webkitTransitionDuration'] = easing;\r\n\t\t\t}\r\n\t\t\tif (this.indicators) {\r\n\t\t\t\tfor (var i = this.indicators.length; i--;) {\r\n\t\t\t\t\tthis.indicators[i].transitionTimingFunction(easing);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\t_translate: function(x, y) {\r\n\t\t\tthis.x = x;\r\n\t\t\tthis.y = y;\r\n\t\t},\r\n\t\t_clearRequestAnimationFrame: function() {\r\n\t\t\tif (this.requestAnimationFrame) {\r\n\t\t\t\tcancelAnimationFrame(this.requestAnimationFrame);\r\n\t\t\t\tthis.requestAnimationFrame = null;\r\n\t\t\t}\r\n\t\t},\r\n\t\t_updateTranslate: function() {\r\n\t\t\tvar self = this;\r\n\t\t\tif (self.x !== self.lastX || self.y !== self.lastY) {\r\n\t\t\t\tself.setTranslate(self.x, self.y);\r\n\t\t\t}\r\n\t\t\tself.requestAnimationFrame = requestAnimationFrame(function() {\r\n\t\t\t\tself._updateTranslate();\r\n\t\t\t});\r\n\t\t},\r\n\t\t_createScrollBar: function(clazz) {\r\n\t\t\tvar scrollbar = document.createElement('div');\r\n\t\t\tvar indicator = document.createElement('div');\r\n\t\t\tscrollbar.className = CLASS_SCROLLBAR + ' ' + clazz;\r\n\t\t\tindicator.className = CLASS_INDICATOR;\r\n\t\t\tscrollbar.appendChild(indicator);\r\n\t\t\tif (clazz === CLASS_SCROLLBAR_VERTICAL) {\r\n\t\t\t\tthis.scrollbarY = scrollbar;\r\n\t\t\t\tthis.scrollbarIndicatorY = indicator;\r\n\t\t\t} else if (clazz === CLASS_SCROLLBAR_HORIZONTAL) {\r\n\t\t\t\tthis.scrollbarX = scrollbar;\r\n\t\t\t\tthis.scrollbarIndicatorX = indicator;\r\n\t\t\t}\r\n\t\t\tthis.wrapper.appendChild(scrollbar);\r\n\t\t\treturn scrollbar;\r\n\t\t},\r\n\t\t_preventDefaultException: function(el, exceptions) {\r\n\t\t\tfor (var i in exceptions) {\r\n\t\t\t\tif (exceptions[i].test(el[i])) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t},\r\n\t\t_reLayout: function() {\r\n\t\t\tif (!this.hasHorizontalScroll) {\r\n\t\t\t\tthis.maxScrollX = 0;\r\n\t\t\t\tthis.scrollerWidth = this.wrapperWidth;\r\n\t\t\t}\r\n\r\n\t\t\tif (!this.hasVerticalScroll) {\r\n\t\t\t\tthis.maxScrollY = 0;\r\n\t\t\t\tthis.scrollerHeight = this.wrapperHeight;\r\n\t\t\t}\r\n\r\n\t\t\tthis.indicators.map(function(indicator) {\r\n\t\t\t\tindicator.refresh();\r\n\t\t\t});\r\n\r\n\t\t\t//以防slider类嵌套使用\r\n\t\t\tif (this.options.snap && typeof this.options.snap === 'string') {\r\n\t\t\t\tvar items = this.scroller.querySelectorAll(this.options.snap);\r\n\t\t\t\tthis.itemLength = 0;\r\n\t\t\t\tthis.snaps = [];\r\n\t\t\t\tfor (var i = 0, len = items.length; i < len; i++) {\r\n\t\t\t\t\tvar item = items[i];\r\n\t\t\t\t\tif (item.parentNode === this.scroller) {\r\n\t\t\t\t\t\tthis.itemLength++;\r\n\t\t\t\t\t\tthis.snaps.push(item);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis._initSnap(); //需要每次都_initSnap么。其实init的时候执行一次，后续resize的时候执行一次就行了吧.先这么做吧，如果影响性能，再调整\r\n\t\t\t}\r\n\t\t},\r\n\t\t_momentum: function(current, distance, time, lowerMargin, wrapperSize, deceleration) {\r\n\t\t\tvar speed = parseFloat(Math.abs(distance) / time),\r\n\t\t\t\tdestination,\r\n\t\t\t\tduration;\r\n\r\n\t\t\tdeceleration = deceleration === undefined ? 0.0006 : deceleration;\r\n\t\t\tdestination = current + (speed * speed) / (2 * deceleration) * (distance < 0 ? -1 : 1);\r\n\t\t\tduration = speed / deceleration;\r\n\t\t\tif (destination < lowerMargin) {\r\n\t\t\t\tdestination = wrapperSize ? lowerMargin - (wrapperSize / 2.5 * (speed / 8)) : lowerMargin;\r\n\t\t\t\tdistance = Math.abs(destination - current);\r\n\t\t\t\tduration = distance / speed;\r\n\t\t\t} else if (destination > 0) {\r\n\t\t\t\tdestination = wrapperSize ? wrapperSize / 2.5 * (speed / 8) : 0;\r\n\t\t\t\tdistance = Math.abs(current) + destination;\r\n\t\t\t\tduration = distance / speed;\r\n\t\t\t}\r\n\r\n\t\t\treturn {\r\n\t\t\t\tdestination: Math.round(destination),\r\n\t\t\t\tduration: duration\r\n\t\t\t};\r\n\t\t},\r\n\t\t_getTranslateStr: function(x, y) {\r\n\t\t\tif (this.options.hardwareAccelerated) {\r\n\t\t\t\treturn 'translate3d(' + x + 'px,' + y + 'px,0px) ' + this.translateZ;\r\n\t\t\t}\r\n\t\t\treturn 'translate(' + x + 'px,' + y + 'px) ';\r\n\t\t},\r\n\t\t//API\r\n\t\tsetStopped: function(stopped) {\r\n\t\t\tthis.stopped = !!stopped;\r\n\t\t},\r\n\t\tsetTranslate: function(x, y) {\r\n\t\t\tthis.x = x;\r\n\t\t\tthis.y = y;\r\n\t\t\tthis.scrollerStyle['webkitTransform'] = this._getTranslateStr(x, y);\r\n\t\t\tif (this.parallaxElement && this.options.scrollY) { //目前仅支持竖向视差效果\r\n\t\t\t\tvar parallaxY = y * this.options.parallaxRatio;\r\n\t\t\t\tvar scale = 1 + parallaxY / ((this.parallaxHeight - parallaxY) / 2);\r\n\t\t\t\tif (scale > 1) {\r\n\t\t\t\t\tthis.parallaxImgStyle['opacity'] = 1 - parallaxY / 100 * this.options.parallaxRatio;\r\n\t\t\t\t\tthis.parallaxStyle['webkitTransform'] = this._getTranslateStr(0, -parallaxY) + ' scale(' + scale + ',' + scale + ')';\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.parallaxImgStyle['opacity'] = 1;\r\n\t\t\t\t\tthis.parallaxStyle['webkitTransform'] = this._getTranslateStr(0, -1) + ' scale(1,1)';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (this.indicators) {\r\n\t\t\t\tfor (var i = this.indicators.length; i--;) {\r\n\t\t\t\t\tthis.indicators[i].updatePosition();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.lastX = this.x;\r\n\t\t\tthis.lastY = this.y;\r\n\t\t\t$.trigger(this.scroller, 'scroll', this);\r\n\t\t},\r\n\t\treLayout: function() {\r\n\t\t\tthis.wrapper.offsetHeight;\r\n\r\n\t\t\tvar paddingLeft = parseFloat($.getStyles(this.wrapper, 'padding-left')) || 0;\r\n\t\t\tvar paddingRight = parseFloat($.getStyles(this.wrapper, 'padding-right')) || 0;\r\n\t\t\tvar paddingTop = parseFloat($.getStyles(this.wrapper, 'padding-top')) || 0;\r\n\t\t\tvar paddingBottom = parseFloat($.getStyles(this.wrapper, 'padding-bottom')) || 0;\r\n\r\n\t\t\tvar clientWidth = this.wrapper.clientWidth;\r\n\t\t\tvar clientHeight = this.wrapper.clientHeight;\r\n\r\n\t\t\tthis.scrollerWidth = this.scroller.offsetWidth;\r\n\t\t\tthis.scrollerHeight = this.scroller.offsetHeight;\r\n\r\n\t\t\tthis.wrapperWidth = clientWidth - paddingLeft - paddingRight;\r\n\t\t\tthis.wrapperHeight = clientHeight - paddingTop - paddingBottom;\r\n\r\n\t\t\tthis.maxScrollX = Math.min(this.wrapperWidth - this.scrollerWidth, 0);\r\n\t\t\tthis.maxScrollY = Math.min(this.wrapperHeight - this.scrollerHeight, 0);\r\n\t\t\tthis.hasHorizontalScroll = this.options.scrollX && this.maxScrollX < 0;\r\n\t\t\tthis.hasVerticalScroll = this.options.scrollY && this.maxScrollY < 0;\r\n\t\t\tthis._reLayout();\r\n\t\t},\r\n\t\tresetPosition: function(time) {\r\n\t\t\tvar x = this.x,\r\n\t\t\t\ty = this.y;\r\n\r\n\t\t\ttime = time || 0;\r\n\t\t\tif (!this.hasHorizontalScroll || this.x > 0) {\r\n\t\t\t\tx = 0;\r\n\t\t\t} else if (this.x < this.maxScrollX) {\r\n\t\t\t\tx = this.maxScrollX;\r\n\t\t\t}\r\n\r\n\t\t\tif (!this.hasVerticalScroll || this.y > 0) {\r\n\t\t\t\ty = 0;\r\n\t\t\t} else if (this.y < this.maxScrollY) {\r\n\t\t\t\ty = this.maxScrollY;\r\n\t\t\t}\r\n\r\n\t\t\tif (x == this.x && y == this.y) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tthis.scrollTo(x, y, time, this.options.scrollEasing);\r\n\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\t_reInit: function() {\r\n\t\t\tvar groups = this.wrapper.querySelectorAll('.' + CLASS_SCROLL);\r\n\t\t\tfor (var i = 0, len = groups.length; i < len; i++) {\r\n\t\t\t\tif (groups[i].parentNode === this.wrapper) {\r\n\t\t\t\t\tthis.scroller = groups[i];\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.scrollerStyle = this.scroller && this.scroller.style;\r\n\t\t},\r\n\t\trefresh: function() {\r\n\t\t\tthis._reInit();\r\n\t\t\tthis.reLayout();\r\n\t\t\t$.trigger(this.scroller, 'refresh', this);\r\n\t\t\tthis.resetPosition();\r\n\t\t},\r\n\t\tscrollTo: function(x, y, time, easing) {\r\n\t\t\tvar easing = easing || ease.circular;\r\n\t\t\t//\t\t\tthis.isInTransition = time > 0 && (this.lastX != x || this.lastY != y);\r\n\t\t\t//暂不严格判断x,y，否则会导致部分版本上不正常触发轮播\r\n\t\t\tthis.isInTransition = time > 0;\r\n\t\t\tif (this.isInTransition) {\r\n\t\t\t\tthis._clearRequestAnimationFrame();\r\n\t\t\t\tthis._transitionTimingFunction(easing.style);\r\n\t\t\t\tthis._transitionTime(time);\r\n\t\t\t\tthis.setTranslate(x, y);\r\n\t\t\t} else {\r\n\t\t\t\tthis.setTranslate(x, y);\r\n\t\t\t}\r\n\r\n\t\t},\r\n\t\tscrollToBottom: function(time, easing) {\r\n\t\t\ttime = time || this.options.scrollTime;\r\n\t\t\tthis.scrollTo(0, this.maxScrollY, time, easing);\r\n\t\t},\r\n\t\tgotoPage: function(index) {\r\n\t\t\tthis._gotoPage(index);\r\n\t\t},\r\n\t\tdestroy: function() {\r\n\t\t\tthis._initEvent(true); //detach\r\n\t\t\tdelete $.data[this.wrapper.getAttribute('data-scroll')];\r\n\t\t\tthis.wrapper.setAttribute('data-scroll', '');\r\n\t\t}\r\n\t});\r\n\t//Indicator\r\n\tvar Indicator = function(scroller, options) {\r\n\t\tthis.wrapper = typeof options.el == 'string' ? document.querySelector(options.el) : options.el;\r\n\t\tthis.wrapperStyle = this.wrapper.style;\r\n\t\tthis.indicator = this.wrapper.children[0];\r\n\t\tthis.indicatorStyle = this.indicator.style;\r\n\t\tthis.scroller = scroller;\r\n\r\n\t\tthis.options = $.extend({\r\n\t\t\tlistenX: true,\r\n\t\t\tlistenY: true,\r\n\t\t\tfade: false,\r\n\t\t\tspeedRatioX: 0,\r\n\t\t\tspeedRatioY: 0\r\n\t\t}, options);\r\n\r\n\t\tthis.sizeRatioX = 1;\r\n\t\tthis.sizeRatioY = 1;\r\n\t\tthis.maxPosX = 0;\r\n\t\tthis.maxPosY = 0;\r\n\r\n\t\tif (this.options.fade) {\r\n\t\t\tthis.wrapperStyle['webkitTransform'] = this.scroller.translateZ;\r\n\t\t\tthis.wrapperStyle['webkitTransitionDuration'] = this.options.fixedBadAndorid && $.os.isBadAndroid ? '0.001s' : '0ms';\r\n\t\t\tthis.wrapperStyle.opacity = '0';\r\n\t\t}\r\n\t}\r\n\tIndicator.prototype = {\r\n\t\thandleEvent: function(e) {\r\n\r\n\t\t},\r\n\t\ttransitionTime: function(time) {\r\n\t\t\ttime = time || 0;\r\n\t\t\tthis.indicatorStyle['webkitTransitionDuration'] = time + 'ms';\r\n\t\t\tif (this.scroller.options.fixedBadAndorid && !time && $.os.isBadAndroid) {\r\n\t\t\t\tthis.indicatorStyle['webkitTransitionDuration'] = '0.001s';\r\n\t\t\t}\r\n\t\t},\r\n\t\ttransitionTimingFunction: function(easing) {\r\n\t\t\tthis.indicatorStyle['webkitTransitionTimingFunction'] = easing;\r\n\t\t},\r\n\t\trefresh: function() {\r\n\t\t\tthis.transitionTime();\r\n\r\n\t\t\tif (this.options.listenX && !this.options.listenY) {\r\n\t\t\t\tthis.indicatorStyle.display = this.scroller.hasHorizontalScroll ? 'block' : 'none';\r\n\t\t\t} else if (this.options.listenY && !this.options.listenX) {\r\n\t\t\t\tthis.indicatorStyle.display = this.scroller.hasVerticalScroll ? 'block' : 'none';\r\n\t\t\t} else {\r\n\t\t\t\tthis.indicatorStyle.display = this.scroller.hasHorizontalScroll || this.scroller.hasVerticalScroll ? 'block' : 'none';\r\n\t\t\t}\r\n\r\n\t\t\tthis.wrapper.offsetHeight; // force refresh\r\n\r\n\t\t\tif (this.options.listenX) {\r\n\t\t\t\tthis.wrapperWidth = this.wrapper.clientWidth;\r\n\t\t\t\tthis.indicatorWidth = Math.max(Math.round(this.wrapperWidth * this.wrapperWidth / (this.scroller.scrollerWidth || this.wrapperWidth || 1)), 8);\r\n\t\t\t\tthis.indicatorStyle.width = this.indicatorWidth + 'px';\r\n\r\n\t\t\t\tthis.maxPosX = this.wrapperWidth - this.indicatorWidth;\r\n\r\n\t\t\t\tthis.minBoundaryX = 0;\r\n\t\t\t\tthis.maxBoundaryX = this.maxPosX;\r\n\r\n\t\t\t\tthis.sizeRatioX = this.options.speedRatioX || (this.scroller.maxScrollX && (this.maxPosX / this.scroller.maxScrollX));\r\n\t\t\t}\r\n\r\n\t\t\tif (this.options.listenY) {\r\n\t\t\t\tthis.wrapperHeight = this.wrapper.clientHeight;\r\n\t\t\t\tthis.indicatorHeight = Math.max(Math.round(this.wrapperHeight * this.wrapperHeight / (this.scroller.scrollerHeight || this.wrapperHeight || 1)), 8);\r\n\t\t\t\tthis.indicatorStyle.height = this.indicatorHeight + 'px';\r\n\r\n\t\t\t\tthis.maxPosY = this.wrapperHeight - this.indicatorHeight;\r\n\r\n\t\t\t\tthis.minBoundaryY = 0;\r\n\t\t\t\tthis.maxBoundaryY = this.maxPosY;\r\n\r\n\t\t\t\tthis.sizeRatioY = this.options.speedRatioY || (this.scroller.maxScrollY && (this.maxPosY / this.scroller.maxScrollY));\r\n\t\t\t}\r\n\r\n\t\t\tthis.updatePosition();\r\n\t\t},\r\n\r\n\t\tupdatePosition: function() {\r\n\t\t\tvar x = this.options.listenX && Math.round(this.sizeRatioX * this.scroller.x) || 0,\r\n\t\t\t\ty = this.options.listenY && Math.round(this.sizeRatioY * this.scroller.y) || 0;\r\n\r\n\t\t\tif (x < this.minBoundaryX) {\r\n\t\t\t\tthis.width = Math.max(this.indicatorWidth + x, 8);\r\n\t\t\t\tthis.indicatorStyle.width = this.width + 'px';\r\n\t\t\t\tx = this.minBoundaryX;\r\n\t\t\t} else if (x > this.maxBoundaryX) {\r\n\t\t\t\tthis.width = Math.max(this.indicatorWidth - (x - this.maxPosX), 8);\r\n\t\t\t\tthis.indicatorStyle.width = this.width + 'px';\r\n\t\t\t\tx = this.maxPosX + this.indicatorWidth - this.width;\r\n\t\t\t} else if (this.width != this.indicatorWidth) {\r\n\t\t\t\tthis.width = this.indicatorWidth;\r\n\t\t\t\tthis.indicatorStyle.width = this.width + 'px';\r\n\t\t\t}\r\n\r\n\t\t\tif (y < this.minBoundaryY) {\r\n\t\t\t\tthis.height = Math.max(this.indicatorHeight + y * 3, 8);\r\n\t\t\t\tthis.indicatorStyle.height = this.height + 'px';\r\n\t\t\t\ty = this.minBoundaryY;\r\n\t\t\t} else if (y > this.maxBoundaryY) {\r\n\t\t\t\tthis.height = Math.max(this.indicatorHeight - (y - this.maxPosY) * 3, 8);\r\n\t\t\t\tthis.indicatorStyle.height = this.height + 'px';\r\n\t\t\t\ty = this.maxPosY + this.indicatorHeight - this.height;\r\n\t\t\t} else if (this.height != this.indicatorHeight) {\r\n\t\t\t\tthis.height = this.indicatorHeight;\r\n\t\t\t\tthis.indicatorStyle.height = this.height + 'px';\r\n\t\t\t}\r\n\r\n\t\t\tthis.x = x;\r\n\t\t\tthis.y = y;\r\n\r\n\t\t\tthis.indicatorStyle['webkitTransform'] = this.scroller._getTranslateStr(x, y);\r\n\r\n\t\t},\r\n\t\tfade: function(val, hold) {\r\n\t\t\tif (hold && !this.visible) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tclearTimeout(this.fadeTimeout);\r\n\t\t\tthis.fadeTimeout = null;\r\n\r\n\t\t\tvar time = val ? 250 : 500,\r\n\t\t\t\tdelay = val ? 0 : 300;\r\n\r\n\t\t\tval = val ? '1' : '0';\r\n\r\n\t\t\tthis.wrapperStyle['webkitTransitionDuration'] = time + 'ms';\r\n\r\n\t\t\tthis.fadeTimeout = setTimeout((function(val) {\r\n\t\t\t\tthis.wrapperStyle.opacity = val;\r\n\t\t\t\tthis.visible = +val;\r\n\t\t\t}).bind(this, val), delay);\r\n\t\t}\r\n\t};\r\n\r\n\t$.Scroll = Scroll;\r\n\r\n\t$.fn.scroll = function(options) {\r\n\t\tvar scrollApis = [];\r\n\t\tthis.each(function() {\r\n\t\t\tvar scrollApi = null;\r\n\t\t\tvar self = this;\r\n\t\t\tvar id = self.getAttribute('data-scroll');\r\n\t\t\tif (!id) {\r\n\t\t\t\tid = ++$.uuid;\r\n\t\t\t\tvar _options = $.extend({}, options);\r\n\t\t\t\tif (self.classList.contains('mui-segmented-control')) {\r\n\t\t\t\t\t_options = $.extend(_options, {\r\n\t\t\t\t\t\tscrollY: false,\r\n\t\t\t\t\t\tscrollX: true,\r\n\t\t\t\t\t\tindicators: false,\r\n\t\t\t\t\t\tsnap: '.mui-control-item'\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\t$.data[id] = scrollApi = new Scroll(self, _options);\r\n\t\t\t\tself.setAttribute('data-scroll', id);\r\n\t\t\t} else {\r\n\t\t\t\tscrollApi = $.data[id];\r\n\t\t\t}\r\n\t\t\tscrollApis.push(scrollApi);\r\n\t\t});\r\n\t\treturn scrollApis.length === 1 ? scrollApis[0] : scrollApis;\r\n\t};\r\n})(mui, window, document);\r\n(function($, window, document, undefined) {\r\n\r\n\tvar CLASS_VISIBILITY = 'mui-visibility';\r\n\tvar CLASS_HIDDEN = 'mui-hidden';\r\n\r\n\tvar PullRefresh = $.Scroll.extend($.extend({\r\n\t\thandleEvent: function(e) {\r\n\t\t\tthis._super(e);\r\n\t\t\tif (e.type === 'scrollbottom') {\r\n\t\t\t\tif (e.target === this.scroller) {\r\n\t\t\t\t\tthis._scrollbottom();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\t_scrollbottom: function() {\r\n\t\t\tif (!this.pulldown && !this.loading) {\r\n\t\t\t\tthis.pulldown = false;\r\n\t\t\t\tthis._initPullupRefresh();\r\n\t\t\t\tthis.pullupLoading();\r\n\t\t\t}\r\n\t\t},\r\n\t\t_start: function(e) {\r\n\t\t\t//仅下拉刷新在start阻止默认事件\r\n\t\t\tif (e.touches && e.touches.length && e.touches[0].clientX > 30) {\r\n\t\t\t\te.target && !this._preventDefaultException(e.target, this.options.preventDefaultException) && e.preventDefault();\r\n\t\t\t}\r\n\t\t\tif (!this.loading) {\r\n\t\t\t\tthis.pulldown = this.pullPocket = this.pullCaption = this.pullLoading = false\r\n\t\t\t}\r\n\t\t\tthis._super(e);\r\n\t\t},\r\n\t\t_drag: function(e) {\r\n\t\t\tthis._super(e);\r\n\t\t\tif (!this.pulldown && !this.loading && this.topPocket && e.detail.direction === 'down' && this.y >= 0) {\r\n\t\t\t\tthis._initPulldownRefresh();\r\n\t\t\t}\r\n\t\t\tif (this.pulldown) {\r\n\t\t\t\tthis._setCaption(this.y > this.options.down.height ? this.options.down.contentover : this.options.down.contentdown);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_reLayout: function() {\r\n\t\t\tthis.hasVerticalScroll = true;\r\n\t\t\tthis._super();\r\n\t\t},\r\n\t\t//API\r\n\t\tresetPosition: function(time) {\r\n\t\t\tif (this.pulldown) {\r\n\t\t\t\tif (this.y >= this.options.down.height) {\r\n\t\t\t\t\tthis.pulldownLoading(undefined, time || 0);\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t!this.loading && this.topPocket.classList.remove(CLASS_VISIBILITY);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn this._super(time);\r\n\t\t},\r\n\t\tpulldownLoading: function(y, time) {\r\n\t\t\ttypeof y === 'undefined' && (y = this.options.down.height); //默认高度\r\n\t\t\tthis.scrollTo(0, y, time, this.options.bounceEasing);\r\n\t\t\tif (this.loading) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t//\t\t\tif (!this.pulldown) {\r\n\t\t\tthis._initPulldownRefresh();\r\n\t\t\t//\t\t\t}\r\n\t\t\tthis._setCaption(this.options.down.contentrefresh);\r\n\t\t\tthis.loading = true;\r\n\t\t\tthis.indicators.map(function(indicator) {\r\n\t\t\t\tindicator.fade(0);\r\n\t\t\t});\r\n\t\t\tvar callback = this.options.down.callback;\r\n\t\t\tcallback && callback.call(this);\r\n\t\t},\r\n\t\tendPulldownToRefresh: function() {\r\n\t\t\tvar self = this;\r\n\t\t\tif (self.topPocket && self.loading && this.pulldown) {\r\n\t\t\t\tself.scrollTo(0, 0, self.options.bounceTime, self.options.bounceEasing);\r\n\t\t\t\tself.loading = false;\r\n\t\t\t\tself._setCaption(self.options.down.contentdown, true);\r\n\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\tself.loading || self.topPocket.classList.remove(CLASS_VISIBILITY);\r\n\t\t\t\t}, 350);\r\n\t\t\t}\r\n\t\t},\r\n\t\tpullupLoading: function(callback, x, time) {\r\n\t\t\tx = x || 0;\r\n\t\t\tthis.scrollTo(x, this.maxScrollY, time, this.options.bounceEasing);\r\n\t\t\tif (this.loading) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis._initPullupRefresh();\r\n\t\t\tthis._setCaption(this.options.up.contentrefresh);\r\n\t\t\tthis.indicators.map(function(indicator) {\r\n\t\t\t\tindicator.fade(0);\r\n\t\t\t});\r\n\t\t\tthis.loading = true;\r\n\t\t\tcallback = callback || this.options.up.callback;\r\n\t\t\tcallback && callback.call(this);\r\n\t\t},\r\n\t\tendPullupToRefresh: function(finished) {\r\n\t\t\tvar self = this;\r\n\t\t\tif (self.bottomPocket) { // && self.loading && !this.pulldown\r\n\t\t\t\tself.loading = false;\r\n\t\t\t\tif (finished) {\r\n\t\t\t\t\tthis.finished = true;\r\n\t\t\t\t\tself._setCaption(self.options.up.contentnomore);\r\n\t\t\t\t\t//\t\t\t\t\tself.bottomPocket.classList.remove(CLASS_VISIBILITY);\r\n\t\t\t\t\t//\t\t\t\t\tself.bottomPocket.classList.add(CLASS_HIDDEN);\r\n\t\t\t\t\tself.wrapper.removeEventListener('scrollbottom', self);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tself._setCaption(self.options.up.contentdown);\r\n\t\t\t\t\t//\t\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\tself.loading || self.bottomPocket.classList.remove(CLASS_VISIBILITY);\r\n\t\t\t\t\t//\t\t\t\t\t}, 300);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tdisablePullupToRefresh: function() {\r\n\t\t\tthis._initPullupRefresh();\r\n\t\t\tthis.bottomPocket.className = 'mui-pull-bottom-pocket' + ' ' + CLASS_HIDDEN;\r\n\t\t\tthis.wrapper.removeEventListener('scrollbottom', this);\r\n\t\t},\r\n\t\tenablePullupToRefresh: function() {\r\n\t\t\tthis._initPullupRefresh();\r\n\t\t\tthis.bottomPocket.classList.remove(CLASS_HIDDEN);\r\n\t\t\tthis._setCaption(this.options.up.contentdown);\r\n\t\t\tthis.wrapper.addEventListener('scrollbottom', this);\r\n\t\t},\r\n\t\trefresh: function(isReset) {\r\n\t\t\tif (isReset && this.finished) {\r\n\t\t\t\tthis.enablePullupToRefresh();\r\n\t\t\t\tthis.finished = false;\r\n\t\t\t}\r\n\t\t\tthis._super();\r\n\t\t},\r\n\t}, $.PullRefresh));\r\n\t$.fn.pullRefresh = function(options) {\r\n\t\tif (this.length === 1) {\r\n\t\t\tvar self = this[0];\r\n\t\t\tvar pullRefreshApi = null;\r\n\t\t\tvar id = self.getAttribute('data-pullrefresh');\r\n\t\t\tif (!id && typeof options === 'undefined') {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\toptions = options || {};\r\n\t\t\tif (!id) {\r\n\t\t\t\tid = ++$.uuid;\r\n\t\t\t\t$.data[id] = pullRefreshApi = new PullRefresh(self, options);\r\n\t\t\t\tself.setAttribute('data-pullrefresh', id);\r\n\t\t\t} else {\r\n\t\t\t\tpullRefreshApi = $.data[id];\r\n\t\t\t}\r\n\t\t\tif (options.down && options.down.auto) { //如果设置了auto，则自动下拉一次\r\n\t\t\t\tpullRefreshApi.pulldownLoading(options.down.autoY);\r\n\t\t\t} else if (options.up && options.up.auto) { //如果设置了auto，则自动上拉一次\r\n\t\t\t\tpullRefreshApi.pullupLoading();\r\n\t\t\t}\r\n\t\t\t//暂不提供这种调用方式吧\t\t\t\r\n\t\t\t//\t\t\tif (typeof options === 'string') {\r\n\t\t\t//\t\t\t\tvar methodValue = pullRefreshApi[options].apply(pullRefreshApi, $.slice.call(arguments, 1));\r\n\t\t\t//\t\t\t\tif (methodValue !== undefined) {\r\n\t\t\t//\t\t\t\t\treturn methodValue;\r\n\t\t\t//\t\t\t\t}\r\n\t\t\t//\t\t\t}\r\n\t\t\treturn pullRefreshApi;\r\n\t\t}\r\n\t};\r\n})(mui, window, document);\r\n/**\r\n * snap 重构\r\n * @param {Object} $\r\n * @param {Object} window\r\n */\r\n(function($, window) {\r\n\tvar CLASS_SLIDER = 'mui-slider';\r\n\tvar CLASS_SLIDER_GROUP = 'mui-slider-group';\r\n\tvar CLASS_SLIDER_LOOP = 'mui-slider-loop';\r\n\tvar CLASS_SLIDER_INDICATOR = 'mui-slider-indicator';\r\n\tvar CLASS_ACTION_PREVIOUS = 'mui-action-previous';\r\n\tvar CLASS_ACTION_NEXT = 'mui-action-next';\r\n\tvar CLASS_SLIDER_ITEM = 'mui-slider-item';\r\n\r\n\tvar CLASS_ACTIVE = 'mui-active';\r\n\r\n\tvar SELECTOR_SLIDER_ITEM = '.' + CLASS_SLIDER_ITEM;\r\n\tvar SELECTOR_SLIDER_INDICATOR = '.' + CLASS_SLIDER_INDICATOR;\r\n\tvar SELECTOR_SLIDER_PROGRESS_BAR = '.mui-slider-progress-bar';\r\n\r\n\tvar Slider = $.Slider = $.Scroll.extend({\r\n\t\tinit: function(element, options) {\r\n\t\t\tthis._super(element, $.extend(true, {\r\n\t\t\t\tfingers: 1,\r\n\t\t\t\tinterval: 0, //设置为0，则不定时轮播\r\n\t\t\t\tscrollY: false,\r\n\t\t\t\tscrollX: true,\r\n\t\t\t\tindicators: false,\r\n\t\t\t\tscrollTime: 1000,\r\n\t\t\t\tstartX: false,\r\n\t\t\t\tslideTime: 0, //滑动动画时间\r\n\t\t\t\tsnap: SELECTOR_SLIDER_ITEM\r\n\t\t\t}, options));\r\n\t\t\tif (this.options.startX) {\r\n\t\t\t\t//\t\t\t\t$.trigger(this.wrapper, 'scrollend', this);\r\n\t\t\t}\r\n\t\t},\r\n\t\t_init: function() {\r\n\t\t\tthis._reInit();\r\n\t\t\tif (this.scroller) {\r\n\t\t\t\tthis.scrollerStyle = this.scroller.style;\r\n\t\t\t\tthis.progressBar = this.wrapper.querySelector(SELECTOR_SLIDER_PROGRESS_BAR);\r\n\t\t\t\tif (this.progressBar) {\r\n\t\t\t\t\tthis.progressBarWidth = this.progressBar.offsetWidth;\r\n\t\t\t\t\tthis.progressBarStyle = this.progressBar.style;\r\n\t\t\t\t}\r\n\t\t\t\t//忘记这个代码是干什么的了？\r\n\t\t\t\t//\t\t\t\tthis.x = this._getScroll();\r\n\t\t\t\t//\t\t\t\tif (this.options.startX === false) {\r\n\t\t\t\t//\t\t\t\t\tthis.options.startX = this.x;\r\n\t\t\t\t//\t\t\t\t}\r\n\t\t\t\t//根据active修正startX\r\n\r\n\t\t\t\tthis._super();\r\n\t\t\t\tthis._initTimer();\r\n\t\t\t}\r\n\t\t},\r\n\t\t_triggerSlide: function() {\r\n\t\t\tvar self = this;\r\n\t\t\tself.isInTransition = false;\r\n\t\t\tvar page = self.currentPage;\r\n\t\t\tself.slideNumber = self._fixedSlideNumber();\r\n\t\t\tif (self.loop) {\r\n\t\t\t\tif (self.slideNumber === 0) {\r\n\t\t\t\t\tself.setTranslate(self.pages[1][0].x, 0);\r\n\t\t\t\t} else if (self.slideNumber === self.itemLength - 3) {\r\n\t\t\t\t\tself.setTranslate(self.pages[self.itemLength - 2][0].x, 0);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (self.lastSlideNumber != self.slideNumber) {\r\n\t\t\t\tself.lastSlideNumber = self.slideNumber;\r\n\t\t\t\tself.lastPage = self.currentPage;\r\n\t\t\t\t$.trigger(self.wrapper, 'slide', {\r\n\t\t\t\t\tslideNumber: self.slideNumber\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tself._initTimer();\r\n\t\t},\r\n\t\t_handleSlide: function(e) {\r\n\t\t\tvar self = this;\r\n\t\t\tif (e.target !== self.wrapper) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar detail = e.detail;\r\n\t\t\tdetail.slideNumber = detail.slideNumber || 0;\r\n\t\t\tvar temps = self.scroller.querySelectorAll(SELECTOR_SLIDER_ITEM);\r\n\t\t\tvar items = [];\r\n\t\t\tfor (var i = 0, len = temps.length; i < len; i++) {\r\n\t\t\t\tvar item = temps[i];\r\n\t\t\t\tif (item.parentNode === self.scroller) {\r\n\t\t\t\t\titems.push(item);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar _slideNumber = detail.slideNumber;\r\n\t\t\tif (self.loop) {\r\n\t\t\t\t_slideNumber += 1;\r\n\t\t\t}\r\n\t\t\tif (!self.wrapper.classList.contains('mui-segmented-control')) {\r\n\t\t\t\tfor (var i = 0, len = items.length; i < len; i++) {\r\n\t\t\t\t\tvar item = items[i];\r\n\t\t\t\t\tif (item.parentNode === self.scroller) {\r\n\t\t\t\t\t\tif (i === _slideNumber) {\r\n\t\t\t\t\t\t\titem.classList.add(CLASS_ACTIVE);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\titem.classList.remove(CLASS_ACTIVE);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar indicatorWrap = self.wrapper.querySelector('.mui-slider-indicator');\r\n\t\t\tif (indicatorWrap) {\r\n\t\t\t\tif (indicatorWrap.getAttribute('data-scroll')) { //scroll\r\n\t\t\t\t\t$(indicatorWrap).scroll().gotoPage(detail.slideNumber);\r\n\t\t\t\t}\r\n\t\t\t\tvar indicators = indicatorWrap.querySelectorAll('.mui-indicator');\r\n\t\t\t\tif (indicators.length > 0) { //图片轮播\r\n\t\t\t\t\tfor (var i = 0, len = indicators.length; i < len; i++) {\r\n\t\t\t\t\t\tindicators[i].classList[i === detail.slideNumber ? 'add' : 'remove'](CLASS_ACTIVE);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar number = indicatorWrap.querySelector('.mui-number span');\r\n\t\t\t\t\tif (number) { //图文表格\r\n\t\t\t\t\t\tnumber.innerText = (detail.slideNumber + 1);\r\n\t\t\t\t\t} else { //segmented controls\r\n\t\t\t\t\t\tvar controlItems = indicatorWrap.querySelectorAll('.mui-control-item');\r\n\t\t\t\t\t\tfor (var i = 0, len = controlItems.length; i < len; i++) {\r\n\t\t\t\t\t\t\tcontrolItems[i].classList[i === detail.slideNumber ? 'add' : 'remove'](CLASS_ACTIVE);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\te.stopPropagation();\r\n\t\t},\r\n\t\t_handleTabShow: function(e) {\r\n\t\t\tvar self = this;\r\n\t\t\tself.gotoItem((e.detail.tabNumber || 0), self.options.slideTime);\r\n\t\t},\r\n\t\t_handleIndicatorTap: function(event) {\r\n\t\t\tvar self = this;\r\n\t\t\tvar target = event.target;\r\n\t\t\tif (target.classList.contains(CLASS_ACTION_PREVIOUS) || target.classList.contains(CLASS_ACTION_NEXT)) {\r\n\t\t\t\tself[target.classList.contains(CLASS_ACTION_PREVIOUS) ? 'prevItem' : 'nextItem']();\r\n\t\t\t\tevent.stopPropagation();\r\n\t\t\t}\r\n\t\t},\r\n\t\t_initEvent: function(detach) {\r\n\t\t\tvar self = this;\r\n\t\t\tself._super(detach);\r\n\t\t\tvar action = detach ? 'removeEventListener' : 'addEventListener';\r\n\t\t\tself.wrapper[action]('slide', this);\r\n\t\t\tself.wrapper[action]($.eventName('shown', 'tab'), this);\r\n\t\t},\r\n\t\thandleEvent: function(e) {\r\n\t\t\tthis._super(e);\r\n\t\t\tswitch (e.type) {\r\n\t\t\t\tcase 'slide':\r\n\t\t\t\t\tthis._handleSlide(e);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase $.eventName('shown', 'tab'):\r\n\t\t\t\t\tif (~this.snaps.indexOf(e.target)) { //避免嵌套监听错误的tab show\r\n\t\t\t\t\t\tthis._handleTabShow(e);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t},\r\n\t\t_scrollend: function(e) {\r\n\t\t\tthis._super(e);\r\n\t\t\tthis._triggerSlide(e);\r\n\t\t},\r\n\t\t_drag: function(e) {\r\n\t\t\tthis._super(e);\r\n\t\t\tvar direction = e.detail.direction;\r\n\t\t\tif (direction === 'left' || direction === 'right') {\r\n\t\t\t\t//拖拽期间取消定时\r\n\t\t\t\tvar slidershowTimer = this.wrapper.getAttribute('data-slidershowTimer');\r\n\t\t\t\tslidershowTimer && window.clearTimeout(slidershowTimer);\r\n\r\n\t\t\t\te.stopPropagation();\r\n\t\t\t}\r\n\t\t},\r\n\t\t_initTimer: function() {\r\n\t\t\tvar self = this;\r\n\t\t\tvar slider = self.wrapper;\r\n\t\t\tvar interval = self.options.interval;\r\n\t\t\tvar slidershowTimer = slider.getAttribute('data-slidershowTimer');\r\n\t\t\tslidershowTimer && window.clearTimeout(slidershowTimer);\r\n\t\t\tif (interval) {\r\n\t\t\t\tslidershowTimer = window.setTimeout(function() {\r\n\t\t\t\t\tif (!slider) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//仅slider显示状态进行自动轮播\r\n\t\t\t\t\tif (!!(slider.offsetWidth || slider.offsetHeight)) {\r\n\t\t\t\t\t\tself.nextItem(true);\r\n\t\t\t\t\t\t//下一个\r\n\t\t\t\t\t}\r\n\t\t\t\t\tself._initTimer();\r\n\t\t\t\t}, interval);\r\n\t\t\t\tslider.setAttribute('data-slidershowTimer', slidershowTimer);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_fixedSlideNumber: function(page) {\r\n\t\t\tpage = page || this.currentPage;\r\n\t\t\tvar slideNumber = page.pageX;\r\n\t\t\tif (this.loop) {\r\n\t\t\t\tif (page.pageX === 0) {\r\n\t\t\t\t\tslideNumber = this.itemLength - 3;\r\n\t\t\t\t} else if (page.pageX === (this.itemLength - 1)) {\r\n\t\t\t\t\tslideNumber = 0;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tslideNumber = page.pageX - 1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn slideNumber;\r\n\t\t},\r\n\t\t_reLayout: function() {\r\n\t\t\tthis.hasHorizontalScroll = true;\r\n\t\t\tthis.loop = this.scroller.classList.contains(CLASS_SLIDER_LOOP);\r\n\t\t\tthis._super();\r\n\t\t},\r\n\t\t_getScroll: function() {\r\n\t\t\tvar result = $.parseTranslateMatrix($.getStyles(this.scroller, 'webkitTransform'));\r\n\t\t\treturn result ? result.x : 0;\r\n\t\t},\r\n\t\t_transitionEnd: function(e) {\r\n\t\t\tif (e.target !== this.scroller || !this.isInTransition) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis._transitionTime();\r\n\t\t\tthis.isInTransition = false;\r\n\t\t\t$.trigger(this.wrapper, 'scrollend', this);\r\n\t\t},\r\n\t\t_flick: function(e) {\r\n\t\t\tif (!this.moved) { //无moved\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar detail = e.detail;\r\n\t\t\tvar direction = detail.direction;\r\n\t\t\tthis._clearRequestAnimationFrame();\r\n\t\t\tthis.isInTransition = true;\r\n\t\t\t//\t\t\tif (direction === 'up' || direction === 'down') {\r\n\t\t\t//\t\t\t\tthis.resetPosition(this.options.bounceTime);\r\n\t\t\t//\t\t\t\treturn;\r\n\t\t\t//\t\t\t}\r\n\t\t\tif (e.type === 'flick') {\r\n\t\t\t\tif (detail.deltaTime < 200) { //flick，太容易触发，额外校验一下deltaTime\r\n\t\t\t\t\tthis.x = this._getPage((this.slideNumber + (direction === 'right' ? -1 : 1)), true).x;\r\n\t\t\t\t}\r\n\t\t\t\tthis.resetPosition(this.options.bounceTime);\r\n\t\t\t} else if (e.type === 'dragend' && !detail.flick) {\r\n\t\t\t\tthis.resetPosition(this.options.bounceTime);\r\n\t\t\t}\r\n\t\t\te.stopPropagation();\r\n\t\t},\r\n\t\t_initSnap: function() {\r\n\t\t\tthis.scrollerWidth = this.itemLength * this.scrollerWidth;\r\n\t\t\tthis.maxScrollX = Math.min(this.wrapperWidth - this.scrollerWidth, 0);\r\n\t\t\tthis._super();\r\n\t\t\tif (!this.currentPage.x) {\r\n\t\t\t\t//当slider处于隐藏状态时，导致snap计算是错误的，临时先这么判断一下，后续要考虑解决所有scroll在隐藏状态下初始化属性不正确的问题\r\n\t\t\t\tvar currentPage = this.pages[this.loop ? 1 : 0];\r\n\t\t\t\tcurrentPage = currentPage || this.pages[0];\r\n\t\t\t\tif (!currentPage) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tthis.currentPage = currentPage[0];\r\n\t\t\t\tthis.slideNumber = 0;\r\n\t\t\t\tthis.lastSlideNumber = typeof this.lastSlideNumber === 'undefined' ? 0 : this.lastSlideNumber;\r\n\t\t\t} else {\r\n\t\t\t\tthis.slideNumber = this._fixedSlideNumber();\r\n\t\t\t\tthis.lastSlideNumber = typeof this.lastSlideNumber === 'undefined' ? this.slideNumber : this.lastSlideNumber;\r\n\t\t\t}\r\n\t\t\tthis.options.startX = this.currentPage.x || 0;\r\n\t\t},\r\n\t\t_getSnapX: function(offsetLeft) {\r\n\t\t\treturn Math.max(-offsetLeft, this.maxScrollX);\r\n\t\t},\r\n\t\t_getPage: function(slideNumber, isFlick) {\r\n\t\t\tif (this.loop) {\r\n\t\t\t\tif (slideNumber > (this.itemLength - (isFlick ? 2 : 3))) {\r\n\t\t\t\t\tslideNumber = 1;\r\n\t\t\t\t\ttime = 0;\r\n\t\t\t\t} else if (slideNumber < (isFlick ? -1 : 0)) {\r\n\t\t\t\t\tslideNumber = this.itemLength - 2;\r\n\t\t\t\t\ttime = 0;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tslideNumber += 1;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (!isFlick) {\r\n\t\t\t\t\tif (slideNumber > (this.itemLength - 1)) {\r\n\t\t\t\t\t\tslideNumber = 0;\r\n\t\t\t\t\t\ttime = 0;\r\n\t\t\t\t\t} else if (slideNumber < 0) {\r\n\t\t\t\t\t\tslideNumber = this.itemLength - 1;\r\n\t\t\t\t\t\ttime = 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tslideNumber = Math.min(Math.max(0, slideNumber), this.itemLength - 1);\r\n\t\t\t}\r\n\t\t\treturn this.pages[slideNumber][0];\r\n\t\t},\r\n\t\t_gotoItem: function(slideNumber, time) {\r\n\t\t\tthis.currentPage = this._getPage(slideNumber, true); //此处传true。可保证程序切换时，动画与人手操作一致(第一张，最后一张的切换动画)\r\n\t\t\tthis.scrollTo(this.currentPage.x, 0, time, this.options.scrollEasing);\r\n\t\t\tif (time === 0) {\r\n\t\t\t\t$.trigger(this.wrapper, 'scrollend', this);\r\n\t\t\t}\r\n\t\t},\r\n\t\t//API\r\n\t\tsetTranslate: function(x, y) {\r\n\t\t\tthis._super(x, y);\r\n\t\t\tvar progressBar = this.progressBar;\r\n\t\t\tif (progressBar) {\r\n\t\t\t\tthis.progressBarStyle.webkitTransform = this._getTranslateStr((-x * (this.progressBarWidth / this.wrapperWidth)), 0);\r\n\t\t\t}\r\n\t\t},\r\n\t\tresetPosition: function(time) {\r\n\t\t\ttime = time || 0;\r\n\t\t\tif (this.x > 0) {\r\n\t\t\t\tthis.x = 0;\r\n\t\t\t} else if (this.x < this.maxScrollX) {\r\n\t\t\t\tthis.x = this.maxScrollX;\r\n\t\t\t}\r\n\t\t\tthis.currentPage = this._nearestSnap(this.x);\r\n\t\t\tthis.scrollTo(this.currentPage.x, 0, time, this.options.scrollEasing);\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tgotoItem: function(slideNumber, time) {\r\n\t\t\tthis._gotoItem(slideNumber, typeof time === 'undefined' ? this.options.scrollTime : time);\r\n\t\t},\r\n\t\tnextItem: function() {\r\n\t\t\tthis._gotoItem(this.slideNumber + 1, this.options.scrollTime);\r\n\t\t},\r\n\t\tprevItem: function() {\r\n\t\t\tthis._gotoItem(this.slideNumber - 1, this.options.scrollTime);\r\n\t\t},\r\n\t\tgetSlideNumber: function() {\r\n\t\t\treturn this.slideNumber || 0;\r\n\t\t},\r\n\t\t_reInit: function() {\r\n\t\t\tvar groups = this.wrapper.querySelectorAll('.' + CLASS_SLIDER_GROUP);\r\n\t\t\tfor (var i = 0, len = groups.length; i < len; i++) {\r\n\t\t\t\tif (groups[i].parentNode === this.wrapper) {\r\n\t\t\t\t\tthis.scroller = groups[i];\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.scrollerStyle = this.scroller && this.scroller.style;\r\n\t\t\tif (this.progressBar) {\r\n\t\t\t\tthis.progressBarWidth = this.progressBar.offsetWidth;\r\n\t\t\t\tthis.progressBarStyle = this.progressBar.style;\r\n\t\t\t}\r\n\t\t},\r\n\t\trefresh: function(options) {\r\n\t\t\tif (options) {\r\n\t\t\t\t$.extend(this.options, options);\r\n\t\t\t\tthis._super();\r\n\t\t\t\tthis._initTimer();\r\n\t\t\t} else {\r\n\t\t\t\tthis._super();\r\n\t\t\t}\r\n\t\t},\r\n\t\tdestroy: function() {\r\n\t\t\tthis._initEvent(true); //detach\r\n\t\t\tdelete $.data[this.wrapper.getAttribute('data-slider')];\r\n\t\t\tthis.wrapper.setAttribute('data-slider', '');\r\n\t\t}\r\n\t});\r\n\t$.fn.slider = function(options) {\r\n\t\tvar slider = null;\r\n\t\tthis.each(function() {\r\n\t\t\tvar sliderElement = this;\r\n\t\t\tif (!this.classList.contains(CLASS_SLIDER)) {\r\n\t\t\t\tsliderElement = this.querySelector('.' + CLASS_SLIDER);\r\n\t\t\t}\r\n\t\t\tif (sliderElement && sliderElement.querySelector(SELECTOR_SLIDER_ITEM)) {\r\n\t\t\t\tvar id = sliderElement.getAttribute('data-slider');\r\n\t\t\t\tif (!id) {\r\n\t\t\t\t\tid = ++$.uuid;\r\n\t\t\t\t\t$.data[id] = slider = new Slider(sliderElement, options);\r\n\t\t\t\t\tsliderElement.setAttribute('data-slider', id);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tslider = $.data[id];\r\n\t\t\t\t\tif (slider && options) {\r\n\t\t\t\t\t\tslider.refresh(options);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn slider;\r\n\t};\r\n\t$.ready(function() {\r\n\t\t//\t\tsetTimeout(function() {\r\n\t\t$('.mui-slider').slider();\r\n\t\t$('.mui-scroll-wrapper.mui-slider-indicator.mui-segmented-control').scroll({\r\n\t\t\tscrollY: false,\r\n\t\t\tscrollX: true,\r\n\t\t\tindicators: false,\r\n\t\t\tsnap: '.mui-control-item'\r\n\t\t});\r\n\t\t//\t\t}, 500); //临时处理slider宽度计算不正确的问题(初步确认是scrollbar导致的)\r\n\r\n\t});\r\n})(mui, window);\r\n/**\r\n * pullRefresh 5+\r\n * @param {type} $\r\n * @returns {undefined}\r\n */\r\n(function($, document) {\r\n    if (!($.os.plus)) { //仅在5+android支持多webview的使用\r\n        return;\r\n    }\r\n    $.plusReady(function() {\r\n        if (window.__NWin_Enable__ === false) { //不支持多webview，则不用5+下拉刷新\r\n            return;\r\n        }\r\n        var CLASS_PLUS_PULLREFRESH = 'mui-plus-pullrefresh';\r\n        var CLASS_VISIBILITY = 'mui-visibility';\r\n        var CLASS_HIDDEN = 'mui-hidden';\r\n        var CLASS_BLOCK = 'mui-block';\r\n\r\n        var CLASS_PULL_CAPTION = 'mui-pull-caption';\r\n        var CLASS_PULL_CAPTION_DOWN = 'mui-pull-caption-down';\r\n        var CLASS_PULL_CAPTION_REFRESH = 'mui-pull-caption-refresh';\r\n        var CLASS_PULL_CAPTION_NOMORE = 'mui-pull-caption-nomore';\r\n\r\n        var PlusPullRefresh = $.Class.extend({\r\n            init: function(element, options) {\r\n                this.element = element;\r\n                this.options = options;\r\n                this.wrapper = this.scroller = element;\r\n                this._init();\r\n                this._initPulldownRefreshEvent();\r\n            },\r\n            _init: function() {\r\n                var self = this;\r\n                //document.addEventListener('plusscrollbottom', this);\r\n                window.addEventListener('dragup', self);\r\n                document.addEventListener(\"plusscrollbottom\", self);\r\n                self.scrollInterval = window.setInterval(function() {\r\n                    if (self.isScroll && !self.loading) {\r\n                        if (window.pageYOffset + window.innerHeight + 10 >= document.documentElement.scrollHeight) {\r\n                            self.isScroll = false; //放在这里是因为快速滚动的话，有可能检测时，还没到底，所以只要有滚动，没到底之前一直检测高度变化\r\n                            if (self.bottomPocket) {\r\n                                self.pullupLoading();\r\n                            }\r\n                        }\r\n                    }\r\n                }, 100);\r\n            },\r\n            _initPulldownRefreshEvent: function() {\r\n                var self = this;\r\n                $.plusReady(function() {\r\n                \t\tif(self.options.down.style == \"circle\"){\r\n\t                \t\t//单webview、原生转圈\r\n\t                \t\tself.options.webview = plus.webview.currentWebview();\r\n\t\t\t\t\t\tself.options.webview.setPullToRefresh({\r\n\t\t\t\t\t\t\tsupport: true,\r\n\t\t\t\t\t\t\tcolor:self.options.down.color || '#2BD009',\r\n\t\t\t\t\t\t\theight: self.options.down.height || '50px',\r\n\t\t\t\t\t\t\trange: self.options.down.range || '100px',\r\n\t\t\t\t\t\t\tstyle: 'circle',\r\n\t\t\t\t\t\t\toffset: self.options.down.offset || '0px'\r\n\t\t\t\t\t\t}, function() {\r\n\t\t\t\t\t\t\tself.options.down.callback();\r\n\t\t\t\t\t\t});\r\n\t               }else if (self.topPocket && self.options.webviewId) {\r\n                        var webview = plus.webview.getWebviewById(self.options.webviewId);//子窗口\r\n                        if (!webview) {\r\n                            return;\r\n                        }\r\n                        self.options.webview = webview;\r\n                        var downOptions = self.options.down;\r\n                        var height = downOptions.height;\r\n                        webview.addEventListener('close', function() {\r\n                            var attrWebviewId = self.options.webviewId && self.options.webviewId.replace(/\\//g, \"_\"); //替换所有\"/\" \r\n                            self.element.removeAttribute('data-pullrefresh-plus-' + attrWebviewId);\r\n                        });\r\n                        webview.addEventListener(\"dragBounce\", function(e) {\r\n                            if (!self.pulldown) {\r\n                                self._initPulldownRefresh();\r\n                            } else {\r\n                                self.pullPocket.classList.add(CLASS_BLOCK);\r\n                            }\r\n                            switch (e.status) {\r\n                                case \"beforeChangeOffset\": //下拉可刷新状态\r\n                                    self._setCaption(downOptions.contentdown);\r\n                                    break;\r\n                                case \"afterChangeOffset\": //松开可刷新状态\r\n                                    self._setCaption(downOptions.contentover);\r\n                                    break;\r\n                                case \"dragEndAfterChangeOffset\": //正在刷新状态\r\n                                    //执行下拉刷新所在webview的回调函数\r\n                                    webview.evalJS(\"window.mui&&mui.options.pullRefresh.down.callback()\");\r\n                                    self._setCaption(downOptions.contentrefresh);\r\n                                    break;\r\n                                default:\r\n                                    break;\r\n                            }\r\n                        }, false);\r\n                        \r\n                        webview.setBounce({\r\n                            position: {\r\n                                top: height * 2 + 'px'\r\n                            },\r\n                            changeoffset: {\r\n                                top: height + 'px'\r\n                            }\r\n                        });\r\n                    \r\n\t                }\r\n                });\r\n            },\r\n            handleEvent: function(e) {\r\n                var self = this;\r\n                if (self.stopped) {\r\n                    return;\r\n                }\r\n                self.isScroll = false;\r\n                if (e.type === 'dragup' || e.type === 'plusscrollbottom') {\r\n                    self.isScroll = true;\r\n                    setTimeout(function() {\r\n                        self.isScroll = false;\r\n                    }, 1000);\r\n                }\r\n            }\r\n        }).extend($.extend({\r\n            setStopped: function(stopped) { //该方法是子页面调用的\r\n                this.stopped = !!stopped;\r\n                //TODO 此处需要设置当前webview的bounce为none,目前5+有BUG\r\n                var webview = plus.webview.currentWebview();\r\n                if (this.stopped) {\r\n                    webview.setStyle({\r\n                        bounce: 'none'\r\n                    });\r\n                    webview.setBounce({\r\n                        position: {\r\n                            top: 'none'\r\n                        }\r\n                    });\r\n                } else {\r\n                    var height = this.options.down.height;\r\n                    webview.setStyle({\r\n                        bounce: 'vertical'\r\n                    });\r\n                    webview.setBounce({\r\n                        position: {\r\n                            top: height * 2 + 'px'\r\n                        },\r\n                        changeoffset: {\r\n                            top: height + 'px'\r\n                        }\r\n                    });\r\n                }\r\n            },\r\n            beginPulldown:function() { \r\n            \t\tvar self = this;\r\n                $.plusReady(function() {\r\n                \t\t//这里延时的目的是为了保证下拉刷新组件初始化完成，后续应该做成有状态的\r\n                \t\tsetTimeout(function () {\r\n                \t\t\tif(self.options.down.style == \"circle\"){//单webview下拉刷新\r\n\t                \t\t\tplus.webview.currentWebview().beginPullToRefresh();\r\n\t                \t\t}else{//双webview模式\r\n\t                \t\t\tvar webview = self.options.webview;\r\n\t                \t\t\tif(webview){\r\n\t                \t\t\t\twebview.setBounce({\r\n\t\t\t                        offset: {\r\n\t\t\t                            top: self.options.down.height + \"px\"\r\n\t\t\t                        }\r\n\t\t\t                    });\r\n\t                \t\t\t}\r\n\t                \t\t}\r\n                \t\t},15);\r\n                }.bind(this));\r\n            },\r\n            pulldownLoading: function () {//该方法是子页面调用的，兼容老的历史API\r\n            \t\tthis.beginPulldown();\r\n            },\r\n            _pulldownLoading: function() { //该方法是父页面调用的\r\n                var self = this;\r\n                $.plusReady(function() {\r\n                    var childWebview = plus.webview.getWebviewById(self.options.webviewId);\r\n                   \tchildWebview && childWebview.setBounce({\r\n                        offset: {\r\n                            top: self.options.down.height + \"px\"\r\n                        }\r\n                    });\r\n                });\r\n            },\r\n            endPulldown:function(){\r\n            \t\tvar _wv = plus.webview.currentWebview();\r\n                //双webview的下拉刷新，需要修改父窗口提示信息\r\n                if(_wv.parent() && this.options.down.style !== \"circle\"){\r\n\t                \t_wv.parent().evalJS(\"mui&&mui(document.querySelector('.mui-content')).pullRefresh('\" + JSON.stringify({\r\n\t                    webviewId: _wv.id\r\n\t                }) + \"')._endPulldownToRefresh()\");\r\n                }else{\r\n                \t\t_wv.endPullToRefresh();\r\n                }\r\n            },\r\n            endPulldownToRefresh: function () {//该方法是子页面调用的，兼容老的历史API\r\n           \t \tthis.endPulldown();\r\n            }, \r\n            _endPulldownToRefresh: function() { //该方法是父页面调用的\r\n                var self = this;\r\n                if (self.topPocket && self.options.webview) {\r\n                    self.options.webview.endPullToRefresh(); //下拉刷新所在webview回弹\r\n                    self.loading = false;\r\n                    self._setCaption(self.options.down.contentdown, true);\r\n                    setTimeout(function() {\r\n                        self.loading || self.topPocket.classList.remove(CLASS_BLOCK);\r\n                    }, 350);\r\n                }\r\n            },\r\n            beginPullup:function(callback) {//开始上拉加载\r\n                var self = this;\r\n                if (self.isLoading) return;\r\n                self.isLoading = true;\r\n                if (self.pulldown !== false) {\r\n                    self._initPullupRefresh();\r\n                } else {\r\n                    this.pullPocket.classList.add(CLASS_BLOCK);\r\n                }\r\n                setTimeout(function() {\r\n                    self.pullLoading.classList.add(CLASS_VISIBILITY);\r\n                    self.pullLoading.classList.remove(CLASS_HIDDEN);\r\n                    self.pullCaption.innerHTML = ''; //修正5+里边第一次加载时，文字显示的bug(还会显示出来个“多”,猜测应该是渲染问题导致的)\r\n                    self.pullCaption.className = CLASS_PULL_CAPTION + ' ' + CLASS_PULL_CAPTION_REFRESH;\r\n                    self.pullCaption.innerHTML = self.options.up.contentrefresh;\r\n                    callback = callback || self.options.up.callback;\r\n                    callback && callback.call(self);\r\n                }, 300);\r\n            },\r\n            pullupLoading:function (callback) {//兼容老的API\r\n            \t\tthis.beginPullup(callback);\r\n            },\r\n            endPullup:function(finished) {//上拉加载结束\r\n                var self = this;\r\n                if (self.pullLoading) {\r\n                    self.pullLoading.classList.remove(CLASS_VISIBILITY);\r\n                    self.pullLoading.classList.add(CLASS_HIDDEN);\r\n                    self.isLoading = false;\r\n                    if (finished) {\r\n                        self.finished = true;\r\n                        self.pullCaption.className = CLASS_PULL_CAPTION + ' ' + CLASS_PULL_CAPTION_NOMORE;\r\n                        self.pullCaption.innerHTML = self.options.up.contentnomore;\r\n                        //取消5+的plusscrollbottom事件\r\n                        document.removeEventListener('plusscrollbottom', self);\r\n                        window.removeEventListener('dragup', self);\r\n                    } else { //初始化时隐藏，后续不再隐藏\r\n                        self.pullCaption.className = CLASS_PULL_CAPTION + ' ' + CLASS_PULL_CAPTION_DOWN;\r\n                        self.pullCaption.innerHTML = self.options.up.contentdown;\r\n                    }\r\n                }\r\n            },\r\n            endPullupToRefresh: function (finished) {//上拉加载结束，兼容老的API\r\n            \t\tthis.endPullup(finished);\r\n            },\r\n            disablePullupToRefresh: function() {\r\n                this._initPullupRefresh();\r\n                this.bottomPocket.className = 'mui-pull-bottom-pocket' + ' ' + CLASS_HIDDEN;\r\n                window.removeEventListener('dragup', this);\r\n            },\r\n            enablePullupToRefresh: function() {\r\n                this._initPullupRefresh();\r\n                this.bottomPocket.classList.remove(CLASS_HIDDEN);\r\n                this.pullCaption.className = CLASS_PULL_CAPTION + ' ' + CLASS_PULL_CAPTION_DOWN;\r\n                this.pullCaption.innerHTML = this.options.up.contentdown;\r\n                document.addEventListener(\"plusscrollbottom\", this);\r\n                window.addEventListener('dragup', this);\r\n            },\r\n            scrollTo: function(x, y, time) {\r\n                $.scrollTo(y, time);\r\n            },\r\n            scrollToBottom: function(time) {\r\n                $.scrollTo(document.documentElement.scrollHeight, time);\r\n            },\r\n            refresh: function(isReset) {\r\n                if (isReset && this.finished) {\r\n                    this.enablePullupToRefresh();\r\n                    this.finished = false;\r\n                }\r\n            }\r\n        }, $.PullRefresh));\r\n\r\n        //override h5 pullRefresh\r\n        $.fn.pullRefresh_native = function(options) {\r\n            var self;\r\n            if (this.length === 0) {\r\n                self = document.createElement('div');\r\n                self.className = 'mui-content';\r\n                document.body.appendChild(self);\r\n            } else {\r\n                self = this[0];\r\n            }\r\n            var args = options;\r\n            //一个父需要支持多个子下拉刷新\r\n            options = options || {}\r\n            if (typeof options === 'string') {\r\n                options = $.parseJSON(options);\r\n            };\r\n            !options.webviewId && (options.webviewId = (plus.webview.currentWebview().id || plus.webview.currentWebview().getURL()));\r\n            var pullRefreshApi = null;\r\n            var attrWebviewId = options.webviewId && options.webviewId.replace(/\\//g, \"_\"); //替换所有\"/\"\r\n            var id = self.getAttribute('data-pullrefresh-plus-' + attrWebviewId);\r\n            if (!id && typeof args === 'undefined') {\r\n                return false;\r\n            }\r\n            if (!id) { //避免重复初始化5+ pullrefresh\r\n                id = ++$.uuid;\r\n                self.setAttribute('data-pullrefresh-plus-' + attrWebviewId, id);\r\n                document.body.classList.add(CLASS_PLUS_PULLREFRESH);\r\n                $.data[id] = pullRefreshApi = new PlusPullRefresh(self, options);\r\n            } else {\r\n                pullRefreshApi = $.data[id];\r\n            }\r\n            if (options.down && options.down.auto) { //如果设置了auto，则自动下拉一次\r\n                //pullRefreshApi._pulldownLoading(); //parent webview\r\n                pullRefreshApi.beginPulldown();\r\n            } else if (options.up && options.up.auto) { //如果设置了auto，则自动上拉一次\r\n                pullRefreshApi.beginPullup();\r\n            }\r\n            return pullRefreshApi;\r\n        };\r\n    });\r\n\r\n})(mui, document);\r\n/**\r\n * off-canvas\r\n * @param {type} $\r\n * @param {type} window\r\n * @param {type} document\r\n * @param {type} action\r\n * @returns {undefined}\r\n */\r\n(function($, window, document, name) {\r\n\tvar CLASS_OFF_CANVAS_LEFT = 'mui-off-canvas-left';\r\n\tvar CLASS_OFF_CANVAS_RIGHT = 'mui-off-canvas-right';\r\n\tvar CLASS_ACTION_BACKDROP = 'mui-off-canvas-backdrop';\r\n\tvar CLASS_OFF_CANVAS_WRAP = 'mui-off-canvas-wrap';\r\n\r\n\tvar CLASS_SLIDE_IN = 'mui-slide-in';\r\n\tvar CLASS_ACTIVE = 'mui-active';\r\n\r\n\r\n\tvar CLASS_TRANSITIONING = 'mui-transitioning';\r\n\r\n\tvar SELECTOR_INNER_WRAP = '.mui-inner-wrap';\r\n\r\n\r\n\tvar OffCanvas = $.Class.extend({\r\n\t\tinit: function(element, options) {\r\n\t\t\tthis.wrapper = this.element = element;\r\n\t\t\tthis.scroller = this.wrapper.querySelector(SELECTOR_INNER_WRAP);\r\n\t\t\tthis.classList = this.wrapper.classList;\r\n\t\t\tif (this.scroller) {\r\n\t\t\t\tthis.options = $.extend(true, {\r\n\t\t\t\t\tdragThresholdX: 10,\r\n\t\t\t\t\tscale: 0.8,\r\n\t\t\t\t\topacity: 0.1,\r\n\t\t\t\t\tpreventDefaultException: {\r\n\t\t\t\t\t\ttagName: /^(INPUT|TEXTAREA|BUTTON|SELECT|VIDEO)$/\r\n\t\t\t\t\t},\r\n\t\t\t\t}, options);\r\n\t\t\t\tdocument.body.classList.add('mui-fullscreen'); //fullscreen\r\n\t\t\t\tthis.refresh();\r\n\t\t\t\tthis.initEvent();\r\n\t\t\t}\r\n\t\t},\r\n\t\t_preventDefaultException: function(el, exceptions) {\r\n\t\t\tfor (var i in exceptions) {\r\n\t\t\t\tif (exceptions[i].test(el[i])) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t},\r\n\t\trefresh: function(offCanvas) {\r\n\t\t\t//\t\t\toffCanvas && !offCanvas.classList.contains(CLASS_ACTIVE) && this.classList.remove(CLASS_ACTIVE);\r\n\t\t\tthis.slideIn = this.classList.contains(CLASS_SLIDE_IN);\r\n\t\t\tthis.scalable = this.classList.contains('mui-scalable') && !this.slideIn;\r\n\t\t\tthis.scroller = this.wrapper.querySelector(SELECTOR_INNER_WRAP);\r\n\t\t\t//\t\t\t!offCanvas && this.scroller.classList.remove(CLASS_TRANSITIONING);\r\n\t\t\t//\t\t\t!offCanvas && this.scroller.setAttribute('style', '');\r\n\t\t\tthis.offCanvasLefts = this.wrapper.querySelectorAll('.' + CLASS_OFF_CANVAS_LEFT);\r\n\t\t\tthis.offCanvasRights = this.wrapper.querySelectorAll('.' + CLASS_OFF_CANVAS_RIGHT);\r\n\t\t\tif (offCanvas) {\r\n\t\t\t\tif (offCanvas.classList.contains(CLASS_OFF_CANVAS_LEFT)) {\r\n\t\t\t\t\tthis.offCanvasLeft = offCanvas;\r\n\t\t\t\t} else if (offCanvas.classList.contains(CLASS_OFF_CANVAS_RIGHT)) {\r\n\t\t\t\t\tthis.offCanvasRight = offCanvas;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tthis.offCanvasRight = this.wrapper.querySelector('.' + CLASS_OFF_CANVAS_RIGHT);\r\n\t\t\t\tthis.offCanvasLeft = this.wrapper.querySelector('.' + CLASS_OFF_CANVAS_LEFT);\r\n\t\t\t}\r\n\t\t\tthis.offCanvasRightWidth = this.offCanvasLeftWidth = 0;\r\n\t\t\tthis.offCanvasLeftSlideIn = this.offCanvasRightSlideIn = false;\r\n\t\t\tif (this.offCanvasRight) {\r\n\t\t\t\tthis.offCanvasRightWidth = this.offCanvasRight.offsetWidth;\r\n\t\t\t\tthis.offCanvasRightSlideIn = this.slideIn && (this.offCanvasRight.parentNode === this.wrapper);\r\n\t\t\t\t//\t\t\t\tthis.offCanvasRight.classList.remove(CLASS_TRANSITIONING);\r\n\t\t\t\t//\t\t\t\tthis.offCanvasRight.classList.remove(CLASS_ACTIVE);\r\n\t\t\t\t//\t\t\t\tthis.offCanvasRight.setAttribute('style', '');\r\n\t\t\t}\r\n\t\t\tif (this.offCanvasLeft) {\r\n\t\t\t\tthis.offCanvasLeftWidth = this.offCanvasLeft.offsetWidth;\r\n\t\t\t\tthis.offCanvasLeftSlideIn = this.slideIn && (this.offCanvasLeft.parentNode === this.wrapper);\r\n\t\t\t\t//\t\t\t\tthis.offCanvasLeft.classList.remove(CLASS_TRANSITIONING);\r\n\t\t\t\t//\t\t\t\tthis.offCanvasLeft.classList.remove(CLASS_ACTIVE);\r\n\t\t\t\t//\t\t\t\tthis.offCanvasLeft.setAttribute('style', '');\r\n\t\t\t}\r\n\t\t\tthis.backdrop = this.scroller.querySelector('.' + CLASS_ACTION_BACKDROP);\r\n\r\n\t\t\tthis.options.dragThresholdX = this.options.dragThresholdX || 10;\r\n\r\n\t\t\tthis.visible = false;\r\n\t\t\tthis.startX = null;\r\n\t\t\tthis.lastX = null;\r\n\t\t\tthis.offsetX = null;\r\n\t\t\tthis.lastTranslateX = null;\r\n\t\t},\r\n\t\thandleEvent: function(e) {\r\n\t\t\tswitch (e.type) {\r\n\t\t\t\tcase $.EVENT_START:\r\n\t\t\t\t\te.target && !this._preventDefaultException(e.target, this.options.preventDefaultException) && e.preventDefault();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'webkitTransitionEnd': //有个bug需要处理，需要考虑假设没有触发webkitTransitionEnd的情况\r\n\t\t\t\t\tif (e.target === this.scroller) {\r\n\t\t\t\t\t\tthis._dispatchEvent();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'drag':\r\n\t\t\t\t\tvar detail = e.detail;\r\n\t\t\t\t\tif (!this.startX) {\r\n\t\t\t\t\t\tthis.startX = detail.center.x;\r\n\t\t\t\t\t\tthis.lastX = this.startX;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.lastX = detail.center.x;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!this.isDragging && Math.abs(this.lastX - this.startX) > this.options.dragThresholdX && (detail.direction === 'left' || (detail.direction === 'right'))) {\r\n\t\t\t\t\t\tif (this.slideIn) {\r\n\t\t\t\t\t\t\tthis.scroller = this.wrapper.querySelector(SELECTOR_INNER_WRAP);\r\n\t\t\t\t\t\t\tif (this.classList.contains(CLASS_ACTIVE)) {\r\n\t\t\t\t\t\t\t\tif (this.offCanvasRight && this.offCanvasRight.classList.contains(CLASS_ACTIVE)) {\r\n\t\t\t\t\t\t\t\t\tthis.offCanvas = this.offCanvasRight;\r\n\t\t\t\t\t\t\t\t\tthis.offCanvasWidth = this.offCanvasRightWidth;\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tthis.offCanvas = this.offCanvasLeft;\r\n\t\t\t\t\t\t\t\t\tthis.offCanvasWidth = this.offCanvasLeftWidth;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tif (detail.direction === 'left' && this.offCanvasRight) {\r\n\t\t\t\t\t\t\t\t\tthis.offCanvas = this.offCanvasRight;\r\n\t\t\t\t\t\t\t\t\tthis.offCanvasWidth = this.offCanvasRightWidth;\r\n\t\t\t\t\t\t\t\t} else if (detail.direction === 'right' && this.offCanvasLeft) {\r\n\t\t\t\t\t\t\t\t\tthis.offCanvas = this.offCanvasLeft;\r\n\t\t\t\t\t\t\t\t\tthis.offCanvasWidth = this.offCanvasLeftWidth;\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tthis.scroller = null;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tif (this.classList.contains(CLASS_ACTIVE)) {\r\n\t\t\t\t\t\t\t\tif (detail.direction === 'left') {\r\n\t\t\t\t\t\t\t\t\tthis.offCanvas = this.offCanvasLeft;\r\n\t\t\t\t\t\t\t\t\tthis.offCanvasWidth = this.offCanvasLeftWidth;\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tthis.offCanvas = this.offCanvasRight;\r\n\t\t\t\t\t\t\t\t\tthis.offCanvasWidth = this.offCanvasRightWidth;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tif (detail.direction === 'right') {\r\n\t\t\t\t\t\t\t\t\tthis.offCanvas = this.offCanvasLeft;\r\n\t\t\t\t\t\t\t\t\tthis.offCanvasWidth = this.offCanvasLeftWidth;\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tthis.offCanvas = this.offCanvasRight;\r\n\t\t\t\t\t\t\t\t\tthis.offCanvasWidth = this.offCanvasRightWidth;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (this.offCanvas && this.scroller) {\r\n\t\t\t\t\t\t\tthis.startX = this.lastX;\r\n\t\t\t\t\t\t\tthis.isDragging = true;\r\n\r\n\t\t\t\t\t\t\t$.gestures.session.lockDirection = true; //锁定方向\r\n\t\t\t\t\t\t\t$.gestures.session.startDirection = detail.direction;\r\n\r\n\t\t\t\t\t\t\tthis.offCanvas.classList.remove(CLASS_TRANSITIONING);\r\n\t\t\t\t\t\t\tthis.scroller.classList.remove(CLASS_TRANSITIONING);\r\n\t\t\t\t\t\t\tthis.offsetX = this.getTranslateX();\r\n\t\t\t\t\t\t\tthis._initOffCanvasVisible();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (this.isDragging) {\r\n\t\t\t\t\t\tthis.updateTranslate(this.offsetX + (this.lastX - this.startX));\r\n\t\t\t\t\t\tdetail.gesture.preventDefault();\r\n\t\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'dragend':\r\n\t\t\t\t\tif (this.isDragging) {\r\n\t\t\t\t\t\tvar detail = e.detail;\r\n\t\t\t\t\t\tvar direction = detail.direction;\r\n\t\t\t\t\t\tthis.isDragging = false;\r\n\t\t\t\t\t\tthis.offCanvas.classList.add(CLASS_TRANSITIONING);\r\n\t\t\t\t\t\tthis.scroller.classList.add(CLASS_TRANSITIONING);\r\n\t\t\t\t\t\tvar ratio = 0;\r\n\t\t\t\t\t\tvar x = this.getTranslateX();\r\n\t\t\t\t\t\tif (!this.slideIn) {\r\n\t\t\t\t\t\t\tif (x >= 0) {\r\n\t\t\t\t\t\t\t\tratio = (this.offCanvasLeftWidth && (x / this.offCanvasLeftWidth)) || 0;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tratio = (this.offCanvasRightWidth && (x / this.offCanvasRightWidth)) || 0;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (ratio === 0) {\r\n\t\t\t\t\t\t\t\tthis.openPercentage(0);\r\n\t\t\t\t\t\t\t\tthis._dispatchEvent(); //此处不触发webkitTransitionEnd,所以手动dispatch\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (direction === 'right' && ratio >= 0 && (ratio >= 0.5 || detail.swipe)) { //右滑打开\r\n\t\t\t\t\t\t\t\tthis.openPercentage(100);\r\n\t\t\t\t\t\t\t} else if (direction === 'right' && ratio < 0 && (ratio > -0.5 || detail.swipe)) { //右滑关闭\r\n\t\t\t\t\t\t\t\tthis.openPercentage(0);\r\n\t\t\t\t\t\t\t} else if (direction === 'right' && ratio > 0 && ratio < 0.5) { //右滑还原关闭\r\n\t\t\t\t\t\t\t\tthis.openPercentage(0);\r\n\t\t\t\t\t\t\t} else if (direction === 'right' && ratio < 0.5) { //右滑还原打开\r\n\t\t\t\t\t\t\t\tthis.openPercentage(-100);\r\n\t\t\t\t\t\t\t} else if (direction === 'left' && ratio <= 0 && (ratio <= -0.5 || detail.swipe)) { //左滑打开\r\n\t\t\t\t\t\t\t\tthis.openPercentage(-100);\r\n\t\t\t\t\t\t\t} else if (direction === 'left' && ratio > 0 && (ratio <= 0.5 || detail.swipe)) { //左滑关闭\r\n\t\t\t\t\t\t\t\tthis.openPercentage(0);\r\n\t\t\t\t\t\t\t} else if (direction === 'left' && ratio < 0 && ratio >= -0.5) { //左滑还原关闭\r\n\t\t\t\t\t\t\t\tthis.openPercentage(0);\r\n\t\t\t\t\t\t\t} else if (direction === 'left' && ratio > 0.5) { //左滑还原打开\r\n\t\t\t\t\t\t\t\tthis.openPercentage(100);\r\n\t\t\t\t\t\t\t} else { //默认关闭\r\n\t\t\t\t\t\t\t\tthis.openPercentage(0);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (ratio === 1 || ratio === -1) { //此处不触发webkitTransitionEnd,所以手动dispatch\r\n\t\t\t\t\t\t\t\tthis._dispatchEvent();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tif (x >= 0) {\r\n\t\t\t\t\t\t\t\tratio = (this.offCanvasRightWidth && (x / this.offCanvasRightWidth)) || 0;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tratio = (this.offCanvasLeftWidth && (x / this.offCanvasLeftWidth)) || 0;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (direction === 'right' && ratio <= 0 && (ratio >= -0.5 || detail.swipe)) { //右滑打开\r\n\t\t\t\t\t\t\t\tthis.openPercentage(100);\r\n\t\t\t\t\t\t\t} else if (direction === 'right' && ratio > 0 && (ratio >= 0.5 || detail.swipe)) { //右滑关闭\r\n\t\t\t\t\t\t\t\tthis.openPercentage(0);\r\n\t\t\t\t\t\t\t} else if (direction === 'right' && ratio <= -0.5) { //右滑还原关闭\r\n\t\t\t\t\t\t\t\tthis.openPercentage(0);\r\n\t\t\t\t\t\t\t} else if (direction === 'right' && ratio > 0 && ratio <= 0.5) { //右滑还原打开\r\n\t\t\t\t\t\t\t\tthis.openPercentage(-100);\r\n\t\t\t\t\t\t\t} else if (direction === 'left' && ratio >= 0 && (ratio <= 0.5 || detail.swipe)) { //左滑打开\r\n\t\t\t\t\t\t\t\tthis.openPercentage(-100);\r\n\t\t\t\t\t\t\t} else if (direction === 'left' && ratio < 0 && (ratio <= -0.5 || detail.swipe)) { //左滑关闭\r\n\t\t\t\t\t\t\t\tthis.openPercentage(0);\r\n\t\t\t\t\t\t\t} else if (direction === 'left' && ratio >= 0.5) { //左滑还原关闭\r\n\t\t\t\t\t\t\t\tthis.openPercentage(0);\r\n\t\t\t\t\t\t\t} else if (direction === 'left' && ratio >= -0.5 && ratio < 0) { //左滑还原打开\r\n\t\t\t\t\t\t\t\tthis.openPercentage(100);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tthis.openPercentage(0);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (ratio === 1 || ratio === -1 || ratio === 0) {\r\n\t\t\t\t\t\t\t\tthis._dispatchEvent();\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t},\r\n\t\t_dispatchEvent: function() {\r\n\t\t\tif (this.classList.contains(CLASS_ACTIVE)) {\r\n\t\t\t\t$.trigger(this.wrapper, 'shown', this);\r\n\t\t\t} else {\r\n\t\t\t\t$.trigger(this.wrapper, 'hidden', this);\r\n\t\t\t}\r\n\t\t},\r\n\t\t_initOffCanvasVisible: function() {\r\n\t\t\tif (!this.visible) {\r\n\t\t\t\tthis.visible = true;\r\n\t\t\t\tif (this.offCanvasLeft) {\r\n\t\t\t\t\tthis.offCanvasLeft.style.visibility = 'visible';\r\n\t\t\t\t}\r\n\t\t\t\tif (this.offCanvasRight) {\r\n\t\t\t\t\tthis.offCanvasRight.style.visibility = 'visible';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tinitEvent: function() {\r\n\t\t\tvar self = this;\r\n\t\t\tif (self.backdrop) {\r\n\t\t\t\tself.backdrop.addEventListener('tap', function(e) {\r\n\t\t\t\t\tself.close();\r\n\t\t\t\t\te.detail.gesture.preventDefault();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tif (this.classList.contains('mui-draggable')) {\r\n\t\t\t\tthis.wrapper.addEventListener($.EVENT_START, this); //临时处理\r\n\t\t\t\tthis.wrapper.addEventListener('drag', this);\r\n\t\t\t\tthis.wrapper.addEventListener('dragend', this);\r\n\t\t\t}\r\n\t\t\tthis.wrapper.addEventListener('webkitTransitionEnd', this);\r\n\t\t},\r\n\t\topenPercentage: function(percentage) {\r\n\t\t\tvar p = percentage / 100;\r\n\t\t\tif (!this.slideIn) {\r\n\t\t\t\tif (this.offCanvasLeft && percentage >= 0) {\r\n\t\t\t\t\tthis.updateTranslate(this.offCanvasLeftWidth * p);\r\n\t\t\t\t\tthis.offCanvasLeft.classList[p !== 0 ? 'add' : 'remove'](CLASS_ACTIVE);\r\n\t\t\t\t} else if (this.offCanvasRight && percentage <= 0) {\r\n\t\t\t\t\tthis.updateTranslate(this.offCanvasRightWidth * p);\r\n\t\t\t\t\tthis.offCanvasRight.classList[p !== 0 ? 'add' : 'remove'](CLASS_ACTIVE);\r\n\t\t\t\t}\r\n\t\t\t\tthis.classList[p !== 0 ? 'add' : 'remove'](CLASS_ACTIVE);\r\n\t\t\t} else {\r\n\t\t\t\tif (this.offCanvasLeft && percentage >= 0) {\r\n\t\t\t\t\tp = p === 0 ? -1 : 0;\r\n\t\t\t\t\tthis.updateTranslate(this.offCanvasLeftWidth * p);\r\n\t\t\t\t\tthis.offCanvasLeft.classList[percentage !== 0 ? 'add' : 'remove'](CLASS_ACTIVE);\r\n\t\t\t\t} else if (this.offCanvasRight && percentage <= 0) {\r\n\t\t\t\t\tp = p === 0 ? 1 : 0;\r\n\t\t\t\t\tthis.updateTranslate(this.offCanvasRightWidth * p);\r\n\t\t\t\t\tthis.offCanvasRight.classList[percentage !== 0 ? 'add' : 'remove'](CLASS_ACTIVE);\r\n\t\t\t\t}\r\n\t\t\t\tthis.classList[percentage !== 0 ? 'add' : 'remove'](CLASS_ACTIVE);\r\n\t\t\t}\r\n\t\t},\r\n\t\tupdateTranslate: function(x) {\r\n\t\t\tif (x !== this.lastTranslateX) {\r\n\t\t\t\tif (!this.slideIn) {\r\n\t\t\t\t\tif ((!this.offCanvasLeft && x > 0) || (!this.offCanvasRight && x < 0)) {\r\n\t\t\t\t\t\tthis.setTranslateX(0);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (this.leftShowing && x > this.offCanvasLeftWidth) {\r\n\t\t\t\t\t\tthis.setTranslateX(this.offCanvasLeftWidth);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (this.rightShowing && x < -this.offCanvasRightWidth) {\r\n\t\t\t\t\t\tthis.setTranslateX(-this.offCanvasRightWidth);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.setTranslateX(x);\r\n\t\t\t\t\tif (x >= 0) {\r\n\t\t\t\t\t\tthis.leftShowing = true;\r\n\t\t\t\t\t\tthis.rightShowing = false;\r\n\t\t\t\t\t\tif (x > 0) {\r\n\t\t\t\t\t\t\tif (this.offCanvasLeft) {\r\n\t\t\t\t\t\t\t\t$.each(this.offCanvasLefts, function(index, offCanvas) {\r\n\t\t\t\t\t\t\t\t\tif (offCanvas === this.offCanvasLeft) {\r\n\t\t\t\t\t\t\t\t\t\tthis.offCanvasLeft.style.zIndex = 0;\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\toffCanvas.style.zIndex = -1;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}.bind(this));\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (this.offCanvasRight) {\r\n\t\t\t\t\t\t\t\tthis.offCanvasRight.style.zIndex = -1;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.rightShowing = true;\r\n\t\t\t\t\t\tthis.leftShowing = false;\r\n\t\t\t\t\t\tif (this.offCanvasRight) {\r\n\t\t\t\t\t\t\t$.each(this.offCanvasRights, function(index, offCanvas) {\r\n\t\t\t\t\t\t\t\tif (offCanvas === this.offCanvasRight) {\r\n\t\t\t\t\t\t\t\t\toffCanvas.style.zIndex = 0;\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\toffCanvas.style.zIndex = -1;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (this.offCanvasLeft) {\r\n\t\t\t\t\t\t\tthis.offCanvasLeft.style.zIndex = -1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (this.offCanvas.classList.contains(CLASS_OFF_CANVAS_RIGHT)) {\r\n\t\t\t\t\t\tif (x < 0) {\r\n\t\t\t\t\t\t\tthis.setTranslateX(0);\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (x > this.offCanvasRightWidth) {\r\n\t\t\t\t\t\t\tthis.setTranslateX(this.offCanvasRightWidth);\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (x > 0) {\r\n\t\t\t\t\t\t\tthis.setTranslateX(0);\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (x < -this.offCanvasLeftWidth) {\r\n\t\t\t\t\t\t\tthis.setTranslateX(-this.offCanvasLeftWidth);\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.setTranslateX(x);\r\n\t\t\t\t}\r\n\t\t\t\tthis.lastTranslateX = x;\r\n\t\t\t}\r\n\t\t},\r\n\t\tsetTranslateX: $.animationFrame(function(x) {\r\n\t\t\tif (this.scroller) {\r\n\t\t\t\tif (this.scalable && this.offCanvas.parentNode === this.wrapper) {\r\n\t\t\t\t\tvar percent = Math.abs(x) / this.offCanvasWidth;\r\n\t\t\t\t\tvar zoomOutScale = 1 - (1 - this.options.scale) * percent;\r\n\t\t\t\t\tvar zoomInScale = this.options.scale + (1 - this.options.scale) * percent;\r\n\t\t\t\t\tvar zoomOutOpacity = 1 - (1 - this.options.opacity) * percent;\r\n\t\t\t\t\tvar zoomInOpacity = this.options.opacity + (1 - this.options.opacity) * percent;\r\n\t\t\t\t\tif (this.offCanvas.classList.contains(CLASS_OFF_CANVAS_LEFT)) {\r\n\t\t\t\t\t\tthis.offCanvas.style.webkitTransformOrigin = '-100%';\r\n\t\t\t\t\t\tthis.scroller.style.webkitTransformOrigin = 'left';\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.offCanvas.style.webkitTransformOrigin = '200%';\r\n\t\t\t\t\t\tthis.scroller.style.webkitTransformOrigin = 'right';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.offCanvas.style.opacity = zoomInOpacity;\r\n\t\t\t\t\tthis.offCanvas.style.webkitTransform = 'translate3d(0,0,0) scale(' + zoomInScale + ')';\r\n\t\t\t\t\tthis.scroller.style.webkitTransform = 'translate3d(' + x + 'px,0,0) scale(' + zoomOutScale + ')';\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (this.slideIn) {\r\n\t\t\t\t\t\tthis.offCanvas.style.webkitTransform = 'translate3d(' + x + 'px,0,0)';\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.scroller.style.webkitTransform = 'translate3d(' + x + 'px,0,0)';\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}),\r\n\t\tgetTranslateX: function() {\r\n\t\t\tif (this.offCanvas) {\r\n\t\t\t\tvar scroller = this.slideIn ? this.offCanvas : this.scroller;\r\n\t\t\t\tvar result = $.parseTranslateMatrix($.getStyles(scroller, 'webkitTransform'));\r\n\t\t\t\treturn (result && result.x) || 0;\r\n\t\t\t}\r\n\t\t\treturn 0;\r\n\t\t},\r\n\t\tisShown: function(direction) {\r\n\t\t\tvar shown = false;\r\n\t\t\tif (!this.slideIn) {\r\n\t\t\t\tvar x = this.getTranslateX();\r\n\t\t\t\tif (direction === 'right') {\r\n\t\t\t\t\tshown = this.classList.contains(CLASS_ACTIVE) && x < 0;\r\n\t\t\t\t} else if (direction === 'left') {\r\n\t\t\t\t\tshown = this.classList.contains(CLASS_ACTIVE) && x > 0;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tshown = this.classList.contains(CLASS_ACTIVE) && x !== 0;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (direction === 'left') {\r\n\t\t\t\t\tshown = this.classList.contains(CLASS_ACTIVE) && this.wrapper.querySelector('.' + CLASS_OFF_CANVAS_LEFT + '.' + CLASS_ACTIVE);\r\n\t\t\t\t} else if (direction === 'right') {\r\n\t\t\t\t\tshown = this.classList.contains(CLASS_ACTIVE) && this.wrapper.querySelector('.' + CLASS_OFF_CANVAS_RIGHT + '.' + CLASS_ACTIVE);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tshown = this.classList.contains(CLASS_ACTIVE) && (this.wrapper.querySelector('.' + CLASS_OFF_CANVAS_LEFT + '.' + CLASS_ACTIVE) || this.wrapper.querySelector('.' + CLASS_OFF_CANVAS_RIGHT + '.' + CLASS_ACTIVE));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn shown;\r\n\t\t},\r\n\t\tclose: function() {\r\n\t\t\tthis._initOffCanvasVisible();\r\n\t\t\tthis.offCanvas = this.wrapper.querySelector('.' + CLASS_OFF_CANVAS_RIGHT + '.' + CLASS_ACTIVE) || this.wrapper.querySelector('.' + CLASS_OFF_CANVAS_LEFT + '.' + CLASS_ACTIVE);\r\n\t\t\tthis.offCanvasWidth = this.offCanvas.offsetWidth;\r\n\t\t\tif (this.scroller) {\r\n\t\t\t\tthis.offCanvas.offsetHeight;\r\n\t\t\t\tthis.offCanvas.classList.add(CLASS_TRANSITIONING);\r\n\t\t\t\tthis.scroller.classList.add(CLASS_TRANSITIONING);\r\n\t\t\t\tthis.openPercentage(0);\r\n\t\t\t}\r\n\t\t},\r\n\t\tshow: function(direction) {\r\n\t\t\tthis._initOffCanvasVisible();\r\n\t\t\tif (this.isShown(direction)) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tif (!direction) {\r\n\t\t\t\tdirection = this.wrapper.querySelector('.' + CLASS_OFF_CANVAS_RIGHT) ? 'right' : 'left';\r\n\t\t\t}\r\n\t\t\tif (direction === 'right') {\r\n\t\t\t\tthis.offCanvas = this.offCanvasRight;\r\n\t\t\t\tthis.offCanvasWidth = this.offCanvasRightWidth;\r\n\t\t\t} else {\r\n\t\t\t\tthis.offCanvas = this.offCanvasLeft;\r\n\t\t\t\tthis.offCanvasWidth = this.offCanvasLeftWidth;\r\n\t\t\t}\r\n\t\t\tif (this.scroller) {\r\n\t\t\t\tthis.offCanvas.offsetHeight;\r\n\t\t\t\tthis.offCanvas.classList.add(CLASS_TRANSITIONING);\r\n\t\t\t\tthis.scroller.classList.add(CLASS_TRANSITIONING);\r\n\t\t\t\tthis.openPercentage(direction === 'left' ? 100 : -100);\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\ttoggle: function(directionOrOffCanvas) {\r\n\t\t\tvar direction = directionOrOffCanvas;\r\n\t\t\tif (directionOrOffCanvas && directionOrOffCanvas.classList) {\r\n\t\t\t\tdirection = directionOrOffCanvas.classList.contains(CLASS_OFF_CANVAS_LEFT) ? 'left' : 'right';\r\n\t\t\t\tthis.refresh(directionOrOffCanvas);\r\n\t\t\t}\r\n\t\t\tif (!this.show(direction)) {\r\n\t\t\t\tthis.close();\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n\r\n\t//hash to offcanvas\r\n\tvar findOffCanvasContainer = function(target) {\r\n\t\tparentNode = target.parentNode;\r\n\t\tif (parentNode) {\r\n\t\t\tif (parentNode.classList.contains(CLASS_OFF_CANVAS_WRAP)) {\r\n\t\t\t\treturn parentNode;\r\n\t\t\t} else {\r\n\t\t\t\tparentNode = parentNode.parentNode;\r\n\t\t\t\tif (parentNode.classList.contains(CLASS_OFF_CANVAS_WRAP)) {\r\n\t\t\t\t\treturn parentNode;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\tvar handle = function(event, target) {\r\n\t\tif (target.tagName === 'A' && target.hash) {\r\n\t\t\tvar offcanvas = document.getElementById(target.hash.replace('#', ''));\r\n\t\t\tif (offcanvas) {\r\n\t\t\t\tvar container = findOffCanvasContainer(offcanvas);\r\n\t\t\t\tif (container) {\r\n\t\t\t\t\t$.targets._container = container;\r\n\t\t\t\t\treturn offcanvas;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t};\r\n\r\n\t$.registerTarget({\r\n\t\tname: name,\r\n\t\tindex: 60,\r\n\t\thandle: handle,\r\n\t\ttarget: false,\r\n\t\tisReset: false,\r\n\t\tisContinue: true\r\n\t});\r\n\r\n\twindow.addEventListener('tap', function(e) {\r\n\t\tif (!$.targets.offcanvas) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t//TODO 此处类型的代码后续考虑统一优化(target机制)，现在的实现费力不讨好\r\n\t\tvar target = e.target;\r\n\t\tfor (; target && target !== document; target = target.parentNode) {\r\n\t\t\tif (target.tagName === 'A' && target.hash && target.hash === ('#' + $.targets.offcanvas.id)) {\r\n\t\t\t\te.detail && e.detail.gesture && e.detail.gesture.preventDefault(); //fixed hashchange\r\n\t\t\t\t$($.targets._container).offCanvas().toggle($.targets.offcanvas);\r\n\t\t\t\t$.targets.offcanvas = $.targets._container = null;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n\r\n\t$.fn.offCanvas = function(options) {\r\n\t\tvar offCanvasApis = [];\r\n\t\tthis.each(function() {\r\n\t\t\tvar offCanvasApi = null;\r\n\t\t\tvar self = this;\r\n\t\t\t//hack old version\r\n\t\t\tif (!self.classList.contains(CLASS_OFF_CANVAS_WRAP)) {\r\n\t\t\t\tself = findOffCanvasContainer(self);\r\n\t\t\t}\r\n\t\t\tvar id = self.getAttribute('data-offCanvas');\r\n\t\t\tif (!id) {\r\n\t\t\t\tid = ++$.uuid;\r\n\t\t\t\t$.data[id] = offCanvasApi = new OffCanvas(self, options);\r\n\t\t\t\tself.setAttribute('data-offCanvas', id);\r\n\t\t\t} else {\r\n\t\t\t\toffCanvasApi = $.data[id];\r\n\t\t\t}\r\n\t\t\tif (options === 'show' || options === 'close' || options === 'toggle') {\r\n\t\t\t\toffCanvasApi.toggle();\r\n\t\t\t}\r\n\t\t\toffCanvasApis.push(offCanvasApi);\r\n\t\t});\r\n\t\treturn offCanvasApis.length === 1 ? offCanvasApis[0] : offCanvasApis;\r\n\t};\r\n\t$.ready(function() {\r\n\t\t$('.mui-off-canvas-wrap').offCanvas();\r\n\t});\r\n})(mui, window, document, 'offcanvas');\r\n/**\r\n * actions\r\n * @param {type} $\r\n * @param {type} name\r\n * @returns {undefined}\r\n */\r\n(function($, name) {\r\n\tvar CLASS_ACTION = 'mui-action';\r\n\r\n\tvar handle = function(event, target) {\r\n\t\tvar className = target.className || '';\r\n\t\tif (typeof className !== 'string') { //svg className(SVGAnimatedString)\r\n\t\t\tclassName = '';\r\n\t\t}\r\n\t\tif (className && ~className.indexOf(CLASS_ACTION)) {\r\n\t\t\tif (target.classList.contains('mui-action-back')) {\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t}\r\n\t\t\treturn target;\r\n\t\t}\r\n\t\treturn false;\r\n\t};\r\n\r\n\t$.registerTarget({\r\n\t\tname: name,\r\n\t\tindex: 50,\r\n\t\thandle: handle,\r\n\t\ttarget: false,\r\n\t\tisContinue: true\r\n\t});\r\n\r\n})(mui, 'action');\r\n/**\r\n * Modals\r\n * @param {type} $\r\n * @param {type} window\r\n * @param {type} document\r\n * @param {type} name\r\n * @returns {undefined}\r\n */\r\n(function($, window, document, name) {\r\n\tvar CLASS_MODAL = 'mui-modal';\r\n\r\n\tvar handle = function(event, target) {\r\n\t\tif (target.tagName === 'A' && target.hash) {\r\n\t\t\tvar modal = document.getElementById(target.hash.replace('#', ''));\r\n\t\t\tif (modal && modal.classList.contains(CLASS_MODAL)) {\r\n\t\t\t\treturn modal;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t};\r\n\r\n\t$.registerTarget({\r\n\t\tname: name,\r\n\t\tindex: 50,\r\n\t\thandle: handle,\r\n\t\ttarget: false,\r\n\t\tisReset: false,\r\n\t\tisContinue: true\r\n\t});\r\n\r\n\twindow.addEventListener('tap', function(event) {\r\n\t\tif ($.targets.modal) {\r\n\t\t\tevent.detail.gesture.preventDefault(); //fixed hashchange\r\n\t\t\t$.targets.modal.classList.toggle('mui-active');\r\n\t\t}\r\n\t});\r\n})(mui, window, document, 'modal');\r\n/**\r\n * Popovers\r\n * @param {type} $\r\n * @param {type} window\r\n * @param {type} document\r\n * @param {type} name\r\n * @param {type} undefined\r\n * @returns {undefined}\r\n */\r\n(function($, window, document, name) {\r\n\r\n\tvar CLASS_POPOVER = 'mui-popover';\r\n\tvar CLASS_POPOVER_ARROW = 'mui-popover-arrow';\r\n\tvar CLASS_ACTION_POPOVER = 'mui-popover-action';\r\n\tvar CLASS_BACKDROP = 'mui-backdrop';\r\n\tvar CLASS_BAR_POPOVER = 'mui-bar-popover';\r\n\tvar CLASS_BAR_BACKDROP = 'mui-bar-backdrop';\r\n\tvar CLASS_ACTION_BACKDROP = 'mui-backdrop-action';\r\n\tvar CLASS_ACTIVE = 'mui-active';\r\n\tvar CLASS_BOTTOM = 'mui-bottom';\r\n\r\n\r\n\r\n\tvar handle = function(event, target) {\r\n\t\tif (target.tagName === 'A' && target.hash) {\r\n\t\t\t$.targets._popover = document.getElementById(target.hash.replace('#', ''));\r\n\t\t\tif ($.targets._popover && $.targets._popover.classList.contains(CLASS_POPOVER)) {\r\n\t\t\t\treturn target;\r\n\t\t\t} else {\r\n\t\t\t\t$.targets._popover = null;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t};\r\n\r\n\t$.registerTarget({\r\n\t\tname: name,\r\n\t\tindex: 60,\r\n\t\thandle: handle,\r\n\t\ttarget: false,\r\n\t\tisReset: false,\r\n\t\tisContinue: true\r\n\t});\r\n\r\n\tvar onPopoverShown = function(e) {\r\n\t\tthis.removeEventListener('webkitTransitionEnd', onPopoverShown);\r\n\t\tthis.addEventListener($.EVENT_MOVE, $.preventDefault);\r\n\t\t$.trigger(this, 'shown', this);\r\n\t}\r\n\tvar onPopoverHidden = function(e) {\r\n\t\tsetStyle(this, 'none');\r\n\t\tthis.removeEventListener('webkitTransitionEnd', onPopoverHidden);\r\n\t\tthis.removeEventListener($.EVENT_MOVE, $.preventDefault);\r\n\t\t$.trigger(this, 'hidden', this);\r\n\t};\r\n\r\n\tvar backdrop = (function() {\r\n\t\tvar element = document.createElement('div');\r\n\t\telement.classList.add(CLASS_BACKDROP);\r\n\t\telement.addEventListener($.EVENT_MOVE, $.preventDefault);\r\n\t\telement.addEventListener('tap', function(e) {\r\n\t\t\tvar popover = $.targets._popover;\r\n\t\t\tif (popover) {\r\n\t\t\t\tpopover.addEventListener('webkitTransitionEnd', onPopoverHidden);\r\n\t\t\t\tpopover.classList.remove(CLASS_ACTIVE);\r\n\t\t\t\tremoveBackdrop(popover);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn element;\r\n\t}());\r\n\tvar removeBackdropTimer;\r\n\tvar removeBackdrop = function(popover) {\r\n\t\tbackdrop.setAttribute('style', 'opacity:0');\r\n\t\t$.targets.popover = $.targets._popover = null; //reset\r\n\t\tremoveBackdropTimer = $.later(function() {\r\n\t\t\tif (!popover.classList.contains(CLASS_ACTIVE) && backdrop.parentNode && backdrop.parentNode === document.body) {\r\n\t\t\t\tdocument.body.removeChild(backdrop);\r\n\t\t\t}\r\n\t\t}, 350);\r\n\t};\r\n\twindow.addEventListener('tap', function(e) {\r\n\t\tif (!$.targets.popover) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar toggle = false;\r\n\t\tvar target = e.target;\r\n\t\tfor (; target && target !== document; target = target.parentNode) {\r\n\t\t\tif (target === $.targets.popover) {\r\n\t\t\t\ttoggle = true;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (toggle) {\r\n\t\t\te.detail.gesture.preventDefault(); //fixed hashchange\r\n\t\t\ttogglePopover($.targets._popover, $.targets.popover);\r\n\t\t}\r\n\r\n\t});\r\n\r\n\tvar togglePopover = function(popover, anchor, state) {\r\n\t\tif ((state === 'show' && popover.classList.contains(CLASS_ACTIVE)) || (state === 'hide' && !popover.classList.contains(CLASS_ACTIVE))) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tremoveBackdropTimer && removeBackdropTimer.cancel(); //取消remove的timer\r\n\t\t//remove一遍，以免来回快速切换，导致webkitTransitionEnd不触发，无法remove\r\n\t\tpopover.removeEventListener('webkitTransitionEnd', onPopoverShown);\r\n\t\tpopover.removeEventListener('webkitTransitionEnd', onPopoverHidden);\r\n\t\tbackdrop.classList.remove(CLASS_BAR_BACKDROP);\r\n\t\tbackdrop.classList.remove(CLASS_ACTION_BACKDROP);\r\n\t\tvar _popover = document.querySelector('.mui-popover.mui-active');\r\n\t\tif (_popover) {\r\n\t\t\t//\t\t\t_popover.setAttribute('style', '');\r\n\t\t\t_popover.addEventListener('webkitTransitionEnd', onPopoverHidden);\r\n\t\t\t_popover.classList.remove(CLASS_ACTIVE);\r\n\t\t\t//\t\t\t_popover.removeEventListener('webkitTransitionEnd', onPopoverHidden);\r\n\t\t\t//同一个弹出则直接返回，解决同一个popover的toggle\r\n\t\t\tif (popover === _popover) {\r\n\t\t\t\tremoveBackdrop(_popover);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar isActionSheet = false;\r\n\t\tif (popover.classList.contains(CLASS_BAR_POPOVER) || popover.classList.contains(CLASS_ACTION_POPOVER)) { //navBar\r\n\t\t\tif (popover.classList.contains(CLASS_ACTION_POPOVER)) { //action sheet popover\r\n\t\t\t\tisActionSheet = true;\r\n\t\t\t\tbackdrop.classList.add(CLASS_ACTION_BACKDROP);\r\n\t\t\t} else { //bar popover\r\n\t\t\t\tbackdrop.classList.add(CLASS_BAR_BACKDROP);\r\n\t\t\t\t//\t\t\t\tif (anchor) {\r\n\t\t\t\t//\t\t\t\t\tif (anchor.parentNode) {\r\n\t\t\t\t//\t\t\t\t\t\tvar offsetWidth = anchor.offsetWidth;\r\n\t\t\t\t//\t\t\t\t\t\tvar offsetLeft = anchor.offsetLeft;\r\n\t\t\t\t//\t\t\t\t\t\tvar innerWidth = window.innerWidth;\r\n\t\t\t\t//\t\t\t\t\t\tpopover.style.left = (Math.min(Math.max(offsetLeft, defaultPadding), innerWidth - offsetWidth - defaultPadding)) + \"px\";\r\n\t\t\t\t//\t\t\t\t\t} else {\r\n\t\t\t\t//\t\t\t\t\t\t//TODO anchor is position:{left,top,bottom,right}\r\n\t\t\t\t//\t\t\t\t\t}\r\n\t\t\t\t//\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tsetStyle(popover, 'block'); //actionsheet transform\r\n\t\tpopover.offsetHeight;\r\n\t\tpopover.classList.add(CLASS_ACTIVE);\r\n\t\tbackdrop.setAttribute('style', '');\r\n\t\tdocument.body.appendChild(backdrop);\r\n\t\tcalPosition(popover, anchor, isActionSheet); //position\r\n\t\tbackdrop.classList.add(CLASS_ACTIVE);\r\n\t\tpopover.addEventListener('webkitTransitionEnd', onPopoverShown);\r\n\t};\r\n\tvar setStyle = function(popover, display, top, left) {\r\n\t\tvar style = popover.style;\r\n\t\tif (typeof display !== 'undefined')\r\n\t\t\tstyle.display = display;\r\n\t\tif (typeof top !== 'undefined')\r\n\t\t\tstyle.top = top + 'px';\r\n\t\tif (typeof left !== 'undefined')\r\n\t\t\tstyle.left = left + 'px';\r\n\t};\r\n\tvar calPosition = function(popover, anchor, isActionSheet) {\r\n\t\tif (!popover || !anchor) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (isActionSheet) { //actionsheet\r\n\t\t\tsetStyle(popover, 'block')\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar wWidth = window.innerWidth;\r\n\t\tvar wHeight = window.innerHeight;\r\n\r\n\t\tvar pWidth = popover.offsetWidth;\r\n\t\tvar pHeight = popover.offsetHeight;\r\n\r\n\t\tvar aWidth = anchor.offsetWidth;\r\n\t\tvar aHeight = anchor.offsetHeight;\r\n\t\tvar offset = $.offset(anchor);\r\n\r\n\t\tvar arrow = popover.querySelector('.' + CLASS_POPOVER_ARROW);\r\n\t\tif (!arrow) {\r\n\t\t\tarrow = document.createElement('div');\r\n\t\t\tarrow.className = CLASS_POPOVER_ARROW;\r\n\t\t\tpopover.appendChild(arrow);\r\n\t\t}\r\n\t\tvar arrowSize = arrow && arrow.offsetWidth / 2 || 0;\r\n\r\n\r\n\r\n\t\tvar pTop = 0;\r\n\t\tvar pLeft = 0;\r\n\t\tvar diff = 0;\r\n\t\tvar arrowLeft = 0;\r\n\t\tvar defaultPadding = popover.classList.contains(CLASS_ACTION_POPOVER) ? 0 : 5;\r\n\r\n\t\tvar position = 'top';\r\n\t\tif ((pHeight + arrowSize) < (offset.top - window.pageYOffset)) { //top\r\n\t\t\tpTop = offset.top - pHeight - arrowSize;\r\n\t\t} else if ((pHeight + arrowSize) < (wHeight - (offset.top - window.pageYOffset) - aHeight)) { //bottom\r\n\t\t\tposition = 'bottom';\r\n\t\t\tpTop = offset.top + aHeight + arrowSize;\r\n\t\t} else { //middle\r\n\t\t\tposition = 'middle';\r\n\t\t\tpTop = Math.max((wHeight - pHeight) / 2 + window.pageYOffset, 0);\r\n\t\t\tpLeft = Math.max((wWidth - pWidth) / 2 + window.pageXOffset, 0);\r\n\t\t}\r\n\t\tif (position === 'top' || position === 'bottom') {\r\n\t\t\tpLeft = aWidth / 2 + offset.left - pWidth / 2;\r\n\t\t\tdiff = pLeft;\r\n\t\t\tif (pLeft < defaultPadding) pLeft = defaultPadding;\r\n\t\t\tif (pLeft + pWidth > wWidth) pLeft = wWidth - pWidth - defaultPadding;\r\n\r\n\t\t\tif (arrow) {\r\n\t\t\t\tif (position === 'top') {\r\n\t\t\t\t\tarrow.classList.add(CLASS_BOTTOM);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tarrow.classList.remove(CLASS_BOTTOM);\r\n\t\t\t\t}\r\n\t\t\t\tdiff = diff - pLeft;\r\n\t\t\t\tarrowLeft = (pWidth / 2 - arrowSize / 2 + diff);\r\n\t\t\t\tarrowLeft = Math.max(Math.min(arrowLeft, pWidth - arrowSize * 2 - 6), 6);\r\n\t\t\t\tarrow.setAttribute('style', 'left:' + arrowLeft + 'px');\r\n\t\t\t}\r\n\t\t} else if (position === 'middle') {\r\n\t\t\tarrow.setAttribute('style', 'display:none');\r\n\t\t}\r\n\t\tsetStyle(popover, 'block', pTop, pLeft);\r\n\t};\r\n\r\n\t$.createMask = function(callback) {\r\n\t\tvar element = document.createElement('div');\r\n\t\telement.classList.add(CLASS_BACKDROP);\r\n\t\telement.addEventListener($.EVENT_MOVE, $.preventDefault);\r\n\t\telement.addEventListener('tap', function() {\r\n\t\t\tmask.close();\r\n\t\t});\r\n\t\tvar mask = [element];\r\n\t\tmask._show = false;\r\n\t\tmask.show = function() {\r\n\t\t\tmask._show = true;\r\n\t\t\telement.setAttribute('style', 'opacity:1');\r\n\t\t\tdocument.body.appendChild(element);\r\n\t\t\treturn mask;\r\n\t\t};\r\n\t\tmask._remove = function() {\r\n\t\t\tif (mask._show) {\r\n\t\t\t\tmask._show = false;\r\n\t\t\t\telement.setAttribute('style', 'opacity:0');\r\n\t\t\t\t$.later(function() {\r\n\t\t\t\t\tvar body = document.body;\r\n\t\t\t\t\telement.parentNode === body && body.removeChild(element);\r\n\t\t\t\t}, 350);\r\n\t\t\t}\r\n\t\t\treturn mask;\r\n\t\t};\r\n\t\tmask.close = function() {\r\n\t\t\tif (callback) {\r\n\t\t\t\tif (callback() !== false) {\r\n\t\t\t\t\tmask._remove();\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tmask._remove();\r\n\t\t\t}\r\n\t\t};\r\n\t\treturn mask;\r\n\t};\r\n\t$.fn.popover = function() {\r\n\t\tvar args = arguments;\r\n\t\tthis.each(function() {\r\n\t\t\t$.targets._popover = this;\r\n\t\t\tif (args[0] === 'show' || args[0] === 'hide' || args[0] === 'toggle') {\r\n\t\t\t\ttogglePopover(this, args[1], args[0]);\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\r\n})(mui, window, document, 'popover');\r\n/**\r\n * segmented-controllers\r\n * @param {type} $\r\n * @param {type} window\r\n * @param {type} document\r\n * @param {type} undefined\r\n * @returns {undefined}\r\n */\r\n(function($, window, document, name, undefined) {\r\n\r\n\tvar CLASS_CONTROL_ITEM = 'mui-control-item';\r\n\tvar CLASS_SEGMENTED_CONTROL = 'mui-segmented-control';\r\n\tvar CLASS_SEGMENTED_CONTROL_VERTICAL = 'mui-segmented-control-vertical';\r\n\tvar CLASS_CONTROL_CONTENT = 'mui-control-content';\r\n\tvar CLASS_TAB_BAR = 'mui-bar-tab';\r\n\tvar CLASS_TAB_ITEM = 'mui-tab-item';\r\n\tvar CLASS_SLIDER_ITEM = 'mui-slider-item';\r\n\r\n\tvar handle = function(event, target) {\r\n\t\tif (target.classList && (target.classList.contains(CLASS_CONTROL_ITEM) || target.classList.contains(CLASS_TAB_ITEM))) {\r\n\t\t\tif (target.parentNode && target.parentNode.classList && target.parentNode.classList.contains(CLASS_SEGMENTED_CONTROL_VERTICAL)) {\r\n\t\t\t\t//vertical 如果preventDefault会导致无法滚动\r\n\t\t\t} else {\r\n\t\t\t\tevent.preventDefault(); //stop hash change\t\t\t\t\r\n\t\t\t}\r\n\t\t\t//\t\t\tif (target.hash) {\r\n\t\t\treturn target;\r\n\t\t\t//\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t};\r\n\r\n\t$.registerTarget({\r\n\t\tname: name,\r\n\t\tindex: 80,\r\n\t\thandle: handle,\r\n\t\ttarget: false\r\n\t});\r\n\r\n\twindow.addEventListener('tap', function(e) {\r\n\r\n\t\tvar targetTab = $.targets.tab;\r\n\t\tif (!targetTab) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar activeTab;\r\n\t\tvar activeBodies;\r\n\t\tvar targetBody;\r\n\t\tvar className = 'mui-active';\r\n\t\tvar classSelector = '.' + className;\r\n\t\tvar segmentedControl = targetTab.parentNode;\r\n\r\n\t\tfor (; segmentedControl && segmentedControl !== document; segmentedControl = segmentedControl.parentNode) {\r\n\t\t\tif (segmentedControl.classList.contains(CLASS_SEGMENTED_CONTROL)) {\r\n\t\t\t\tactiveTab = segmentedControl.querySelector(classSelector + '.' + CLASS_CONTROL_ITEM);\r\n\t\t\t\tbreak;\r\n\t\t\t} else if (segmentedControl.classList.contains(CLASS_TAB_BAR)) {\r\n\t\t\t\tactiveTab = segmentedControl.querySelector(classSelector + '.' + CLASS_TAB_ITEM);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (activeTab) {\r\n\t\t\tactiveTab.classList.remove(className);\r\n\t\t}\r\n\r\n\t\tvar isLastActive = targetTab === activeTab;\r\n\t\tif (targetTab) {\r\n\t\t\ttargetTab.classList.add(className);\r\n\t\t}\r\n\r\n\t\tif (!targetTab.hash) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\ttargetBody = document.getElementById(targetTab.hash.replace('#', ''));\r\n\r\n\t\tif (!targetBody) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (!targetBody.classList.contains(CLASS_CONTROL_CONTENT)) { //tab bar popover\r\n\t\t\ttargetTab.classList[isLastActive ? 'remove' : 'add'](className);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (isLastActive) { //same\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar parentNode = targetBody.parentNode;\r\n\t\tactiveBodies = parentNode.querySelectorAll('.' + CLASS_CONTROL_CONTENT + classSelector);\r\n\t\tfor (var i = 0; i < activeBodies.length; i++) {\r\n\t\t\tvar activeBody = activeBodies[i];\r\n\t\t\tactiveBody.parentNode === parentNode && activeBody.classList.remove(className);\r\n\t\t}\r\n\r\n\t\ttargetBody.classList.add(className);\r\n\r\n\t\tvar contents = [];\r\n\t\tvar _contents = parentNode.querySelectorAll('.' + CLASS_CONTROL_CONTENT);\r\n\t\tfor (var i = 0; i < _contents.length; i++) { //查找直属子节点\r\n\t\t\t_contents[i].parentNode === parentNode && (contents.push(_contents[i]));\r\n\t\t}\r\n\t\t$.trigger(targetBody, $.eventName('shown', name), {\r\n\t\t\ttabNumber: Array.prototype.indexOf.call(contents, targetBody)\r\n\t\t});\r\n\t\te.detail && e.detail.gesture.preventDefault(); //fixed hashchange\r\n\t});\r\n\r\n})(mui, window, document, 'tab');\r\n/**\r\n * Toggles switch\r\n * @param {type} $\r\n * @param {type} window\r\n * @param {type} name\r\n * @returns {undefined}\r\n */\r\n(function($, window, name) {\r\n\r\n\tvar CLASS_SWITCH = 'mui-switch';\r\n\tvar CLASS_SWITCH_HANDLE = 'mui-switch-handle';\r\n\tvar CLASS_ACTIVE = 'mui-active';\r\n\tvar CLASS_DRAGGING = 'mui-dragging';\r\n\r\n\tvar CLASS_DISABLED = 'mui-disabled';\r\n\r\n\tvar SELECTOR_SWITCH_HANDLE = '.' + CLASS_SWITCH_HANDLE;\r\n\r\n\tvar handle = function(event, target) {\r\n\t\tif (target.classList && target.classList.contains(CLASS_SWITCH)) {\r\n\t\t\treturn target;\r\n\t\t}\r\n\t\treturn false;\r\n\t};\r\n\r\n\t$.registerTarget({\r\n\t\tname: name,\r\n\t\tindex: 100,\r\n\t\thandle: handle,\r\n\t\ttarget: false\r\n\t});\r\n\r\n\r\n\tvar Toggle = function(element) {\r\n\t\tthis.element = element;\r\n\t\tthis.classList = this.element.classList;\r\n\t\tthis.handle = this.element.querySelector(SELECTOR_SWITCH_HANDLE);\r\n\t\tthis.init();\r\n\t\tthis.initEvent();\r\n\t};\r\n\tToggle.prototype.init = function() {\r\n\t\tthis.toggleWidth = this.element.offsetWidth;\r\n\t\tthis.handleWidth = this.handle.offsetWidth;\r\n\t\tthis.handleX = this.toggleWidth - this.handleWidth - 3;\r\n\t};\r\n\tToggle.prototype.initEvent = function() {\r\n\t\tthis.element.addEventListener($.EVENT_START, this);\r\n\t\tthis.element.addEventListener('drag', this);\r\n\t\tthis.element.addEventListener('swiperight', this);\r\n\t\tthis.element.addEventListener($.EVENT_END, this);\r\n\t\tthis.element.addEventListener($.EVENT_CANCEL, this);\r\n\r\n\t};\r\n\tToggle.prototype.handleEvent = function(e) {\r\n\t\tif (this.classList.contains(CLASS_DISABLED)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tswitch (e.type) {\r\n\t\t\tcase $.EVENT_START:\r\n\t\t\t\tthis.start(e);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'drag':\r\n\t\t\t\tthis.drag(e);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'swiperight':\r\n\t\t\t\tthis.swiperight();\r\n\t\t\t\tbreak;\r\n\t\t\tcase $.EVENT_END:\r\n\t\t\tcase $.EVENT_CANCEL:\r\n\t\t\t\tthis.end(e);\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t};\r\n\tToggle.prototype.start = function(e) {\r\n\t\tthis.handle.style.webkitTransitionDuration = this.element.style.webkitTransitionDuration = '.2s';\r\n\t\tthis.classList.add(CLASS_DRAGGING);\r\n\t\tif (this.toggleWidth === 0 || this.handleWidth === 0) { //当switch处于隐藏状态时，width为0，需要重新初始化\r\n\t\t\tthis.init();\r\n\t\t}\r\n\t};\r\n\tToggle.prototype.drag = function(e) {\r\n\t\tvar detail = e.detail;\r\n\t\tif (!this.isDragging) {\r\n\t\t\tif (detail.direction === 'left' || detail.direction === 'right') {\r\n\t\t\t\tthis.isDragging = true;\r\n\t\t\t\tthis.lastChanged = undefined;\r\n\t\t\t\tthis.initialState = this.classList.contains(CLASS_ACTIVE);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (this.isDragging) {\r\n\t\t\tthis.setTranslateX(detail.deltaX);\r\n\t\t\te.stopPropagation();\r\n\t\t\tdetail.gesture.preventDefault();\r\n\t\t}\r\n\t};\r\n\tToggle.prototype.swiperight = function(e) {\r\n\t\tif (this.isDragging) {\r\n\t\t\te.stopPropagation();\r\n\t\t}\r\n\t};\r\n\tToggle.prototype.end = function(e) {\r\n\t\tthis.classList.remove(CLASS_DRAGGING);\r\n\t\tif (this.isDragging) {\r\n\t\t\tthis.isDragging = false;\r\n\t\t\te.stopPropagation();\r\n\t\t\t$.trigger(this.element, 'toggle', {\r\n\t\t\t\tisActive: this.classList.contains(CLASS_ACTIVE)\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tthis.toggle();\r\n\t\t}\r\n\t};\r\n\tToggle.prototype.toggle = function(animate) {\r\n\t\tvar classList = this.classList;\r\n\t\tif (animate === false) {\r\n\t\t\tthis.handle.style.webkitTransitionDuration = this.element.style.webkitTransitionDuration = '0s';\r\n\t\t} else {\r\n\t\t\tthis.handle.style.webkitTransitionDuration = this.element.style.webkitTransitionDuration = '.2s';\r\n\t\t}\r\n\t\tif (classList.contains(CLASS_ACTIVE)) {\r\n\t\t\tclassList.remove(CLASS_ACTIVE);\r\n\t\t\tthis.handle.style.webkitTransform = 'translate(0,0)';\r\n\t\t} else {\r\n\t\t\tclassList.add(CLASS_ACTIVE);\r\n\t\t\tthis.handle.style.webkitTransform = 'translate(' + this.handleX + 'px,0)';\r\n\t\t}\r\n\t\t$.trigger(this.element, 'toggle', {\r\n\t\t\tisActive: this.classList.contains(CLASS_ACTIVE)\r\n\t\t});\r\n\t};\r\n\tToggle.prototype.setTranslateX = $.animationFrame(function(x) {\r\n\t\tif (!this.isDragging) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar isChanged = false;\r\n\t\tif ((this.initialState && -x > (this.handleX / 2)) || (!this.initialState && x > (this.handleX / 2))) {\r\n\t\t\tisChanged = true;\r\n\t\t}\r\n\t\tif (this.lastChanged !== isChanged) {\r\n\t\t\tif (isChanged) {\r\n\t\t\t\tthis.handle.style.webkitTransform = 'translate(' + (this.initialState ? 0 : this.handleX) + 'px,0)';\r\n\t\t\t\tthis.classList[this.initialState ? 'remove' : 'add'](CLASS_ACTIVE);\r\n\t\t\t} else {\r\n\t\t\t\tthis.handle.style.webkitTransform = 'translate(' + (this.initialState ? this.handleX : 0) + 'px,0)';\r\n\t\t\t\tthis.classList[this.initialState ? 'add' : 'remove'](CLASS_ACTIVE);\r\n\t\t\t}\r\n\t\t\tthis.lastChanged = isChanged;\r\n\t\t}\r\n\r\n\t});\r\n\r\n\t$.fn['switch'] = function(options) {\r\n\t\tvar switchApis = [];\r\n\t\tthis.each(function() {\r\n\t\t\tvar switchApi = null;\r\n\t\t\tvar id = this.getAttribute('data-switch');\r\n\t\t\tif (!id) {\r\n\t\t\t\tid = ++$.uuid;\r\n\t\t\t\t$.data[id] = new Toggle(this);\r\n\t\t\t\tthis.setAttribute('data-switch', id);\r\n\t\t\t} else {\r\n\t\t\t\tswitchApi = $.data[id];\r\n\t\t\t}\r\n\t\t\tswitchApis.push(switchApi);\r\n\t\t});\r\n\t\treturn switchApis.length > 1 ? switchApis : switchApis[0];\r\n\t};\r\n\t$.ready(function() {\r\n\t\t$('.' + CLASS_SWITCH)['switch']();\r\n\t});\r\n})(mui, window, 'toggle');\r\n/**\r\n * Tableviews\r\n * @param {type} $\r\n * @param {type} window\r\n * @param {type} document\r\n * @returns {undefined}\r\n */\r\n(function($, window, document) {\r\n\r\n\tvar CLASS_ACTIVE = 'mui-active';\r\n\tvar CLASS_SELECTED = 'mui-selected';\r\n\tvar CLASS_GRID_VIEW = 'mui-grid-view';\r\n\tvar CLASS_RADIO_VIEW = 'mui-table-view-radio';\r\n\tvar CLASS_TABLE_VIEW_CELL = 'mui-table-view-cell';\r\n\tvar CLASS_COLLAPSE_CONTENT = 'mui-collapse-content';\r\n\tvar CLASS_DISABLED = 'mui-disabled';\r\n\tvar CLASS_TOGGLE = 'mui-switch';\r\n\tvar CLASS_BTN = 'mui-btn';\r\n\r\n\tvar CLASS_SLIDER_HANDLE = 'mui-slider-handle';\r\n\tvar CLASS_SLIDER_LEFT = 'mui-slider-left';\r\n\tvar CLASS_SLIDER_RIGHT = 'mui-slider-right';\r\n\tvar CLASS_TRANSITIONING = 'mui-transitioning';\r\n\r\n\r\n\tvar SELECTOR_SLIDER_HANDLE = '.' + CLASS_SLIDER_HANDLE;\r\n\tvar SELECTOR_SLIDER_LEFT = '.' + CLASS_SLIDER_LEFT;\r\n\tvar SELECTOR_SLIDER_RIGHT = '.' + CLASS_SLIDER_RIGHT;\r\n\tvar SELECTOR_SELECTED = '.' + CLASS_SELECTED;\r\n\tvar SELECTOR_BUTTON = '.' + CLASS_BTN;\r\n\tvar overFactor = 0.8;\r\n\tvar cell, a;\r\n\r\n\tvar isMoved = isOpened = openedActions = progress = false;\r\n\tvar sliderHandle = sliderActionLeft = sliderActionRight = buttonsLeft = buttonsRight = sliderDirection = sliderRequestAnimationFrame = false;\r\n\tvar timer = translateX = lastTranslateX = sliderActionLeftWidth = sliderActionRightWidth = 0;\r\n\r\n\r\n\r\n\tvar toggleActive = function(isActive) {\r\n\t\tif (isActive) {\r\n\t\t\tif (a) {\r\n\t\t\t\ta.classList.add(CLASS_ACTIVE);\r\n\t\t\t} else if (cell) {\r\n\t\t\t\tcell.classList.add(CLASS_ACTIVE);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\ttimer && timer.cancel();\r\n\t\t\tif (a) {\r\n\t\t\t\ta.classList.remove(CLASS_ACTIVE);\r\n\t\t\t} else if (cell) {\r\n\t\t\t\tcell.classList.remove(CLASS_ACTIVE);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tvar updateTranslate = function() {\r\n\t\tif (translateX !== lastTranslateX) {\r\n\t\t\tif (buttonsRight && buttonsRight.length > 0) {\r\n\t\t\t\tprogress = translateX / sliderActionRightWidth;\r\n\t\t\t\tif (translateX < -sliderActionRightWidth) {\r\n\t\t\t\t\ttranslateX = -sliderActionRightWidth - Math.pow(-translateX - sliderActionRightWidth, overFactor);\r\n\t\t\t\t}\r\n\t\t\t\tfor (var i = 0, len = buttonsRight.length; i < len; i++) {\r\n\t\t\t\t\tvar buttonRight = buttonsRight[i];\r\n\t\t\t\t\tif (typeof buttonRight._buttonOffset === 'undefined') {\r\n\t\t\t\t\t\tbuttonRight._buttonOffset = buttonRight.offsetLeft;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbuttonOffset = buttonRight._buttonOffset;\r\n\t\t\t\t\tsetTranslate(buttonRight, (translateX - buttonOffset * (1 + Math.max(progress, -1))));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (buttonsLeft && buttonsLeft.length > 0) {\r\n\t\t\t\tprogress = translateX / sliderActionLeftWidth;\r\n\t\t\t\tif (translateX > sliderActionLeftWidth) {\r\n\t\t\t\t\ttranslateX = sliderActionLeftWidth + Math.pow(translateX - sliderActionLeftWidth, overFactor);\r\n\t\t\t\t}\r\n\t\t\t\tfor (var i = 0, len = buttonsLeft.length; i < len; i++) {\r\n\t\t\t\t\tvar buttonLeft = buttonsLeft[i];\r\n\t\t\t\t\tif (typeof buttonLeft._buttonOffset === 'undefined') {\r\n\t\t\t\t\t\tbuttonLeft._buttonOffset = sliderActionLeftWidth - buttonLeft.offsetLeft - buttonLeft.offsetWidth;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbuttonOffset = buttonLeft._buttonOffset;\r\n\t\t\t\t\tif (buttonsLeft.length > 1) {\r\n\t\t\t\t\t\tbuttonLeft.style.zIndex = buttonsLeft.length - i;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsetTranslate(buttonLeft, (translateX + buttonOffset * (1 - Math.min(progress, 1))));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tsetTranslate(sliderHandle, translateX);\r\n\t\t\tlastTranslateX = translateX;\r\n\t\t}\r\n\t\tsliderRequestAnimationFrame = requestAnimationFrame(function() {\r\n\t\t\tupdateTranslate();\r\n\t\t});\r\n\t};\r\n\tvar setTranslate = function(element, x) {\r\n\t\tif (element) {\r\n\t\t\telement.style.webkitTransform = 'translate(' + x + 'px,0)';\r\n\t\t}\r\n\t};\r\n\r\n\twindow.addEventListener($.EVENT_START, function(event) {\r\n\t\tif (cell) {\r\n\t\t\ttoggleActive(false);\r\n\t\t}\r\n\t\tcell = a = false;\r\n\t\tisMoved = isOpened = openedActions = false;\r\n\t\tvar target = event.target;\r\n\t\tvar isDisabled = false;\r\n\t\tfor (; target && target !== document; target = target.parentNode) {\r\n\t\t\tif (target.classList) {\r\n\t\t\t\tvar classList = target.classList;\r\n\t\t\t\tif ((target.tagName === 'INPUT' && target.type !== 'radio' && target.type !== 'checkbox') || target.tagName === 'BUTTON' || classList.contains(CLASS_TOGGLE) || classList.contains(CLASS_BTN) || classList.contains(CLASS_DISABLED)) {\r\n\t\t\t\t\tisDisabled = true;\r\n\t\t\t\t}\r\n\t\t\t\tif (classList.contains(CLASS_COLLAPSE_CONTENT)) { //collapse content\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tif (classList.contains(CLASS_TABLE_VIEW_CELL)) {\r\n\t\t\t\t\tcell = target;\r\n\t\t\t\t\t//TODO swipe to delete close\r\n\t\t\t\t\tvar selected = cell.parentNode.querySelector(SELECTOR_SELECTED);\r\n\t\t\t\t\tif (!cell.parentNode.classList.contains(CLASS_RADIO_VIEW) && selected && selected !== cell) {\r\n\t\t\t\t\t\t$.swipeoutClose(selected);\r\n\t\t\t\t\t\tcell = isDisabled = false;\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!cell.parentNode.classList.contains(CLASS_GRID_VIEW)) {\r\n\t\t\t\t\t\tvar link = cell.querySelector('a');\r\n\t\t\t\t\t\tif (link && link.parentNode === cell) { //li>a\r\n\t\t\t\t\t\t\ta = link;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar handle = cell.querySelector(SELECTOR_SLIDER_HANDLE);\r\n\t\t\t\t\tif (handle) {\r\n\t\t\t\t\t\ttoggleEvents(cell);\r\n\t\t\t\t\t\tevent.stopPropagation();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!isDisabled) {\r\n\t\t\t\t\t\tif (handle) {\r\n\t\t\t\t\t\t\tif (timer) {\r\n\t\t\t\t\t\t\t\ttimer.cancel();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\ttimer = $.later(function() {\r\n\t\t\t\t\t\t\t\ttoggleActive(true);\r\n\t\t\t\t\t\t\t}, 100);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\ttoggleActive(true);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n\twindow.addEventListener($.EVENT_MOVE, function(event) {\r\n\t\ttoggleActive(false);\r\n\t});\r\n\r\n\tvar handleEvent = {\r\n\t\thandleEvent: function(event) {\r\n\t\t\tswitch (event.type) {\r\n\t\t\t\tcase 'drag':\r\n\t\t\t\t\tthis.drag(event);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'dragend':\r\n\t\t\t\t\tthis.dragend(event);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'flick':\r\n\t\t\t\t\tthis.flick(event);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'swiperight':\r\n\t\t\t\t\tthis.swiperight(event);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'swipeleft':\r\n\t\t\t\t\tthis.swipeleft(event);\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t},\r\n\t\tdrag: function(event) {\r\n\t\t\tif (!cell) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (!isMoved) { //init\r\n\t\t\t\tsliderHandle = sliderActionLeft = sliderActionRight = buttonsLeft = buttonsRight = sliderDirection = sliderRequestAnimationFrame = false;\r\n\t\t\t\tsliderHandle = cell.querySelector(SELECTOR_SLIDER_HANDLE);\r\n\t\t\t\tif (sliderHandle) {\r\n\t\t\t\t\tsliderActionLeft = cell.querySelector(SELECTOR_SLIDER_LEFT);\r\n\t\t\t\t\tsliderActionRight = cell.querySelector(SELECTOR_SLIDER_RIGHT);\r\n\t\t\t\t\tif (sliderActionLeft) {\r\n\t\t\t\t\t\tsliderActionLeftWidth = sliderActionLeft.offsetWidth;\r\n\t\t\t\t\t\tbuttonsLeft = sliderActionLeft.querySelectorAll(SELECTOR_BUTTON);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (sliderActionRight) {\r\n\t\t\t\t\t\tsliderActionRightWidth = sliderActionRight.offsetWidth;\r\n\t\t\t\t\t\tbuttonsRight = sliderActionRight.querySelectorAll(SELECTOR_BUTTON);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcell.classList.remove(CLASS_TRANSITIONING);\r\n\t\t\t\t\tisOpened = cell.classList.contains(CLASS_SELECTED);\r\n\t\t\t\t\tif (isOpened) {\r\n\t\t\t\t\t\topenedActions = cell.querySelector(SELECTOR_SLIDER_LEFT + SELECTOR_SELECTED) ? 'left' : 'right';\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar detail = event.detail;\r\n\t\t\tvar direction = detail.direction;\r\n\t\t\tvar angle = detail.angle;\r\n\t\t\tif (direction === 'left' && (angle > 150 || angle < -150)) {\r\n\t\t\t\tif (buttonsRight || (buttonsLeft && isOpened)) { //存在右侧按钮或存在左侧按钮且是已打开状态\r\n\t\t\t\t\tisMoved = true;\r\n\t\t\t\t}\r\n\t\t\t} else if (direction === 'right' && (angle > -30 && angle < 30)) {\r\n\t\t\t\tif (buttonsLeft || (buttonsRight && isOpened)) { //存在左侧按钮或存在右侧按钮且是已打开状态\r\n\t\t\t\t\tisMoved = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (isMoved) {\r\n\t\t\t\tevent.stopPropagation();\r\n\t\t\t\tevent.detail.gesture.preventDefault();\r\n\t\t\t\tvar translate = event.detail.deltaX;\r\n\t\t\t\tif (isOpened) {\r\n\t\t\t\t\tif (openedActions === 'right') {\r\n\t\t\t\t\t\ttranslate = translate - sliderActionRightWidth;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\ttranslate = translate + sliderActionLeftWidth;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif ((translate > 0 && !buttonsLeft) || (translate < 0 && !buttonsRight)) {\r\n\t\t\t\t\tif (!isOpened) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttranslate = 0;\r\n\t\t\t\t}\r\n\t\t\t\tif (translate < 0) {\r\n\t\t\t\t\tsliderDirection = 'toLeft';\r\n\t\t\t\t} else if (translate > 0) {\r\n\t\t\t\t\tsliderDirection = 'toRight';\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (!sliderDirection) {\r\n\t\t\t\t\t\tsliderDirection = 'toLeft';\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (!sliderRequestAnimationFrame) {\r\n\t\t\t\t\tupdateTranslate();\r\n\t\t\t\t}\r\n\t\t\t\ttranslateX = translate;\r\n\t\t\t}\r\n\t\t},\r\n\t\tflick: function(event) {\r\n\t\t\tif (isMoved) {\r\n\t\t\t\tevent.stopPropagation();\r\n\t\t\t}\r\n\t\t},\r\n\t\tswipeleft: function(event) {\r\n\t\t\tif (isMoved) {\r\n\t\t\t\tevent.stopPropagation();\r\n\t\t\t}\r\n\t\t},\r\n\t\tswiperight: function(event) {\r\n\t\t\tif (isMoved) {\r\n\t\t\t\tevent.stopPropagation();\r\n\t\t\t}\r\n\t\t},\r\n\t\tdragend: function(event) {\r\n\t\t\tif (!isMoved) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tevent.stopPropagation();\r\n\t\t\tif (sliderRequestAnimationFrame) {\r\n\t\t\t\tcancelAnimationFrame(sliderRequestAnimationFrame);\r\n\t\t\t\tsliderRequestAnimationFrame = null;\r\n\t\t\t}\r\n\t\t\tvar detail = event.detail;\r\n\t\t\tisMoved = false;\r\n\t\t\tvar action = 'close';\r\n\t\t\tvar actionsWidth = sliderDirection === 'toLeft' ? sliderActionRightWidth : sliderActionLeftWidth;\r\n\t\t\tvar isToggle = detail.swipe || (Math.abs(translateX) > actionsWidth / 2);\r\n\t\t\tif (isToggle) {\r\n\t\t\t\tif (!isOpened) {\r\n\t\t\t\t\taction = 'open';\r\n\t\t\t\t} else if (detail.direction === 'left' && openedActions === 'right') {\r\n\t\t\t\t\taction = 'open';\r\n\t\t\t\t} else if (detail.direction === 'right' && openedActions === 'left') {\r\n\t\t\t\t\taction = 'open';\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t\tcell.classList.add(CLASS_TRANSITIONING);\r\n\t\t\tvar buttons;\r\n\t\t\tif (action === 'open') {\r\n\t\t\t\tvar newTranslate = sliderDirection === 'toLeft' ? -actionsWidth : actionsWidth;\r\n\t\t\t\tsetTranslate(sliderHandle, newTranslate);\r\n\t\t\t\tbuttons = sliderDirection === 'toLeft' ? buttonsRight : buttonsLeft;\r\n\t\t\t\tif (typeof buttons !== 'undefined') {\r\n\t\t\t\t\tvar button = null;\r\n\t\t\t\t\tfor (var i = 0; i < buttons.length; i++) {\r\n\t\t\t\t\t\tbutton = buttons[i];\r\n\t\t\t\t\t\tsetTranslate(button, newTranslate);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbutton.parentNode.classList.add(CLASS_SELECTED);\r\n\t\t\t\t\tcell.classList.add(CLASS_SELECTED);\r\n\t\t\t\t\tif (!isOpened) {\r\n\t\t\t\t\t\t$.trigger(cell, sliderDirection === 'toLeft' ? 'slideleft' : 'slideright');\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tsetTranslate(sliderHandle, 0);\r\n\t\t\t\tsliderActionLeft && sliderActionLeft.classList.remove(CLASS_SELECTED);\r\n\t\t\t\tsliderActionRight && sliderActionRight.classList.remove(CLASS_SELECTED);\r\n\t\t\t\tcell.classList.remove(CLASS_SELECTED);\r\n\t\t\t}\r\n\t\t\tvar buttonOffset;\r\n\t\t\tif (buttonsLeft && buttonsLeft.length > 0 && buttonsLeft !== buttons) {\r\n\t\t\t\tfor (var i = 0, len = buttonsLeft.length; i < len; i++) {\r\n\t\t\t\t\tvar buttonLeft = buttonsLeft[i];\r\n\t\t\t\t\tbuttonOffset = buttonLeft._buttonOffset;\r\n\t\t\t\t\tif (typeof buttonOffset === 'undefined') {\r\n\t\t\t\t\t\tbuttonLeft._buttonOffset = sliderActionLeftWidth - buttonLeft.offsetLeft - buttonLeft.offsetWidth;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsetTranslate(buttonLeft, buttonOffset);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (buttonsRight && buttonsRight.length > 0 && buttonsRight !== buttons) {\r\n\t\t\t\tfor (var i = 0, len = buttonsRight.length; i < len; i++) {\r\n\t\t\t\t\tvar buttonRight = buttonsRight[i];\r\n\t\t\t\t\tbuttonOffset = buttonRight._buttonOffset;\r\n\t\t\t\t\tif (typeof buttonOffset === 'undefined') {\r\n\t\t\t\t\t\tbuttonRight._buttonOffset = buttonRight.offsetLeft;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsetTranslate(buttonRight, -buttonOffset);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tfunction toggleEvents(element, isRemove) {\r\n\t\tvar method = !!isRemove ? 'removeEventListener' : 'addEventListener';\r\n\t\telement[method]('drag', handleEvent);\r\n\t\telement[method]('dragend', handleEvent);\r\n\t\telement[method]('swiperight', handleEvent);\r\n\t\telement[method]('swipeleft', handleEvent);\r\n\t\telement[method]('flick', handleEvent);\r\n\t};\r\n\t/**\r\n\t * 打开滑动菜单\r\n\t * @param {Object} el\r\n\t * @param {Object} direction\r\n\t */\r\n\t$.swipeoutOpen = function(el, direction) {\r\n\t\tif (!el) return;\r\n\t\tvar classList = el.classList;\r\n\t\tif (classList.contains(CLASS_SELECTED)) return;\r\n\t\tif (!direction) {\r\n\t\t\tif (el.querySelector(SELECTOR_SLIDER_RIGHT)) {\r\n\t\t\t\tdirection = 'right';\r\n\t\t\t} else {\r\n\t\t\t\tdirection = 'left';\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar swipeoutAction = el.querySelector($.classSelector(\".slider-\" + direction));\r\n\t\tif (!swipeoutAction) return;\r\n\t\tswipeoutAction.classList.add(CLASS_SELECTED);\r\n\t\tclassList.add(CLASS_SELECTED);\r\n\t\tclassList.remove(CLASS_TRANSITIONING);\r\n\t\tvar buttons = swipeoutAction.querySelectorAll(SELECTOR_BUTTON);\r\n\t\tvar swipeoutWidth = swipeoutAction.offsetWidth;\r\n\t\tvar translate = (direction === 'right') ? -swipeoutWidth : swipeoutWidth;\r\n\t\tvar length = buttons.length;\r\n\t\tvar button;\r\n\t\tfor (var i = 0; i < length; i++) {\r\n\t\t\tbutton = buttons[i];\r\n\t\t\tif (direction === 'right') {\r\n\t\t\t\tsetTranslate(button, -button.offsetLeft);\r\n\t\t\t} else {\r\n\t\t\t\tsetTranslate(button, (swipeoutWidth - button.offsetWidth - button.offsetLeft));\r\n\t\t\t}\r\n\t\t}\r\n\t\tclassList.add(CLASS_TRANSITIONING);\r\n\t\tfor (var i = 0; i < length; i++) {\r\n\t\t\tsetTranslate(buttons[i], translate);\r\n\t\t}\r\n\t\tsetTranslate(el.querySelector(SELECTOR_SLIDER_HANDLE), translate);\r\n\t};\r\n\t/**\r\n\t * 关闭滑动菜单\r\n\t * @param {Object} el\r\n\t */\r\n\t$.swipeoutClose = function(el) {\r\n\t\tif (!el) return;\r\n\t\tvar classList = el.classList;\r\n\t\tif (!classList.contains(CLASS_SELECTED)) return;\r\n\t\tvar direction = el.querySelector(SELECTOR_SLIDER_RIGHT + SELECTOR_SELECTED) ? 'right' : 'left';\r\n\t\tvar swipeoutAction = el.querySelector($.classSelector(\".slider-\" + direction));\r\n\t\tif (!swipeoutAction) return;\r\n\t\tswipeoutAction.classList.remove(CLASS_SELECTED);\r\n\t\tclassList.remove(CLASS_SELECTED);\r\n\t\tclassList.add(CLASS_TRANSITIONING);\r\n\t\tvar buttons = swipeoutAction.querySelectorAll(SELECTOR_BUTTON);\r\n\t\tvar swipeoutWidth = swipeoutAction.offsetWidth;\r\n\t\tvar length = buttons.length;\r\n\t\tvar button;\r\n\t\tsetTranslate(el.querySelector(SELECTOR_SLIDER_HANDLE), 0);\r\n\t\tfor (var i = 0; i < length; i++) {\r\n\t\t\tbutton = buttons[i];\r\n\t\t\tif (direction === 'right') {\r\n\t\t\t\tsetTranslate(button, (-button.offsetLeft));\r\n\t\t\t} else {\r\n\t\t\t\tsetTranslate(button, (swipeoutWidth - button.offsetWidth - button.offsetLeft));\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\twindow.addEventListener($.EVENT_END, function(event) { //使用touchend来取消高亮，避免一次点击既不触发tap，doubletap，longtap的事件\r\n\t\tif (!cell) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\ttoggleActive(false);\r\n\t\tsliderHandle && toggleEvents(cell, true);\r\n\t});\r\n\twindow.addEventListener($.EVENT_CANCEL, function(event) { //使用touchcancel来取消高亮，避免一次点击既不触发tap，doubletap，longtap的事件\r\n\t\tif (!cell) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\ttoggleActive(false);\r\n\t\tsliderHandle && toggleEvents(cell, true);\r\n\t});\r\n\tvar radioOrCheckboxClick = function(event) {\r\n\t\tvar type = event.target && event.target.type || '';\r\n\t\tif (type === 'radio' || type === 'checkbox') {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar classList = cell.classList;\r\n\t\tif (classList.contains('mui-radio')) {\r\n\t\t\tvar input = cell.querySelector('input[type=radio]');\r\n\t\t\tif (input) {\r\n\t\t\t\t//\t\t\t\tinput.click();\r\n\t\t\t\tif (!input.disabled && !input.readOnly) {\r\n\t\t\t\t\tinput.checked = !input.checked;\r\n\t\t\t\t\t$.trigger(input, 'change');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else if (classList.contains('mui-checkbox')) {\r\n\t\t\tvar input = cell.querySelector('input[type=checkbox]');\r\n\t\t\tif (input) {\r\n\t\t\t\t//\t\t\t\tinput.click();\r\n\t\t\t\tif (!input.disabled && !input.readOnly) {\r\n\t\t\t\t\tinput.checked = !input.checked;\r\n\t\t\t\t\t$.trigger(input, 'change');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\t//fixed hashchange(android)\r\n\twindow.addEventListener($.EVENT_CLICK, function(e) {\r\n\t\tif (cell && cell.classList.contains('mui-collapse')) {\r\n\t\t\te.preventDefault();\r\n\t\t}\r\n\t});\r\n\twindow.addEventListener('doubletap', function(event) {\r\n\t\tif (cell) {\r\n\t\t\tradioOrCheckboxClick(event);\r\n\t\t}\r\n\t});\r\n\tvar preventDefaultException = /^(INPUT|TEXTAREA|BUTTON|SELECT)$/;\r\n\twindow.addEventListener('tap', function(event) {\r\n\t\tif (!cell) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar isExpand = false;\r\n\t\tvar classList = cell.classList;\r\n\t\tvar ul = cell.parentNode;\r\n\t\tif (ul && ul.classList.contains(CLASS_RADIO_VIEW)) {\r\n\t\t\tif (classList.contains(CLASS_SELECTED)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar selected = ul.querySelector('li' + SELECTOR_SELECTED);\r\n\t\t\tif (selected) {\r\n\t\t\t\tselected.classList.remove(CLASS_SELECTED);\r\n\t\t\t}\r\n\t\t\tclassList.add(CLASS_SELECTED);\r\n\t\t\t$.trigger(cell, 'selected', {\r\n\t\t\t\tel: cell\r\n\t\t\t});\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (classList.contains('mui-collapse') && !cell.parentNode.classList.contains('mui-unfold')) {\r\n\t\t\tif (!preventDefaultException.test(event.target.tagName)) {\r\n\t\t\t\tevent.detail.gesture.preventDefault();\r\n\t\t\t}\r\n\r\n\t\t\tif (!classList.contains(CLASS_ACTIVE)) { //展开时,需要收缩其他同类\r\n\t\t\t\tvar collapse = cell.parentNode.querySelector('.mui-collapse.mui-active');\r\n\t\t\t\tif (collapse) {\r\n\t\t\t\t\tcollapse.classList.remove(CLASS_ACTIVE);\r\n\t\t\t\t}\r\n\t\t\t\tisExpand = true;\r\n\t\t\t}\r\n\t\t\tclassList.toggle(CLASS_ACTIVE);\r\n\t\t\tif (isExpand) {\r\n\t\t\t\t//触发展开事件\r\n\t\t\t\t$.trigger(cell, 'expand');\r\n\r\n\t\t\t\t//scroll\r\n\t\t\t\t//暂不滚动\r\n\t\t\t\t// var offsetTop = $.offset(cell).top;\r\n\t\t\t\t// var scrollTop = document.body.scrollTop;\r\n\t\t\t\t// var height = window.innerHeight;\r\n\t\t\t\t// var offsetHeight = cell.offsetHeight;\r\n\t\t\t\t// var cellHeight = (offsetTop - scrollTop + offsetHeight);\r\n\t\t\t\t// if (offsetHeight > height) {\r\n\t\t\t\t// \t$.scrollTo(offsetTop, 300);\r\n\t\t\t\t// } else if (cellHeight > height) {\r\n\t\t\t\t// \t$.scrollTo(cellHeight - height + scrollTop, 300);\r\n\t\t\t\t// }\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tradioOrCheckboxClick(event);\r\n\t\t}\r\n\t});\r\n})(mui, window, document);\r\n(function($, window) {\r\n\t/**\r\n\t * 警告消息框\r\n\t */\r\n\t$.alert = function(message, title, btnValue, callback) {\r\n\t\tif ($.os.plus) {\r\n\t\t\tif (typeof message === 'undefined') {\r\n\t\t\t\treturn;\r\n\t\t\t} else {\r\n\t\t\t\tif (typeof title === 'function') {\r\n\t\t\t\t\tcallback = title;\r\n\t\t\t\t\ttitle = null;\r\n\t\t\t\t\tbtnValue = '确定';\r\n\t\t\t\t} else if (typeof btnValue === 'function') {\r\n\t\t\t\t\tcallback = btnValue;\r\n\t\t\t\t\tbtnValue = null;\r\n\t\t\t\t}\r\n\t\t\t\t$.plusReady(function() {\r\n\t\t\t\t\tplus.nativeUI.alert(message, callback, title, btnValue);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\t\t\t//TODO H5版本\r\n\t\t\twindow.alert(message);\r\n\t\t}\r\n\t};\r\n\r\n})(mui, window);\r\n(function($, window) {\r\n\t/**\r\n\t * 确认消息框\r\n\t */\r\n\t$.confirm = function(message, title, btnArray, callback) {\r\n\t\tif ($.os.plus) {\r\n\t\t\tif (typeof message === 'undefined') {\r\n\t\t\t\treturn;\r\n\t\t\t} else {\r\n\t\t\t\tif (typeof title === 'function') {\r\n\t\t\t\t\tcallback = title;\r\n\t\t\t\t\ttitle = null;\r\n\t\t\t\t\tbtnArray = null;\r\n\t\t\t\t} else if (typeof btnArray === 'function') {\r\n\t\t\t\t\tcallback = btnArray;\r\n\t\t\t\t\tbtnArray = null;\r\n\t\t\t\t}\r\n\t\t\t\t$.plusReady(function() {\r\n\t\t\t\t\tplus.nativeUI.confirm(message, callback, title, btnArray);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\t\t\t//H5版本，0为确认，1为取消\r\n\t\t\tif (window.confirm(message)) {\r\n\t\t\t\tcallback({\r\n\t\t\t\t\tindex: 0\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tcallback({\r\n\t\t\t\t\tindex: 1\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n})(mui, window);\r\n(function($, window) {\r\n\t/**\r\n\t * 输入对话框\r\n\t */\r\n\t$.prompt = function(text, defaultText, title, btnArray, callback) {\r\n\t\tif ($.os.plus) {\r\n\t\t\tif (typeof message === 'undefined') {\r\n\t\t\t\treturn;\r\n\t\t\t} else {\r\n\r\n\t\t\t\tif (typeof defaultText === 'function') {\r\n\t\t\t\t\tcallback = defaultText;\r\n\t\t\t\t\tdefaultText = null;\r\n\t\t\t\t\ttitle = null;\r\n\t\t\t\t\tbtnArray = null;\r\n\t\t\t\t} else if (typeof title === 'function') {\r\n\t\t\t\t\tcallback = title;\r\n\t\t\t\t\ttitle = null;\r\n\t\t\t\t\tbtnArray = null;\r\n\t\t\t\t} else if (typeof btnArray === 'function') {\r\n\t\t\t\t\tcallback = btnArray;\r\n\t\t\t\t\tbtnArray = null;\r\n\t\t\t\t}\r\n\t\t\t\t$.plusReady(function() {\r\n\t\t\t\t\tplus.nativeUI.prompt(text, callback, title, defaultText, btnArray);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\t\t\t//H5版本(确认index为0，取消index为1)\r\n\t\t\tvar result = window.prompt(text);\r\n\t\t\tif (result) {\r\n\t\t\t\tcallback({\r\n\t\t\t\t\tindex: 0,\r\n\t\t\t\t\tvalue: result\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tcallback({\r\n\t\t\t\t\tindex: 1,\r\n\t\t\t\t\tvalue: ''\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n})(mui, window);\r\n(function($, window) {\r\n\tvar CLASS_ACTIVE = 'mui-active';\r\n\t/**\r\n\t * 自动消失提示框\r\n\t */\r\n\t$.toast = function(message,options) {\r\n\t\tvar durations = {\r\n\t\t    'long': 3500,\r\n\t\t    'short': 2000\r\n\t\t};\r\n\r\n\t\t//计算显示时间\r\n\t\t options = $.extend({\r\n\t        duration: 'short'\r\n\t    }, options || {});\r\n\r\n\r\n\t\tif ($.os.plus && options.type !== 'div') {\r\n\t\t\t//默认显示在底部；\r\n\t\t\t$.plusReady(function() {\r\n\t\t\t\tplus.nativeUI.toast(message, {\r\n\t\t\t\t\tverticalAlign: 'bottom',\r\n\t\t\t\t\tduration:options.duration\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tif (typeof options.duration === 'number') {\r\n\t\t        duration = options.duration>0 ? options.duration:durations['short'];\r\n\t\t    } else {\r\n\t\t        duration = durations[options.duration];\r\n\t\t    }\r\n\t\t    if (!duration) {\r\n\t\t        duration = durations['short'];\r\n\t\t    }\r\n\t\t\tvar toast = document.createElement('div');\r\n\t\t\ttoast.classList.add('mui-toast-container');\r\n\t\t\ttoast.innerHTML = '<div class=\"' + 'mui-toast-message' + '\">' + message + '</div>';\r\n\t\t\ttoast.addEventListener('webkitTransitionEnd', function() {\r\n\t\t\t\tif (!toast.classList.contains(CLASS_ACTIVE)) {\r\n\t\t\t\t\ttoast.parentNode.removeChild(toast);\r\n\t\t\t\t\ttoast = null;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\t//点击则自动消失\r\n\t\t\ttoast.addEventListener('click', function() {\r\n\t\t        toast.parentNode.removeChild(toast);\r\n\t\t        toast = null;\r\n\t\t    });\r\n\t\t\tdocument.body.appendChild(toast);\r\n\t\t\ttoast.offsetHeight;\r\n\t\t\ttoast.classList.add(CLASS_ACTIVE);\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\ttoast && toast.classList.remove(CLASS_ACTIVE);\r\n\t\t\t}, duration);\r\n\t\t\t\r\n\t\t\treturn {\r\n\t\t        isVisible: function() {return !!toast;}\r\n\t\t    }\r\n\t\t}   \r\n\t};\r\n\r\n})(mui, window);\r\n/**\r\n * Popup(alert,confirm,prompt)  \r\n * @param {Object} $\r\n * @param {Object} window\r\n * @param {Object} document\r\n */\r\n(function($, window, document) {\r\n    var CLASS_POPUP = 'mui-popup';\r\n    var CLASS_POPUP_BACKDROP = 'mui-popup-backdrop';\r\n    var CLASS_POPUP_IN = 'mui-popup-in';\r\n    var CLASS_POPUP_OUT = 'mui-popup-out';\r\n    var CLASS_POPUP_INNER = 'mui-popup-inner';\r\n    var CLASS_POPUP_TITLE = 'mui-popup-title';\r\n    var CLASS_POPUP_TEXT = 'mui-popup-text';\r\n    var CLASS_POPUP_INPUT = 'mui-popup-input';\r\n    var CLASS_POPUP_BUTTONS = 'mui-popup-buttons';\r\n    var CLASS_POPUP_BUTTON = 'mui-popup-button';\r\n    var CLASS_POPUP_BUTTON_BOLD = 'mui-popup-button-bold';\r\n    var CLASS_POPUP_BACKDROP = 'mui-popup-backdrop';\r\n    var CLASS_ACTIVE = 'mui-active';\r\n\r\n    var popupStack = [];\r\n    var backdrop = (function() {\r\n        var element = document.createElement('div');\r\n        element.classList.add(CLASS_POPUP_BACKDROP);\r\n        element.addEventListener($.EVENT_MOVE, $.preventDefault);\r\n        element.addEventListener('webkitTransitionEnd', function() {\r\n            if (!this.classList.contains(CLASS_ACTIVE)) {\r\n                element.parentNode && element.parentNode.removeChild(element);\r\n            }\r\n        });\r\n        return element;\r\n    }());\r\n\r\n    var createInput = function(placeholder) {\r\n        return '<div class=\"' + CLASS_POPUP_INPUT + '\"><input type=\"text\" autofocus placeholder=\"' + (placeholder || '') + '\"/></div>';\r\n    };\r\n    var createInner = function(message, title, extra) {\r\n        return '<div class=\"' + CLASS_POPUP_INNER + '\"><div class=\"' + CLASS_POPUP_TITLE + '\">' + title + '</div><div class=\"' + CLASS_POPUP_TEXT + '\">' + message.replace(/\\r\\n/g, \"<br/>\").replace(/\\n/g, \"<br/>\") + '</div>' + (extra || '') + '</div>';\r\n    };\r\n    var createButtons = function(btnArray) {\r\n        var length = btnArray.length;\r\n        var btns = [];\r\n        for (var i = 0; i < length; i++) {\r\n            btns.push('<span class=\"' + CLASS_POPUP_BUTTON + (i === length - 1 ? (' ' + CLASS_POPUP_BUTTON_BOLD) : '') + '\">' + btnArray[i] + '</span>');\r\n        }\r\n        return '<div class=\"' + CLASS_POPUP_BUTTONS + '\">' + btns.join('') + '</div>';\r\n    };\r\n\r\n    var createPopup = function(html, callback) {\r\n        var popupElement = document.createElement('div');\r\n        popupElement.className = CLASS_POPUP;\r\n        popupElement.innerHTML = html;\r\n        var removePopupElement = function() {\r\n            popupElement.parentNode && popupElement.parentNode.removeChild(popupElement);\r\n            popupElement = null;\r\n        };\r\n        popupElement.addEventListener($.EVENT_MOVE, $.preventDefault);\r\n        popupElement.addEventListener('webkitTransitionEnd', function(e) {\r\n            if (popupElement && e.target === popupElement && popupElement.classList.contains(CLASS_POPUP_OUT)) {\r\n                removePopupElement();\r\n            }\r\n        });\r\n        popupElement.style.display = 'block';\r\n        document.body.appendChild(popupElement);\r\n        popupElement.offsetHeight;\r\n        popupElement.classList.add(CLASS_POPUP_IN);\r\n\r\n        if (!backdrop.classList.contains(CLASS_ACTIVE)) {\r\n            backdrop.style.display = 'block';\r\n            document.body.appendChild(backdrop);\r\n            backdrop.offsetHeight;\r\n            backdrop.classList.add(CLASS_ACTIVE);\r\n        }\r\n        var btns = $.qsa('.' + CLASS_POPUP_BUTTON, popupElement);\r\n        var input = popupElement.querySelector('.' + CLASS_POPUP_INPUT + ' input');\r\n        var popup = {\r\n            element: popupElement,\r\n            close: function(index, animate) {\r\n                if (popupElement) {\r\n                    var result = callback && callback({\r\n                        index: index || 0,\r\n                        value: input && input.value || ''\r\n                    });\r\n                    if (result === false) { //返回false则不关闭当前popup\r\n                        return;\r\n                    }\r\n                    if (animate !== false) {\r\n                        popupElement.classList.remove(CLASS_POPUP_IN);\r\n                        popupElement.classList.add(CLASS_POPUP_OUT);\r\n                    } else {\r\n                        removePopupElement();\r\n                    }\r\n                    popupStack.pop();\r\n                    //如果还有其他popup，则不remove backdrop\r\n                    if (popupStack.length) {\r\n                        popupStack[popupStack.length - 1]['show'](animate);\r\n                    } else {\r\n                        backdrop.classList.remove(CLASS_ACTIVE);\r\n                    }\r\n                }\r\n            }\r\n        };\r\n        var handleEvent = function(e) {\r\n            popup.close(btns.indexOf(e.target));\r\n        };\r\n        $(popupElement).on('tap', '.' + CLASS_POPUP_BUTTON, handleEvent);\r\n        if (popupStack.length) {\r\n            popupStack[popupStack.length - 1]['hide']();\r\n        }\r\n        popupStack.push({\r\n            close: popup.close,\r\n            show: function(animate) {\r\n                popupElement.style.display = 'block';\r\n                popupElement.offsetHeight;\r\n                popupElement.classList.add(CLASS_POPUP_IN);\r\n            },\r\n            hide: function() {\r\n                popupElement.style.display = 'none';\r\n                popupElement.classList.remove(CLASS_POPUP_IN);\r\n            }\r\n        });\r\n        return popup;\r\n    };\r\n    var createAlert = function(message, title, btnValue, callback, type) {\r\n        if (typeof message === 'undefined') {\r\n            return;\r\n        } else {\r\n            if (typeof title === 'function') {\r\n                callback = title;\r\n                type = btnValue;\r\n                title = null;\r\n                btnValue = null;\r\n            } else if (typeof btnValue === 'function') {\r\n                type = callback;\r\n                callback = btnValue;\r\n                btnValue = null;\r\n            }\r\n        }\r\n        if (!$.os.plus || type === 'div') {\r\n            return createPopup(createInner(message, title || '提示') + createButtons([btnValue || '确定']), callback);\r\n        }\r\n        return plus.nativeUI.alert(message, callback, title || '提示', btnValue || '确定');\r\n    };\r\n    var createConfirm = function(message, title, btnArray, callback, type) {\r\n        if (typeof message === 'undefined') {\r\n            return;\r\n        } else {\r\n            if (typeof title === 'function') {\r\n                callback = title;\r\n                type = btnArray;\r\n                title = null;\r\n                btnArray = null;\r\n            } else if (typeof btnArray === 'function') {\r\n                type = callback;\r\n                callback = btnArray;\r\n                btnArray = null;\r\n            }\r\n        }\r\n        if (!$.os.plus || type === 'div') {\r\n            return createPopup(createInner(message, title || '提示') + createButtons(btnArray || ['取消', '确认']), callback);\r\n        }\r\n        return plus.nativeUI.confirm(message, callback, title, btnArray || ['取消', '确认']);\r\n    };\r\n    var createPrompt = function(message, placeholder, title, btnArray, callback, type) {\r\n        if (typeof message === 'undefined') {\r\n            return;\r\n        } else {\r\n            if (typeof placeholder === 'function') {\r\n                callback = placeholder;\r\n                type = title;\r\n                placeholder = null;\r\n                title = null;\r\n                btnArray = null;\r\n            } else if (typeof title === 'function') {\r\n                callback = title;\r\n                type = btnArray;\r\n                title = null;\r\n                btnArray = null;\r\n            } else if (typeof btnArray === 'function') {\r\n                type = callback;\r\n                callback = btnArray;\r\n                btnArray = null;\r\n            }\r\n        }\r\n        if (!$.os.plus || type === 'div') {\r\n            return createPopup(createInner(message, title || '提示', createInput(placeholder)) + createButtons(btnArray || ['取消', '确认']), callback);\r\n        }\r\n        return plus.nativeUI.prompt(message, callback, title || '提示', placeholder, btnArray || ['取消', '确认']);\r\n    };\r\n    var closePopup = function() {\r\n        if (popupStack.length) {\r\n            popupStack[popupStack.length - 1]['close']();\r\n            return true;\r\n        } else {\r\n            return false;\r\n        }\r\n    };\r\n    var closePopups = function() {\r\n        while (popupStack.length) {\r\n            popupStack[popupStack.length - 1]['close']();\r\n        }\r\n    };\r\n\r\n    $.closePopup = closePopup;\r\n    $.closePopups = closePopups;\r\n    $.alert = createAlert;\r\n    $.confirm = createConfirm;\r\n    $.prompt = createPrompt;\r\n})(mui, window, document);\r\n(function($, document) {\r\n\tvar CLASS_PROGRESSBAR = 'mui-progressbar';\r\n\tvar CLASS_PROGRESSBAR_IN = 'mui-progressbar-in';\r\n\tvar CLASS_PROGRESSBAR_OUT = 'mui-progressbar-out';\r\n\tvar CLASS_PROGRESSBAR_INFINITE = 'mui-progressbar-infinite';\r\n\r\n\tvar SELECTOR_PROGRESSBAR = '.mui-progressbar';\r\n\r\n\tvar _findProgressbar = function(container) {\r\n\t\tcontainer = $(container || 'body');\r\n\t\tif (container.length === 0) return;\r\n\t\tcontainer = container[0];\r\n\t\tif (container.classList.contains(CLASS_PROGRESSBAR)) {\r\n\t\t\treturn container;\r\n\t\t}\r\n\t\tvar progressbars = container.querySelectorAll(SELECTOR_PROGRESSBAR);\r\n\t\tif (progressbars) {\r\n\t\t\tfor (var i = 0, len = progressbars.length; i < len; i++) {\r\n\t\t\t\tvar progressbar = progressbars[i];\r\n\t\t\t\tif (progressbar.parentNode === container) {\r\n\t\t\t\t\treturn progressbar;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\t/**\r\n\t * 创建并显示进度条 \r\n\t * @param {Object} container  可选，默认body，支持selector,DOM Node,mui wrapper\r\n\t * @param {Object} progress 可选，undefined表示循环，数字表示具体进度\r\n\t * @param {Object} color 可选，指定颜色样式(目前暂未提供实际样式，可暂时不暴露此参数)\r\n\t */\r\n\tvar showProgressbar = function(container, progress, color) {\r\n\t\tif (typeof container === 'number') {\r\n\t\t\tcolor = progress;\r\n\t\t\tprogress = container;\r\n\t\t\tcontainer = 'body';\r\n\t\t}\r\n\t\tcontainer = $(container || 'body');\r\n\t\tif (container.length === 0) return;\r\n\t\tcontainer = container[0];\r\n\t\tvar progressbar;\r\n\t\tif (container.classList.contains(CLASS_PROGRESSBAR)) {\r\n\t\t\tprogressbar = container;\r\n\t\t} else {\r\n\t\t\tvar progressbars = container.querySelectorAll(SELECTOR_PROGRESSBAR + ':not(.' + CLASS_PROGRESSBAR_OUT + ')');\r\n\t\t\tif (progressbars) {\r\n\t\t\t\tfor (var i = 0, len = progressbars.length; i < len; i++) {\r\n\t\t\t\t\tvar _progressbar = progressbars[i];\r\n\t\t\t\t\tif (_progressbar.parentNode === container) {\r\n\t\t\t\t\t\tprogressbar = _progressbar;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (!progressbar) {\r\n\t\t\t\tprogressbar = document.createElement('span');\r\n\t\t\t\tprogressbar.className = CLASS_PROGRESSBAR + ' ' + CLASS_PROGRESSBAR_IN + (typeof progress !== 'undefined' ? '' : (' ' + CLASS_PROGRESSBAR_INFINITE)) + (color ? (' ' + CLASS_PROGRESSBAR + '-' + color) : '');\r\n\t\t\t\tif (typeof progress !== 'undefined') {\r\n\t\t\t\t\tprogressbar.innerHTML = '<span></span>';\r\n\t\t\t\t}\r\n\t\t\t\tcontainer.appendChild(progressbar);\r\n\t\t\t} else {\r\n\t\t\t\tprogressbar.classList.add(CLASS_PROGRESSBAR_IN);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (progress) setProgressbar(container, progress);\r\n\t\treturn progressbar;\r\n\t};\r\n\t/**\r\n\t * 关闭进度条 \r\n\t * @param {Object} container 可选，默认body，支持selector,DOM Node,mui wrapper\r\n\t */\r\n\tvar hideProgressbar = function(container) {\r\n\t\tvar progressbar = _findProgressbar(container);\r\n\t\tif (!progressbar) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar classList = progressbar.classList;\r\n\t\tif (!classList.contains(CLASS_PROGRESSBAR_IN) || classList.contains(CLASS_PROGRESSBAR_OUT)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tclassList.remove(CLASS_PROGRESSBAR_IN);\r\n\t\tclassList.add(CLASS_PROGRESSBAR_OUT);\r\n\t\tprogressbar.addEventListener('webkitAnimationEnd', function() {\r\n\t\t\tprogressbar.parentNode && progressbar.parentNode.removeChild(progressbar);\r\n\t\t\tprogressbar = null;\r\n\t\t});\r\n\t\treturn;\r\n\t};\r\n\t/**\r\n\t * 设置指定进度条进度 \r\n\t * @param {Object} container  可选，默认body，支持selector,DOM Node,mui wrapper\r\n\t * @param {Object} progress 可选，默认0 取值范围[0-100]\r\n\t * @param {Object} speed 进度条动画时间\r\n\t */\r\n\tvar setProgressbar = function(container, progress, speed) {\r\n\t\tif (typeof container === 'number') {\r\n\t\t\tspeed = progress;\r\n\t\t\tprogress = container;\r\n\t\t\tcontainer = false;\r\n\t\t}\r\n\t\tvar progressbar = _findProgressbar(container);\r\n\t\tif (!progressbar || progressbar.classList.contains(CLASS_PROGRESSBAR_INFINITE)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (progress) progress = Math.min(Math.max(progress, 0), 100);\r\n\t\tprogressbar.offsetHeight;\r\n\t\tvar span = progressbar.querySelector('span');\r\n\t\tif (span) {\r\n\t\t\tvar style = span.style;\r\n\t\t\tstyle.webkitTransform = 'translate3d(' + (-100 + progress) + '%,0,0)';\r\n\t\t\tif (typeof speed !== 'undefined') {\r\n\t\t\t\tstyle.webkitTransitionDuration = speed + 'ms';\r\n\t\t\t} else {\r\n\t\t\t\tstyle.webkitTransitionDuration = '';\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn progressbar;\r\n\t};\r\n\t$.fn.progressbar = function(options) {\r\n\t\tvar progressbarApis = [];\r\n\t\toptions = options || {};\r\n\t\tthis.each(function() {\r\n\t\t\tvar self = this;\r\n\t\t\tvar progressbarApi = self.mui_plugin_progressbar;\r\n\t\t\tif (!progressbarApi) {\r\n\t\t\t\tself.mui_plugin_progressbar = progressbarApi = {\r\n\t\t\t\t\toptions: options,\r\n\t\t\t\t\tsetOptions: function(options) {\r\n\t\t\t\t\t\tthis.options = options;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tshow: function() {\r\n\t\t\t\t\t\treturn showProgressbar(self, this.options.progress, this.options.color);\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsetProgress: function(progress) {\r\n\t\t\t\t\t\treturn setProgressbar(self, progress);\r\n\t\t\t\t\t},\r\n\t\t\t\t\thide: function() {\r\n\t\t\t\t\t\treturn hideProgressbar(self);\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t} else if (options) {\r\n\t\t\t\tprogressbarApi.setOptions(options);\r\n\t\t\t}\r\n\t\t\tprogressbarApis.push(progressbarApi);\r\n\t\t});\r\n\t\treturn progressbarApis.length === 1 ? progressbarApis[0] : progressbarApis;\r\n\t};\r\n\t//\t$.setProgressbar = setProgressbar;\r\n\t//\t$.showProgressbar = showProgressbar;\r\n\t//\t$.hideProgressbar = hideProgressbar;\r\n})(mui, document);\r\n/**\r\n * Input(TODO resize)\r\n * @param {type} $\r\n * @param {type} window\r\n * @param {type} document\r\n * @returns {undefined}\r\n */\r\n(function($, window, document) {\r\n\tvar CLASS_ICON = 'mui-icon';\r\n\tvar CLASS_ICON_CLEAR = 'mui-icon-clear';\r\n\tvar CLASS_ICON_SPEECH = 'mui-icon-speech';\r\n\tvar CLASS_ICON_SEARCH = 'mui-icon-search';\r\n\tvar CLASS_ICON_PASSWORD = 'mui-icon-eye';\r\n\tvar CLASS_INPUT_ROW = 'mui-input-row';\r\n\tvar CLASS_PLACEHOLDER = 'mui-placeholder';\r\n\tvar CLASS_TOOLTIP = 'mui-tooltip';\r\n\tvar CLASS_HIDDEN = 'mui-hidden';\r\n\tvar CLASS_FOCUSIN = 'mui-focusin';\r\n\tvar SELECTOR_ICON_CLOSE = '.' + CLASS_ICON_CLEAR;\r\n\tvar SELECTOR_ICON_SPEECH = '.' + CLASS_ICON_SPEECH;\r\n\tvar SELECTOR_ICON_PASSWORD = '.' + CLASS_ICON_PASSWORD;\r\n\tvar SELECTOR_PLACEHOLDER = '.' + CLASS_PLACEHOLDER;\r\n\tvar SELECTOR_TOOLTIP = '.' + CLASS_TOOLTIP;\r\n\r\n\tvar findRow = function(target) {\r\n\t\tfor (; target && target !== document; target = target.parentNode) {\r\n\t\t\tif (target.classList && target.classList.contains(CLASS_INPUT_ROW)) {\r\n\t\t\t\treturn target;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t};\r\n\tvar Input = function(element, options) {\r\n\t\tthis.element = element;\r\n\t\tthis.options = options || {\r\n\t\t\tactions: 'clear'\r\n\t\t};\r\n\t\tif (~this.options.actions.indexOf('slider')) { //slider\r\n\t\t\tthis.sliderActionClass = CLASS_TOOLTIP + ' ' + CLASS_HIDDEN;\r\n\t\t\tthis.sliderActionSelector = SELECTOR_TOOLTIP;\r\n\t\t} else { //clear,speech,search\r\n\t\t\tif (~this.options.actions.indexOf('clear')) {\r\n\t\t\t\tthis.clearActionClass = CLASS_ICON + ' ' + CLASS_ICON_CLEAR + ' ' + CLASS_HIDDEN;\r\n\t\t\t\tthis.clearActionSelector = SELECTOR_ICON_CLOSE;\r\n\t\t\t}\r\n\t\t\tif (~this.options.actions.indexOf('speech')) { //only for 5+\r\n\t\t\t\tthis.speechActionClass = CLASS_ICON + ' ' + CLASS_ICON_SPEECH;\r\n\t\t\t\tthis.speechActionSelector = SELECTOR_ICON_SPEECH;\r\n\t\t\t}\r\n\t\t\tif (~this.options.actions.indexOf('search')) {\r\n\t\t\t\tthis.searchActionClass = CLASS_PLACEHOLDER;\r\n\t\t\t\tthis.searchActionSelector = SELECTOR_PLACEHOLDER;\r\n\t\t\t}\r\n\t\t\tif (~this.options.actions.indexOf('password')) {\r\n\t\t\t\tthis.passwordActionClass = CLASS_ICON + ' ' + CLASS_ICON_PASSWORD;\r\n\t\t\t\tthis.passwordActionSelector = SELECTOR_ICON_PASSWORD;\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.init();\r\n\t};\r\n\tInput.prototype.init = function() {\r\n\t\tthis.initAction();\r\n\t\tthis.initElementEvent();\r\n\t};\r\n\tInput.prototype.initAction = function() {\r\n\t\tvar self = this;\r\n\r\n\t\tvar row = self.element.parentNode;\r\n\t\tif (row) {\r\n\t\t\tif (self.sliderActionClass) {\r\n\t\t\t\tself.sliderAction = self.createAction(row, self.sliderActionClass, self.sliderActionSelector);\r\n\t\t\t} else {\r\n\t\t\t\tif (self.searchActionClass) {\r\n\t\t\t\t\tself.searchAction = self.createAction(row, self.searchActionClass, self.searchActionSelector);\r\n\t\t\t\t\tself.searchAction.addEventListener('tap', function(e) {\r\n\t\t\t\t\t\t$.focus(self.element);\r\n\t\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\tif (self.speechActionClass) {\r\n\t\t\t\t\tself.speechAction = self.createAction(row, self.speechActionClass, self.speechActionSelector);\r\n\t\t\t\t\tself.speechAction.addEventListener('click', $.stopPropagation);\r\n\t\t\t\t\tself.speechAction.addEventListener('tap', function(event) {\r\n\t\t\t\t\t\tself.speechActionClick(event);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\tif (self.clearActionClass) {\r\n\t\t\t\t\tself.clearAction = self.createAction(row, self.clearActionClass, self.clearActionSelector);\r\n\t\t\t\t\tself.clearAction.addEventListener('tap', function(event) {\r\n\t\t\t\t\t\tself.clearActionClick(event);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\tif (self.passwordActionClass) {\r\n\t\t\t\t\tself.passwordAction = self.createAction(row, self.passwordActionClass, self.passwordActionSelector);\r\n\t\t\t\t\tself.passwordAction.addEventListener('tap', function(event) {\r\n\t\t\t\t\t\tself.passwordActionClick(event);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\tInput.prototype.createAction = function(row, actionClass, actionSelector) {\r\n\t\tvar action = row.querySelector(actionSelector);\r\n\t\tif (!action) {\r\n\t\t\tvar action = document.createElement('span');\r\n\t\t\taction.className = actionClass;\r\n\t\t\tif (actionClass === this.searchActionClass) {\r\n\t\t\t\taction.innerHTML = '<span class=\"' + CLASS_ICON + ' ' + CLASS_ICON_SEARCH + '\"></span><span>' + this.element.getAttribute('placeholder') + '</span>';\r\n\t\t\t\tthis.element.setAttribute('placeholder', '');\r\n\t\t\t\tif (this.element.value.trim()) {\r\n\t\t\t\t\trow.classList.add('mui-active');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\trow.insertBefore(action, this.element.nextSibling);\r\n\t\t}\r\n\t\treturn action;\r\n\t};\r\n\tInput.prototype.initElementEvent = function() {\r\n\t\tvar element = this.element;\r\n\r\n\t\tif (this.sliderActionClass) {\r\n\t\t\tvar tooltip = this.sliderAction;\r\n\t\t\tvar timer = null;\r\n\t\t\tvar showTip = function() { //每次重新计算是因为控件可能被隐藏，初始化时计算是不正确的\r\n\t\t\t\ttooltip.classList.remove(CLASS_HIDDEN);\r\n\t\t\t\tvar offsetLeft = element.offsetLeft;\r\n\t\t\t\tvar width = element.offsetWidth - 28;\r\n\t\t\t\tvar tooltipWidth = tooltip.offsetWidth;\r\n\t\t\t\tvar distince = Math.abs(element.max - element.min);\r\n\t\t\t\tvar scaleWidth = (width / distince) * Math.abs(element.value - element.min);\r\n\t\t\t\ttooltip.style.left = (14 + offsetLeft + scaleWidth - tooltipWidth / 2) + 'px';\r\n\t\t\t\ttooltip.innerText = element.value;\r\n\t\t\t\tif (timer) {\r\n\t\t\t\t\tclearTimeout(timer);\r\n\t\t\t\t}\r\n\t\t\t\ttimer = setTimeout(function() {\r\n\t\t\t\t\ttooltip.classList.add(CLASS_HIDDEN);\r\n\t\t\t\t}, 1000);\r\n\t\t\t};\r\n\t\t\telement.addEventListener('input', showTip);\r\n\t\t\telement.addEventListener('tap', showTip);\r\n\t\t\telement.addEventListener($.EVENT_MOVE, function(e) {\r\n\t\t\t\te.stopPropagation();\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tif (this.clearActionClass) {\r\n\t\t\t\tvar action = this.clearAction;\r\n\t\t\t\tif (!action) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t$.each(['keyup', 'change', 'input', 'focus', 'cut', 'paste'], function(index, type) {\r\n\t\t\t\t\t(function(type) {\r\n\t\t\t\t\t\telement.addEventListener(type, function() {\r\n\t\t\t\t\t\t\taction.classList[element.value.trim() ? 'remove' : 'add'](CLASS_HIDDEN);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t})(type);\r\n\t\t\t\t});\r\n\t\t\t\telement.addEventListener('blur', function() {\r\n\t\t\t\t\taction.classList.add(CLASS_HIDDEN);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tif (this.searchActionClass) {\r\n\t\t\t\telement.addEventListener('focus', function() {\r\n\t\t\t\t\telement.parentNode.classList.add('mui-active');\r\n\t\t\t\t});\r\n\t\t\t\telement.addEventListener('blur', function() {\r\n\t\t\t\t\tif (!element.value.trim()) {\r\n\t\t\t\t\t\telement.parentNode.classList.remove('mui-active');\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\tInput.prototype.setPlaceholder = function(text) {\r\n\t\tif (this.searchActionClass) {\r\n\t\t\tvar placeholder = this.element.parentNode.querySelector(SELECTOR_PLACEHOLDER);\r\n\t\t\tplaceholder && (placeholder.getElementsByTagName('span')[1].innerText = text);\r\n\t\t} else {\r\n\t\t\tthis.element.setAttribute('placeholder', text);\r\n\t\t}\r\n\t};\r\n\tInput.prototype.passwordActionClick = function(event) {\r\n\t\tif (this.element.type === 'text') {\r\n\t\t\tthis.element.type = 'password';\r\n\t\t} else {\r\n\t\t\tthis.element.type = 'text';\r\n\t\t}\r\n\t\tthis.passwordAction.classList.toggle('mui-active');\r\n\t\tevent.preventDefault();\r\n\t};\r\n\tInput.prototype.clearActionClick = function(event) {\r\n\t\tvar self = this;\r\n\t\tself.element.value = '';\r\n\t\t$.focus(self.element);\r\n\t\tself.clearAction.classList.add(CLASS_HIDDEN);\r\n\t\tevent.preventDefault();\r\n\t};\r\n\tInput.prototype.speechActionClick = function(event) {\r\n\t\tif (window.plus) {\r\n\t\t\tvar self = this;\r\n\t\t\tvar oldValue = self.element.value;\r\n\t\t\tself.element.value = '';\r\n\t\t\tdocument.body.classList.add(CLASS_FOCUSIN);\r\n\t\t\tplus.speech.startRecognize({\r\n\t\t\t\tengine: 'iFly'\r\n\t\t\t}, function(s) {\r\n\t\t\t\tself.element.value += s;\r\n\t\t\t\t$.focus(self.element);\r\n\t\t\t\tplus.speech.stopRecognize();\r\n\t\t\t\t$.trigger(self.element, 'recognized', {\r\n\t\t\t\t\tvalue: self.element.value\r\n\t\t\t\t});\r\n\t\t\t\tif (oldValue !== self.element.value) {\r\n\t\t\t\t\t$.trigger(self.element, 'change');\r\n\t\t\t\t\t$.trigger(self.element, 'input');\r\n\t\t\t\t}\r\n\t\t\t\t// document.body.classList.remove(CLASS_FOCUSIN);\r\n\t\t\t}, function(e) {\r\n\t\t\t\tdocument.body.classList.remove(CLASS_FOCUSIN);\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\talert('only for 5+');\r\n\t\t}\r\n\t\tevent.preventDefault();\r\n\t};\r\n\t$.fn.input = function(options) {\r\n\t\tvar inputApis = [];\r\n\t\tthis.each(function() {\r\n\t\t\tvar inputApi = null;\r\n\t\t\tvar actions = [];\r\n\t\t\tvar row = findRow(this.parentNode);\r\n\t\t\tif (this.type === 'range' && row.classList.contains('mui-input-range')) {\r\n\t\t\t\tactions.push('slider');\r\n\t\t\t} else {\r\n\t\t\t\tvar classList = this.classList;\r\n\t\t\t\tif (classList.contains('mui-input-clear')) {\r\n\t\t\t\t\tactions.push('clear');\r\n\t\t\t\t}\r\n\t\t\t\tif (!($.os.android && $.os.stream) && classList.contains('mui-input-speech')) {\r\n\t\t\t\t\tactions.push('speech');\r\n\t\t\t\t}\r\n\t\t\t\tif (classList.contains('mui-input-password')) {\r\n\t\t\t\t\tactions.push('password');\r\n\t\t\t\t}\r\n\t\t\t\tif (this.type === 'search' && row.classList.contains('mui-search')) {\r\n\t\t\t\t\tactions.push('search');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar id = this.getAttribute('data-input-' + actions[0]);\r\n\t\t\tif (!id) {\r\n\t\t\t\tid = ++$.uuid;\r\n\t\t\t\tinputApi = $.data[id] = new Input(this, {\r\n\t\t\t\t\tactions: actions.join(',')\r\n\t\t\t\t});\r\n\t\t\t\tfor (var i = 0, len = actions.length; i < len; i++) {\r\n\t\t\t\t\tthis.setAttribute('data-input-' + actions[i], id);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tinputApi = $.data[id];\r\n\t\t\t}\r\n\t\t\tinputApis.push(inputApi);\r\n\t\t});\r\n\t\treturn inputApis.length === 1 ? inputApis[0] : inputApis;\r\n\t};\r\n\t$.ready(function() {\r\n\t\t$('.mui-input-row input').input();\r\n\t});\r\n})(mui, window, document);\r\n(function($, window) {\r\n    var CLASS_ACTIVE = 'mui-active';\r\n    var rgbaRegex = /^rgba\\((\\d{1,3}),\\s*(\\d{1,3}),\\s*(\\d{1,3}),\\s*(\\d*(?:\\.\\d+)?)\\)$/;\r\n    var getColor = function(colorStr) {\r\n        var matches = colorStr.match(rgbaRegex);\r\n        if (matches && matches.length === 5) {\r\n            return [\r\n                matches[1],\r\n                matches[2],\r\n                matches[3],\r\n                matches[4]\r\n            ];\r\n        }\r\n        return [];\r\n    };\r\n    var Transparent = function(element, options) {\r\n        this.element = element;\r\n        this.options = $.extend({\r\n            top: 0, //距离顶部高度(到达该高度即触发)\r\n            offset: 150, //滚动透明距离\r\n            duration: 16, //过渡时间\r\n            scrollby: window//监听滚动距离容器\r\n        }, options || {});\r\n\r\n        this.scrollByElem = this.options.scrollby || window;\r\n        if (!this.scrollByElem) {\r\n            throw new Error(\"监听滚动的元素不存在\");\r\n        }\r\n        this.isNativeScroll = false;\r\n        if (this.scrollByElem === window) {\r\n            this.isNativeScroll = true;\r\n        } else if (!~this.scrollByElem.className.indexOf('mui-scroll-wrapper')) {\r\n            this.isNativeScroll = true;\r\n        }\r\n\r\n        this._style = this.element.style;\r\n        this._bgColor = this._style.backgroundColor;\r\n        var color = getColor(mui.getStyles(this.element, 'backgroundColor'));\r\n        if (color.length) {\r\n            this._R = color[0];\r\n            this._G = color[1];\r\n            this._B = color[2];\r\n            this._A = parseFloat(color[3]);\r\n            this.lastOpacity = this._A;\r\n            this._bufferFn = $.buffer(this.handleScroll, this.options.duration, this);\r\n            this.initEvent();\r\n        } else {\r\n            throw new Error(\"元素背景颜色必须为RGBA\");\r\n        }\r\n    };\r\n\r\n    Transparent.prototype.initEvent = function() {\r\n        this.scrollByElem.addEventListener('scroll', this._bufferFn);\r\n        if (this.isNativeScroll) { //原生scroll\r\n            this.scrollByElem.addEventListener($.EVENT_MOVE, this._bufferFn);\r\n        }\r\n    }\r\n    Transparent.prototype.handleScroll = function(e) {\r\n        var y = window.scrollY;\r\n        if (!this.isNativeScroll && e && e.detail) {\r\n            y = -e.detail.y;\r\n        }\r\n        var opacity = (y - this.options.top) / this.options.offset + this._A;\r\n        opacity = Math.min(Math.max(this._A, opacity), 1);\r\n        this._style.backgroundColor = 'rgba(' + this._R + ',' + this._G + ',' + this._B + ',' + opacity + ')';\r\n        if (opacity > this._A) {\r\n            this.element.classList.add(CLASS_ACTIVE);\r\n        } else {\r\n            this.element.classList.remove(CLASS_ACTIVE);\r\n        }\r\n        if (this.lastOpacity !== opacity) {\r\n            $.trigger(this.element, 'alpha', {\r\n                alpha: opacity\r\n            });\r\n            this.lastOpacity = opacity;\r\n        }\r\n    };\r\n    Transparent.prototype.destory = function() {\r\n        this.scrollByElem.removeEventListener('scroll', this._bufferFn);\r\n        this.scrollByElem.removeEventListener($.EVENT_MOVE, this._bufferFn);\r\n        this.element.style.backgroundColor = this._bgColor;\r\n        this.element.mui_plugin_transparent = null;\r\n    };\r\n    $.fn.transparent = function(options) {\r\n        options = options || {};\r\n        var transparentApis = [];\r\n        this.each(function() {\r\n            var transparentApi = this.mui_plugin_transparent;\r\n            if (!transparentApi) {\r\n                var top = this.getAttribute('data-top');\r\n                var offset = this.getAttribute('data-offset');\r\n                var duration = this.getAttribute('data-duration');\r\n                var scrollby = this.getAttribute('data-scrollby');\r\n                if (top !== null && typeof options.top === 'undefined') {\r\n                    options.top = top;\r\n                }\r\n                if (offset !== null && typeof options.offset === 'undefined') {\r\n                    options.offset = offset;\r\n                }\r\n                if (duration !== null && typeof options.duration === 'undefined') {\r\n                    options.duration = duration;\r\n                }\r\n                if (scrollby !== null && typeof options.scrollby === 'undefined') {\r\n                    options.scrollby = document.querySelector(scrollby) || window;\r\n                }\r\n                transparentApi = this.mui_plugin_transparent = new Transparent(this, options);\r\n            }\r\n            transparentApis.push(transparentApi);\r\n        });\r\n        return transparentApis.length === 1 ? transparentApis[0] : transparentApis;\r\n    };\r\n    $.ready(function() {\r\n        $('.mui-bar-transparent').transparent();\r\n    });\r\n})(mui, window);\r\n/**\r\n * 数字输入框\r\n * varstion 1.0.1\r\n * by Houfeng\r\n * Houfeng@DCloud.io\r\n */\r\n\r\n(function($) {\r\n\r\n    var touchSupport = ('ontouchstart' in document);\r\n    var tapEventName = touchSupport ? 'tap' : 'click';\r\n    var changeEventName = 'change';\r\n    var holderClassName = 'mui-numbox';\r\n    var plusClassSelector = '.mui-btn-numbox-plus,.mui-numbox-btn-plus';\r\n    var minusClassSelector = '.mui-btn-numbox-minus,.mui-numbox-btn-minus';\r\n    var inputClassSelector = '.mui-input-numbox,.mui-numbox-input';\r\n\r\n    var Numbox = $.Numbox = $.Class.extend({\r\n        /**\r\n         * 构造函数\r\n         **/\r\n        init: function(holder, options) {\r\n            var self = this;\r\n            if (!holder) {\r\n                throw \"构造 numbox 时缺少容器元素\";\r\n            }\r\n            self.holder = holder;\r\n            options = options || {};\r\n            options.step = parseInt(options.step || 1);\r\n            self.options = options;\r\n            self.input = $.qsa(inputClassSelector, self.holder)[0];\r\n            self.plus = $.qsa(plusClassSelector, self.holder)[0];\r\n            self.minus = $.qsa(minusClassSelector, self.holder)[0];\r\n            self.checkValue();\r\n            self.initEvent();\r\n        },\r\n        /**\r\n         * 初始化事件绑定\r\n         **/\r\n        initEvent: function() {\r\n            var self = this;\r\n            self.plus.addEventListener(tapEventName, function(event) {\r\n                var val = parseInt(self.input.value) + self.options.step;\r\n                self.input.value = val.toString();\r\n                $.trigger(self.input, changeEventName, null);\r\n            });\r\n            self.minus.addEventListener(tapEventName, function(event) {\r\n                var val = parseInt(self.input.value) - self.options.step;\r\n                self.input.value = val.toString();\r\n                $.trigger(self.input, changeEventName, null);\r\n            });\r\n            self.input.addEventListener(changeEventName, function(event) {\r\n                self.checkValue();\r\n                var val = parseInt(self.input.value);\r\n                //触发顶层容器\r\n                $.trigger(self.holder, changeEventName, {\r\n                    value: val\r\n                });\r\n            });\r\n        },\r\n        /**\r\n         * 获取当前值\r\n         **/\r\n        getValue: function() {\r\n            var self = this;\r\n            return parseInt(self.input.value);\r\n        },\r\n        /**\r\n         * 验证当前值是法合法\r\n         **/\r\n        checkValue: function() {\r\n            var self = this;\r\n            var val = self.input.value;\r\n            if (val == null || val == '' || isNaN(val)) {\r\n                self.input.value = self.options.min || 0;\r\n                self.minus.disabled = self.options.min != null;\r\n            } else {\r\n                var val = parseInt(val);\r\n                if (self.options.max != null && !isNaN(self.options.max) && val >= parseInt(self.options.max)) {\r\n                    val = self.options.max;\r\n                    self.plus.disabled = true;\r\n                } else {\r\n                    self.plus.disabled = false;\r\n                }\r\n                if (self.options.min != null && !isNaN(self.options.min) && val <= parseInt(self.options.min)) {\r\n                    val = self.options.min;\r\n                    self.minus.disabled = true;\r\n                } else {\r\n                    self.minus.disabled = false;\r\n                }\r\n                self.input.value = val;\r\n            }\r\n        },\r\n        /**\r\n         * 更新选项\r\n         **/\r\n        setOption: function(name, value) {\r\n            var self = this;\r\n            self.options[name] = value;\r\n        },\r\n        /**\r\n         * 动态设置新值\r\n         **/\r\n        setValue: function(value) {\r\n            this.input.value = value;\r\n            this.checkValue();\r\n        }\r\n    });\r\n\r\n    $.fn.numbox = function(options) {\r\n        var instanceArray = [];\r\n        //遍历选择的元素\r\n        this.each(function(i, element) {\r\n            if (element.numbox) {\r\n                return;\r\n            }\r\n            if (options) {\r\n                element.numbox = new Numbox(element, options);\r\n            } else {\r\n                var optionsText = element.getAttribute('data-numbox-options');\r\n                var options = optionsText ? JSON.parse(optionsText) : {};\r\n                options.step = element.getAttribute('data-numbox-step') || options.step;\r\n                options.min = element.getAttribute('data-numbox-min') || options.min;\r\n                options.max = element.getAttribute('data-numbox-max') || options.max;\r\n                element.numbox = new Numbox(element, options);\r\n            }\r\n        });\r\n        return this[0] ? this[0].numbox : null;\r\n    }\r\n\r\n    //自动处理 class='mui-locker' 的 dom\r\n    $.ready(function() {\r\n        $('.' + holderClassName).numbox();\r\n    });\r\n\r\n}(mui));\r\n/**\r\n * Button\r\n * @param {type} $\r\n * @param {type} window\r\n * @param {type} document\r\n * @returns {undefined}\r\n */\r\n(function($, window, document) {\r\n    var CLASS_ICON = 'mui-icon';\r\n    var CLASS_DISABLED = 'mui-disabled';\r\n\r\n    var STATE_RESET = 'reset';\r\n    var STATE_LOADING = 'loading';\r\n\r\n    var defaultOptions = {\r\n        loadingText: 'Loading...', //文案\r\n        loadingIcon: 'mui-spinner' + ' ' + 'mui-spinner-white', //图标，可为空\r\n        loadingIconPosition: 'left' //图标所处位置，仅支持left|right\r\n    };\r\n\r\n    var Button = function(element, options) {\r\n        this.element = element;\r\n        this.options = $.extend({}, defaultOptions, options);\r\n        if (!this.options.loadingText) {\r\n            this.options.loadingText = defaultOptions.loadingText;\r\n        }\r\n        if (this.options.loadingIcon === null) {\r\n            this.options.loadingIcon = 'mui-spinner';\r\n            if ($.getStyles(this.element, 'color') === 'rgb(255, 255, 255)') {\r\n                this.options.loadingIcon += ' ' + 'mui-spinner-white';\r\n            }\r\n        }\r\n        this.isInput = this.element.tagName === 'INPUT';\r\n        this.resetHTML = this.isInput ? this.element.value : this.element.innerHTML;\r\n        this.state = '';\r\n    };\r\n    Button.prototype.loading = function() {\r\n        this.setState(STATE_LOADING);\r\n    };\r\n    Button.prototype.reset = function() {\r\n        this.setState(STATE_RESET);\r\n    };\r\n    Button.prototype.setState = function(state) {\r\n        if (this.state === state) {\r\n            return false;\r\n        }\r\n        this.state = state;\r\n        if (state === STATE_RESET) {\r\n            this.element.disabled = false;\r\n            this.element.classList.remove(CLASS_DISABLED);\r\n            this.setHtml(this.resetHTML);\r\n        } else if (state === STATE_LOADING) {\r\n            this.element.disabled = true;\r\n            this.element.classList.add(CLASS_DISABLED);\r\n            var html = this.isInput ? this.options.loadingText : ('<span>' + this.options.loadingText + '</span>');\r\n            if (this.options.loadingIcon && !this.isInput) {\r\n                if (this.options.loadingIconPosition === 'right') {\r\n                    html += '&nbsp;<span class=\"' + this.options.loadingIcon + '\"></span>';\r\n                } else {\r\n                    html = '<span class=\"' + this.options.loadingIcon + '\"></span>&nbsp;' + html;\r\n                }\r\n            }\r\n            this.setHtml(html);\r\n        }\r\n    };\r\n    Button.prototype.setHtml = function(html) {\r\n        if (this.isInput) {\r\n            this.element.value = html;\r\n        } else {\r\n            this.element.innerHTML = html;\r\n        }\r\n    }\r\n    $.fn.button = function(state) {\r\n        var buttonApis = [];\r\n        this.each(function() {\r\n            var buttonApi = this.mui_plugin_button;\r\n            if (!buttonApi) {\r\n                var loadingText = this.getAttribute('data-loading-text');\r\n                var loadingIcon = this.getAttribute('data-loading-icon');\r\n                var loadingIconPosition = this.getAttribute('data-loading-icon-position');\r\n                this.mui_plugin_button = buttonApi = new Button(this, {\r\n                    loadingText: loadingText,\r\n                    loadingIcon: loadingIcon,\r\n                    loadingIconPosition: loadingIconPosition\r\n                });\r\n            }\r\n            if (state === STATE_LOADING || state === STATE_RESET) {\r\n                buttonApi.setState(state);\r\n            }\r\n            buttonApis.push(buttonApi);\r\n        });\r\n        return buttonApis.length === 1 ? buttonApis[0] : buttonApis;\r\n    };\r\n})(mui, window, document);\r\nwindow.mui=mui"]}]}